{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Overview","text":"Bespokefit_smee <p>Generate a Bespoke Force-Field Parametrization Quickly and Reliably. Developed in the Cole Group at Newcastle University. Please see the documentation.</p> <p>Warning: This code is experimental and under active development. It is not guaranteed to provide correct results, the documentation and testing is incomplete, and the API may change without notice.</p> <p>Please note that the MACE-OFF models are released under the Academic Software License which does not permit commercial use. However, the default Egret-1 model and AIMNet-2 models do.</p>"},{"location":"#what-is-bespokefit_smee","title":"What is Bespokefit_smee?","text":"<p>Bespokefit_smee is a Force-Field parametrization tool. For a given molecule, it will generate a data set of conformers using machine learning models in OpenMM-ML simulations. This dataset is used to optimise the force field parameters.</p>"},{"location":"#installation","title":"Installation","text":"<p>Ensuring that you have pixi installed, run: <pre><code>git clone https://github.com/fjclark/bespokefit_smee.git\ncd bespokefit_smee\npixi install\n</code></pre></p>"},{"location":"#usage","title":"Usage","text":"<p>First, start a shell in the current environment (this must be run from the <code>bespokefit_smee</code> base directory) <pre><code>pixi shell\n</code></pre> For more information on activating pixi environments, see the documentation.</p> <p>Run with command line arguments: <pre><code>bespokefit_smee train --parameterisation-settings.smiles \"CCC(CC)C(=O)Nc2cc(NC(=O)c1c(Cl)cccc1Cl)ccn2\"\n</code></pre></p> <p>Sensible defaults have been set, but all available options can be viewed with: <pre><code>bespokefit_smee train --help\n</code></pre></p> <p>Run from a yaml file: <pre><code>bespokefit_smee write-default-yaml default.yaml\n# Modify the yaml to set the desired smiles\nbespokefit_smee train-from-yaml default.yaml\n</code></pre></p> <p>For more details on the theory and implementation, please see the documentation.</p>"},{"location":"#mace-model-use","title":"MACE-Model Use","text":"<p>To use models with the MACE architecture, run <pre><code>pixi shell -e mace-runtime\n</code></pre></p>"},{"location":"#copyright","title":"Copyright","text":"<p>Copyright (c) 2025-2026, Finlay Clark, Newcastle University, UK</p> <p>Copyright (c) 2025-2026, Thomas James Pope, Newcastle University, UK</p> <p>This package includes models from other projects under the MIT license. See <code>bespokefit_smee/models/LICENSES.md</code> for details.</p>"},{"location":"#acknowledgements","title":"Acknowledgements","text":"<p>All early development was completed by Thomas James Pope. Many ideas taken from Simon Boothroyd's super helpful python-template.</p>"},{"location":"changelog/","title":"Changelog","text":""},{"location":"changelog/#020","title":"0.2.0","text":""},{"location":"changelog/#new-features","title":"New Features","text":"<ul> <li>Implement new default protocol with MLP-minimised configurations</li> <li>Add support for loading multiple pre-computed datasets for training</li> <li>Implement flexible bespoke SMARTS type generation with <code>MergeQueryHs</code></li> <li>Add support for multi-molecule simultaneous fits</li> <li>Add dataset filtering function for preprocessing</li> <li>Add function for calculating Hessian matrices</li> </ul>"},{"location":"changelog/#improvements","title":"Improvements","text":"<ul> <li>GPU Memory Management: Significantly improved GPU memory handling</li> <li>Add GPU memory cleanup utility function</li> <li>Clear GPU memory after sampling operations</li> <li>Reduce GPU memory usage throughout training pipeline</li> <li>Fix GPU memory leaks with LM optimizer</li> <li>Make CUDA operations conditional on availability for CPU-only environments</li> <li>Modified Seminario Method (MSM)</li> <li>Complete reimplementation of MSM for better performance</li> <li>ML Potential Updates</li> <li>Add aceff-2.0 and make it the default MLP</li> <li>Update default sampling settings (consistent with higher speed of aceff-2.0)</li> <li>Force Field Updates</li> <li>Update default MM-FF to 2.3.0</li> <li>Ensure we train FF with bespoke types added</li> <li>Ensure parameter names are not overwritten</li> <li>Regularization Improvements</li> <li>Overhaul regularization and calculation of loss</li> <li>Normalize regularization per-parameter</li> <li>Decouple type generation from regularization</li> <li>Optimizer Fixes</li> <li>Fix LM optimizer implementation</li> <li>Clear cache between iterations with Adam</li> <li>Avoid GPU memory leaks with LM optimizer</li> <li>Path Management</li> <li>Fix path management for multiple molecules</li> <li>Improve handling of output paths for per-molecule outputs</li> </ul>"},{"location":"changelog/#maintenance","title":"Maintenance","text":"<ul> <li>Remove bespoke toolkit wrapper</li> </ul>"},{"location":"changelog/#011","title":"0.1.1","text":""},{"location":"changelog/#documentation","title":"Documentation","text":"<ul> <li>Added example notebook</li> </ul>"},{"location":"changelog/#010","title":"0.1.0","text":"<ul> <li>Initial implementation.</li> </ul>"},{"location":"development/","title":"Development","text":""},{"location":"development/#writing-code","title":"Writing Code","text":"<p>To create a development environment, you must have <code>pixi</code> installed.</p> <p>A development environment (the default environment) can be created and activated with:</p> <pre><code>pixi shell\n</code></pre> <p>Some handy <code>pixi</code> commands are available: <pre><code>pixi run lint # Lint the codebase with Ruff\npixi run format # Format the codebase with Ruff\npixi run type-check # Type-check the codebase with Mypy\npixi run test # Run the unit tests with Pytest\n</code></pre></p> <p>To build and the documentation locally:</p> <pre><code>pixi run docs-build\npixi run docs-serve\n</code></pre> <p>To deploy the documentation (not usually necessary as it should be automatically deployed by GH Actions):</p> <pre><code>pixi run docs-deploy\n</code></pre>"},{"location":"development/#publishing","title":"Publishing","text":""},{"location":"development/#pypi","title":"PyPI","text":"<p>NOTE: Not yet implemented.</p> <p>There is a GitHub Actions workflow that will automatically publish to PyPI when a new tag is pushed: <pre><code>git tag &lt;new version&gt;\ngit push origin &lt;new version&gt;\n</code></pre></p>"},{"location":"theory/","title":"Theory","text":"<p>The accuracy of transferable molecular mechanics force fields is often limited by their lack of transferability, rather than their functional form. <code>bespokefit_smee</code> aims to generate accurate molecular mechanics force field parameters specifically for your molecule/ molecules of interest. This is done by fitting parameters to energies and forces from a machine learning potential, which loses little accuracy compared to the QM method it was trained on, but is orders of magnitude faster:</p> <p></p>"},{"location":"theory/#initial-force-field","title":"Initial force field","text":"<p>The fit can be started from any standard OpenFF, force field. Only the valence parameters (bonds, angles, proper torsions, and improper torsions) are trained, while the Lennard-Jones terms and changes are left unaltered. The functional form of the valence terms are:</p> <ul> <li>Bonds and angles are defined by a harmonic function, \\(u(x;k,x_0)=\\frac{k}{2}\\left(x-x_0\\right)^2\\), where the position of the minimum, \\(x_0\\), and the magnitude, \\(k\\), are the fitting parameters.</li> <li>Proper and improper torsions are defined by a set of cosine functions, \\(u_p(\\phi;k,\\phi_0)=k\\left(1+\\cos{\\left(p\\phi-\\phi_0\\right)}\\right)\\), where the phase, \\(\\phi_0\\), and the magnitude, \\(k\\), are the fitted parameters. Here, proper torsions are expanded to include four periodicities, whereas improper torsions include only one. It is also noted that for symmetry, the phase \\(\\phi_0\\) is expected to be either 0 or \\(\\pi\\)</li> </ul>"},{"location":"theory/#bespoke-parameter-generation","title":"Bespoke parameter generation","text":"<p>The parameters in an OpenFF SMIRNOFF force field are assigned to specific bonds, angles, etc. using \"SMIRKS\" (really tagged SMARTS) patterns which are generally very non-specific. By default, we generate extremely specific \"SMIRKS\" patterns which specify the entire molecule of interest. </p>"},{"location":"theory/#sampling","title":"Sampling","text":"<p>The molecule is sampled using high-temperature molecular dynamics. By default, this is performed at 500 K, using the input molecular mechanics force field, well-tempered metadynamics is applied to all rotatable bonds to enhance sampling of diverse conformers and torsional barriers. The sampling is started from several different conformers generated with <code>RDKit</code>'s <code>ETKDG</code> algorithm. </p>"},{"location":"theory/#energy-and-force-evaluation","title":"Energy and force evaluation","text":"<p>Snapshots are saved from the molecular dynamics and the energies and forces of each are computed using a machine-learning potential such as Egret-1 or AIMNet2. By default, energies are offset by their mean before training.</p>"},{"location":"theory/#training","title":"Training","text":"<p>The molecular mechanics force field parameters are optimised to reproduce the energies and forces from the machine learning potential. A regularisation penalty is also applied for deviations of the improper and proper torsion parameters from their starting point, as we found this was important to avoid a number of torsion-barrier outliers. By default, the Adam optimiser is used. A technicality of training is that we linearise the harmonic potentials (bonds and angles) to stabilise fitting -- see the footnote.</p>"},{"location":"theory/#iterations","title":"Iterations","text":"<p>Optionally, the user can perform iterative fitting, where the molecular mechanics force field (which is used for sampling) is iteratively refined and sampled.</p>"},{"location":"theory/#final-force-field","title":"Final force field","text":"<p>The bespoke parameters are added on to the end of the input force field and this is saved (see <code>bespoke_ff.offxml</code> in the relevant output directory). Because parameters lower down the <code>.offxml</code> file are given higher priority, these parameters are used instead of the original non-specific parameters from the input force field when you parameterise your molecule of interest.</p>"},{"location":"theory/#footnote","title":"Footnote","text":"<p>To stabilise and speed up convergence of the parameter fitting, harmonic potentials are linearized.</p> <p>The linearization of the harmonic terms followed the approach by espaloma, where the minimum is assumed to be within a window given by \\(x_1\\) and \\(x_2\\), such that the fitting parameters may by remapped onto linear terms,</p> \\[k_1=k\\frac{x_2-x_0}{x_2-x_1} \\quad\\text{and}\\quad k_2=k\\frac{x_0-x_1}{x_2-x_1}\\] <p>These terms give the original parameters via,</p> \\[k=k_1+k_2 \\quad\\text{and}\\quad x_0=\\frac{k_1x_1+k_2x_2}{k_1+k_2}\\] <p>Crucially, the gradient along \\(k_1\\) and \\(k_2\\) behaves more reliably and so the parameters minimize faster.</p>"},{"location":"examples/","title":"Examples","text":"<p>This directory contains examples of how to use <code>bespokefit-smee</code>:</p> <ul> <li>Basic walk-though of use through the command-line interface (CLI)</li> </ul>"},{"location":"examples/basic-walk-through-cli/","title":"Basic Walk-Through: Command-Line Interface","text":"In\u00a0[3]: Copied! <pre>! mkdir bespoke-fitting-example-cli\n%cd bespoke-fitting-example-cli\n! bespokefit_smee write-default-yaml\n</pre> ! mkdir bespoke-fitting-example-cli %cd bespoke-fitting-example-cli ! bespokefit_smee write-default-yaml <pre>mkdir: cannot create directory \u2018bespoke-fitting-example-cli\u2019: File exists\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/examples/bespoke-fitting-example-cli\nWarning: importing 'simtk.openmm' is deprecated.  Import 'openmm' instead.\n2025-12-03 14:52:54.725 | INFO     | bespokefit_smee.utils.rdkit_bespoke_wrapper:__init__:148 - Using RDKitBespokeToolkitWrapper with symmetry-aware SMARTS matching. This will significantly speed up matching for molecules where each type  matches only one set of symmetry-equivalent atoms.\n2025-12-03 14:52:54.733 | INFO     | bespokefit_smee._cli:cli_cmd:57 - Writing default YAML settings to workflow_settings.yaml.\n</pre> <p>Have a look at the contents of the <code>workflow_settings.yaml</code> file, which comes pre-populated with all of the default settings for every available option:</p> In\u00a0[4]: Copied! <pre>! cat workflow_settings.yaml\n</pre> ! cat workflow_settings.yaml <pre>version: 0.1.2.dev1+g896189d7f.d20251203\noutput_dir: .\ndevice_type: cuda\nn_iterations: 2\nmemory: false\nparameterisation_settings:\n  smiles: CHANGEME\n  initial_force_field: openff_unconstrained-2.2.1.offxml\n  excluded_smirks:\n  - '[*:1]-[*:2]#[*:3]-[*:4]'\n  - '[*:1]~[*:2]-[*:3]#[*:4]'\n  - '[*:1]~[*:2]=[#6,#7,#16,#15;X2:3]=[*:4]'\n  linear_harmonics: true\n  linear_torsions: false\n  msm_settings: null\n  expand_torsions: true\ntraining_sampling_settings:\n  sampling_protocol: mm_md_metadynamics\n  ml_potential: egret-1\n  timestep: 1 fs\n  temperature: 500 K\n  snapshot_interval: 100 fs\n  n_conformers: 10\n  equilibration_sampling_time_per_conformer: 0.1 ps\n  production_sampling_time_per_conformer: 10 ps\n  metadynamics_bias_factor: 10.0\n  bias_width: 0.3141592653589793\n  bias_factor: 10.0\n  bias_height: 2.0 kJ * mol**-1\n  bias_frequency: 0.5 ps\n  bias_save_frequency: 1.0 ps\ntesting_sampling_settings:\n  sampling_protocol: mm_md\n  ml_potential: egret-1\n  timestep: 1 fs\n  temperature: 500 K\n  snapshot_interval: 100 fs\n  n_conformers: 10\n  equilibration_sampling_time_per_conformer: 0.1 ps\n  production_sampling_time_per_conformer: 10 ps\ntraining_settings:\n  optimiser: adam\n  test_data_path: null\n  data: null\n  n_epochs: 1000\n  learning_rate: 0.01\n  learning_rate_decay: 1.0\n  learning_rate_decay_step: 10\n  loss_force_weight: 0.1\n  regularisation_settings:\n    regularisation_strength: 100.0\n    regularisation_value: initial\n    parameters:\n      ProperTorsions:\n      - k\n      ImproperTorsions:\n      - k\n</pre> <p>Some particularly important settings are:</p> <ul> <li><code>smiles</code> under <code>parameterisation_settings</code>. You must tell the program what molecule you want to run!</li> <li><code>ml_potential</code> under <code>training_sampling_settings</code> and <code>testing_sampling_settings</code>. <code>egret-1</code> is the recommended default for neutral molecules, but for charged molecules you should use <code>aimnet2_wb97m_d3_ens</code> or another MLP which was trained on charged molecules.</li> <li><code>sampling_protocol</code> under <code>training_sampling_settings</code>. Using <code>mm_md_metadynamics</code> means that we will run MD with the molecular mechanics force field and use well-tempered metadynamics on rotatable bonds to enhance sampling.</li> </ul> <p>Change the SMILES and any other settings you'd like in the yaml file.</p> In\u00a0[5]: Copied! <pre>! sed -i 's/  smiles: CHANGEME/  smiles: \"CCC(CC)C(=O)Nc2cc(NC(=O)c1c(Cl)cccc1Cl)ccn2\"/' workflow_settings.yaml\n</pre> ! sed -i 's/  smiles: CHANGEME/  smiles: \"CCC(CC)C(=O)Nc2cc(NC(=O)c1c(Cl)cccc1Cl)ccn2\"/' workflow_settings.yaml <p>Now we're ready to run!</p> In\u00a0[6]: Copied! <pre>! bespokefit_smee train-from-yaml workflow_settings.yaml\n</pre> ! bespokefit_smee train-from-yaml workflow_settings.yaml <pre>Warning: importing 'simtk.openmm' is deprecated.  Import 'openmm' instead.\n2025-12-03 15:10:05.085 | INFO     | bespokefit_smee.utils.rdkit_bespoke_wrapper:__init__:148 - Using RDKitBespokeToolkitWrapper with symmetry-aware SMARTS matching. This will significantly speed up matching for molecules where each type  matches only one set of symmetry-equivalent atoms.\n2025-12-03 15:10:05.093 | INFO     | bespokefit_smee._cli:cli_cmd:42 - Running bespokefit_smee with settings from workflow_settings.yaml\n2025-12-03 15:10:44.088 | INFO     | bespokefit_smee.workflow:get_bespoke_force_field:90 - Generating test data\nGenerating Snapshots:   0%|                              | 0/10 [00:00&lt;?, ?it/s]\nRunning MD for conformer 1:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\nRunning MD for conformer 1:  30%|\u2588\u2588\u2588\u2589         | 30/100 [00:00&lt;00:00, 292.00it/s]\nRunning MD for conformer 1:  60%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a     | 60/100 [00:00&lt;00:00, 284.24it/s]\nRunning MD for conformer 1:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 90/100 [00:00&lt;00:00, 287.72it/s]\nGenerating Snapshots:  10%|\u2588\u2588\u258f                   | 1/10 [00:00&lt;00:03,  2.77it/s]\nRunning MD for conformer 2:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\nRunning MD for conformer 2:  28%|\u2588\u2588\u2588\u258b         | 28/100 [00:00&lt;00:00, 274.29it/s]\nRunning MD for conformer 2:  57%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d     | 57/100 [00:00&lt;00:00, 281.32it/s]\nRunning MD for conformer 2:  88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 88/100 [00:00&lt;00:00, 291.19it/s]\nGenerating Snapshots:  20%|\u2588\u2588\u2588\u2588\u258d                 | 2/10 [00:00&lt;00:02,  2.80it/s]\nRunning MD for conformer 3:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\nRunning MD for conformer 3:  32%|\u2588\u2588\u2588\u2588\u258f        | 32/100 [00:00&lt;00:00, 312.98it/s]\nRunning MD for conformer 3:  64%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e    | 64/100 [00:00&lt;00:00, 282.66it/s]\nRunning MD for conformer 3:  93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 | 93/100 [00:00&lt;00:00, 283.16it/s]\nGenerating Snapshots:  30%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c               | 3/10 [00:01&lt;00:02,  2.79it/s]\nRunning MD for conformer 4:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\nRunning MD for conformer 4:  30%|\u2588\u2588\u2588\u2589         | 30/100 [00:00&lt;00:00, 294.78it/s]\nRunning MD for conformer 4:  60%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a     | 60/100 [00:00&lt;00:00, 285.14it/s]\nRunning MD for conformer 4:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 89/100 [00:00&lt;00:00, 283.52it/s]\nGenerating Snapshots:  40%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a             | 4/10 [00:01&lt;00:02,  2.78it/s]\nRunning MD for conformer 5:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\nRunning MD for conformer 5:  28%|\u2588\u2588\u2588\u258b         | 28/100 [00:00&lt;00:00, 272.93it/s]\nRunning MD for conformer 5:  58%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c     | 58/100 [00:00&lt;00:00, 287.40it/s]\nRunning MD for conformer 5:  88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 88/100 [00:00&lt;00:00, 292.48it/s]\nGenerating Snapshots:  50%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588           | 5/10 [00:01&lt;00:01,  2.80it/s]\nRunning MD for conformer 6:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\nRunning MD for conformer 6:  28%|\u2588\u2588\u2588\u258b         | 28/100 [00:00&lt;00:00, 271.98it/s]\nRunning MD for conformer 6:  56%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e     | 56/100 [00:00&lt;00:00, 275.89it/s]\nRunning MD for conformer 6:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 84/100 [00:00&lt;00:00, 275.99it/s]\nGenerating Snapshots:  60%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f        | 6/10 [00:02&lt;00:01,  2.77it/s]\nRunning MD for conformer 7:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\nRunning MD for conformer 7:  28%|\u2588\u2588\u2588\u258b         | 28/100 [00:00&lt;00:00, 272.09it/s]\nRunning MD for conformer 7:  58%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c     | 58/100 [00:00&lt;00:00, 283.54it/s]\nRunning MD for conformer 7:  88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 88/100 [00:00&lt;00:00, 287.44it/s]\nGenerating Snapshots:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d      | 7/10 [00:02&lt;00:01,  2.76it/s]\nRunning MD for conformer 8:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\nRunning MD for conformer 8:  30%|\u2588\u2588\u2588\u2589         | 30/100 [00:00&lt;00:00, 292.35it/s]\nRunning MD for conformer 8:  60%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a     | 60/100 [00:00&lt;00:00, 288.98it/s]\nRunning MD for conformer 8:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 89/100 [00:00&lt;00:00, 288.09it/s]\nGenerating Snapshots:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c    | 8/10 [00:02&lt;00:00,  2.77it/s]\nRunning MD for conformer 9:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\nRunning MD for conformer 9:  28%|\u2588\u2588\u2588\u258b         | 28/100 [00:00&lt;00:00, 273.02it/s]\nRunning MD for conformer 9:  60%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a     | 60/100 [00:00&lt;00:00, 296.66it/s]\nRunning MD for conformer 9:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 90/100 [00:00&lt;00:00, 295.81it/s]\nGenerating Snapshots:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 9/10 [00:03&lt;00:00,  2.80it/s]\nRunning MD for conformer 10:   0%|                      | 0/100 [00:00&lt;?, ?it/s]\nRunning MD for conformer 10:  30%|\u2588\u2588\u2588\u258c        | 30/100 [00:00&lt;00:00, 292.61it/s]\nRunning MD for conformer 10:  61%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e    | 61/100 [00:00&lt;00:00, 301.29it/s]\nRunning MD for conformer 10:  92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 | 92/100 [00:00&lt;00:00, 282.63it/s]\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/.pixi/envs/default/lib/python3.13/site-packages/descent/targets/energy.py:52: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).\n  \"coords\": torch.tensor(entry[\"coords\"]).flatten().tolist(),\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/.pixi/envs/default/lib/python3.13/site-packages/descent/targets/energy.py:53: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).\n  \"energy\": torch.tensor(entry[\"energy\"]).flatten().tolist(),\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/.pixi/envs/default/lib/python3.13/site-packages/descent/targets/energy.py:54: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).\n  \"forces\": torch.tensor(entry[\"forces\"]).flatten().tolist(),\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/.pixi/envs/default/lib/python3.13/site-packages/e3nn/o3/_wigner.py:10: UserWarning: Environment variable TORCH_FORCE_NO_WEIGHTS_ONLY_LOAD detected, since the`weights_only` argument was not explicitly passed to `torch.load`, forcing weights_only=False.\n  _Jd, _W3j_flat, _W3j_indices = torch.load(os.path.join(os.path.dirname(__file__), 'constants.pt'))\ncuequivariance or cuequivariance_torch is not available. Cuequivariance acceleration will be disabled.\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/.pixi/envs/default/lib/python3.13/site-packages/openmmml/models/macepotential.py:174: UserWarning: Environment variable TORCH_FORCE_NO_WEIGHTS_ONLY_LOAD detected, since the`weights_only` argument was not explicitly passed to `torch.load`, forcing weights_only=False.\n  model = torch.load(self.modelPath, map_location=\"cpu\")\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/.pixi/envs/default/lib/python3.13/site-packages/torch/serialization.py:1434: UserWarning: 'torch.load' received a zip file that looks like a TorchScript archive dispatching to 'torch.jit.load' (call 'torch.jit.load' directly to silence this warning)\n  warnings.warn(\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/bespokefit_smee/sample.py:250: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /home/conda/feedstock_root/build_artifacts/libtorch_1744247799952/work/torch/csrc/utils/tensor_new.cpp:254.)\n  \"forces\": torch.tensor(recalc_forces),\nSaving the dataset (1/1 shards): 100%|\u2588\u2588\u2588\u2588| 1/1 [00:00&lt;00:00, 193.06 examples/s]\n2025-12-03 15:11:17.550 | INFO     | bespokefit_smee.workflow:get_bespoke_force_field:115 - Initial force field statistics: Energy (Mean/SD): 3.399e-04/6.531e+00, Forces (Mean/SD): -1.146e-09/1.539e+01\nIterating the Fit:   0%|                                  | 0/2 [00:00&lt;?, ?it/s]\nGenerating Snapshots:   0%|                              | 0/10 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 1:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 1:   4%|\u258c              | 4/100 [00:00&lt;00:02, 38.10it/s]\n\nRunning MD for conformer 1:   8%|\u2588\u258f             | 8/100 [00:00&lt;00:02, 38.71it/s]\n\nRunning MD for conformer 1:  12%|\u2588\u258b            | 12/100 [00:00&lt;00:02, 39.17it/s]\n\nRunning MD for conformer 1:  16%|\u2588\u2588\u258f           | 16/100 [00:00&lt;00:02, 39.40it/s]\n\nRunning MD for conformer 1:  20%|\u2588\u2588\u258a           | 20/100 [00:00&lt;00:02, 38.77it/s]\n\nRunning MD for conformer 1:  24%|\u2588\u2588\u2588\u258e          | 24/100 [00:00&lt;00:01, 38.58it/s]\n\nRunning MD for conformer 1:  29%|\u2588\u2588\u2588\u2588          | 29/100 [00:00&lt;00:01, 38.58it/s]\n\nRunning MD for conformer 1:  33%|\u2588\u2588\u2588\u2588\u258c         | 33/100 [00:00&lt;00:01, 38.62it/s]\n\nRunning MD for conformer 1:  37%|\u2588\u2588\u2588\u2588\u2588\u258f        | 37/100 [00:00&lt;00:01, 38.82it/s]\n\nRunning MD for conformer 1:  41%|\u2588\u2588\u2588\u2588\u2588\u258b        | 41/100 [00:01&lt;00:01, 38.90it/s]\n\nRunning MD for conformer 1:  45%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e       | 45/100 [00:01&lt;00:01, 38.90it/s]\n\nRunning MD for conformer 1:  49%|\u2588\u2588\u2588\u2588\u2588\u2588\u258a       | 49/100 [00:01&lt;00:01, 38.92it/s]\n\nRunning MD for conformer 1:  53%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d      | 53/100 [00:01&lt;00:01, 38.92it/s]\n\nRunning MD for conformer 1:  57%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589      | 57/100 [00:01&lt;00:01, 38.92it/s]\n\nRunning MD for conformer 1:  61%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c     | 61/100 [00:01&lt;00:01, 38.64it/s]\n\nRunning MD for conformer 1:  65%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588     | 65/100 [00:01&lt;00:00, 38.57it/s]\n\nRunning MD for conformer 1:  69%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b    | 69/100 [00:01&lt;00:00, 38.33it/s]\n\nRunning MD for conformer 1:  73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 73/100 [00:01&lt;00:00, 38.41it/s]\n\nRunning MD for conformer 1:  77%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a   | 77/100 [00:01&lt;00:00, 38.78it/s]\n\nRunning MD for conformer 1:  81%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e  | 81/100 [00:02&lt;00:00, 39.09it/s]\n\nRunning MD for conformer 1:  85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 85/100 [00:02&lt;00:00, 38.82it/s]\n\nRunning MD for conformer 1:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 89/100 [00:02&lt;00:00, 38.32it/s]\n\nRunning MD for conformer 1:  93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 | 93/100 [00:02&lt;00:00, 38.18it/s]\n\nRunning MD for conformer 1:  97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 97/100 [00:02&lt;00:00, 38.38it/s]\n\n                                                                                \nGenerating Snapshots:  10%|\u2588\u2588\u258f                   | 1/10 [00:02&lt;00:24,  2.67s/it]\n\nRunning MD for conformer 2:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 2:   4%|\u258c              | 4/100 [00:00&lt;00:02, 37.07it/s]\n\nRunning MD for conformer 2:   8%|\u2588\u258f             | 8/100 [00:00&lt;00:02, 37.07it/s]\n\nRunning MD for conformer 2:  12%|\u2588\u258b            | 12/100 [00:00&lt;00:02, 38.23it/s]\n\nRunning MD for conformer 2:  16%|\u2588\u2588\u258f           | 16/100 [00:00&lt;00:02, 38.41it/s]\n\nRunning MD for conformer 2:  20%|\u2588\u2588\u258a           | 20/100 [00:00&lt;00:02, 38.33it/s]\n\nRunning MD for conformer 2:  24%|\u2588\u2588\u2588\u258e          | 24/100 [00:00&lt;00:01, 38.20it/s]\n\nRunning MD for conformer 2:  28%|\u2588\u2588\u2588\u2589          | 28/100 [00:00&lt;00:01, 38.26it/s]\n\nRunning MD for conformer 2:  32%|\u2588\u2588\u2588\u2588\u258d         | 32/100 [00:00&lt;00:01, 38.64it/s]\n\nRunning MD for conformer 2:  36%|\u2588\u2588\u2588\u2588\u2588         | 36/100 [00:00&lt;00:01, 38.49it/s]\n\nRunning MD for conformer 2:  40%|\u2588\u2588\u2588\u2588\u2588\u258c        | 40/100 [00:01&lt;00:01, 38.24it/s]\n\nRunning MD for conformer 2:  44%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f       | 44/100 [00:01&lt;00:01, 38.27it/s]\n\nRunning MD for conformer 2:  48%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b       | 48/100 [00:01&lt;00:01, 38.66it/s]\n\nRunning MD for conformer 2:  53%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d      | 53/100 [00:01&lt;00:01, 39.11it/s]\n\nRunning MD for conformer 2:  58%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588      | 58/100 [00:01&lt;00:01, 39.36it/s]\n\nRunning MD for conformer 2:  62%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b     | 62/100 [00:01&lt;00:00, 39.10it/s]\n\nRunning MD for conformer 2:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f    | 66/100 [00:01&lt;00:00, 39.17it/s]\n\nRunning MD for conformer 2:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a    | 70/100 [00:01&lt;00:00, 39.06it/s]\n\nRunning MD for conformer 2:  74%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e   | 74/100 [00:01&lt;00:00, 39.09it/s]\n\nRunning MD for conformer 2:  78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 78/100 [00:02&lt;00:00, 38.87it/s]\n\nRunning MD for conformer 2:  82%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d  | 82/100 [00:02&lt;00:00, 38.55it/s]\n\nRunning MD for conformer 2:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 86/100 [00:02&lt;00:00, 38.35it/s]\n\nRunning MD for conformer 2:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 90/100 [00:02&lt;00:00, 38.58it/s]\n\nRunning MD for conformer 2:  94%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 94/100 [00:02&lt;00:00, 38.97it/s]\n\nRunning MD for conformer 2:  98%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b| 98/100 [00:02&lt;00:00, 39.21it/s]\n\n                                                                                \nGenerating Snapshots:  20%|\u2588\u2588\u2588\u2588\u258d                 | 2/10 [00:05&lt;00:21,  2.65s/it]\n\nRunning MD for conformer 3:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 3:   4%|\u258c              | 4/100 [00:00&lt;00:02, 39.86it/s]\n\nRunning MD for conformer 3:   8%|\u2588\u258f             | 8/100 [00:00&lt;00:02, 39.05it/s]\n\nRunning MD for conformer 3:  12%|\u2588\u258b            | 12/100 [00:00&lt;00:02, 39.14it/s]\n\nRunning MD for conformer 3:  17%|\u2588\u2588\u258d           | 17/100 [00:00&lt;00:02, 41.36it/s]\n\nRunning MD for conformer 3:  22%|\u2588\u2588\u2588           | 22/100 [00:00&lt;00:01, 43.12it/s]\n\nRunning MD for conformer 3:  28%|\u2588\u2588\u2588\u2589          | 28/100 [00:00&lt;00:01, 46.10it/s]\n\nRunning MD for conformer 3:  34%|\u2588\u2588\u2588\u2588\u258a         | 34/100 [00:00&lt;00:01, 47.92it/s]\n\nRunning MD for conformer 3:  39%|\u2588\u2588\u2588\u2588\u2588\u258d        | 39/100 [00:00&lt;00:01, 48.50it/s]\n\nRunning MD for conformer 3:  44%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f       | 44/100 [00:00&lt;00:01, 46.72it/s]\n\nRunning MD for conformer 3:  49%|\u2588\u2588\u2588\u2588\u2588\u2588\u258a       | 49/100 [00:01&lt;00:01, 45.96it/s]\n\nRunning MD for conformer 3:  54%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c      | 54/100 [00:01&lt;00:01, 44.92it/s]\n\nRunning MD for conformer 3:  59%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e     | 59/100 [00:01&lt;00:00, 43.08it/s]\n\nRunning MD for conformer 3:  64%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589     | 64/100 [00:01&lt;00:00, 41.83it/s]\n\nRunning MD for conformer 3:  69%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b    | 69/100 [00:01&lt;00:00, 41.01it/s]\n\nRunning MD for conformer 3:  74%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e   | 74/100 [00:01&lt;00:00, 42.77it/s]\n\nRunning MD for conformer 3:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 80/100 [00:01&lt;00:00, 45.35it/s]\n\nRunning MD for conformer 3:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 86/100 [00:01&lt;00:00, 47.26it/s]\n\nRunning MD for conformer 3:  92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589 | 92/100 [00:02&lt;00:00, 48.31it/s]\n\nRunning MD for conformer 3:  98%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b| 98/100 [00:02&lt;00:00, 48.94it/s]\n\n                                                                                \nGenerating Snapshots:  30%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c               | 3/10 [00:07&lt;00:17,  2.47s/it]\n\nRunning MD for conformer 4:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 4:   5%|\u258a              | 5/100 [00:00&lt;00:02, 43.59it/s]\n\nRunning MD for conformer 4:  10%|\u2588\u258d            | 10/100 [00:00&lt;00:02, 40.85it/s]\n\nRunning MD for conformer 4:  15%|\u2588\u2588            | 15/100 [00:00&lt;00:03, 23.76it/s]\n\nRunning MD for conformer 4:  20%|\u2588\u2588\u258a           | 20/100 [00:00&lt;00:02, 29.30it/s]\n\nRunning MD for conformer 4:  25%|\u2588\u2588\u2588\u258c          | 25/100 [00:00&lt;00:02, 32.92it/s]\n\nRunning MD for conformer 4:  29%|\u2588\u2588\u2588\u2588          | 29/100 [00:00&lt;00:02, 34.44it/s]\n\nRunning MD for conformer 4:  34%|\u2588\u2588\u2588\u2588\u258a         | 34/100 [00:01&lt;00:01, 36.91it/s]\n\nRunning MD for conformer 4:  39%|\u2588\u2588\u2588\u2588\u2588\u258d        | 39/100 [00:01&lt;00:01, 39.47it/s]\n\nRunning MD for conformer 4:  44%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f       | 44/100 [00:01&lt;00:01, 41.32it/s]\n\nRunning MD for conformer 4:  49%|\u2588\u2588\u2588\u2588\u2588\u2588\u258a       | 49/100 [00:01&lt;00:01, 43.58it/s]\n\nRunning MD for conformer 4:  54%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c      | 54/100 [00:01&lt;00:01, 44.10it/s]\n\nRunning MD for conformer 4:  59%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e     | 59/100 [00:01&lt;00:00, 43.27it/s]\n\nRunning MD for conformer 4:  64%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589     | 64/100 [00:01&lt;00:00, 43.39it/s]\n\nRunning MD for conformer 4:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a    | 70/100 [00:01&lt;00:00, 45.48it/s]\n\nRunning MD for conformer 4:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 75/100 [00:01&lt;00:00, 45.67it/s]\n\nRunning MD for conformer 4:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 80/100 [00:02&lt;00:00, 46.01it/s]\n\nRunning MD for conformer 4:  85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 85/100 [00:02&lt;00:00, 44.65it/s]\n\nRunning MD for conformer 4:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 90/100 [00:02&lt;00:00, 42.64it/s]\n\nRunning MD for conformer 4:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e| 95/100 [00:02&lt;00:00, 43.67it/s]\n\nRunning MD for conformer 4: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 100/100 [00:02&lt;00:00, 43.80it/s]\n\n                                                                                \nGenerating Snapshots:  40%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a             | 4/10 [00:10&lt;00:14,  2.49s/it]\n\nRunning MD for conformer 5:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 5:   5%|\u258a              | 5/100 [00:00&lt;00:02, 44.01it/s]\n\nRunning MD for conformer 5:  10%|\u2588\u258d            | 10/100 [00:00&lt;00:02, 40.65it/s]\n\nRunning MD for conformer 5:  15%|\u2588\u2588            | 15/100 [00:00&lt;00:01, 42.64it/s]\n\nRunning MD for conformer 5:  21%|\u2588\u2588\u2589           | 21/100 [00:00&lt;00:01, 45.99it/s]\n\nRunning MD for conformer 5:  26%|\u2588\u2588\u2588\u258b          | 26/100 [00:00&lt;00:01, 47.18it/s]\n\nRunning MD for conformer 5:  31%|\u2588\u2588\u2588\u2588\u258e         | 31/100 [00:00&lt;00:01, 47.00it/s]\n\nRunning MD for conformer 5:  36%|\u2588\u2588\u2588\u2588\u2588         | 36/100 [00:00&lt;00:01, 45.79it/s]\n\nRunning MD for conformer 5:  41%|\u2588\u2588\u2588\u2588\u2588\u258b        | 41/100 [00:00&lt;00:01, 43.86it/s]\n\nRunning MD for conformer 5:  46%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d       | 46/100 [00:01&lt;00:01, 44.01it/s]\n\nRunning MD for conformer 5:  51%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f      | 51/100 [00:01&lt;00:01, 44.63it/s]\n\nRunning MD for conformer 5:  57%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589      | 57/100 [00:01&lt;00:00, 46.71it/s]\n\nRunning MD for conformer 5:  63%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a     | 63/100 [00:01&lt;00:00, 48.25it/s]\n\nRunning MD for conformer 5:  69%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b    | 69/100 [00:01&lt;00:00, 49.31it/s]\n\nRunning MD for conformer 5:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 75/100 [00:01&lt;00:00, 49.41it/s]\n\nRunning MD for conformer 5:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 80/100 [00:01&lt;00:00, 48.49it/s]\n\nRunning MD for conformer 5:  85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 85/100 [00:01&lt;00:00, 48.05it/s]\n\nRunning MD for conformer 5:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 90/100 [00:01&lt;00:00, 47.44it/s]\n\nRunning MD for conformer 5:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e| 95/100 [00:02&lt;00:00, 47.86it/s]\n\nRunning MD for conformer 5: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 100/100 [00:02&lt;00:00, 47.58it/s]\n\n                                                                                \nGenerating Snapshots:  50%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588           | 5/10 [00:12&lt;00:11,  2.38s/it]\n\nRunning MD for conformer 6:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 6:   5%|\u258a              | 5/100 [00:00&lt;00:02, 46.87it/s]\n\nRunning MD for conformer 6:  10%|\u2588\u258d            | 10/100 [00:00&lt;00:01, 47.56it/s]\n\nRunning MD for conformer 6:  15%|\u2588\u2588            | 15/100 [00:00&lt;00:01, 46.77it/s]\n\nRunning MD for conformer 6:  20%|\u2588\u2588\u258a           | 20/100 [00:00&lt;00:01, 47.31it/s]\n\nRunning MD for conformer 6:  25%|\u2588\u2588\u2588\u258c          | 25/100 [00:00&lt;00:01, 47.80it/s]\n\nRunning MD for conformer 6:  31%|\u2588\u2588\u2588\u2588\u258e         | 31/100 [00:00&lt;00:01, 49.21it/s]\n\nRunning MD for conformer 6:  37%|\u2588\u2588\u2588\u2588\u2588\u258f        | 37/100 [00:00&lt;00:01, 50.05it/s]\n\nRunning MD for conformer 6:  42%|\u2588\u2588\u2588\u2588\u2588\u2589        | 42/100 [00:00&lt;00:01, 48.97it/s]\n\nRunning MD for conformer 6:  47%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c       | 47/100 [00:00&lt;00:01, 46.11it/s]\n\nRunning MD for conformer 6:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e      | 52/100 [00:01&lt;00:01, 45.44it/s]\n\nRunning MD for conformer 6:  57%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589      | 57/100 [00:01&lt;00:00, 44.75it/s]\n\nRunning MD for conformer 6:  62%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b     | 62/100 [00:01&lt;00:00, 43.71it/s]\n\nRunning MD for conformer 6:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d    | 67/100 [00:01&lt;00:00, 42.27it/s]\n\nRunning MD for conformer 6:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588    | 72/100 [00:01&lt;00:00, 41.42it/s]\n\nRunning MD for conformer 6:  77%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a   | 77/100 [00:01&lt;00:00, 40.15it/s]\n\nRunning MD for conformer 6:  82%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d  | 82/100 [00:01&lt;00:00, 40.96it/s]\n\nRunning MD for conformer 6:  88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 88/100 [00:01&lt;00:00, 43.86it/s]\n\nRunning MD for conformer 6:  94%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 94/100 [00:02&lt;00:00, 46.08it/s]\n\nRunning MD for conformer 6:  99%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a| 99/100 [00:02&lt;00:00, 46.92it/s]\n\n                                                                                \nGenerating Snapshots:  60%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f        | 6/10 [00:14&lt;00:09,  2.34s/it]\n\nRunning MD for conformer 7:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 7:   6%|\u2589              | 6/100 [00:00&lt;00:01, 51.42it/s]\n\nRunning MD for conformer 7:  12%|\u2588\u258b            | 12/100 [00:00&lt;00:01, 50.65it/s]\n\nRunning MD for conformer 7:  18%|\u2588\u2588\u258c           | 18/100 [00:00&lt;00:01, 50.97it/s]\n\nRunning MD for conformer 7:  24%|\u2588\u2588\u2588\u258e          | 24/100 [00:00&lt;00:01, 51.09it/s]\n\nRunning MD for conformer 7:  30%|\u2588\u2588\u2588\u2588\u258f         | 30/100 [00:00&lt;00:01, 49.04it/s]\n\nRunning MD for conformer 7:  36%|\u2588\u2588\u2588\u2588\u2588         | 36/100 [00:00&lt;00:01, 49.85it/s]\n\nRunning MD for conformer 7:  42%|\u2588\u2588\u2588\u2588\u2588\u2589        | 42/100 [00:00&lt;00:01, 50.50it/s]\n\nRunning MD for conformer 7:  48%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b       | 48/100 [00:00&lt;00:01, 50.12it/s]\n\nRunning MD for conformer 7:  54%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c      | 54/100 [00:01&lt;00:00, 50.29it/s]\n\nRunning MD for conformer 7:  60%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d     | 60/100 [00:01&lt;00:00, 49.59it/s]\n\nRunning MD for conformer 7:  65%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588     | 65/100 [00:01&lt;00:00, 48.03it/s]\n\nRunning MD for conformer 7:  71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589    | 71/100 [00:01&lt;00:00, 49.10it/s]\n\nRunning MD for conformer 7:  76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b   | 76/100 [00:01&lt;00:00, 48.62it/s]\n\nRunning MD for conformer 7:  81%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e  | 81/100 [00:01&lt;00:00, 47.23it/s]\n\nRunning MD for conformer 7:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 86/100 [00:01&lt;00:00, 44.98it/s]\n\nRunning MD for conformer 7:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 91/100 [00:01&lt;00:00, 45.58it/s]\n\nRunning MD for conformer 7:  96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 96/100 [00:01&lt;00:00, 44.74it/s]\n\n                                                                                \nGenerating Snapshots:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d      | 7/10 [00:16&lt;00:06,  2.28s/it]\n\nRunning MD for conformer 8:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 8:   4%|\u258c              | 4/100 [00:00&lt;00:02, 39.88it/s]\n\nRunning MD for conformer 8:   8%|\u2588\u258f             | 8/100 [00:00&lt;00:02, 38.49it/s]\n\nRunning MD for conformer 8:  12%|\u2588\u258b            | 12/100 [00:00&lt;00:02, 38.40it/s]\n\nRunning MD for conformer 8:  17%|\u2588\u2588\u258d           | 17/100 [00:00&lt;00:02, 40.61it/s]\n\nRunning MD for conformer 8:  22%|\u2588\u2588\u2588           | 22/100 [00:00&lt;00:01, 41.45it/s]\n\nRunning MD for conformer 8:  27%|\u2588\u2588\u2588\u258a          | 27/100 [00:00&lt;00:01, 42.26it/s]\n\nRunning MD for conformer 8:  32%|\u2588\u2588\u2588\u2588\u258d         | 32/100 [00:00&lt;00:01, 43.03it/s]\n\nRunning MD for conformer 8:  38%|\u2588\u2588\u2588\u2588\u2588\u258e        | 38/100 [00:00&lt;00:01, 45.65it/s]\n\nRunning MD for conformer 8:  44%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f       | 44/100 [00:01&lt;00:01, 47.58it/s]\n\nRunning MD for conformer 8:  50%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588       | 50/100 [00:01&lt;00:01, 48.55it/s]\n\nRunning MD for conformer 8:  55%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b      | 55/100 [00:01&lt;00:00, 46.91it/s]\n\nRunning MD for conformer 8:  60%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d     | 60/100 [00:01&lt;00:00, 45.23it/s]\n\nRunning MD for conformer 8:  65%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588     | 65/100 [00:01&lt;00:00, 44.35it/s]\n\nRunning MD for conformer 8:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a    | 70/100 [00:01&lt;00:00, 44.72it/s]\n\nRunning MD for conformer 8:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 75/100 [00:01&lt;00:00, 44.74it/s]\n\nRunning MD for conformer 8:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 80/100 [00:01&lt;00:00, 45.21it/s]\n\nRunning MD for conformer 8:  85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 85/100 [00:01&lt;00:00, 43.29it/s]\n\nRunning MD for conformer 8:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 90/100 [00:02&lt;00:00, 42.08it/s]\n\nRunning MD for conformer 8:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e| 95/100 [00:02&lt;00:00, 41.70it/s]\n\nRunning MD for conformer 8: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 100/100 [00:02&lt;00:00, 41.45it/s]\n\n                                                                                \nGenerating Snapshots:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c    | 8/10 [00:19&lt;00:04,  2.30s/it]\n\nRunning MD for conformer 9:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 9:   5%|\u258a              | 5/100 [00:00&lt;00:02, 42.16it/s]\n\nRunning MD for conformer 9:  10%|\u2588\u258d            | 10/100 [00:00&lt;00:02, 43.03it/s]\n\nRunning MD for conformer 9:  15%|\u2588\u2588            | 15/100 [00:00&lt;00:02, 41.94it/s]\n\nRunning MD for conformer 9:  20%|\u2588\u2588\u258a           | 20/100 [00:00&lt;00:01, 41.73it/s]\n\nRunning MD for conformer 9:  25%|\u2588\u2588\u2588\u258c          | 25/100 [00:00&lt;00:01, 44.22it/s]\n\nRunning MD for conformer 9:  30%|\u2588\u2588\u2588\u2588\u258f         | 30/100 [00:00&lt;00:01, 45.06it/s]\n\nRunning MD for conformer 9:  36%|\u2588\u2588\u2588\u2588\u2588         | 36/100 [00:00&lt;00:01, 46.94it/s]\n\nRunning MD for conformer 9:  41%|\u2588\u2588\u2588\u2588\u2588\u258b        | 41/100 [00:00&lt;00:01, 47.57it/s]\n\nRunning MD for conformer 9:  46%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d       | 46/100 [00:01&lt;00:01, 47.37it/s]\n\nRunning MD for conformer 9:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e      | 52/100 [00:01&lt;00:00, 48.49it/s]\n\nRunning MD for conformer 9:  57%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589      | 57/100 [00:01&lt;00:00, 47.08it/s]\n\nRunning MD for conformer 9:  62%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b     | 62/100 [00:01&lt;00:00, 46.95it/s]\n\nRunning MD for conformer 9:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d    | 67/100 [00:01&lt;00:00, 47.72it/s]\n\nRunning MD for conformer 9:  73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 73/100 [00:01&lt;00:00, 48.29it/s]\n\nRunning MD for conformer 9:  78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 78/100 [00:01&lt;00:00, 47.99it/s]\n\nRunning MD for conformer 9:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 84/100 [00:01&lt;00:00, 48.76it/s]\n\nRunning MD for conformer 9:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 89/100 [00:01&lt;00:00, 47.78it/s]\n\nRunning MD for conformer 9:  94%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 94/100 [00:02&lt;00:00, 46.78it/s]\n\nRunning MD for conformer 9:  99%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a| 99/100 [00:02&lt;00:00, 44.66it/s]\n\n                                                                                \nGenerating Snapshots:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 9/10 [00:21&lt;00:02,  2.28s/it]\n\nRunning MD for conformer 10:   0%|                      | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 10:   5%|\u258b             | 5/100 [00:00&lt;00:02, 44.29it/s]\n\nRunning MD for conformer 10:  11%|\u2588\u258d           | 11/100 [00:00&lt;00:01, 47.66it/s]\n\nRunning MD for conformer 10:  16%|\u2588\u2588           | 16/100 [00:00&lt;00:01, 47.13it/s]\n\nRunning MD for conformer 10:  21%|\u2588\u2588\u258b          | 21/100 [00:00&lt;00:01, 44.70it/s]\n\nRunning MD for conformer 10:  26%|\u2588\u2588\u2588\u258d         | 26/100 [00:00&lt;00:01, 43.42it/s]\n\nRunning MD for conformer 10:  31%|\u2588\u2588\u2588\u2588         | 31/100 [00:00&lt;00:01, 42.10it/s]\n\nRunning MD for conformer 10:  36%|\u2588\u2588\u2588\u2588\u258b        | 36/100 [00:00&lt;00:01, 43.47it/s]\n\nRunning MD for conformer 10:  41%|\u2588\u2588\u2588\u2588\u2588\u258e       | 41/100 [00:00&lt;00:01, 42.82it/s]\n\nRunning MD for conformer 10:  46%|\u2588\u2588\u2588\u2588\u2588\u2589       | 46/100 [00:01&lt;00:01, 43.00it/s]\n\nRunning MD for conformer 10:  51%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b      | 51/100 [00:01&lt;00:01, 43.87it/s]\n\nRunning MD for conformer 10:  56%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e     | 56/100 [00:01&lt;00:00, 45.34it/s]\n\nRunning MD for conformer 10:  61%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589     | 61/100 [00:01&lt;00:00, 45.48it/s]\n\nRunning MD for conformer 10:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c    | 66/100 [00:01&lt;00:00, 44.41it/s]\n\nRunning MD for conformer 10:  71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 71/100 [00:01&lt;00:00, 42.26it/s]\n\nRunning MD for conformer 10:  76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 76/100 [00:01&lt;00:00, 42.58it/s]\n\nRunning MD for conformer 10:  81%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 81/100 [00:01&lt;00:00, 41.70it/s]\n\nRunning MD for conformer 10:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f | 86/100 [00:01&lt;00:00, 41.01it/s]\n\nRunning MD for conformer 10:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 91/100 [00:02&lt;00:00, 40.23it/s]\n\nRunning MD for conformer 10:  96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 96/100 [00:02&lt;00:00, 40.42it/s]\n\n                                                                                \nGenerating Snapshots: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 10/10 [00:23&lt;00:00,  2.32s/it]\n                                                                                \nRecalculating energies and forces:   0%|               | 0/1000 [00:00&lt;?, ?it/s]\nRecalculating energies and forces:   0%|       | 2/1000 [00:00&lt;02:41,  6.17it/s]\nRecalculating energies and forces:   0%|       | 3/1000 [00:01&lt;07:13,  2.30it/s]\nRecalculating energies and forces:   0%|       | 4/1000 [00:01&lt;09:11,  1.80it/s]\nRecalculating energies and forces:   0%|       | 5/1000 [00:02&lt;09:28,  1.75it/s]\nRecalculating energies and forces:   1%|       | 9/1000 [00:02&lt;03:28,  4.76it/s]\nRecalculating energies and forces:   1%|      | 13/1000 [00:02&lt;02:00,  8.20it/s]\nRecalculating energies and forces:   2%|      | 17/1000 [00:02&lt;01:22, 11.98it/s]\nRecalculating energies and forces:   2%|\u258f     | 21/1000 [00:02&lt;01:01, 15.91it/s]\nRecalculating energies and forces:   2%|\u258f     | 25/1000 [00:03&lt;00:48, 20.07it/s]\nRecalculating energies and forces:   3%|\u258f     | 30/1000 [00:03&lt;00:38, 24.90it/s]\nRecalculating energies and forces:   3%|\u258f     | 34/1000 [00:03&lt;00:34, 27.73it/s]\nRecalculating energies and forces:   4%|\u258f     | 38/1000 [00:03&lt;00:32, 29.98it/s]\nRecalculating energies and forces:   4%|\u258e     | 43/1000 [00:03&lt;00:28, 33.51it/s]\nRecalculating energies and forces:   5%|\u258e     | 48/1000 [00:03&lt;00:26, 36.37it/s]\nRecalculating energies and forces:   5%|\u258e     | 53/1000 [00:03&lt;00:24, 38.41it/s]\nRecalculating energies and forces:   6%|\u258e     | 58/1000 [00:03&lt;00:23, 40.02it/s]\nRecalculating energies and forces:   6%|\u258d     | 63/1000 [00:03&lt;00:23, 39.94it/s]\nRecalculating energies and forces:   7%|\u258d     | 68/1000 [00:04&lt;00:23, 39.08it/s]\nRecalculating energies and forces:   7%|\u258d     | 73/1000 [00:04&lt;00:24, 38.27it/s]\nRecalculating energies and forces:   8%|\u258d     | 77/1000 [00:04&lt;00:24, 37.97it/s]\nRecalculating energies and forces:   8%|\u258d     | 81/1000 [00:04&lt;00:24, 37.60it/s]\nRecalculating energies and forces:   8%|\u258c     | 85/1000 [00:04&lt;00:24, 37.37it/s]\nRecalculating energies and forces:   9%|\u258c     | 89/1000 [00:04&lt;00:24, 36.76it/s]\nRecalculating energies and forces:   9%|\u258c     | 93/1000 [00:04&lt;00:25, 36.19it/s]\nRecalculating energies and forces:  10%|\u258c     | 97/1000 [00:04&lt;00:24, 36.43it/s]\nRecalculating energies and forces:  10%|\u258c    | 101/1000 [00:05&lt;00:24, 36.68it/s]\nRecalculating energies and forces:  10%|\u258c    | 105/1000 [00:05&lt;00:24, 36.61it/s]\nRecalculating energies and forces:  11%|\u258c    | 109/1000 [00:05&lt;00:24, 36.40it/s]\nRecalculating energies and forces:  11%|\u258c    | 113/1000 [00:05&lt;00:24, 35.97it/s]\nRecalculating energies and forces:  12%|\u258c    | 117/1000 [00:05&lt;00:24, 36.14it/s]\nRecalculating energies and forces:  12%|\u258c    | 121/1000 [00:05&lt;00:24, 35.86it/s]\nRecalculating energies and forces:  12%|\u258b    | 125/1000 [00:05&lt;00:24, 35.96it/s]\nRecalculating energies and forces:  13%|\u258b    | 129/1000 [00:05&lt;00:24, 36.09it/s]\nRecalculating energies and forces:  13%|\u258b    | 133/1000 [00:05&lt;00:23, 36.22it/s]\nRecalculating energies and forces:  14%|\u258b    | 137/1000 [00:06&lt;00:23, 36.09it/s]\nRecalculating energies and forces:  14%|\u258b    | 141/1000 [00:06&lt;00:23, 36.02it/s]\nRecalculating energies and forces:  14%|\u258b    | 145/1000 [00:06&lt;00:23, 35.78it/s]\nRecalculating energies and forces:  15%|\u258b    | 149/1000 [00:06&lt;00:23, 36.36it/s]\nRecalculating energies and forces:  15%|\u258a    | 153/1000 [00:06&lt;00:22, 37.27it/s]\nRecalculating energies and forces:  16%|\u258a    | 157/1000 [00:06&lt;00:22, 37.24it/s]\nRecalculating energies and forces:  16%|\u258a    | 161/1000 [00:06&lt;00:22, 36.96it/s]\nRecalculating energies and forces:  16%|\u258a    | 165/1000 [00:06&lt;00:22, 36.50it/s]\nRecalculating energies and forces:  17%|\u258a    | 169/1000 [00:06&lt;00:22, 36.59it/s]\nRecalculating energies and forces:  17%|\u258a    | 174/1000 [00:07&lt;00:21, 38.09it/s]\nRecalculating energies and forces:  18%|\u2589    | 179/1000 [00:07&lt;00:20, 39.85it/s]\nRecalculating energies and forces:  18%|\u2589    | 184/1000 [00:07&lt;00:19, 41.03it/s]\nRecalculating energies and forces:  19%|\u2589    | 189/1000 [00:07&lt;00:19, 42.00it/s]\nRecalculating energies and forces:  19%|\u2589    | 194/1000 [00:07&lt;00:18, 42.64it/s]\nRecalculating energies and forces:  20%|\u2589    | 199/1000 [00:07&lt;00:18, 43.08it/s]\nRecalculating energies and forces:  20%|\u2588    | 204/1000 [00:07&lt;00:19, 41.16it/s]\nRecalculating energies and forces:  21%|\u2588    | 209/1000 [00:07&lt;00:20, 39.55it/s]\nRecalculating energies and forces:  21%|\u2588    | 213/1000 [00:07&lt;00:20, 38.97it/s]\nRecalculating energies and forces:  22%|\u2588    | 217/1000 [00:08&lt;00:20, 38.44it/s]\nRecalculating energies and forces:  22%|\u2588    | 221/1000 [00:08&lt;00:20, 38.01it/s]\nRecalculating energies and forces:  22%|\u2588\u258f   | 225/1000 [00:08&lt;00:20, 37.29it/s]\nRecalculating energies and forces:  23%|\u2588\u258f   | 229/1000 [00:08&lt;00:20, 36.72it/s]\nRecalculating energies and forces:  23%|\u2588\u258f   | 233/1000 [00:08&lt;00:20, 36.53it/s]\nRecalculating energies and forces:  24%|\u2588\u258f   | 237/1000 [00:08&lt;00:20, 36.40it/s]\nRecalculating energies and forces:  24%|\u2588\u258f   | 241/1000 [00:08&lt;00:21, 36.13it/s]\nRecalculating energies and forces:  24%|\u2588\u258f   | 245/1000 [00:08&lt;00:21, 35.86it/s]\nRecalculating energies and forces:  25%|\u2588\u258f   | 249/1000 [00:08&lt;00:21, 35.74it/s]\nRecalculating energies and forces:  25%|\u2588\u258e   | 253/1000 [00:09&lt;00:21, 35.48it/s]\nRecalculating energies and forces:  26%|\u2588\u258e   | 257/1000 [00:09&lt;00:21, 35.12it/s]\nRecalculating energies and forces:  26%|\u2588\u258e   | 261/1000 [00:09&lt;00:21, 35.16it/s]\nRecalculating energies and forces:  26%|\u2588\u258e   | 265/1000 [00:09&lt;00:20, 35.88it/s]\nRecalculating energies and forces:  27%|\u2588\u258e   | 269/1000 [00:09&lt;00:20, 36.31it/s]\nRecalculating energies and forces:  27%|\u2588\u258e   | 274/1000 [00:09&lt;00:18, 38.37it/s]\nRecalculating energies and forces:  28%|\u2588\u258d   | 279/1000 [00:09&lt;00:18, 39.94it/s]\nRecalculating energies and forces:  28%|\u2588\u258d   | 284/1000 [00:09&lt;00:17, 41.09it/s]\nRecalculating energies and forces:  29%|\u2588\u258d   | 289/1000 [00:09&lt;00:17, 41.75it/s]\nRecalculating energies and forces:  29%|\u2588\u258d   | 294/1000 [00:10&lt;00:16, 42.19it/s]\nRecalculating energies and forces:  30%|\u2588\u258d   | 299/1000 [00:10&lt;00:16, 42.01it/s]\nRecalculating energies and forces:  30%|\u2588\u258c   | 304/1000 [00:10&lt;00:16, 42.41it/s]\nRecalculating energies and forces:  31%|\u2588\u258c   | 309/1000 [00:10&lt;00:16, 42.54it/s]\nRecalculating energies and forces:  31%|\u2588\u258c   | 314/1000 [00:10&lt;00:16, 42.77it/s]\nRecalculating energies and forces:  32%|\u2588\u258c   | 319/1000 [00:10&lt;00:16, 41.32it/s]\nRecalculating energies and forces:  32%|\u2588\u258c   | 324/1000 [00:10&lt;00:16, 40.22it/s]\nRecalculating energies and forces:  33%|\u2588\u258b   | 329/1000 [00:10&lt;00:17, 39.41it/s]\nRecalculating energies and forces:  33%|\u2588\u258b   | 333/1000 [00:11&lt;00:17, 38.68it/s]\nRecalculating energies and forces:  34%|\u2588\u258b   | 337/1000 [00:11&lt;00:17, 38.13it/s]\nRecalculating energies and forces:  34%|\u2588\u258b   | 341/1000 [00:11&lt;00:17, 37.99it/s]\nRecalculating energies and forces:  34%|\u2588\u258b   | 345/1000 [00:11&lt;00:17, 37.08it/s]\nRecalculating energies and forces:  35%|\u2588\u258b   | 349/1000 [00:11&lt;00:17, 36.57it/s]\nRecalculating energies and forces:  35%|\u2588\u258a   | 353/1000 [00:11&lt;00:17, 36.19it/s]\nRecalculating energies and forces:  36%|\u2588\u258a   | 357/1000 [00:11&lt;00:17, 35.81it/s]\nRecalculating energies and forces:  36%|\u2588\u258a   | 361/1000 [00:11&lt;00:17, 35.93it/s]\nRecalculating energies and forces:  36%|\u2588\u258a   | 365/1000 [00:11&lt;00:17, 36.06it/s]\nRecalculating energies and forces:  37%|\u2588\u258a   | 369/1000 [00:12&lt;00:17, 35.54it/s]\nRecalculating energies and forces:  37%|\u2588\u258a   | 373/1000 [00:12&lt;00:17, 35.45it/s]\nRecalculating energies and forces:  38%|\u2588\u2589   | 377/1000 [00:12&lt;00:17, 35.77it/s]\nRecalculating energies and forces:  38%|\u2588\u2589   | 381/1000 [00:12&lt;00:16, 36.57it/s]\nRecalculating energies and forces:  38%|\u2588\u2589   | 385/1000 [00:12&lt;00:16, 36.60it/s]\nRecalculating energies and forces:  39%|\u2588\u2589   | 389/1000 [00:12&lt;00:16, 37.32it/s]\nRecalculating energies and forces:  39%|\u2588\u2589   | 393/1000 [00:12&lt;00:16, 37.12it/s]\nRecalculating energies and forces:  40%|\u2588\u2589   | 397/1000 [00:12&lt;00:15, 37.73it/s]\nRecalculating energies and forces:  40%|\u2588\u2588   | 401/1000 [00:12&lt;00:16, 37.33it/s]\nRecalculating energies and forces:  40%|\u2588\u2588   | 405/1000 [00:13&lt;00:16, 36.74it/s]\nRecalculating energies and forces:  41%|\u2588\u2588   | 409/1000 [00:13&lt;00:16, 36.57it/s]\nRecalculating energies and forces:  41%|\u2588\u2588   | 413/1000 [00:13&lt;00:16, 36.05it/s]\nRecalculating energies and forces:  42%|\u2588\u2588   | 417/1000 [00:13&lt;00:16, 36.42it/s]\nRecalculating energies and forces:  42%|\u2588\u2588   | 421/1000 [00:13&lt;00:16, 36.02it/s]\nRecalculating energies and forces:  42%|\u2588\u2588\u258f  | 425/1000 [00:13&lt;00:15, 36.12it/s]\nRecalculating energies and forces:  43%|\u2588\u2588\u258f  | 429/1000 [00:13&lt;00:15, 36.78it/s]\nRecalculating energies and forces:  43%|\u2588\u2588\u258f  | 433/1000 [00:13&lt;00:15, 37.15it/s]\nRecalculating energies and forces:  44%|\u2588\u2588\u258f  | 437/1000 [00:13&lt;00:15, 37.39it/s]\nRecalculating energies and forces:  44%|\u2588\u2588\u258f  | 441/1000 [00:14&lt;00:14, 37.79it/s]\nRecalculating energies and forces:  44%|\u2588\u2588\u258f  | 445/1000 [00:14&lt;00:14, 38.39it/s]\nRecalculating energies and forces:  45%|\u2588\u2588\u258f  | 449/1000 [00:14&lt;00:14, 38.46it/s]\nRecalculating energies and forces:  45%|\u2588\u2588\u258e  | 453/1000 [00:14&lt;00:14, 38.48it/s]\nRecalculating energies and forces:  46%|\u2588\u2588\u258e  | 457/1000 [00:14&lt;00:14, 38.56it/s]\nRecalculating energies and forces:  46%|\u2588\u2588\u258e  | 461/1000 [00:14&lt;00:13, 38.50it/s]\nRecalculating energies and forces:  46%|\u2588\u2588\u258e  | 465/1000 [00:14&lt;00:14, 37.81it/s]\nRecalculating energies and forces:  47%|\u2588\u2588\u258e  | 469/1000 [00:14&lt;00:14, 36.43it/s]\nRecalculating energies and forces:  47%|\u2588\u2588\u258e  | 473/1000 [00:14&lt;00:14, 36.44it/s]\nRecalculating energies and forces:  48%|\u2588\u2588\u258d  | 477/1000 [00:14&lt;00:14, 36.37it/s]\nRecalculating energies and forces:  48%|\u2588\u2588\u258d  | 481/1000 [00:15&lt;00:14, 35.74it/s]\nRecalculating energies and forces:  48%|\u2588\u2588\u258d  | 485/1000 [00:15&lt;00:14, 35.47it/s]\nRecalculating energies and forces:  49%|\u2588\u2588\u258d  | 489/1000 [00:15&lt;00:14, 35.82it/s]\nRecalculating energies and forces:  49%|\u2588\u2588\u258d  | 493/1000 [00:15&lt;00:14, 35.91it/s]\nRecalculating energies and forces:  50%|\u2588\u2588\u258d  | 497/1000 [00:15&lt;00:14, 35.59it/s]\nRecalculating energies and forces:  50%|\u2588\u2588\u258c  | 501/1000 [00:15&lt;00:14, 35.64it/s]\nRecalculating energies and forces:  50%|\u2588\u2588\u258c  | 505/1000 [00:15&lt;00:13, 36.28it/s]\nRecalculating energies and forces:  51%|\u2588\u2588\u258c  | 510/1000 [00:15&lt;00:12, 38.21it/s]\nRecalculating energies and forces:  52%|\u2588\u2588\u258c  | 515/1000 [00:15&lt;00:12, 39.73it/s]\nRecalculating energies and forces:  52%|\u2588\u2588\u258c  | 520/1000 [00:16&lt;00:11, 40.89it/s]\nRecalculating energies and forces:  52%|\u2588\u2588\u258b  | 525/1000 [00:16&lt;00:11, 41.61it/s]\nRecalculating energies and forces:  53%|\u2588\u2588\u258b  | 530/1000 [00:16&lt;00:11, 42.04it/s]\nRecalculating energies and forces:  54%|\u2588\u2588\u258b  | 535/1000 [00:16&lt;00:10, 42.52it/s]\nRecalculating energies and forces:  54%|\u2588\u2588\u258b  | 540/1000 [00:16&lt;00:10, 42.73it/s]\nRecalculating energies and forces:  55%|\u2588\u2588\u258b  | 545/1000 [00:16&lt;00:10, 43.01it/s]\nRecalculating energies and forces:  55%|\u2588\u2588\u258a  | 550/1000 [00:16&lt;00:10, 43.15it/s]\nRecalculating energies and forces:  56%|\u2588\u2588\u258a  | 555/1000 [00:16&lt;00:10, 43.32it/s]\nRecalculating energies and forces:  56%|\u2588\u2588\u258a  | 560/1000 [00:17&lt;00:10, 43.42it/s]\nRecalculating energies and forces:  56%|\u2588\u2588\u258a  | 565/1000 [00:17&lt;00:10, 43.22it/s]\nRecalculating energies and forces:  57%|\u2588\u2588\u258a  | 570/1000 [00:17&lt;00:09, 43.38it/s]\nRecalculating energies and forces:  57%|\u2588\u2588\u2589  | 575/1000 [00:17&lt;00:09, 43.26it/s]\nRecalculating energies and forces:  58%|\u2588\u2588\u2589  | 580/1000 [00:17&lt;00:09, 43.34it/s]\nRecalculating energies and forces:  58%|\u2588\u2588\u2589  | 585/1000 [00:17&lt;00:09, 42.75it/s]\nRecalculating energies and forces:  59%|\u2588\u2588\u2589  | 590/1000 [00:17&lt;00:09, 41.70it/s]\nRecalculating energies and forces:  60%|\u2588\u2588\u2589  | 595/1000 [00:17&lt;00:09, 41.45it/s]\nRecalculating energies and forces:  60%|\u2588\u2588\u2588  | 600/1000 [00:17&lt;00:09, 41.36it/s]\nRecalculating energies and forces:  60%|\u2588\u2588\u2588  | 605/1000 [00:18&lt;00:09, 42.21it/s]\nRecalculating energies and forces:  61%|\u2588\u2588\u2588  | 610/1000 [00:18&lt;00:09, 42.72it/s]\nRecalculating energies and forces:  62%|\u2588\u2588\u2588  | 615/1000 [00:18&lt;00:08, 43.18it/s]\nRecalculating energies and forces:  62%|\u2588\u2588\u2588  | 620/1000 [00:18&lt;00:08, 43.36it/s]\nRecalculating energies and forces:  62%|\u2588\u2588\u2588\u258f | 625/1000 [00:18&lt;00:08, 43.42it/s]\nRecalculating energies and forces:  63%|\u2588\u2588\u2588\u258f | 630/1000 [00:18&lt;00:08, 43.35it/s]\nRecalculating energies and forces:  64%|\u2588\u2588\u2588\u258f | 635/1000 [00:18&lt;00:08, 41.79it/s]\nRecalculating energies and forces:  64%|\u2588\u2588\u2588\u258f | 640/1000 [00:18&lt;00:08, 40.42it/s]\nRecalculating energies and forces:  64%|\u2588\u2588\u2588\u258f | 645/1000 [00:19&lt;00:09, 38.79it/s]\nRecalculating energies and forces:  65%|\u2588\u2588\u2588\u258f | 649/1000 [00:19&lt;00:09, 37.87it/s]\nRecalculating energies and forces:  65%|\u2588\u2588\u2588\u258e | 653/1000 [00:19&lt;00:09, 36.85it/s]\nRecalculating energies and forces:  66%|\u2588\u2588\u2588\u258e | 657/1000 [00:19&lt;00:09, 36.02it/s]\nRecalculating energies and forces:  66%|\u2588\u2588\u2588\u258e | 661/1000 [00:19&lt;00:09, 35.35it/s]\nRecalculating energies and forces:  66%|\u2588\u2588\u2588\u258e | 665/1000 [00:19&lt;00:09, 35.20it/s]\nRecalculating energies and forces:  67%|\u2588\u2588\u2588\u258e | 669/1000 [00:19&lt;00:09, 34.90it/s]\nRecalculating energies and forces:  67%|\u2588\u2588\u2588\u258e | 673/1000 [00:19&lt;00:09, 34.96it/s]\nRecalculating energies and forces:  68%|\u2588\u2588\u2588\u258d | 677/1000 [00:20&lt;00:09, 34.97it/s]\nRecalculating energies and forces:  68%|\u2588\u2588\u2588\u258d | 681/1000 [00:20&lt;00:09, 34.97it/s]\nRecalculating energies and forces:  68%|\u2588\u2588\u2588\u258d | 685/1000 [00:20&lt;00:09, 34.98it/s]\nRecalculating energies and forces:  69%|\u2588\u2588\u2588\u258d | 689/1000 [00:20&lt;00:08, 35.73it/s]\nRecalculating energies and forces:  69%|\u2588\u2588\u2588\u258d | 693/1000 [00:20&lt;00:08, 35.96it/s]\nRecalculating energies and forces:  70%|\u2588\u2588\u2588\u258d | 697/1000 [00:20&lt;00:08, 35.87it/s]\nRecalculating energies and forces:  70%|\u2588\u2588\u2588\u258c | 701/1000 [00:20&lt;00:08, 35.03it/s]\nRecalculating energies and forces:  70%|\u2588\u2588\u2588\u258c | 705/1000 [00:20&lt;00:08, 35.50it/s]\nRecalculating energies and forces:  71%|\u2588\u2588\u2588\u258c | 709/1000 [00:20&lt;00:08, 35.65it/s]\nRecalculating energies and forces:  71%|\u2588\u2588\u2588\u258c | 713/1000 [00:21&lt;00:08, 35.74it/s]\nRecalculating energies and forces:  72%|\u2588\u2588\u2588\u258c | 717/1000 [00:21&lt;00:07, 35.82it/s]\nRecalculating energies and forces:  72%|\u2588\u2588\u2588\u258c | 721/1000 [00:21&lt;00:07, 35.92it/s]\nRecalculating energies and forces:  72%|\u2588\u2588\u2588\u258b | 725/1000 [00:21&lt;00:07, 35.95it/s]\nRecalculating energies and forces:  73%|\u2588\u2588\u2588\u258b | 729/1000 [00:21&lt;00:07, 35.39it/s]\nRecalculating energies and forces:  73%|\u2588\u2588\u2588\u258b | 733/1000 [00:21&lt;00:07, 35.15it/s]\nRecalculating energies and forces:  74%|\u2588\u2588\u2588\u258b | 737/1000 [00:21&lt;00:07, 35.27it/s]\nRecalculating energies and forces:  74%|\u2588\u2588\u2588\u258b | 741/1000 [00:21&lt;00:07, 35.41it/s]\nRecalculating energies and forces:  74%|\u2588\u2588\u2588\u258b | 745/1000 [00:21&lt;00:07, 35.44it/s]\nRecalculating energies and forces:  75%|\u2588\u2588\u2588\u258b | 749/1000 [00:22&lt;00:07, 35.41it/s]\nRecalculating energies and forces:  75%|\u2588\u2588\u2588\u258a | 753/1000 [00:22&lt;00:06, 35.63it/s]\nRecalculating energies and forces:  76%|\u2588\u2588\u2588\u258a | 757/1000 [00:22&lt;00:06, 35.75it/s]\nRecalculating energies and forces:  76%|\u2588\u2588\u2588\u258a | 761/1000 [00:22&lt;00:06, 35.49it/s]\nRecalculating energies and forces:  76%|\u2588\u2588\u2588\u258a | 765/1000 [00:22&lt;00:06, 35.30it/s]\nRecalculating energies and forces:  77%|\u2588\u2588\u2588\u258a | 769/1000 [00:22&lt;00:06, 35.33it/s]\nRecalculating energies and forces:  77%|\u2588\u2588\u2588\u258a | 773/1000 [00:22&lt;00:06, 35.26it/s]\nRecalculating energies and forces:  78%|\u2588\u2588\u2588\u2589 | 777/1000 [00:22&lt;00:06, 35.59it/s]\nRecalculating energies and forces:  78%|\u2588\u2588\u2588\u2589 | 781/1000 [00:22&lt;00:06, 35.88it/s]\nRecalculating energies and forces:  79%|\u2588\u2588\u2588\u2589 | 786/1000 [00:23&lt;00:05, 37.99it/s]\nRecalculating energies and forces:  79%|\u2588\u2588\u2588\u2589 | 791/1000 [00:23&lt;00:05, 39.53it/s]\nRecalculating energies and forces:  80%|\u2588\u2588\u2588\u2589 | 796/1000 [00:23&lt;00:05, 40.70it/s]\nRecalculating energies and forces:  80%|\u2588\u2588\u2588\u2588 | 801/1000 [00:23&lt;00:04, 41.56it/s]\nRecalculating energies and forces:  81%|\u2588\u2588\u2588\u2588 | 806/1000 [00:23&lt;00:04, 42.20it/s]\nRecalculating energies and forces:  81%|\u2588\u2588\u2588\u2588 | 811/1000 [00:23&lt;00:04, 42.17it/s]\nRecalculating energies and forces:  82%|\u2588\u2588\u2588\u2588 | 816/1000 [00:23&lt;00:04, 42.55it/s]\nRecalculating energies and forces:  82%|\u2588\u2588\u2588\u2588 | 821/1000 [00:23&lt;00:04, 42.98it/s]\nRecalculating energies and forces:  83%|\u2588\u2588\u2588\u2588\u258f| 826/1000 [00:23&lt;00:04, 43.07it/s]\nRecalculating energies and forces:  83%|\u2588\u2588\u2588\u2588\u258f| 831/1000 [00:24&lt;00:03, 43.27it/s]\nRecalculating energies and forces:  84%|\u2588\u2588\u2588\u2588\u258f| 836/1000 [00:24&lt;00:03, 43.35it/s]\nRecalculating energies and forces:  84%|\u2588\u2588\u2588\u2588\u258f| 841/1000 [00:24&lt;00:03, 43.31it/s]\nRecalculating energies and forces:  85%|\u2588\u2588\u2588\u2588\u258f| 846/1000 [00:24&lt;00:03, 43.45it/s]\nRecalculating energies and forces:  85%|\u2588\u2588\u2588\u2588\u258e| 851/1000 [00:24&lt;00:03, 43.42it/s]\nRecalculating energies and forces:  86%|\u2588\u2588\u2588\u2588\u258e| 856/1000 [00:24&lt;00:03, 43.23it/s]\nRecalculating energies and forces:  86%|\u2588\u2588\u2588\u2588\u258e| 861/1000 [00:24&lt;00:03, 43.29it/s]\nRecalculating energies and forces:  87%|\u2588\u2588\u2588\u2588\u258e| 866/1000 [00:24&lt;00:03, 43.35it/s]\nRecalculating energies and forces:  87%|\u2588\u2588\u2588\u2588\u258e| 871/1000 [00:25&lt;00:02, 43.02it/s]\nRecalculating energies and forces:  88%|\u2588\u2588\u2588\u2588\u258d| 876/1000 [00:25&lt;00:02, 43.08it/s]\nRecalculating energies and forces:  88%|\u2588\u2588\u2588\u2588\u258d| 881/1000 [00:25&lt;00:02, 43.21it/s]\nRecalculating energies and forces:  89%|\u2588\u2588\u2588\u2588\u258d| 886/1000 [00:25&lt;00:02, 43.41it/s]\nRecalculating energies and forces:  89%|\u2588\u2588\u2588\u2588\u258d| 891/1000 [00:25&lt;00:02, 43.50it/s]\nRecalculating energies and forces:  90%|\u2588\u2588\u2588\u2588\u258d| 896/1000 [00:25&lt;00:02, 42.13it/s]\nRecalculating energies and forces:  90%|\u2588\u2588\u2588\u2588\u258c| 901/1000 [00:25&lt;00:02, 42.20it/s]\nRecalculating energies and forces:  91%|\u2588\u2588\u2588\u2588\u258c| 906/1000 [00:25&lt;00:02, 42.64it/s]\nRecalculating energies and forces:  91%|\u2588\u2588\u2588\u2588\u258c| 911/1000 [00:25&lt;00:02, 43.00it/s]\nRecalculating energies and forces:  92%|\u2588\u2588\u2588\u2588\u258c| 916/1000 [00:26&lt;00:01, 43.28it/s]\nRecalculating energies and forces:  92%|\u2588\u2588\u2588\u2588\u258c| 921/1000 [00:26&lt;00:01, 43.29it/s]\nRecalculating energies and forces:  93%|\u2588\u2588\u2588\u2588\u258b| 926/1000 [00:26&lt;00:01, 43.31it/s]\nRecalculating energies and forces:  93%|\u2588\u2588\u2588\u2588\u258b| 931/1000 [00:26&lt;00:01, 43.37it/s]\nRecalculating energies and forces:  94%|\u2588\u2588\u2588\u2588\u258b| 936/1000 [00:26&lt;00:01, 43.33it/s]\nRecalculating energies and forces:  94%|\u2588\u2588\u2588\u2588\u258b| 941/1000 [00:26&lt;00:01, 42.16it/s]\nRecalculating energies and forces:  95%|\u2588\u2588\u2588\u2588\u258b| 946/1000 [00:26&lt;00:01, 40.66it/s]\nRecalculating energies and forces:  95%|\u2588\u2588\u2588\u2588\u258a| 951/1000 [00:26&lt;00:01, 41.14it/s]\nRecalculating energies and forces:  96%|\u2588\u2588\u2588\u2588\u258a| 956/1000 [00:27&lt;00:01, 41.59it/s]\nRecalculating energies and forces:  96%|\u2588\u2588\u2588\u2588\u258a| 961/1000 [00:27&lt;00:00, 42.18it/s]\nRecalculating energies and forces:  97%|\u2588\u2588\u2588\u2588\u258a| 966/1000 [00:27&lt;00:00, 42.73it/s]\nRecalculating energies and forces:  97%|\u2588\u2588\u2588\u2588\u258a| 971/1000 [00:27&lt;00:00, 42.97it/s]\nRecalculating energies and forces:  98%|\u2588\u2588\u2588\u2588\u2589| 976/1000 [00:27&lt;00:00, 43.09it/s]\nRecalculating energies and forces:  98%|\u2588\u2588\u2588\u2588\u2589| 981/1000 [00:27&lt;00:00, 42.98it/s]\nRecalculating energies and forces:  99%|\u2588\u2588\u2588\u2588\u2589| 986/1000 [00:27&lt;00:00, 42.79it/s]\nRecalculating energies and forces:  99%|\u2588\u2588\u2588\u2588\u2589| 991/1000 [00:27&lt;00:00, 42.80it/s]\nRecalculating energies and forces: 100%|\u2588\u2588\u2588\u2588\u2589| 996/1000 [00:27&lt;00:00, 43.10it/s]\n                                                                                \nSaving the dataset (0/1 shards):   0%|             | 0/1 [00:00&lt;?, ? examples/s]\nSaving the dataset (1/1 shards): 100%|\u2588\u2588\u2588\u2588| 1/1 [00:00&lt;00:00, 248.43 examples/s]\n\nOptimising MM parameters:   0%|                        | 0/1000 [00:00&lt;?, ?it/s]\nOptimising MM parameters:   0%|                | 1/1000 [00:00&lt;03:32,  4.71it/s]\nOptimising MM parameters:   1%|                | 6/1000 [00:00&lt;00:47, 20.93it/s]\nOptimising MM parameters:   1%|\u258f              | 11/1000 [00:00&lt;00:35, 27.75it/s]\nOptimising MM parameters:   2%|\u258f              | 16/1000 [00:00&lt;00:30, 32.48it/s]\nOptimising MM parameters:   2%|\u258e              | 21/1000 [00:00&lt;00:28, 34.38it/s]\nOptimising MM parameters:   3%|\u258d              | 26/1000 [00:00&lt;00:26, 36.58it/s]\nOptimising MM parameters:   3%|\u258d              | 31/1000 [00:00&lt;00:26, 36.99it/s]\nOptimising MM parameters:   4%|\u258c              | 36/1000 [00:01&lt;00:25, 38.28it/s]\nOptimising MM parameters:   4%|\u258c              | 41/1000 [00:01&lt;00:25, 38.16it/s]\nOptimising MM parameters:   5%|\u258b              | 46/1000 [00:01&lt;00:24, 39.44it/s]\nOptimising MM parameters:   5%|\u258a              | 51/1000 [00:01&lt;00:24, 39.33it/s]\nOptimising MM parameters:   6%|\u258a              | 56/1000 [00:01&lt;00:23, 40.28it/s]\nOptimising MM parameters:   6%|\u2589              | 61/1000 [00:01&lt;00:23, 39.93it/s]\nOptimising MM parameters:   7%|\u2589              | 66/1000 [00:01&lt;00:22, 40.74it/s]\nOptimising MM parameters:   7%|\u2588              | 71/1000 [00:01&lt;00:23, 40.24it/s]\nOptimising MM parameters:   8%|\u2588\u258f             | 76/1000 [00:02&lt;00:22, 40.94it/s]\nOptimising MM parameters:   8%|\u2588\u258f             | 81/1000 [00:02&lt;00:22, 40.33it/s]\nOptimising MM parameters:   9%|\u2588\u258e             | 86/1000 [00:02&lt;00:22, 41.00it/s]\nOptimising MM parameters:   9%|\u2588\u258e             | 91/1000 [00:02&lt;00:22, 40.42it/s]\nOptimising MM parameters:  10%|\u2588\u258d             | 96/1000 [00:02&lt;00:22, 41.05it/s]\nOptimising MM parameters:  10%|\u2588\u258d            | 101/1000 [00:02&lt;00:22, 40.40it/s]\nOptimising MM parameters:  11%|\u2588\u258d            | 106/1000 [00:02&lt;00:21, 41.06it/s]\nOptimising MM parameters:  11%|\u2588\u258c            | 111/1000 [00:02&lt;00:21, 40.41it/s]\nOptimising MM parameters:  12%|\u2588\u258c            | 116/1000 [00:03&lt;00:21, 41.01it/s]\nOptimising MM parameters:  12%|\u2588\u258b            | 121/1000 [00:03&lt;00:21, 40.42it/s]\nOptimising MM parameters:  13%|\u2588\u258a            | 126/1000 [00:03&lt;00:21, 41.08it/s]\nOptimising MM parameters:  13%|\u2588\u258a            | 131/1000 [00:03&lt;00:21, 40.44it/s]\nOptimising MM parameters:  14%|\u2588\u2589            | 136/1000 [00:03&lt;00:21, 41.12it/s]\nOptimising MM parameters:  14%|\u2588\u2589            | 141/1000 [00:03&lt;00:21, 40.49it/s]\nOptimising MM parameters:  15%|\u2588\u2588            | 146/1000 [00:03&lt;00:20, 41.15it/s]\nOptimising MM parameters:  15%|\u2588\u2588            | 151/1000 [00:03&lt;00:20, 40.53it/s]\nOptimising MM parameters:  16%|\u2588\u2588\u258f           | 156/1000 [00:04&lt;00:20, 41.15it/s]\nOptimising MM parameters:  16%|\u2588\u2588\u258e           | 161/1000 [00:04&lt;00:20, 40.51it/s]\nOptimising MM parameters:  17%|\u2588\u2588\u258e           | 166/1000 [00:04&lt;00:20, 41.13it/s]\nOptimising MM parameters:  17%|\u2588\u2588\u258d           | 171/1000 [00:04&lt;00:20, 40.50it/s]\nOptimising MM parameters:  18%|\u2588\u2588\u258d           | 176/1000 [00:04&lt;00:20, 41.08it/s]\nOptimising MM parameters:  18%|\u2588\u2588\u258c           | 181/1000 [00:04&lt;00:20, 40.45it/s]\nOptimising MM parameters:  19%|\u2588\u2588\u258c           | 186/1000 [00:04&lt;00:19, 41.07it/s]\nOptimising MM parameters:  19%|\u2588\u2588\u258b           | 191/1000 [00:04&lt;00:20, 40.43it/s]\nOptimising MM parameters:  20%|\u2588\u2588\u258b           | 196/1000 [00:05&lt;00:19, 40.94it/s]\nOptimising MM parameters:  20%|\u2588\u2588\u258a           | 201/1000 [00:05&lt;00:20, 39.79it/s]\nOptimising MM parameters:  21%|\u2588\u2588\u2589           | 206/1000 [00:05&lt;00:19, 40.60it/s]\nOptimising MM parameters:  21%|\u2588\u2588\u2589           | 211/1000 [00:05&lt;00:19, 40.09it/s]\nOptimising MM parameters:  22%|\u2588\u2588\u2588           | 216/1000 [00:05&lt;00:19, 40.84it/s]\nOptimising MM parameters:  22%|\u2588\u2588\u2588           | 221/1000 [00:05&lt;00:19, 40.32it/s]\nOptimising MM parameters:  23%|\u2588\u2588\u2588\u258f          | 226/1000 [00:05&lt;00:18, 41.03it/s]\nOptimising MM parameters:  23%|\u2588\u2588\u2588\u258f          | 231/1000 [00:05&lt;00:19, 40.45it/s]\nOptimising MM parameters:  24%|\u2588\u2588\u2588\u258e          | 236/1000 [00:06&lt;00:18, 41.10it/s]\nOptimising MM parameters:  24%|\u2588\u2588\u2588\u258e          | 241/1000 [00:06&lt;00:18, 40.42it/s]\nOptimising MM parameters:  25%|\u2588\u2588\u2588\u258d          | 246/1000 [00:06&lt;00:18, 41.08it/s]\nOptimising MM parameters:  25%|\u2588\u2588\u2588\u258c          | 251/1000 [00:06&lt;00:18, 40.47it/s]\nOptimising MM parameters:  26%|\u2588\u2588\u2588\u258c          | 256/1000 [00:06&lt;00:18, 40.42it/s]\nOptimising MM parameters:  26%|\u2588\u2588\u2588\u258b          | 261/1000 [00:06&lt;00:18, 39.37it/s]\nOptimising MM parameters:  27%|\u2588\u2588\u2588\u258b          | 266/1000 [00:06&lt;00:18, 40.28it/s]\nOptimising MM parameters:  27%|\u2588\u2588\u2588\u258a          | 271/1000 [00:06&lt;00:18, 39.91it/s]\nOptimising MM parameters:  28%|\u2588\u2588\u2588\u258a          | 276/1000 [00:07&lt;00:17, 40.72it/s]\nOptimising MM parameters:  28%|\u2588\u2588\u2588\u2589          | 281/1000 [00:07&lt;00:17, 40.26it/s]\nOptimising MM parameters:  29%|\u2588\u2588\u2588\u2588          | 286/1000 [00:07&lt;00:17, 40.99it/s]\nOptimising MM parameters:  29%|\u2588\u2588\u2588\u2588          | 291/1000 [00:07&lt;00:17, 40.40it/s]\nOptimising MM parameters:  30%|\u2588\u2588\u2588\u2588\u258f         | 296/1000 [00:07&lt;00:17, 41.07it/s]\nOptimising MM parameters:  30%|\u2588\u2588\u2588\u2588\u258f         | 301/1000 [00:07&lt;00:17, 40.42it/s]\nOptimising MM parameters:  31%|\u2588\u2588\u2588\u2588\u258e         | 306/1000 [00:07&lt;00:16, 41.11it/s]\nOptimising MM parameters:  31%|\u2588\u2588\u2588\u2588\u258e         | 311/1000 [00:07&lt;00:17, 40.47it/s]\nOptimising MM parameters:  32%|\u2588\u2588\u2588\u2588\u258d         | 316/1000 [00:07&lt;00:16, 41.10it/s]\nOptimising MM parameters:  32%|\u2588\u2588\u2588\u2588\u258d         | 321/1000 [00:08&lt;00:16, 40.48it/s]\nOptimising MM parameters:  33%|\u2588\u2588\u2588\u2588\u258c         | 326/1000 [00:08&lt;00:16, 41.15it/s]\nOptimising MM parameters:  33%|\u2588\u2588\u2588\u2588\u258b         | 331/1000 [00:08&lt;00:16, 40.48it/s]\nOptimising MM parameters:  34%|\u2588\u2588\u2588\u2588\u258b         | 336/1000 [00:08&lt;00:16, 41.11it/s]\nOptimising MM parameters:  34%|\u2588\u2588\u2588\u2588\u258a         | 341/1000 [00:08&lt;00:16, 40.50it/s]\nOptimising MM parameters:  35%|\u2588\u2588\u2588\u2588\u258a         | 346/1000 [00:08&lt;00:15, 41.15it/s]\nOptimising MM parameters:  35%|\u2588\u2588\u2588\u2588\u2589         | 351/1000 [00:08&lt;00:16, 40.50it/s]\nOptimising MM parameters:  36%|\u2588\u2588\u2588\u2588\u2589         | 356/1000 [00:08&lt;00:15, 41.15it/s]\nOptimising MM parameters:  36%|\u2588\u2588\u2588\u2588\u2588         | 361/1000 [00:09&lt;00:15, 40.50it/s]\nOptimising MM parameters:  37%|\u2588\u2588\u2588\u2588\u2588         | 366/1000 [00:09&lt;00:15, 41.11it/s]\nOptimising MM parameters:  37%|\u2588\u2588\u2588\u2588\u2588\u258f        | 371/1000 [00:09&lt;00:15, 40.45it/s]\nOptimising MM parameters:  38%|\u2588\u2588\u2588\u2588\u2588\u258e        | 376/1000 [00:09&lt;00:15, 41.09it/s]\nOptimising MM parameters:  38%|\u2588\u2588\u2588\u2588\u2588\u258e        | 381/1000 [00:09&lt;00:15, 40.47it/s]\nOptimising MM parameters:  39%|\u2588\u2588\u2588\u2588\u2588\u258d        | 386/1000 [00:09&lt;00:14, 41.10it/s]\nOptimising MM parameters:  39%|\u2588\u2588\u2588\u2588\u2588\u258d        | 391/1000 [00:09&lt;00:15, 40.48it/s]\nOptimising MM parameters:  40%|\u2588\u2588\u2588\u2588\u2588\u258c        | 396/1000 [00:09&lt;00:14, 41.13it/s]\nOptimising MM parameters:  40%|\u2588\u2588\u2588\u2588\u2588\u258c        | 401/1000 [00:10&lt;00:14, 40.06it/s]\nOptimising MM parameters:  41%|\u2588\u2588\u2588\u2588\u2588\u258b        | 406/1000 [00:10&lt;00:14, 40.12it/s]\nOptimising MM parameters:  41%|\u2588\u2588\u2588\u2588\u2588\u258a        | 411/1000 [00:10&lt;00:14, 39.33it/s]\nOptimising MM parameters:  42%|\u2588\u2588\u2588\u2588\u2588\u258a        | 415/1000 [00:10&lt;00:14, 39.49it/s]\nOptimising MM parameters:  42%|\u2588\u2588\u2588\u2588\u2588\u2589        | 420/1000 [00:10&lt;00:14, 39.88it/s]\nOptimising MM parameters:  42%|\u2588\u2588\u2588\u2588\u2588\u2589        | 424/1000 [00:10&lt;00:14, 38.76it/s]\nOptimising MM parameters:  43%|\u2588\u2588\u2588\u2588\u2588\u2588        | 429/1000 [00:10&lt;00:14, 39.45it/s]\nOptimising MM parameters:  43%|\u2588\u2588\u2588\u2588\u2588\u2588        | 433/1000 [00:10&lt;00:14, 38.64it/s]\nOptimising MM parameters:  44%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f       | 438/1000 [00:11&lt;00:14, 39.32it/s]\nOptimising MM parameters:  44%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f       | 442/1000 [00:11&lt;00:14, 38.38it/s]\nOptimising MM parameters:  45%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e       | 447/1000 [00:11&lt;00:14, 39.10it/s]\nOptimising MM parameters:  45%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e       | 451/1000 [00:11&lt;00:14, 38.32it/s]\nOptimising MM parameters:  46%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e       | 455/1000 [00:11&lt;00:14, 38.66it/s]\nOptimising MM parameters:  46%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d       | 460/1000 [00:11&lt;00:13, 39.29it/s]\nOptimising MM parameters:  46%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d       | 464/1000 [00:11&lt;00:13, 38.51it/s]\nOptimising MM parameters:  47%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c       | 469/1000 [00:11&lt;00:13, 39.23it/s]\nOptimising MM parameters:  47%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c       | 473/1000 [00:11&lt;00:13, 38.37it/s]\nOptimising MM parameters:  48%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b       | 478/1000 [00:12&lt;00:13, 39.11it/s]\nOptimising MM parameters:  48%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b       | 482/1000 [00:12&lt;00:13, 38.35it/s]\nOptimising MM parameters:  49%|\u2588\u2588\u2588\u2588\u2588\u2588\u258a       | 486/1000 [00:12&lt;00:13, 38.51it/s]\nOptimising MM parameters:  49%|\u2588\u2588\u2588\u2588\u2588\u2588\u258a       | 490/1000 [00:12&lt;00:13, 38.58it/s]\nOptimising MM parameters:  49%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589       | 494/1000 [00:12&lt;00:13, 37.19it/s]\nOptimising MM parameters:  50%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589       | 499/1000 [00:12&lt;00:13, 38.21it/s]\nOptimising MM parameters:  50%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588       | 503/1000 [00:12&lt;00:13, 37.81it/s]\nOptimising MM parameters:  51%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588       | 508/1000 [00:12&lt;00:12, 38.49it/s]\nOptimising MM parameters:  51%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f      | 512/1000 [00:12&lt;00:12, 37.91it/s]\nOptimising MM parameters:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f      | 517/1000 [00:13&lt;00:12, 38.56it/s]\nOptimising MM parameters:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e      | 521/1000 [00:13&lt;00:12, 37.93it/s]\nOptimising MM parameters:  53%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e      | 526/1000 [00:13&lt;00:12, 38.66it/s]\nOptimising MM parameters:  53%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d      | 531/1000 [00:13&lt;00:12, 38.16it/s]\nOptimising MM parameters:  54%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d      | 535/1000 [00:13&lt;00:12, 38.24it/s]\nOptimising MM parameters:  54%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c      | 540/1000 [00:13&lt;00:11, 38.78it/s]\nOptimising MM parameters:  54%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c      | 544/1000 [00:13&lt;00:12, 37.43it/s]\nOptimising MM parameters:  55%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b      | 549/1000 [00:13&lt;00:11, 38.87it/s]\nOptimising MM parameters:  55%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b      | 553/1000 [00:14&lt;00:11, 38.59it/s]\nOptimising MM parameters:  56%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a      | 558/1000 [00:14&lt;00:11, 39.63it/s]\nOptimising MM parameters:  56%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a      | 562/1000 [00:14&lt;00:11, 39.17it/s]\nOptimising MM parameters:  57%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589      | 567/1000 [00:14&lt;00:10, 40.19it/s]\nOptimising MM parameters:  57%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588      | 572/1000 [00:14&lt;00:10, 39.74it/s]\nOptimising MM parameters:  58%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588      | 577/1000 [00:14&lt;00:10, 40.33it/s]\nOptimising MM parameters:  58%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f     | 582/1000 [00:14&lt;00:10, 39.48it/s]\nOptimising MM parameters:  59%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f     | 587/1000 [00:14&lt;00:10, 39.90it/s]\nOptimising MM parameters:  59%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e     | 591/1000 [00:14&lt;00:10, 39.12it/s]\nOptimising MM parameters:  60%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e     | 596/1000 [00:15&lt;00:10, 40.11it/s]\nOptimising MM parameters:  60%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d     | 601/1000 [00:15&lt;00:10, 39.69it/s]\nOptimising MM parameters:  61%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d     | 606/1000 [00:15&lt;00:09, 40.55it/s]\nOptimising MM parameters:  61%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c     | 611/1000 [00:15&lt;00:09, 39.97it/s]\nOptimising MM parameters:  62%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c     | 616/1000 [00:15&lt;00:09, 40.67it/s]\nOptimising MM parameters:  62%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b     | 621/1000 [00:15&lt;00:09, 40.11it/s]\nOptimising MM parameters:  63%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a     | 626/1000 [00:15&lt;00:09, 40.81it/s]\nOptimising MM parameters:  63%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a     | 631/1000 [00:15&lt;00:09, 40.23it/s]\nOptimising MM parameters:  64%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589     | 636/1000 [00:16&lt;00:08, 40.89it/s]\nOptimising MM parameters:  64%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589     | 641/1000 [00:16&lt;00:08, 40.29it/s]\nOptimising MM parameters:  65%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588     | 646/1000 [00:16&lt;00:08, 40.97it/s]\nOptimising MM parameters:  65%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588     | 651/1000 [00:16&lt;00:08, 40.38it/s]\nOptimising MM parameters:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f    | 656/1000 [00:16&lt;00:08, 41.04it/s]\nOptimising MM parameters:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e    | 661/1000 [00:16&lt;00:08, 40.40it/s]\nOptimising MM parameters:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e    | 666/1000 [00:16&lt;00:08, 41.02it/s]\nOptimising MM parameters:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d    | 671/1000 [00:16&lt;00:08, 40.32it/s]\nOptimising MM parameters:  68%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d    | 676/1000 [00:17&lt;00:07, 40.95it/s]\nOptimising MM parameters:  68%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c    | 681/1000 [00:17&lt;00:07, 40.32it/s]\nOptimising MM parameters:  69%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c    | 686/1000 [00:17&lt;00:07, 40.96it/s]\nOptimising MM parameters:  69%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b    | 691/1000 [00:17&lt;00:07, 40.34it/s]\nOptimising MM parameters:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b    | 696/1000 [00:17&lt;00:07, 41.00it/s]\nOptimising MM parameters:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a    | 701/1000 [00:17&lt;00:07, 40.39it/s]\nOptimising MM parameters:  71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589    | 706/1000 [00:17&lt;00:07, 41.00it/s]\nOptimising MM parameters:  71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589    | 711/1000 [00:17&lt;00:07, 40.35it/s]\nOptimising MM parameters:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588    | 716/1000 [00:18&lt;00:06, 41.01it/s]\nOptimising MM parameters:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588    | 721/1000 [00:18&lt;00:06, 40.39it/s]\nOptimising MM parameters:  73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 726/1000 [00:18&lt;00:06, 41.06it/s]\nOptimising MM parameters:  73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 731/1000 [00:18&lt;00:06, 40.43it/s]\nOptimising MM parameters:  74%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e   | 736/1000 [00:18&lt;00:06, 41.05it/s]\nOptimising MM parameters:  74%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e   | 741/1000 [00:18&lt;00:06, 40.40it/s]\nOptimising MM parameters:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d   | 746/1000 [00:18&lt;00:06, 41.04it/s]\nOptimising MM parameters:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 751/1000 [00:18&lt;00:06, 40.42it/s]\nOptimising MM parameters:  76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 756/1000 [00:19&lt;00:05, 41.05it/s]\nOptimising MM parameters:  76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b   | 761/1000 [00:19&lt;00:05, 40.04it/s]\nOptimising MM parameters:  77%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b   | 766/1000 [00:19&lt;00:05, 40.49it/s]\nOptimising MM parameters:  77%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a   | 771/1000 [00:19&lt;00:05, 40.03it/s]\nOptimising MM parameters:  78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a   | 776/1000 [00:19&lt;00:05, 40.78it/s]\nOptimising MM parameters:  78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 781/1000 [00:19&lt;00:05, 40.24it/s]\nOptimising MM parameters:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588   | 786/1000 [00:19&lt;00:05, 40.95it/s]\nOptimising MM parameters:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588   | 791/1000 [00:19&lt;00:05, 40.37it/s]\nOptimising MM parameters:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 796/1000 [00:20&lt;00:04, 41.02it/s]\nOptimising MM parameters:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 801/1000 [00:20&lt;00:04, 40.21it/s]\nOptimising MM parameters:  81%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e  | 806/1000 [00:20&lt;00:04, 40.90it/s]\nOptimising MM parameters:  81%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e  | 811/1000 [00:20&lt;00:04, 40.30it/s]\nOptimising MM parameters:  82%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d  | 816/1000 [00:20&lt;00:04, 40.99it/s]\nOptimising MM parameters:  82%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d  | 821/1000 [00:20&lt;00:04, 40.37it/s]\nOptimising MM parameters:  83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 826/1000 [00:20&lt;00:04, 41.04it/s]\nOptimising MM parameters:  83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b  | 831/1000 [00:20&lt;00:04, 40.41it/s]\nOptimising MM parameters:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b  | 836/1000 [00:20&lt;00:03, 41.06it/s]\nOptimising MM parameters:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 841/1000 [00:21&lt;00:03, 40.41it/s]\nOptimising MM parameters:  85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 846/1000 [00:21&lt;00:03, 41.03it/s]\nOptimising MM parameters:  85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 851/1000 [00:21&lt;00:03, 40.40it/s]\nOptimising MM parameters:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 856/1000 [00:21&lt;00:03, 41.04it/s]\nOptimising MM parameters:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 861/1000 [00:21&lt;00:03, 40.40it/s]\nOptimising MM parameters:  87%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 866/1000 [00:21&lt;00:03, 41.02it/s]\nOptimising MM parameters:  87%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f | 871/1000 [00:21&lt;00:03, 40.39it/s]\nOptimising MM parameters:  88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 876/1000 [00:21&lt;00:03, 41.03it/s]\nOptimising MM parameters:  88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 881/1000 [00:22&lt;00:02, 40.39it/s]\nOptimising MM parameters:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 886/1000 [00:22&lt;00:02, 41.03it/s]\nOptimising MM parameters:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 891/1000 [00:22&lt;00:02, 40.39it/s]\nOptimising MM parameters:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 896/1000 [00:22&lt;00:02, 41.00it/s]\nOptimising MM parameters:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 901/1000 [00:22&lt;00:02, 40.36it/s]\nOptimising MM parameters:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 906/1000 [00:22&lt;00:02, 40.98it/s]\nOptimising MM parameters:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 911/1000 [00:22&lt;00:02, 40.37it/s]\nOptimising MM parameters:  92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 916/1000 [00:22&lt;00:02, 41.03it/s]\nOptimising MM parameters:  92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589 | 921/1000 [00:23&lt;00:01, 40.41it/s]\nOptimising MM parameters:  93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589 | 926/1000 [00:23&lt;00:01, 41.03it/s]\nOptimising MM parameters:  93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 | 931/1000 [00:23&lt;00:01, 40.40it/s]\nOptimising MM parameters:  94%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 | 936/1000 [00:23&lt;00:01, 41.05it/s]\nOptimising MM parameters:  94%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 941/1000 [00:23&lt;00:01, 40.41it/s]\nOptimising MM parameters:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 946/1000 [00:23&lt;00:01, 41.04it/s]\nOptimising MM parameters:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e| 951/1000 [00:23&lt;00:01, 40.43it/s]\nOptimising MM parameters:  96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 956/1000 [00:23&lt;00:01, 41.09it/s]\nOptimising MM parameters:  96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 961/1000 [00:24&lt;00:00, 40.45it/s]\nOptimising MM parameters:  97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 966/1000 [00:24&lt;00:00, 41.06it/s]\nOptimising MM parameters:  97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 971/1000 [00:24&lt;00:00, 40.42it/s]\nOptimising MM parameters:  98%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b| 976/1000 [00:24&lt;00:00, 41.07it/s]\nOptimising MM parameters:  98%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b| 981/1000 [00:24&lt;00:00, 40.45it/s]\nOptimising MM parameters:  99%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a| 986/1000 [00:24&lt;00:00, 41.06it/s]\nOptimising MM parameters:  99%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a| 991/1000 [00:24&lt;00:00, 40.33it/s]\nOptimising MM parameters: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589| 996/1000 [00:24&lt;00:00, 40.99it/s]\n                                                                                2025-12-03 15:12:36.553 | INFO     | bespokefit_smee.workflow:get_bespoke_force_field:196 - Iteration 1 force field statistics: Energy (Mean/SD): 3.399e-04/6.531e+00, Forces (Mean/SD): -1.146e-09/1.539e+01\n2025-12-03 15:12:36.553 | INFO     | bespokefit_smee.workflow:get_bespoke_force_field:199 -     Energy Error (Mean):  3.399e-04-&gt; 3.340e-04 : Change = -5.898e-06\n2025-12-03 15:12:36.553 | INFO     | bespokefit_smee.workflow:get_bespoke_force_field:202 -                  (SD):    6.531e+00-&gt; 2.778e+00 : Change = -3.753e+00\n2025-12-03 15:12:36.553 | INFO     | bespokefit_smee.workflow:get_bespoke_force_field:205 -     Forces Error (Mean): -1.146e-09-&gt; 1.049e-09 : Change =  2.195e-09\n2025-12-03 15:12:36.553 | INFO     | bespokefit_smee.workflow:get_bespoke_force_field:208 -                  (SD):    1.539e+01-&gt; 7.533e+00 : Change = -7.857e+00\nIterating the Fit:  50%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588             | 1/2 [01:18&lt;01:18, 78.83s/it]\nGenerating Snapshots:   0%|                              | 0/10 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 1:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 1:   6%|\u2589              | 6/100 [00:00&lt;00:01, 51.83it/s]\n\nRunning MD for conformer 1:  12%|\u2588\u258b            | 12/100 [00:00&lt;00:01, 51.72it/s]\n\nRunning MD for conformer 1:  18%|\u2588\u2588\u258c           | 18/100 [00:00&lt;00:01, 51.03it/s]\n\nRunning MD for conformer 1:  24%|\u2588\u2588\u2588\u258e          | 24/100 [00:00&lt;00:01, 49.03it/s]\n\nRunning MD for conformer 1:  29%|\u2588\u2588\u2588\u2588          | 29/100 [00:00&lt;00:01, 48.37it/s]\n\nRunning MD for conformer 1:  34%|\u2588\u2588\u2588\u2588\u258a         | 34/100 [00:00&lt;00:01, 48.64it/s]\n\nRunning MD for conformer 1:  39%|\u2588\u2588\u2588\u2588\u2588\u258d        | 39/100 [00:00&lt;00:01, 49.05it/s]\n\nRunning MD for conformer 1:  45%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e       | 45/100 [00:00&lt;00:01, 49.53it/s]\n\nRunning MD for conformer 1:  50%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588       | 50/100 [00:01&lt;00:01, 49.21it/s]\n\nRunning MD for conformer 1:  56%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a      | 56/100 [00:01&lt;00:00, 49.88it/s]\n\nRunning MD for conformer 1:  62%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b     | 62/100 [00:01&lt;00:00, 50.32it/s]\n\nRunning MD for conformer 1:  68%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c    | 68/100 [00:01&lt;00:00, 50.64it/s]\n\nRunning MD for conformer 1:  74%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e   | 74/100 [00:01&lt;00:00, 50.41it/s]\n\nRunning MD for conformer 1:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 80/100 [00:01&lt;00:00, 50.53it/s]\n\nRunning MD for conformer 1:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 86/100 [00:01&lt;00:00, 50.07it/s]\n\nRunning MD for conformer 1:  92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589 | 92/100 [00:01&lt;00:00, 49.01it/s]\n\nRunning MD for conformer 1:  97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 97/100 [00:01&lt;00:00, 49.24it/s]\n\n                                                                                \nGenerating Snapshots:  10%|\u2588\u2588\u258f                   | 1/10 [00:02&lt;00:18,  2.07s/it]\n\nRunning MD for conformer 2:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 2:   5%|\u258a              | 5/100 [00:00&lt;00:01, 49.14it/s]\n\nRunning MD for conformer 2:  10%|\u2588\u258d            | 10/100 [00:00&lt;00:01, 47.39it/s]\n\nRunning MD for conformer 2:  16%|\u2588\u2588\u258f           | 16/100 [00:00&lt;00:01, 48.35it/s]\n\nRunning MD for conformer 2:  21%|\u2588\u2588\u2589           | 21/100 [00:00&lt;00:01, 48.61it/s]\n\nRunning MD for conformer 2:  26%|\u2588\u2588\u2588\u258b          | 26/100 [00:00&lt;00:01, 48.67it/s]\n\nRunning MD for conformer 2:  31%|\u2588\u2588\u2588\u2588\u258e         | 31/100 [00:00&lt;00:01, 48.88it/s]\n\nRunning MD for conformer 2:  36%|\u2588\u2588\u2588\u2588\u2588         | 36/100 [00:00&lt;00:01, 49.18it/s]\n\nRunning MD for conformer 2:  41%|\u2588\u2588\u2588\u2588\u2588\u258b        | 41/100 [00:00&lt;00:01, 49.40it/s]\n\nRunning MD for conformer 2:  47%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c       | 47/100 [00:00&lt;00:01, 49.62it/s]\n\nRunning MD for conformer 2:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e      | 52/100 [00:01&lt;00:00, 49.37it/s]\n\nRunning MD for conformer 2:  58%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588      | 58/100 [00:01&lt;00:00, 49.65it/s]\n\nRunning MD for conformer 2:  63%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a     | 63/100 [00:01&lt;00:00, 48.58it/s]\n\nRunning MD for conformer 2:  68%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c    | 68/100 [00:01&lt;00:00, 48.59it/s]\n\nRunning MD for conformer 2:  73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 73/100 [00:01&lt;00:00, 48.89it/s]\n\nRunning MD for conformer 2:  78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 78/100 [00:01&lt;00:00, 49.13it/s]\n\nRunning MD for conformer 2:  83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 83/100 [00:01&lt;00:00, 49.36it/s]\n\nRunning MD for conformer 2:  88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 88/100 [00:01&lt;00:00, 49.50it/s]\n\nRunning MD for conformer 2:  93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 | 93/100 [00:01&lt;00:00, 49.42it/s]\n\nRunning MD for conformer 2:  98%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b| 98/100 [00:01&lt;00:00, 48.98it/s]\n\n                                                                                \nGenerating Snapshots:  20%|\u2588\u2588\u2588\u2588\u258d                 | 2/10 [00:04&lt;00:16,  2.08s/it]\n\nRunning MD for conformer 3:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 3:   6%|\u2589              | 6/100 [00:00&lt;00:01, 50.18it/s]\n\nRunning MD for conformer 3:  12%|\u2588\u258b            | 12/100 [00:00&lt;00:01, 49.50it/s]\n\nRunning MD for conformer 3:  18%|\u2588\u2588\u258c           | 18/100 [00:00&lt;00:01, 50.22it/s]\n\nRunning MD for conformer 3:  24%|\u2588\u2588\u2588\u258e          | 24/100 [00:00&lt;00:01, 50.35it/s]\n\nRunning MD for conformer 3:  30%|\u2588\u2588\u2588\u2588\u258f         | 30/100 [00:00&lt;00:01, 49.66it/s]\n\nRunning MD for conformer 3:  36%|\u2588\u2588\u2588\u2588\u2588         | 36/100 [00:00&lt;00:01, 49.71it/s]\n\nRunning MD for conformer 3:  42%|\u2588\u2588\u2588\u2588\u2588\u2589        | 42/100 [00:00&lt;00:01, 49.82it/s]\n\nRunning MD for conformer 3:  47%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c       | 47/100 [00:00&lt;00:01, 48.94it/s]\n\nRunning MD for conformer 3:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e      | 52/100 [00:01&lt;00:00, 48.49it/s]\n\nRunning MD for conformer 3:  57%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589      | 57/100 [00:01&lt;00:00, 48.42it/s]\n\nRunning MD for conformer 3:  62%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b     | 62/100 [00:01&lt;00:00, 48.62it/s]\n\nRunning MD for conformer 3:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d    | 67/100 [00:01&lt;00:00, 48.92it/s]\n\nRunning MD for conformer 3:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588    | 72/100 [00:01&lt;00:00, 49.19it/s]\n\nRunning MD for conformer 3:  78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 78/100 [00:01&lt;00:00, 49.73it/s]\n\nRunning MD for conformer 3:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 84/100 [00:01&lt;00:00, 49.97it/s]\n\nRunning MD for conformer 3:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 89/100 [00:01&lt;00:00, 49.32it/s]\n\nRunning MD for conformer 3:  94%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 94/100 [00:01&lt;00:00, 49.35it/s]\n\nRunning MD for conformer 3: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 100/100 [00:02&lt;00:00, 49.80it/s]\n\n                                                                                \nGenerating Snapshots:  30%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c               | 3/10 [00:06&lt;00:14,  2.07s/it]\n\nRunning MD for conformer 4:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 4:   5%|\u258a              | 5/100 [00:00&lt;00:01, 49.50it/s]\n\nRunning MD for conformer 4:  11%|\u2588\u258c            | 11/100 [00:00&lt;00:01, 50.11it/s]\n\nRunning MD for conformer 4:  17%|\u2588\u2588\u258d           | 17/100 [00:00&lt;00:01, 49.53it/s]\n\nRunning MD for conformer 4:  22%|\u2588\u2588\u2588           | 22/100 [00:00&lt;00:01, 48.50it/s]\n\nRunning MD for conformer 4:  28%|\u2588\u2588\u2588\u2589          | 28/100 [00:00&lt;00:01, 49.69it/s]\n\nRunning MD for conformer 4:  33%|\u2588\u2588\u2588\u2588\u258c         | 33/100 [00:00&lt;00:01, 49.76it/s]\n\nRunning MD for conformer 4:  38%|\u2588\u2588\u2588\u2588\u2588\u258e        | 38/100 [00:00&lt;00:01, 49.22it/s]\n\nRunning MD for conformer 4:  43%|\u2588\u2588\u2588\u2588\u2588\u2588        | 43/100 [00:00&lt;00:01, 48.82it/s]\n\nRunning MD for conformer 4:  48%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b       | 48/100 [00:00&lt;00:01, 48.98it/s]\n\nRunning MD for conformer 4:  53%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d      | 53/100 [00:01&lt;00:00, 47.74it/s]\n\nRunning MD for conformer 4:  58%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588      | 58/100 [00:01&lt;00:00, 46.97it/s]\n\nRunning MD for conformer 4:  64%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589     | 64/100 [00:01&lt;00:00, 48.20it/s]\n\nRunning MD for conformer 4:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a    | 70/100 [00:01&lt;00:00, 49.32it/s]\n\nRunning MD for conformer 4:  76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b   | 76/100 [00:01&lt;00:00, 49.41it/s]\n\nRunning MD for conformer 4:  81%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e  | 81/100 [00:01&lt;00:00, 48.75it/s]\n\nRunning MD for conformer 4:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 86/100 [00:01&lt;00:00, 48.10it/s]\n\nRunning MD for conformer 4:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 91/100 [00:01&lt;00:00, 48.53it/s]\n\nRunning MD for conformer 4:  96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 96/100 [00:01&lt;00:00, 48.12it/s]\n\n                                                                                \nGenerating Snapshots:  40%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a             | 4/10 [00:08&lt;00:12,  2.09s/it]\n\nRunning MD for conformer 5:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 5:   6%|\u2589              | 6/100 [00:00&lt;00:01, 51.26it/s]\n\nRunning MD for conformer 5:  12%|\u2588\u258b            | 12/100 [00:00&lt;00:01, 50.57it/s]\n\nRunning MD for conformer 5:  18%|\u2588\u2588\u258c           | 18/100 [00:00&lt;00:01, 49.53it/s]\n\nRunning MD for conformer 5:  23%|\u2588\u2588\u2588\u258f          | 23/100 [00:00&lt;00:01, 49.60it/s]\n\nRunning MD for conformer 5:  28%|\u2588\u2588\u2588\u2589          | 28/100 [00:00&lt;00:01, 48.43it/s]\n\nRunning MD for conformer 5:  33%|\u2588\u2588\u2588\u2588\u258c         | 33/100 [00:00&lt;00:01, 48.30it/s]\n\nRunning MD for conformer 5:  38%|\u2588\u2588\u2588\u2588\u2588\u258e        | 38/100 [00:00&lt;00:01, 48.04it/s]\n\nRunning MD for conformer 5:  43%|\u2588\u2588\u2588\u2588\u2588\u2588        | 43/100 [00:00&lt;00:01, 48.04it/s]\n\nRunning MD for conformer 5:  48%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b       | 48/100 [00:00&lt;00:01, 48.14it/s]\n\nRunning MD for conformer 5:  54%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c      | 54/100 [00:01&lt;00:00, 48.95it/s]\n\nRunning MD for conformer 5:  60%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d     | 60/100 [00:01&lt;00:00, 49.71it/s]\n\nRunning MD for conformer 5:  65%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588     | 65/100 [00:01&lt;00:00, 49.74it/s]\n\nRunning MD for conformer 5:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a    | 70/100 [00:01&lt;00:00, 48.81it/s]\n\nRunning MD for conformer 5:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 75/100 [00:01&lt;00:00, 48.68it/s]\n\nRunning MD for conformer 5:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 80/100 [00:01&lt;00:00, 47.96it/s]\n\nRunning MD for conformer 5:  85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 85/100 [00:01&lt;00:00, 47.41it/s]\n\nRunning MD for conformer 5:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 90/100 [00:01&lt;00:00, 47.24it/s]\n\nRunning MD for conformer 5:  96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 96/100 [00:01&lt;00:00, 48.10it/s]\n\n                                                                                \nGenerating Snapshots:  50%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588           | 5/10 [00:10&lt;00:10,  2.09s/it]\n\nRunning MD for conformer 6:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 6:   6%|\u2589              | 6/100 [00:00&lt;00:01, 51.69it/s]\n\nRunning MD for conformer 6:  12%|\u2588\u258b            | 12/100 [00:00&lt;00:01, 51.15it/s]\n\nRunning MD for conformer 6:  18%|\u2588\u2588\u258c           | 18/100 [00:00&lt;00:01, 49.49it/s]\n\nRunning MD for conformer 6:  24%|\u2588\u2588\u2588\u258e          | 24/100 [00:00&lt;00:01, 49.21it/s]\n\nRunning MD for conformer 6:  29%|\u2588\u2588\u2588\u2588          | 29/100 [00:00&lt;00:01, 48.22it/s]\n\nRunning MD for conformer 6:  34%|\u2588\u2588\u2588\u2588\u258a         | 34/100 [00:00&lt;00:01, 48.37it/s]\n\nRunning MD for conformer 6:  40%|\u2588\u2588\u2588\u2588\u2588\u258c        | 40/100 [00:00&lt;00:01, 49.20it/s]\n\nRunning MD for conformer 6:  46%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d       | 46/100 [00:00&lt;00:01, 49.69it/s]\n\nRunning MD for conformer 6:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e      | 52/100 [00:01&lt;00:00, 50.14it/s]\n\nRunning MD for conformer 6:  58%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588      | 58/100 [00:01&lt;00:00, 49.53it/s]\n\nRunning MD for conformer 6:  63%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a     | 63/100 [00:01&lt;00:00, 49.15it/s]\n\nRunning MD for conformer 6:  68%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c    | 68/100 [00:01&lt;00:00, 48.62it/s]\n\nRunning MD for conformer 6:  73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 73/100 [00:01&lt;00:00, 48.50it/s]\n\nRunning MD for conformer 6:  78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 78/100 [00:01&lt;00:00, 48.54it/s]\n\nRunning MD for conformer 6:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 84/100 [00:01&lt;00:00, 49.29it/s]\n\nRunning MD for conformer 6:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 89/100 [00:01&lt;00:00, 48.75it/s]\n\nRunning MD for conformer 6:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e| 95/100 [00:01&lt;00:00, 49.28it/s]\n\n                                                                                \nGenerating Snapshots:  60%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f        | 6/10 [00:12&lt;00:08,  2.09s/it]\n\nRunning MD for conformer 7:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 7:   6%|\u2589              | 6/100 [00:00&lt;00:01, 51.03it/s]\n\nRunning MD for conformer 7:  12%|\u2588\u258b            | 12/100 [00:00&lt;00:01, 49.60it/s]\n\nRunning MD for conformer 7:  18%|\u2588\u2588\u258c           | 18/100 [00:00&lt;00:01, 50.15it/s]\n\nRunning MD for conformer 7:  24%|\u2588\u2588\u2588\u258e          | 24/100 [00:00&lt;00:01, 49.38it/s]\n\nRunning MD for conformer 7:  29%|\u2588\u2588\u2588\u2588          | 29/100 [00:00&lt;00:01, 49.05it/s]\n\nRunning MD for conformer 7:  34%|\u2588\u2588\u2588\u2588\u258a         | 34/100 [00:00&lt;00:01, 49.28it/s]\n\nRunning MD for conformer 7:  40%|\u2588\u2588\u2588\u2588\u2588\u258c        | 40/100 [00:00&lt;00:01, 49.94it/s]\n\nRunning MD for conformer 7:  45%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e       | 45/100 [00:00&lt;00:01, 49.08it/s]\n\nRunning MD for conformer 7:  50%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588       | 50/100 [00:01&lt;00:01, 49.22it/s]\n\nRunning MD for conformer 7:  55%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b      | 55/100 [00:01&lt;00:00, 48.93it/s]\n\nRunning MD for conformer 7:  61%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c     | 61/100 [00:01&lt;00:00, 49.76it/s]\n\nRunning MD for conformer 7:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d    | 67/100 [00:01&lt;00:00, 50.19it/s]\n\nRunning MD for conformer 7:  73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 73/100 [00:01&lt;00:00, 50.24it/s]\n\nRunning MD for conformer 7:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588   | 79/100 [00:01&lt;00:00, 49.98it/s]\n\nRunning MD for conformer 7:  85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 85/100 [00:01&lt;00:00, 50.50it/s]\n\nRunning MD for conformer 7:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 91/100 [00:01&lt;00:00, 50.82it/s]\n\nRunning MD for conformer 7:  97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 97/100 [00:01&lt;00:00, 49.32it/s]\n\n                                                                                \nGenerating Snapshots:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d      | 7/10 [00:14&lt;00:06,  2.08s/it]\n\nRunning MD for conformer 8:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 8:   5%|\u258a              | 5/100 [00:00&lt;00:01, 47.85it/s]\n\nRunning MD for conformer 8:  10%|\u2588\u258d            | 10/100 [00:00&lt;00:01, 47.92it/s]\n\nRunning MD for conformer 8:  16%|\u2588\u2588\u258f           | 16/100 [00:00&lt;00:01, 49.49it/s]\n\nRunning MD for conformer 8:  22%|\u2588\u2588\u2588           | 22/100 [00:00&lt;00:01, 50.02it/s]\n\nRunning MD for conformer 8:  28%|\u2588\u2588\u2588\u2589          | 28/100 [00:00&lt;00:01, 50.05it/s]\n\nRunning MD for conformer 8:  34%|\u2588\u2588\u2588\u2588\u258a         | 34/100 [00:00&lt;00:01, 49.20it/s]\n\nRunning MD for conformer 8:  40%|\u2588\u2588\u2588\u2588\u2588\u258c        | 40/100 [00:00&lt;00:01, 49.70it/s]\n\nRunning MD for conformer 8:  45%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e       | 45/100 [00:00&lt;00:01, 48.88it/s]\n\nRunning MD for conformer 8:  51%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f      | 51/100 [00:01&lt;00:00, 49.04it/s]\n\nRunning MD for conformer 8:  56%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a      | 56/100 [00:01&lt;00:00, 48.61it/s]\n\nRunning MD for conformer 8:  62%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b     | 62/100 [00:01&lt;00:00, 49.28it/s]\n\nRunning MD for conformer 8:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d    | 67/100 [00:01&lt;00:00, 48.99it/s]\n\nRunning MD for conformer 8:  73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 73/100 [00:01&lt;00:00, 49.58it/s]\n\nRunning MD for conformer 8:  78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 78/100 [00:01&lt;00:00, 49.34it/s]\n\nRunning MD for conformer 8:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 84/100 [00:01&lt;00:00, 49.94it/s]\n\nRunning MD for conformer 8:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 90/100 [00:01&lt;00:00, 50.13it/s]\n\nRunning MD for conformer 8:  96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 96/100 [00:01&lt;00:00, 48.88it/s]\n\n                                                                                \nGenerating Snapshots:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c    | 8/10 [00:16&lt;00:04,  2.08s/it]\n\nRunning MD for conformer 9:   0%|                       | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 9:   5%|\u258a              | 5/100 [00:00&lt;00:02, 44.80it/s]\n\nRunning MD for conformer 9:  10%|\u2588\u258d            | 10/100 [00:00&lt;00:01, 46.12it/s]\n\nRunning MD for conformer 9:  15%|\u2588\u2588            | 15/100 [00:00&lt;00:01, 45.35it/s]\n\nRunning MD for conformer 9:  21%|\u2588\u2588\u2589           | 21/100 [00:00&lt;00:01, 46.98it/s]\n\nRunning MD for conformer 9:  26%|\u2588\u2588\u2588\u258b          | 26/100 [00:00&lt;00:01, 47.08it/s]\n\nRunning MD for conformer 9:  31%|\u2588\u2588\u2588\u2588\u258e         | 31/100 [00:00&lt;00:01, 47.53it/s]\n\nRunning MD for conformer 9:  37%|\u2588\u2588\u2588\u2588\u2588\u258f        | 37/100 [00:00&lt;00:01, 48.92it/s]\n\nRunning MD for conformer 9:  43%|\u2588\u2588\u2588\u2588\u2588\u2588        | 43/100 [00:00&lt;00:01, 49.12it/s]\n\nRunning MD for conformer 9:  48%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b       | 48/100 [00:01&lt;00:01, 49.14it/s]\n\nRunning MD for conformer 9:  53%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d      | 53/100 [00:01&lt;00:00, 48.95it/s]\n\nRunning MD for conformer 9:  59%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e     | 59/100 [00:01&lt;00:00, 49.70it/s]\n\nRunning MD for conformer 9:  65%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588     | 65/100 [00:01&lt;00:00, 50.16it/s]\n\nRunning MD for conformer 9:  71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589    | 71/100 [00:01&lt;00:00, 50.34it/s]\n\nRunning MD for conformer 9:  77%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a   | 77/100 [00:01&lt;00:00, 49.94it/s]\n\nRunning MD for conformer 9:  83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 83/100 [00:01&lt;00:00, 50.44it/s]\n\nRunning MD for conformer 9:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 89/100 [00:01&lt;00:00, 50.44it/s]\n\nRunning MD for conformer 9:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e| 95/100 [00:01&lt;00:00, 49.44it/s]\n\n                                                                                \nGenerating Snapshots:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 9/10 [00:18&lt;00:02,  2.08s/it]\n\nRunning MD for conformer 10:   0%|                      | 0/100 [00:00&lt;?, ?it/s]\n\nRunning MD for conformer 10:   5%|\u258b             | 5/100 [00:00&lt;00:01, 49.07it/s]\n\nRunning MD for conformer 10:  10%|\u2588\u258e           | 10/100 [00:00&lt;00:01, 47.54it/s]\n\nRunning MD for conformer 10:  15%|\u2588\u2589           | 15/100 [00:00&lt;00:01, 47.66it/s]\n\nRunning MD for conformer 10:  21%|\u2588\u2588\u258b          | 21/100 [00:00&lt;00:01, 48.55it/s]\n\nRunning MD for conformer 10:  26%|\u2588\u2588\u2588\u258d         | 26/100 [00:00&lt;00:01, 48.88it/s]\n\nRunning MD for conformer 10:  31%|\u2588\u2588\u2588\u2588         | 31/100 [00:00&lt;00:01, 48.24it/s]\n\nRunning MD for conformer 10:  37%|\u2588\u2588\u2588\u2588\u258a        | 37/100 [00:00&lt;00:01, 48.91it/s]\n\nRunning MD for conformer 10:  43%|\u2588\u2588\u2588\u2588\u2588\u258c       | 43/100 [00:00&lt;00:01, 49.48it/s]\n\nRunning MD for conformer 10:  48%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f      | 48/100 [00:00&lt;00:01, 49.29it/s]\n\nRunning MD for conformer 10:  53%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589      | 53/100 [00:01&lt;00:00, 49.02it/s]\n\nRunning MD for conformer 10:  58%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c     | 58/100 [00:01&lt;00:00, 48.42it/s]\n\nRunning MD for conformer 10:  63%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f    | 63/100 [00:01&lt;00:00, 48.07it/s]\n\nRunning MD for conformer 10:  69%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589    | 69/100 [00:01&lt;00:00, 49.10it/s]\n\nRunning MD for conformer 10:  74%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 74/100 [00:01&lt;00:00, 48.28it/s]\n\nRunning MD for conformer 10:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e  | 79/100 [00:01&lt;00:00, 47.60it/s]\n\nRunning MD for conformer 10:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 84/100 [00:01&lt;00:00, 47.69it/s]\n\nRunning MD for conformer 10:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 90/100 [00:01&lt;00:00, 48.82it/s]\n\nRunning MD for conformer 10:  96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 96/100 [00:01&lt;00:00, 49.16it/s]\n\n                                                                                \nGenerating Snapshots: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 10/10 [00:20&lt;00:00,  2.09s/it]\n                                                                                \nRecalculating energies and forces:   0%|               | 0/1000 [00:00&lt;?, ?it/s]\nRecalculating energies and forces:   0%|       | 2/1000 [00:00&lt;02:48,  5.92it/s]\nRecalculating energies and forces:   0%|       | 3/1000 [00:00&lt;05:53,  2.82it/s]\nRecalculating energies and forces:   0%|       | 4/1000 [00:01&lt;07:50,  2.12it/s]\nRecalculating energies and forces:   0%|       | 5/1000 [00:02&lt;08:01,  2.07it/s]\nRecalculating energies and forces:   1%|       | 9/1000 [00:02&lt;02:57,  5.58it/s]\nRecalculating energies and forces:   1%|      | 14/1000 [00:02&lt;01:34, 10.45it/s]\nRecalculating energies and forces:   2%|      | 18/1000 [00:02&lt;01:08, 14.41it/s]\nRecalculating energies and forces:   2%|\u258f     | 22/1000 [00:02&lt;00:52, 18.61it/s]\nRecalculating energies and forces:   3%|\u258f     | 27/1000 [00:02&lt;00:41, 23.52it/s]\nRecalculating energies and forces:   3%|\u258f     | 32/1000 [00:02&lt;00:35, 27.59it/s]\nRecalculating energies and forces:   4%|\u258f     | 36/1000 [00:02&lt;00:32, 29.91it/s]\nRecalculating energies and forces:   4%|\u258f     | 41/1000 [00:03&lt;00:29, 32.61it/s]\nRecalculating energies and forces:   4%|\u258e     | 45/1000 [00:03&lt;00:27, 34.29it/s]\nRecalculating energies and forces:   5%|\u258e     | 50/1000 [00:03&lt;00:26, 36.25it/s]\nRecalculating energies and forces:   5%|\u258e     | 54/1000 [00:03&lt;00:25, 37.18it/s]\nRecalculating energies and forces:   6%|\u258e     | 59/1000 [00:03&lt;00:24, 38.27it/s]\nRecalculating energies and forces:   6%|\u258d     | 64/1000 [00:03&lt;00:23, 39.77it/s]\nRecalculating energies and forces:   7%|\u258d     | 69/1000 [00:03&lt;00:22, 40.96it/s]\nRecalculating energies and forces:   7%|\u258d     | 74/1000 [00:03&lt;00:22, 41.76it/s]\nRecalculating energies and forces:   8%|\u258d     | 79/1000 [00:03&lt;00:21, 42.37it/s]\nRecalculating energies and forces:   8%|\u258c     | 84/1000 [00:04&lt;00:21, 42.89it/s]\nRecalculating energies and forces:   9%|\u258c     | 89/1000 [00:04&lt;00:21, 43.19it/s]\nRecalculating energies and forces:   9%|\u258c     | 94/1000 [00:04&lt;00:20, 43.45it/s]\nRecalculating energies and forces:  10%|\u258c     | 99/1000 [00:04&lt;00:20, 43.58it/s]\nRecalculating energies and forces:  10%|\u258c    | 104/1000 [00:04&lt;00:21, 42.39it/s]\nRecalculating energies and forces:  11%|\u258c    | 109/1000 [00:04&lt;00:21, 41.16it/s]\nRecalculating energies and forces:  11%|\u258c    | 114/1000 [00:04&lt;00:21, 41.53it/s]\nRecalculating energies and forces:  12%|\u258c    | 119/1000 [00:04&lt;00:20, 42.07it/s]\nRecalculating energies and forces:  12%|\u258c    | 124/1000 [00:05&lt;00:20, 42.57it/s]\nRecalculating energies and forces:  13%|\u258b    | 129/1000 [00:05&lt;00:20, 43.02it/s]\nRecalculating energies and forces:  13%|\u258b    | 134/1000 [00:05&lt;00:19, 43.34it/s]\nRecalculating energies and forces:  14%|\u258b    | 139/1000 [00:05&lt;00:19, 43.40it/s]\nRecalculating energies and forces:  14%|\u258b    | 144/1000 [00:05&lt;00:19, 43.58it/s]\nRecalculating energies and forces:  15%|\u258b    | 149/1000 [00:05&lt;00:19, 43.75it/s]\nRecalculating energies and forces:  15%|\u258a    | 154/1000 [00:05&lt;00:19, 43.80it/s]\nRecalculating energies and forces:  16%|\u258a    | 159/1000 [00:05&lt;00:19, 43.66it/s]\nRecalculating energies and forces:  16%|\u258a    | 164/1000 [00:05&lt;00:19, 43.61it/s]\nRecalculating energies and forces:  17%|\u258a    | 169/1000 [00:06&lt;00:19, 43.46it/s]\nRecalculating energies and forces:  17%|\u258a    | 174/1000 [00:06&lt;00:19, 43.45it/s]\nRecalculating energies and forces:  18%|\u2589    | 179/1000 [00:06&lt;00:18, 43.40it/s]\nRecalculating energies and forces:  18%|\u2589    | 184/1000 [00:06&lt;00:18, 43.50it/s]\nRecalculating energies and forces:  19%|\u2589    | 189/1000 [00:06&lt;00:18, 43.39it/s]\nRecalculating energies and forces:  19%|\u2589    | 194/1000 [00:06&lt;00:18, 43.52it/s]\nRecalculating energies and forces:  20%|\u2589    | 199/1000 [00:06&lt;00:18, 43.63it/s]\nRecalculating energies and forces:  20%|\u2588    | 204/1000 [00:06&lt;00:18, 43.64it/s]\nRecalculating energies and forces:  21%|\u2588    | 209/1000 [00:06&lt;00:18, 43.74it/s]\nRecalculating energies and forces:  21%|\u2588    | 214/1000 [00:07&lt;00:17, 43.71it/s]\nRecalculating energies and forces:  22%|\u2588    | 219/1000 [00:07&lt;00:17, 43.41it/s]\nRecalculating energies and forces:  22%|\u2588    | 224/1000 [00:07&lt;00:17, 43.50it/s]\nRecalculating energies and forces:  23%|\u2588\u258f   | 229/1000 [00:07&lt;00:17, 43.59it/s]\nRecalculating energies and forces:  23%|\u2588\u258f   | 234/1000 [00:07&lt;00:17, 43.65it/s]\nRecalculating energies and forces:  24%|\u2588\u258f   | 239/1000 [00:07&lt;00:17, 43.62it/s]\nRecalculating energies and forces:  24%|\u2588\u258f   | 244/1000 [00:07&lt;00:17, 43.50it/s]\nRecalculating energies and forces:  25%|\u2588\u258f   | 249/1000 [00:07&lt;00:17, 43.45it/s]\nRecalculating energies and forces:  25%|\u2588\u258e   | 254/1000 [00:07&lt;00:17, 43.53it/s]\nRecalculating energies and forces:  26%|\u2588\u258e   | 259/1000 [00:08&lt;00:16, 43.60it/s]\nRecalculating energies and forces:  26%|\u2588\u258e   | 264/1000 [00:08&lt;00:16, 43.48it/s]\nRecalculating energies and forces:  27%|\u2588\u258e   | 269/1000 [00:08&lt;00:16, 43.55it/s]\nRecalculating energies and forces:  27%|\u2588\u258e   | 274/1000 [00:08&lt;00:16, 43.49it/s]\nRecalculating energies and forces:  28%|\u2588\u258d   | 279/1000 [00:08&lt;00:16, 43.47it/s]\nRecalculating energies and forces:  28%|\u2588\u258d   | 284/1000 [00:08&lt;00:16, 43.58it/s]\nRecalculating energies and forces:  29%|\u2588\u258d   | 289/1000 [00:08&lt;00:16, 43.62it/s]\nRecalculating energies and forces:  29%|\u2588\u258d   | 294/1000 [00:08&lt;00:16, 43.18it/s]\nRecalculating energies and forces:  30%|\u2588\u258d   | 299/1000 [00:09&lt;00:16, 43.09it/s]\nRecalculating energies and forces:  30%|\u2588\u258c   | 304/1000 [00:09&lt;00:16, 42.84it/s]\nRecalculating energies and forces:  31%|\u2588\u258c   | 309/1000 [00:09&lt;00:16, 42.88it/s]\nRecalculating energies and forces:  31%|\u2588\u258c   | 314/1000 [00:09&lt;00:16, 42.84it/s]\nRecalculating energies and forces:  32%|\u2588\u258c   | 319/1000 [00:09&lt;00:15, 42.98it/s]\nRecalculating energies and forces:  32%|\u2588\u258c   | 324/1000 [00:09&lt;00:15, 43.01it/s]\nRecalculating energies and forces:  33%|\u2588\u258b   | 329/1000 [00:09&lt;00:15, 42.91it/s]\nRecalculating energies and forces:  33%|\u2588\u258b   | 334/1000 [00:09&lt;00:15, 43.00it/s]\nRecalculating energies and forces:  34%|\u2588\u258b   | 339/1000 [00:09&lt;00:15, 43.19it/s]\nRecalculating energies and forces:  34%|\u2588\u258b   | 344/1000 [00:10&lt;00:15, 43.33it/s]\nRecalculating energies and forces:  35%|\u2588\u258b   | 349/1000 [00:10&lt;00:15, 43.30it/s]\nRecalculating energies and forces:  35%|\u2588\u258a   | 354/1000 [00:10&lt;00:14, 43.27it/s]\nRecalculating energies and forces:  36%|\u2588\u258a   | 359/1000 [00:10&lt;00:14, 43.29it/s]\nRecalculating energies and forces:  36%|\u2588\u258a   | 364/1000 [00:10&lt;00:14, 43.31it/s]\nRecalculating energies and forces:  37%|\u2588\u258a   | 369/1000 [00:10&lt;00:14, 43.35it/s]\nRecalculating energies and forces:  37%|\u2588\u258a   | 374/1000 [00:10&lt;00:14, 43.43it/s]\nRecalculating energies and forces:  38%|\u2588\u2589   | 379/1000 [00:10&lt;00:14, 43.09it/s]\nRecalculating energies and forces:  38%|\u2588\u2589   | 384/1000 [00:10&lt;00:14, 43.07it/s]\nRecalculating energies and forces:  39%|\u2588\u2589   | 389/1000 [00:11&lt;00:14, 43.15it/s]\nRecalculating energies and forces:  39%|\u2588\u2589   | 394/1000 [00:11&lt;00:14, 43.23it/s]\nRecalculating energies and forces:  40%|\u2588\u2589   | 399/1000 [00:11&lt;00:13, 43.47it/s]\nRecalculating energies and forces:  40%|\u2588\u2588   | 404/1000 [00:11&lt;00:13, 43.61it/s]\nRecalculating energies and forces:  41%|\u2588\u2588   | 409/1000 [00:11&lt;00:13, 43.52it/s]\nRecalculating energies and forces:  41%|\u2588\u2588   | 414/1000 [00:11&lt;00:13, 43.26it/s]\nRecalculating energies and forces:  42%|\u2588\u2588   | 419/1000 [00:11&lt;00:13, 42.78it/s]\nRecalculating energies and forces:  42%|\u2588\u2588   | 424/1000 [00:11&lt;00:13, 42.41it/s]\nRecalculating energies and forces:  43%|\u2588\u2588\u258f  | 429/1000 [00:12&lt;00:13, 41.51it/s]\nRecalculating energies and forces:  43%|\u2588\u2588\u258f  | 434/1000 [00:12&lt;00:13, 41.35it/s]\nRecalculating energies and forces:  44%|\u2588\u2588\u258f  | 439/1000 [00:12&lt;00:13, 41.23it/s]\nRecalculating energies and forces:  44%|\u2588\u2588\u258f  | 444/1000 [00:12&lt;00:13, 41.29it/s]\nRecalculating energies and forces:  45%|\u2588\u2588\u258f  | 449/1000 [00:12&lt;00:13, 41.31it/s]\nRecalculating energies and forces:  45%|\u2588\u2588\u258e  | 454/1000 [00:12&lt;00:13, 41.23it/s]\nRecalculating energies and forces:  46%|\u2588\u2588\u258e  | 459/1000 [00:12&lt;00:13, 41.17it/s]\nRecalculating energies and forces:  46%|\u2588\u2588\u258e  | 464/1000 [00:12&lt;00:13, 40.85it/s]\nRecalculating energies and forces:  47%|\u2588\u2588\u258e  | 469/1000 [00:13&lt;00:13, 40.80it/s]\nRecalculating energies and forces:  47%|\u2588\u2588\u258e  | 474/1000 [00:13&lt;00:12, 41.09it/s]\nRecalculating energies and forces:  48%|\u2588\u2588\u258d  | 479/1000 [00:13&lt;00:12, 41.51it/s]\nRecalculating energies and forces:  48%|\u2588\u2588\u258d  | 484/1000 [00:13&lt;00:12, 41.66it/s]\nRecalculating energies and forces:  49%|\u2588\u2588\u258d  | 489/1000 [00:13&lt;00:12, 41.53it/s]\nRecalculating energies and forces:  49%|\u2588\u2588\u258d  | 494/1000 [00:13&lt;00:12, 40.77it/s]\nRecalculating energies and forces:  50%|\u2588\u2588\u258d  | 499/1000 [00:13&lt;00:12, 40.83it/s]\nRecalculating energies and forces:  50%|\u2588\u2588\u258c  | 504/1000 [00:13&lt;00:11, 41.43it/s]\nRecalculating energies and forces:  51%|\u2588\u2588\u258c  | 509/1000 [00:13&lt;00:11, 41.81it/s]\nRecalculating energies and forces:  51%|\u2588\u2588\u258c  | 514/1000 [00:14&lt;00:11, 42.35it/s]\nRecalculating energies and forces:  52%|\u2588\u2588\u258c  | 519/1000 [00:14&lt;00:11, 42.51it/s]\nRecalculating energies and forces:  52%|\u2588\u2588\u258c  | 524/1000 [00:14&lt;00:11, 42.57it/s]\nRecalculating energies and forces:  53%|\u2588\u2588\u258b  | 529/1000 [00:14&lt;00:11, 42.54it/s]\nRecalculating energies and forces:  53%|\u2588\u2588\u258b  | 534/1000 [00:14&lt;00:10, 42.83it/s]\nRecalculating energies and forces:  54%|\u2588\u2588\u258b  | 539/1000 [00:14&lt;00:10, 43.10it/s]\nRecalculating energies and forces:  54%|\u2588\u2588\u258b  | 544/1000 [00:14&lt;00:10, 43.28it/s]\nRecalculating energies and forces:  55%|\u2588\u2588\u258b  | 549/1000 [00:14&lt;00:10, 43.45it/s]\nRecalculating energies and forces:  55%|\u2588\u2588\u258a  | 554/1000 [00:15&lt;00:10, 43.58it/s]\nRecalculating energies and forces:  56%|\u2588\u2588\u258a  | 559/1000 [00:15&lt;00:10, 43.56it/s]\nRecalculating energies and forces:  56%|\u2588\u2588\u258a  | 564/1000 [00:15&lt;00:10, 43.54it/s]\nRecalculating energies and forces:  57%|\u2588\u2588\u258a  | 569/1000 [00:15&lt;00:09, 43.62it/s]\nRecalculating energies and forces:  57%|\u2588\u2588\u258a  | 574/1000 [00:15&lt;00:09, 43.65it/s]\nRecalculating energies and forces:  58%|\u2588\u2588\u2589  | 579/1000 [00:15&lt;00:09, 43.60it/s]\nRecalculating energies and forces:  58%|\u2588\u2588\u2589  | 584/1000 [00:15&lt;00:09, 43.45it/s]\nRecalculating energies and forces:  59%|\u2588\u2588\u2589  | 589/1000 [00:15&lt;00:09, 43.42it/s]\nRecalculating energies and forces:  59%|\u2588\u2588\u2589  | 594/1000 [00:15&lt;00:09, 43.43it/s]\nRecalculating energies and forces:  60%|\u2588\u2588\u2589  | 599/1000 [00:16&lt;00:09, 43.48it/s]\nRecalculating energies and forces:  60%|\u2588\u2588\u2588  | 604/1000 [00:16&lt;00:09, 43.19it/s]\nRecalculating energies and forces:  61%|\u2588\u2588\u2588  | 609/1000 [00:16&lt;00:09, 42.84it/s]\nRecalculating energies and forces:  61%|\u2588\u2588\u2588  | 614/1000 [00:16&lt;00:09, 42.83it/s]\nRecalculating energies and forces:  62%|\u2588\u2588\u2588  | 619/1000 [00:16&lt;00:08, 42.86it/s]\nRecalculating energies and forces:  62%|\u2588\u2588\u2588  | 624/1000 [00:16&lt;00:08, 42.72it/s]\nRecalculating energies and forces:  63%|\u2588\u2588\u2588\u258f | 629/1000 [00:16&lt;00:08, 42.57it/s]\nRecalculating energies and forces:  63%|\u2588\u2588\u2588\u258f | 634/1000 [00:16&lt;00:08, 41.70it/s]\nRecalculating energies and forces:  64%|\u2588\u2588\u2588\u258f | 639/1000 [00:17&lt;00:09, 40.08it/s]\nRecalculating energies and forces:  64%|\u2588\u2588\u2588\u258f | 644/1000 [00:17&lt;00:09, 39.13it/s]\nRecalculating energies and forces:  65%|\u2588\u2588\u2588\u258f | 649/1000 [00:17&lt;00:08, 40.18it/s]\nRecalculating energies and forces:  65%|\u2588\u2588\u2588\u258e | 654/1000 [00:17&lt;00:08, 39.11it/s]\nRecalculating energies and forces:  66%|\u2588\u2588\u2588\u258e | 658/1000 [00:17&lt;00:08, 38.39it/s]\nRecalculating energies and forces:  66%|\u2588\u2588\u2588\u258e | 662/1000 [00:17&lt;00:08, 38.16it/s]\nRecalculating energies and forces:  67%|\u2588\u2588\u2588\u258e | 666/1000 [00:17&lt;00:08, 37.75it/s]\nRecalculating energies and forces:  67%|\u2588\u2588\u2588\u258e | 670/1000 [00:17&lt;00:08, 37.29it/s]\nRecalculating energies and forces:  67%|\u2588\u2588\u2588\u258e | 674/1000 [00:17&lt;00:08, 37.07it/s]\nRecalculating energies and forces:  68%|\u2588\u2588\u2588\u258d | 678/1000 [00:18&lt;00:08, 37.32it/s]\nRecalculating energies and forces:  68%|\u2588\u2588\u2588\u258d | 682/1000 [00:18&lt;00:08, 36.92it/s]\nRecalculating energies and forces:  69%|\u2588\u2588\u2588\u258d | 686/1000 [00:18&lt;00:08, 36.86it/s]\nRecalculating energies and forces:  69%|\u2588\u2588\u2588\u258d | 690/1000 [00:18&lt;00:08, 36.71it/s]\nRecalculating energies and forces:  69%|\u2588\u2588\u2588\u258d | 694/1000 [00:18&lt;00:08, 36.13it/s]\nRecalculating energies and forces:  70%|\u2588\u2588\u2588\u258d | 698/1000 [00:18&lt;00:08, 36.07it/s]\nRecalculating energies and forces:  70%|\u2588\u2588\u2588\u258c | 702/1000 [00:18&lt;00:08, 36.41it/s]\nRecalculating energies and forces:  71%|\u2588\u2588\u2588\u258c | 706/1000 [00:18&lt;00:08, 36.50it/s]\nRecalculating energies and forces:  71%|\u2588\u2588\u2588\u258c | 710/1000 [00:18&lt;00:07, 36.75it/s]\nRecalculating energies and forces:  71%|\u2588\u2588\u2588\u258c | 714/1000 [00:19&lt;00:07, 36.52it/s]\nRecalculating energies and forces:  72%|\u2588\u2588\u2588\u258c | 718/1000 [00:19&lt;00:07, 36.33it/s]\nRecalculating energies and forces:  72%|\u2588\u2588\u2588\u258c | 722/1000 [00:19&lt;00:07, 36.27it/s]\nRecalculating energies and forces:  73%|\u2588\u2588\u2588\u258b | 726/1000 [00:19&lt;00:07, 36.01it/s]\nRecalculating energies and forces:  73%|\u2588\u2588\u2588\u258b | 730/1000 [00:19&lt;00:07, 35.23it/s]\nRecalculating energies and forces:  73%|\u2588\u2588\u2588\u258b | 734/1000 [00:19&lt;00:07, 34.41it/s]\nRecalculating energies and forces:  74%|\u2588\u2588\u2588\u258b | 738/1000 [00:19&lt;00:07, 33.85it/s]\nRecalculating energies and forces:  74%|\u2588\u2588\u2588\u258b | 742/1000 [00:19&lt;00:07, 34.06it/s]\nRecalculating energies and forces:  75%|\u2588\u2588\u2588\u258b | 746/1000 [00:19&lt;00:07, 34.15it/s]\nRecalculating energies and forces:  75%|\u2588\u2588\u2588\u258a | 750/1000 [00:20&lt;00:07, 33.89it/s]\nRecalculating energies and forces:  75%|\u2588\u2588\u2588\u258a | 754/1000 [00:20&lt;00:07, 33.94it/s]\nRecalculating energies and forces:  76%|\u2588\u2588\u2588\u258a | 758/1000 [00:20&lt;00:07, 34.42it/s]\nRecalculating energies and forces:  76%|\u2588\u2588\u2588\u258a | 762/1000 [00:20&lt;00:06, 34.23it/s]\nRecalculating energies and forces:  77%|\u2588\u2588\u2588\u258a | 766/1000 [00:20&lt;00:06, 34.27it/s]\nRecalculating energies and forces:  77%|\u2588\u2588\u2588\u258a | 770/1000 [00:20&lt;00:06, 34.92it/s]\nRecalculating energies and forces:  77%|\u2588\u2588\u2588\u258a | 774/1000 [00:20&lt;00:06, 35.83it/s]\nRecalculating energies and forces:  78%|\u2588\u2588\u2588\u2589 | 778/1000 [00:20&lt;00:06, 35.88it/s]\nRecalculating energies and forces:  78%|\u2588\u2588\u2588\u2589 | 782/1000 [00:21&lt;00:06, 36.14it/s]\nRecalculating energies and forces:  79%|\u2588\u2588\u2588\u2589 | 786/1000 [00:21&lt;00:05, 36.11it/s]\nRecalculating energies and forces:  79%|\u2588\u2588\u2588\u2589 | 790/1000 [00:21&lt;00:05, 36.15it/s]\nRecalculating energies and forces:  79%|\u2588\u2588\u2588\u2589 | 794/1000 [00:21&lt;00:05, 36.22it/s]\nRecalculating energies and forces:  80%|\u2588\u2588\u2588\u2589 | 798/1000 [00:21&lt;00:05, 35.89it/s]\nRecalculating energies and forces:  80%|\u2588\u2588\u2588\u2588 | 802/1000 [00:21&lt;00:05, 36.70it/s]\nRecalculating energies and forces:  81%|\u2588\u2588\u2588\u2588 | 807/1000 [00:21&lt;00:04, 38.74it/s]\nRecalculating energies and forces:  81%|\u2588\u2588\u2588\u2588 | 812/1000 [00:21&lt;00:04, 40.03it/s]\nRecalculating energies and forces:  82%|\u2588\u2588\u2588\u2588 | 817/1000 [00:21&lt;00:04, 40.92it/s]\nRecalculating energies and forces:  82%|\u2588\u2588\u2588\u2588 | 822/1000 [00:22&lt;00:04, 40.25it/s]\nRecalculating energies and forces:  83%|\u2588\u2588\u2588\u2588\u258f| 827/1000 [00:22&lt;00:04, 39.15it/s]\nRecalculating energies and forces:  83%|\u2588\u2588\u2588\u2588\u258f| 831/1000 [00:22&lt;00:04, 38.12it/s]\nRecalculating energies and forces:  84%|\u2588\u2588\u2588\u2588\u258f| 835/1000 [00:22&lt;00:04, 38.36it/s]\nRecalculating energies and forces:  84%|\u2588\u2588\u2588\u2588\u258f| 839/1000 [00:22&lt;00:04, 38.30it/s]\nRecalculating energies and forces:  84%|\u2588\u2588\u2588\u2588\u258f| 843/1000 [00:22&lt;00:04, 37.99it/s]\nRecalculating energies and forces:  85%|\u2588\u2588\u2588\u2588\u258f| 847/1000 [00:22&lt;00:04, 37.50it/s]\nRecalculating energies and forces:  85%|\u2588\u2588\u2588\u2588\u258e| 851/1000 [00:22&lt;00:04, 37.02it/s]\nRecalculating energies and forces:  86%|\u2588\u2588\u2588\u2588\u258e| 855/1000 [00:22&lt;00:03, 36.59it/s]\nRecalculating energies and forces:  86%|\u2588\u2588\u2588\u2588\u258e| 859/1000 [00:23&lt;00:03, 36.00it/s]\nRecalculating energies and forces:  86%|\u2588\u2588\u2588\u2588\u258e| 863/1000 [00:23&lt;00:03, 36.63it/s]\nRecalculating energies and forces:  87%|\u2588\u2588\u2588\u2588\u258e| 867/1000 [00:23&lt;00:03, 37.23it/s]\nRecalculating energies and forces:  87%|\u2588\u2588\u2588\u2588\u258e| 871/1000 [00:23&lt;00:03, 37.55it/s]\nRecalculating energies and forces:  88%|\u2588\u2588\u2588\u2588\u258d| 875/1000 [00:23&lt;00:03, 37.83it/s]\nRecalculating energies and forces:  88%|\u2588\u2588\u2588\u2588\u258d| 879/1000 [00:23&lt;00:03, 37.75it/s]\nRecalculating energies and forces:  88%|\u2588\u2588\u2588\u2588\u258d| 883/1000 [00:23&lt;00:03, 37.10it/s]\nRecalculating energies and forces:  89%|\u2588\u2588\u2588\u2588\u258d| 887/1000 [00:23&lt;00:03, 37.44it/s]\nRecalculating energies and forces:  89%|\u2588\u2588\u2588\u2588\u258d| 891/1000 [00:23&lt;00:02, 37.83it/s]\nRecalculating energies and forces:  90%|\u2588\u2588\u2588\u2588\u258d| 895/1000 [00:23&lt;00:02, 38.04it/s]\nRecalculating energies and forces:  90%|\u2588\u2588\u2588\u2588\u258d| 899/1000 [00:24&lt;00:02, 38.13it/s]\nRecalculating energies and forces:  90%|\u2588\u2588\u2588\u2588\u258c| 903/1000 [00:24&lt;00:02, 38.23it/s]\nRecalculating energies and forces:  91%|\u2588\u2588\u2588\u2588\u258c| 907/1000 [00:24&lt;00:02, 38.34it/s]\nRecalculating energies and forces:  91%|\u2588\u2588\u2588\u2588\u258c| 911/1000 [00:24&lt;00:02, 38.51it/s]\nRecalculating energies and forces:  92%|\u2588\u2588\u2588\u2588\u258c| 915/1000 [00:24&lt;00:02, 38.53it/s]\nRecalculating energies and forces:  92%|\u2588\u2588\u2588\u2588\u258c| 919/1000 [00:24&lt;00:02, 38.56it/s]\nRecalculating energies and forces:  92%|\u2588\u2588\u2588\u2588\u258c| 923/1000 [00:24&lt;00:01, 38.61it/s]\nRecalculating energies and forces:  93%|\u2588\u2588\u2588\u2588\u258b| 927/1000 [00:24&lt;00:01, 38.64it/s]\nRecalculating energies and forces:  93%|\u2588\u2588\u2588\u2588\u258b| 931/1000 [00:24&lt;00:01, 38.72it/s]\nRecalculating energies and forces:  94%|\u2588\u2588\u2588\u2588\u258b| 935/1000 [00:25&lt;00:01, 38.68it/s]\nRecalculating energies and forces:  94%|\u2588\u2588\u2588\u2588\u258b| 939/1000 [00:25&lt;00:01, 38.73it/s]\nRecalculating energies and forces:  94%|\u2588\u2588\u2588\u2588\u258b| 943/1000 [00:25&lt;00:01, 38.90it/s]\nRecalculating energies and forces:  95%|\u2588\u2588\u2588\u2588\u258b| 947/1000 [00:25&lt;00:01, 38.89it/s]\nRecalculating energies and forces:  95%|\u2588\u2588\u2588\u2588\u258a| 951/1000 [00:25&lt;00:01, 38.90it/s]\nRecalculating energies and forces:  96%|\u2588\u2588\u2588\u2588\u258a| 955/1000 [00:25&lt;00:01, 38.67it/s]\nRecalculating energies and forces:  96%|\u2588\u2588\u2588\u2588\u258a| 959/1000 [00:25&lt;00:01, 38.44it/s]\nRecalculating energies and forces:  96%|\u2588\u2588\u2588\u2588\u258a| 963/1000 [00:25&lt;00:00, 38.45it/s]\nRecalculating energies and forces:  97%|\u2588\u2588\u2588\u2588\u258a| 967/1000 [00:25&lt;00:00, 38.45it/s]\nRecalculating energies and forces:  97%|\u2588\u2588\u2588\u2588\u258a| 971/1000 [00:25&lt;00:00, 38.54it/s]\nRecalculating energies and forces:  98%|\u2588\u2588\u2588\u2588\u2589| 975/1000 [00:26&lt;00:00, 38.63it/s]\nRecalculating energies and forces:  98%|\u2588\u2588\u2588\u2588\u2589| 980/1000 [00:26&lt;00:00, 39.69it/s]\nRecalculating energies and forces:  98%|\u2588\u2588\u2588\u2588\u2589| 985/1000 [00:26&lt;00:00, 40.29it/s]\nRecalculating energies and forces:  99%|\u2588\u2588\u2588\u2588\u2589| 990/1000 [00:26&lt;00:00, 40.15it/s]\nRecalculating energies and forces: 100%|\u2588\u2588\u2588\u2588\u2589| 995/1000 [00:26&lt;00:00, 40.19it/s]\nRecalculating energies and forces: 100%|\u2588\u2588\u2588\u2588| 1000/1000 [00:26&lt;00:00, 39.69it/s]\n                                                                                \nSaving the dataset (0/1 shards):   0%|             | 0/1 [00:00&lt;?, ? examples/s]\nSaving the dataset (1/1 shards): 100%|\u2588\u2588\u2588\u2588| 1/1 [00:00&lt;00:00, 232.09 examples/s]\n\nOptimising MM parameters:   0%|                        | 0/1000 [00:00&lt;?, ?it/s]\nOptimising MM parameters:   0%|                | 4/1000 [00:00&lt;00:28, 34.52it/s]\nOptimising MM parameters:   1%|\u258f               | 8/1000 [00:00&lt;00:26, 37.29it/s]\nOptimising MM parameters:   1%|\u258f              | 12/1000 [00:00&lt;00:26, 36.62it/s]\nOptimising MM parameters:   2%|\u258e              | 17/1000 [00:00&lt;00:25, 38.45it/s]\nOptimising MM parameters:   2%|\u258e              | 21/1000 [00:00&lt;00:25, 37.92it/s]\nOptimising MM parameters:   3%|\u258d              | 26/1000 [00:00&lt;00:24, 39.00it/s]\nOptimising MM parameters:   3%|\u258d              | 31/1000 [00:00&lt;00:25, 38.70it/s]\nOptimising MM parameters:   4%|\u258c              | 36/1000 [00:00&lt;00:24, 39.92it/s]\nOptimising MM parameters:   4%|\u258c              | 41/1000 [00:01&lt;00:24, 39.65it/s]\nOptimising MM parameters:   5%|\u258b              | 46/1000 [00:01&lt;00:23, 40.57it/s]\nOptimising MM parameters:   5%|\u258a              | 51/1000 [00:01&lt;00:23, 40.06it/s]\nOptimising MM parameters:   6%|\u258a              | 56/1000 [00:01&lt;00:23, 40.85it/s]\nOptimising MM parameters:   6%|\u2589              | 61/1000 [00:01&lt;00:23, 40.29it/s]\nOptimising MM parameters:   7%|\u2589              | 66/1000 [00:01&lt;00:22, 40.95it/s]\nOptimising MM parameters:   7%|\u2588              | 71/1000 [00:01&lt;00:23, 40.36it/s]\nOptimising MM parameters:   8%|\u2588\u258f             | 76/1000 [00:01&lt;00:22, 41.01it/s]\nOptimising MM parameters:   8%|\u2588\u258f             | 81/1000 [00:02&lt;00:22, 40.41it/s]\nOptimising MM parameters:   9%|\u2588\u258e             | 86/1000 [00:02&lt;00:22, 41.09it/s]\nOptimising MM parameters:   9%|\u2588\u258e             | 91/1000 [00:02&lt;00:22, 40.46it/s]\nOptimising MM parameters:  10%|\u2588\u258d             | 96/1000 [00:02&lt;00:21, 41.13it/s]\nOptimising MM parameters:  10%|\u2588\u258d            | 101/1000 [00:02&lt;00:22, 40.51it/s]\nOptimising MM parameters:  11%|\u2588\u258d            | 106/1000 [00:02&lt;00:21, 41.15it/s]\nOptimising MM parameters:  11%|\u2588\u258c            | 111/1000 [00:02&lt;00:21, 40.53it/s]\nOptimising MM parameters:  12%|\u2588\u258c            | 116/1000 [00:02&lt;00:21, 41.11it/s]\nOptimising MM parameters:  12%|\u2588\u258b            | 121/1000 [00:03&lt;00:21, 40.47it/s]\nOptimising MM parameters:  13%|\u2588\u258a            | 126/1000 [00:03&lt;00:21, 41.11it/s]\nOptimising MM parameters:  13%|\u2588\u258a            | 131/1000 [00:03&lt;00:21, 40.49it/s]\nOptimising MM parameters:  14%|\u2588\u2589            | 136/1000 [00:03&lt;00:21, 41.13it/s]\nOptimising MM parameters:  14%|\u2588\u2589            | 141/1000 [00:03&lt;00:21, 40.51it/s]\nOptimising MM parameters:  15%|\u2588\u2588            | 146/1000 [00:03&lt;00:20, 41.16it/s]\nOptimising MM parameters:  15%|\u2588\u2588            | 151/1000 [00:03&lt;00:20, 40.52it/s]\nOptimising MM parameters:  16%|\u2588\u2588\u258f           | 156/1000 [00:03&lt;00:20, 41.16it/s]\nOptimising MM parameters:  16%|\u2588\u2588\u258e           | 161/1000 [00:03&lt;00:20, 40.50it/s]\nOptimising MM parameters:  17%|\u2588\u2588\u258e           | 166/1000 [00:04&lt;00:20, 41.15it/s]\nOptimising MM parameters:  17%|\u2588\u2588\u258d           | 171/1000 [00:04&lt;00:20, 40.51it/s]\nOptimising MM parameters:  18%|\u2588\u2588\u258d           | 176/1000 [00:04&lt;00:20, 41.15it/s]\nOptimising MM parameters:  18%|\u2588\u2588\u258c           | 181/1000 [00:04&lt;00:20, 40.24it/s]\nOptimising MM parameters:  19%|\u2588\u2588\u258c           | 186/1000 [00:04&lt;00:20, 40.08it/s]\nOptimising MM parameters:  19%|\u2588\u2588\u258b           | 191/1000 [00:04&lt;00:20, 38.82it/s]\nOptimising MM parameters:  20%|\u2588\u2588\u258b           | 195/1000 [00:04&lt;00:20, 39.03it/s]\nOptimising MM parameters:  20%|\u2588\u2588\u258a           | 199/1000 [00:04&lt;00:20, 39.18it/s]\nOptimising MM parameters:  20%|\u2588\u2588\u258a           | 203/1000 [00:05&lt;00:20, 38.46it/s]\nOptimising MM parameters:  21%|\u2588\u2588\u2589           | 208/1000 [00:05&lt;00:20, 38.81it/s]\nOptimising MM parameters:  21%|\u2588\u2588\u2589           | 212/1000 [00:05&lt;00:20, 38.03it/s]\nOptimising MM parameters:  22%|\u2588\u2588\u2588           | 217/1000 [00:05&lt;00:20, 39.13it/s]\nOptimising MM parameters:  22%|\u2588\u2588\u2588           | 221/1000 [00:05&lt;00:20, 38.46it/s]\nOptimising MM parameters:  23%|\u2588\u2588\u2588\u258f          | 226/1000 [00:05&lt;00:19, 39.32it/s]\nOptimising MM parameters:  23%|\u2588\u2588\u2588\u258f          | 231/1000 [00:05&lt;00:19, 38.95it/s]\nOptimising MM parameters:  24%|\u2588\u2588\u2588\u258e          | 236/1000 [00:05&lt;00:19, 39.67it/s]\nOptimising MM parameters:  24%|\u2588\u2588\u2588\u258e          | 241/1000 [00:06&lt;00:19, 38.92it/s]\nOptimising MM parameters:  25%|\u2588\u2588\u2588\u258d          | 246/1000 [00:06&lt;00:19, 39.40it/s]\nOptimising MM parameters:  25%|\u2588\u2588\u2588\u258c          | 251/1000 [00:06&lt;00:19, 38.98it/s]\nOptimising MM parameters:  26%|\u2588\u2588\u2588\u258c          | 256/1000 [00:06&lt;00:18, 39.59it/s]\nOptimising MM parameters:  26%|\u2588\u2588\u2588\u258b          | 261/1000 [00:06&lt;00:19, 38.89it/s]\nOptimising MM parameters:  27%|\u2588\u2588\u2588\u258b          | 266/1000 [00:06&lt;00:18, 39.59it/s]\nOptimising MM parameters:  27%|\u2588\u2588\u2588\u258a          | 271/1000 [00:06&lt;00:18, 39.00it/s]\nOptimising MM parameters:  28%|\u2588\u2588\u2588\u258a          | 275/1000 [00:06&lt;00:18, 38.79it/s]\nOptimising MM parameters:  28%|\u2588\u2588\u2588\u2589          | 280/1000 [00:07&lt;00:18, 39.63it/s]\nOptimising MM parameters:  28%|\u2588\u2588\u2588\u2589          | 284/1000 [00:07&lt;00:18, 38.72it/s]\nOptimising MM parameters:  29%|\u2588\u2588\u2588\u2588          | 288/1000 [00:07&lt;00:18, 38.96it/s]\nOptimising MM parameters:  29%|\u2588\u2588\u2588\u2588          | 292/1000 [00:07&lt;00:18, 38.33it/s]\nOptimising MM parameters:  30%|\u2588\u2588\u2588\u2588\u258f         | 297/1000 [00:07&lt;00:17, 39.25it/s]\nOptimising MM parameters:  30%|\u2588\u2588\u2588\u2588\u258f         | 301/1000 [00:07&lt;00:18, 38.43it/s]\nOptimising MM parameters:  31%|\u2588\u2588\u2588\u2588\u258e         | 306/1000 [00:07&lt;00:17, 39.29it/s]\nOptimising MM parameters:  31%|\u2588\u2588\u2588\u2588\u258e         | 310/1000 [00:07&lt;00:17, 39.45it/s]\nOptimising MM parameters:  31%|\u2588\u2588\u2588\u2588\u258d         | 314/1000 [00:07&lt;00:17, 38.79it/s]\nOptimising MM parameters:  32%|\u2588\u2588\u2588\u2588\u258d         | 318/1000 [00:08&lt;00:17, 38.99it/s]\nOptimising MM parameters:  32%|\u2588\u2588\u2588\u2588\u258c         | 322/1000 [00:08&lt;00:17, 38.23it/s]\nOptimising MM parameters:  33%|\u2588\u2588\u2588\u2588\u258c         | 327/1000 [00:08&lt;00:17, 39.29it/s]\nOptimising MM parameters:  33%|\u2588\u2588\u2588\u2588\u258b         | 331/1000 [00:08&lt;00:17, 38.66it/s]\nOptimising MM parameters:  34%|\u2588\u2588\u2588\u2588\u258b         | 336/1000 [00:08&lt;00:16, 39.30it/s]\nOptimising MM parameters:  34%|\u2588\u2588\u2588\u2588\u258a         | 340/1000 [00:08&lt;00:16, 38.85it/s]\nOptimising MM parameters:  34%|\u2588\u2588\u2588\u2588\u258a         | 344/1000 [00:08&lt;00:17, 38.38it/s]\nOptimising MM parameters:  35%|\u2588\u2588\u2588\u2588\u2589         | 349/1000 [00:08&lt;00:16, 39.37it/s]\nOptimising MM parameters:  35%|\u2588\u2588\u2588\u2588\u2589         | 353/1000 [00:08&lt;00:16, 38.26it/s]\nOptimising MM parameters:  36%|\u2588\u2588\u2588\u2588\u2588         | 358/1000 [00:09&lt;00:16, 39.35it/s]\nOptimising MM parameters:  36%|\u2588\u2588\u2588\u2588\u2588         | 362/1000 [00:09&lt;00:16, 38.98it/s]\nOptimising MM parameters:  37%|\u2588\u2588\u2588\u2588\u2588\u258f        | 367/1000 [00:09&lt;00:15, 40.10it/s]\nOptimising MM parameters:  37%|\u2588\u2588\u2588\u2588\u2588\u258f        | 372/1000 [00:09&lt;00:15, 39.81it/s]\nOptimising MM parameters:  38%|\u2588\u2588\u2588\u2588\u2588\u258e        | 377/1000 [00:09&lt;00:15, 40.70it/s]\nOptimising MM parameters:  38%|\u2588\u2588\u2588\u2588\u2588\u258e        | 382/1000 [00:09&lt;00:15, 40.22it/s]\nOptimising MM parameters:  39%|\u2588\u2588\u2588\u2588\u2588\u258d        | 387/1000 [00:09&lt;00:14, 40.97it/s]\nOptimising MM parameters:  39%|\u2588\u2588\u2588\u2588\u2588\u258d        | 392/1000 [00:09&lt;00:15, 40.40it/s]\nOptimising MM parameters:  40%|\u2588\u2588\u2588\u2588\u2588\u258c        | 397/1000 [00:09&lt;00:14, 40.97it/s]\nOptimising MM parameters:  40%|\u2588\u2588\u2588\u2588\u2588\u258b        | 402/1000 [00:10&lt;00:14, 39.89it/s]\nOptimising MM parameters:  41%|\u2588\u2588\u2588\u2588\u2588\u258b        | 407/1000 [00:10&lt;00:14, 40.25it/s]\nOptimising MM parameters:  41%|\u2588\u2588\u2588\u2588\u2588\u258a        | 412/1000 [00:10&lt;00:14, 39.40it/s]\nOptimising MM parameters:  42%|\u2588\u2588\u2588\u2588\u2588\u258a        | 417/1000 [00:10&lt;00:14, 40.24it/s]\nOptimising MM parameters:  42%|\u2588\u2588\u2588\u2588\u2588\u2589        | 422/1000 [00:10&lt;00:14, 39.81it/s]\nOptimising MM parameters:  43%|\u2588\u2588\u2588\u2588\u2588\u2589        | 427/1000 [00:10&lt;00:14, 40.63it/s]\nOptimising MM parameters:  43%|\u2588\u2588\u2588\u2588\u2588\u2588        | 432/1000 [00:10&lt;00:14, 39.71it/s]\nOptimising MM parameters:  44%|\u2588\u2588\u2588\u2588\u2588\u2588        | 437/1000 [00:10&lt;00:13, 40.37it/s]\nOptimising MM parameters:  44%|\u2588\u2588\u2588\u2588\u2588\u2588\u258f       | 442/1000 [00:11&lt;00:13, 39.99it/s]\nOptimising MM parameters:  45%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e       | 447/1000 [00:11&lt;00:13, 40.76it/s]\nOptimising MM parameters:  45%|\u2588\u2588\u2588\u2588\u2588\u2588\u258e       | 452/1000 [00:11&lt;00:13, 40.27it/s]\nOptimising MM parameters:  46%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d       | 457/1000 [00:11&lt;00:13, 41.00it/s]\nOptimising MM parameters:  46%|\u2588\u2588\u2588\u2588\u2588\u2588\u258d       | 462/1000 [00:11&lt;00:13, 40.42it/s]\nOptimising MM parameters:  47%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c       | 467/1000 [00:11&lt;00:12, 41.11it/s]\nOptimising MM parameters:  47%|\u2588\u2588\u2588\u2588\u2588\u2588\u258c       | 472/1000 [00:11&lt;00:13, 40.20it/s]\nOptimising MM parameters:  48%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b       | 477/1000 [00:11&lt;00:12, 40.92it/s]\nOptimising MM parameters:  48%|\u2588\u2588\u2588\u2588\u2588\u2588\u258b       | 482/1000 [00:12&lt;00:12, 40.28it/s]\nOptimising MM parameters:  49%|\u2588\u2588\u2588\u2588\u2588\u2588\u258a       | 487/1000 [00:12&lt;00:12, 40.21it/s]\nOptimising MM parameters:  49%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589       | 492/1000 [00:12&lt;00:12, 39.74it/s]\nOptimising MM parameters:  50%|\u2588\u2588\u2588\u2588\u2588\u2588\u2589       | 497/1000 [00:12&lt;00:12, 40.58it/s]\nOptimising MM parameters:  50%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588       | 502/1000 [00:12&lt;00:12, 40.15it/s]\nOptimising MM parameters:  51%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588       | 507/1000 [00:12&lt;00:12, 40.91it/s]\nOptimising MM parameters:  51%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f      | 512/1000 [00:12&lt;00:12, 40.36it/s]\nOptimising MM parameters:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f      | 517/1000 [00:12&lt;00:11, 41.07it/s]\nOptimising MM parameters:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e      | 522/1000 [00:13&lt;00:11, 40.49it/s]\nOptimising MM parameters:  53%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d      | 527/1000 [00:13&lt;00:11, 41.17it/s]\nOptimising MM parameters:  53%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d      | 532/1000 [00:13&lt;00:11, 40.58it/s]\nOptimising MM parameters:  54%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c      | 537/1000 [00:13&lt;00:11, 41.22it/s]\nOptimising MM parameters:  54%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c      | 542/1000 [00:13&lt;00:11, 40.56it/s]\nOptimising MM parameters:  55%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b      | 547/1000 [00:13&lt;00:10, 41.20it/s]\nOptimising MM parameters:  55%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b      | 552/1000 [00:13&lt;00:11, 40.51it/s]\nOptimising MM parameters:  56%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a      | 557/1000 [00:13&lt;00:10, 41.15it/s]\nOptimising MM parameters:  56%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a      | 562/1000 [00:14&lt;00:10, 40.54it/s]\nOptimising MM parameters:  57%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589      | 567/1000 [00:14&lt;00:10, 41.20it/s]\nOptimising MM parameters:  57%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588      | 572/1000 [00:14&lt;00:10, 40.57it/s]\nOptimising MM parameters:  58%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588      | 577/1000 [00:14&lt;00:10, 41.22it/s]\nOptimising MM parameters:  58%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f     | 582/1000 [00:14&lt;00:10, 40.57it/s]\nOptimising MM parameters:  59%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f     | 587/1000 [00:14&lt;00:10, 41.22it/s]\nOptimising MM parameters:  59%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e     | 592/1000 [00:14&lt;00:10, 40.58it/s]\nOptimising MM parameters:  60%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e     | 597/1000 [00:14&lt;00:09, 41.23it/s]\nOptimising MM parameters:  60%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d     | 602/1000 [00:15&lt;00:09, 40.63it/s]\nOptimising MM parameters:  61%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d     | 607/1000 [00:15&lt;00:09, 41.25it/s]\nOptimising MM parameters:  61%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c     | 612/1000 [00:15&lt;00:09, 40.57it/s]\nOptimising MM parameters:  62%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b     | 617/1000 [00:15&lt;00:09, 41.21it/s]\nOptimising MM parameters:  62%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b     | 622/1000 [00:15&lt;00:09, 40.56it/s]\nOptimising MM parameters:  63%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a     | 627/1000 [00:15&lt;00:09, 40.84it/s]\nOptimising MM parameters:  63%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a     | 632/1000 [00:15&lt;00:09, 38.93it/s]\nOptimising MM parameters:  64%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589     | 637/1000 [00:15&lt;00:09, 39.52it/s]\nOptimising MM parameters:  64%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589     | 641/1000 [00:16&lt;00:09, 38.75it/s]\nOptimising MM parameters:  65%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588     | 646/1000 [00:16&lt;00:08, 39.48it/s]\nOptimising MM parameters:  65%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588     | 651/1000 [00:16&lt;00:08, 38.86it/s]\nOptimising MM parameters:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f    | 656/1000 [00:16&lt;00:08, 39.50it/s]\nOptimising MM parameters:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e    | 661/1000 [00:16&lt;00:08, 38.77it/s]\nOptimising MM parameters:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e    | 665/1000 [00:16&lt;00:08, 38.86it/s]\nOptimising MM parameters:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e    | 669/1000 [00:16&lt;00:08, 38.68it/s]\nOptimising MM parameters:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d    | 673/1000 [00:16&lt;00:08, 37.83it/s]\nOptimising MM parameters:  68%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d    | 678/1000 [00:16&lt;00:08, 38.90it/s]\nOptimising MM parameters:  68%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c    | 682/1000 [00:17&lt;00:08, 38.33it/s]\nOptimising MM parameters:  69%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c    | 687/1000 [00:17&lt;00:08, 38.71it/s]\nOptimising MM parameters:  69%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b    | 691/1000 [00:17&lt;00:08, 37.36it/s]\nOptimising MM parameters:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b    | 695/1000 [00:17&lt;00:08, 37.65it/s]\nOptimising MM parameters:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a    | 699/1000 [00:17&lt;00:07, 38.15it/s]\nOptimising MM parameters:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a    | 703/1000 [00:17&lt;00:07, 37.66it/s]\nOptimising MM parameters:  71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589    | 707/1000 [00:17&lt;00:07, 38.24it/s]\nOptimising MM parameters:  71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589    | 711/1000 [00:17&lt;00:07, 37.90it/s]\nOptimising MM parameters:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588    | 716/1000 [00:17&lt;00:07, 38.97it/s]\nOptimising MM parameters:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588    | 720/1000 [00:18&lt;00:07, 39.19it/s]\nOptimising MM parameters:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 724/1000 [00:18&lt;00:07, 37.94it/s]\nOptimising MM parameters:  73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 729/1000 [00:18&lt;00:06, 39.03it/s]\nOptimising MM parameters:  73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e   | 733/1000 [00:18&lt;00:06, 38.39it/s]\nOptimising MM parameters:  74%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e   | 738/1000 [00:18&lt;00:06, 39.54it/s]\nOptimising MM parameters:  74%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d   | 742/1000 [00:18&lt;00:06, 39.15it/s]\nOptimising MM parameters:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d   | 747/1000 [00:18&lt;00:06, 40.28it/s]\nOptimising MM parameters:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 752/1000 [00:18&lt;00:06, 39.94it/s]\nOptimising MM parameters:  76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c   | 757/1000 [00:19&lt;00:05, 40.80it/s]\nOptimising MM parameters:  76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b   | 762/1000 [00:19&lt;00:05, 40.30it/s]\nOptimising MM parameters:  77%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b   | 767/1000 [00:19&lt;00:05, 41.03it/s]\nOptimising MM parameters:  77%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a   | 772/1000 [00:19&lt;00:05, 40.48it/s]\nOptimising MM parameters:  78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 777/1000 [00:19&lt;00:05, 41.16it/s]\nOptimising MM parameters:  78%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589   | 782/1000 [00:19&lt;00:05, 40.53it/s]\nOptimising MM parameters:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588   | 787/1000 [00:19&lt;00:05, 41.20it/s]\nOptimising MM parameters:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588   | 792/1000 [00:19&lt;00:05, 40.56it/s]\nOptimising MM parameters:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 797/1000 [00:19&lt;00:04, 41.19it/s]\nOptimising MM parameters:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 802/1000 [00:20&lt;00:04, 40.53it/s]\nOptimising MM parameters:  81%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e  | 807/1000 [00:20&lt;00:04, 41.18it/s]\nOptimising MM parameters:  81%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e  | 812/1000 [00:20&lt;00:04, 40.57it/s]\nOptimising MM parameters:  82%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d  | 817/1000 [00:20&lt;00:04, 41.20it/s]\nOptimising MM parameters:  82%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 822/1000 [00:20&lt;00:04, 40.51it/s]\nOptimising MM parameters:  83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c  | 827/1000 [00:20&lt;00:04, 41.16it/s]\nOptimising MM parameters:  83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b  | 832/1000 [00:20&lt;00:04, 40.55it/s]\nOptimising MM parameters:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b  | 837/1000 [00:20&lt;00:03, 41.20it/s]\nOptimising MM parameters:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 842/1000 [00:21&lt;00:03, 40.57it/s]\nOptimising MM parameters:  85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a  | 847/1000 [00:21&lt;00:03, 41.24it/s]\nOptimising MM parameters:  85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 852/1000 [00:21&lt;00:03, 40.61it/s]\nOptimising MM parameters:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589  | 857/1000 [00:21&lt;00:03, 41.23it/s]\nOptimising MM parameters:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 862/1000 [00:21&lt;00:03, 40.55it/s]\nOptimising MM parameters:  87%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f | 867/1000 [00:21&lt;00:03, 41.19it/s]\nOptimising MM parameters:  87%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f | 872/1000 [00:21&lt;00:03, 40.57it/s]\nOptimising MM parameters:  88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 877/1000 [00:21&lt;00:02, 41.21it/s]\nOptimising MM parameters:  88%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 882/1000 [00:22&lt;00:02, 40.57it/s]\nOptimising MM parameters:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 887/1000 [00:22&lt;00:02, 41.22it/s]\nOptimising MM parameters:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d | 892/1000 [00:22&lt;00:02, 40.59it/s]\nOptimising MM parameters:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c | 897/1000 [00:22&lt;00:02, 41.24it/s]\nOptimising MM parameters:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 902/1000 [00:22&lt;00:02, 40.59it/s]\nOptimising MM parameters:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 907/1000 [00:22&lt;00:02, 41.24it/s]\nOptimising MM parameters:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 912/1000 [00:22&lt;00:02, 40.10it/s]\nOptimising MM parameters:  92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a | 917/1000 [00:22&lt;00:02, 40.67it/s]\nOptimising MM parameters:  92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589 | 922/1000 [00:23&lt;00:01, 39.51it/s]\nOptimising MM parameters:  93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589 | 927/1000 [00:23&lt;00:01, 40.38it/s]\nOptimising MM parameters:  93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 | 932/1000 [00:23&lt;00:01, 39.99it/s]\nOptimising MM parameters:  94%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 | 937/1000 [00:23&lt;00:01, 40.78it/s]\nOptimising MM parameters:  94%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f| 942/1000 [00:23&lt;00:01, 40.31it/s]\nOptimising MM parameters:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e| 947/1000 [00:23&lt;00:01, 41.03it/s]\nOptimising MM parameters:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e| 952/1000 [00:23&lt;00:01, 40.48it/s]\nOptimising MM parameters:  96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 957/1000 [00:23&lt;00:01, 41.15it/s]\nOptimising MM parameters:  96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d| 962/1000 [00:24&lt;00:00, 40.56it/s]\nOptimising MM parameters:  97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 967/1000 [00:24&lt;00:00, 41.21it/s]\nOptimising MM parameters:  97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c| 972/1000 [00:24&lt;00:00, 40.60it/s]\nOptimising MM parameters:  98%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b| 977/1000 [00:24&lt;00:00, 41.26it/s]\nOptimising MM parameters:  98%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b| 982/1000 [00:24&lt;00:00, 40.62it/s]\nOptimising MM parameters:  99%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a| 987/1000 [00:24&lt;00:00, 41.24it/s]\nOptimising MM parameters:  99%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589| 992/1000 [00:24&lt;00:00, 40.60it/s]\nOptimising MM parameters: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589| 997/1000 [00:24&lt;00:00, 41.24it/s]\n                                                                                2025-12-03 15:13:51.023 | INFO     | bespokefit_smee.workflow:get_bespoke_force_field:196 - Iteration 2 force field statistics: Energy (Mean/SD): 3.340e-04/2.778e+00, Forces (Mean/SD): 1.049e-09/7.533e+00\n2025-12-03 15:13:51.023 | INFO     | bespokefit_smee.workflow:get_bespoke_force_field:199 -     Energy Error (Mean):  3.340e-04-&gt; 3.307e-04 : Change = -3.304e-06\n2025-12-03 15:13:51.023 | INFO     | bespokefit_smee.workflow:get_bespoke_force_field:202 -                  (SD):    2.778e+00-&gt; 2.697e+00 : Change = -8.115e-02\n2025-12-03 15:13:51.023 | INFO     | bespokefit_smee.workflow:get_bespoke_force_field:205 -     Forces Error (Mean):  1.049e-09-&gt;-4.206e-09 : Change = -5.255e-09\n2025-12-03 15:13:51.023 | INFO     | bespokefit_smee.workflow:get_bespoke_force_field:208 -                  (SD):    7.533e+00-&gt; 7.432e+00 : Change = -1.016e-01\n2025-12-03 15:13:55.224 | INFO     | bespokefit_smee.analyse:plot_all_ffs:523 - Plotting force field values with 8 rows and 4 columns\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 4/4 [00:02&lt;00:00,  1.48it/s]\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/bespokefit_smee/analyse.py:536: UserWarning: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.\n  axs[2, 3].legend(bbox_to_anchor=(1.05, 1), loc=\"upper left\")\n2025-12-03 15:14:01.926 | INFO     | bespokefit_smee.analyse:plot_all_ffs:523 - Plotting force field differences with 8 rows and 4 columns\n  0%|                                                     | 0/4 [00:00&lt;?, ?it/s]/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/bespokefit_smee/analyse.py:424: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.\n  ax.set_xticklabels(differences.keys(), rotation=90)\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/bespokefit_smee/analyse.py:424: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.\n  ax.set_xticklabels(differences.keys(), rotation=90)\n 25%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                 | 1/4 [00:00&lt;00:00,  4.76it/s]/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/bespokefit_smee/analyse.py:424: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.\n  ax.set_xticklabels(differences.keys(), rotation=90)\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/bespokefit_smee/analyse.py:424: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.\n  ax.set_xticklabels(differences.keys(), rotation=90)\n 50%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                      | 2/4 [00:00&lt;00:00,  4.52it/s]/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/bespokefit_smee/analyse.py:424: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.\n  ax.set_xticklabels(differences.keys(), rotation=90)\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/bespokefit_smee/analyse.py:424: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.\n  ax.set_xticklabels(differences.keys(), rotation=90)\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/bespokefit_smee/analyse.py:424: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.\n  ax.set_xticklabels(differences.keys(), rotation=90)\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/bespokefit_smee/analyse.py:424: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.\n  ax.set_xticklabels(differences.keys(), rotation=90)\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/bespokefit_smee/analyse.py:424: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.\n  ax.set_xticklabels(differences.keys(), rotation=90)\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/bespokefit_smee/analyse.py:424: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.\n  ax.set_xticklabels(differences.keys(), rotation=90)\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/bespokefit_smee/analyse.py:424: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.\n  ax.set_xticklabels(differences.keys(), rotation=90)\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/bespokefit_smee/analyse.py:424: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.\n  ax.set_xticklabels(differences.keys(), rotation=90)\n 75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a           | 3/4 [00:01&lt;00:00,  1.73it/s]/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/bespokefit_smee/analyse.py:424: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.\n  ax.set_xticklabels(differences.keys(), rotation=90)\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/bespokefit_smee/analyse.py:424: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.\n  ax.set_xticklabels(differences.keys(), rotation=90)\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 4/4 [00:01&lt;00:00,  2.46it/s]\n/home/campus.ncl.ac.uk/nfc78/software/devel/bespokefit_smee/bespokefit_smee/analyse.py:536: UserWarning: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.\n  axs[2, 3].legend(bbox_to_anchor=(1.05, 1), loc=\"upper left\")\n</pre> In\u00a0[7]: Copied! <pre>! cat training_iteration_2/bespoke_ff.offxml\n</pre> ! cat training_iteration_2/bespoke_ff.offxml <pre>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;SMIRNOFF version=\"0.3\" aromaticity_model=\"OEAroModel_MDL\"&gt;\n    &lt;Author&gt;The Open Force Field Initiative&lt;/Author&gt;\n    &lt;Date&gt;2024-09-11&lt;/Date&gt;\n    &lt;Constraints version=\"0.3\"&gt;\n        &lt;Constraint smirks=\"[#1:1]-[#8X2H2+0:2]-[#1]\" id=\"c-tip3p-H-O\" distance=\"0.9572 * angstrom ** 1\"&gt;&lt;/Constraint&gt;\n        &lt;Constraint smirks=\"[#1:1]-[#8X2H2+0]-[#1:2]\" id=\"c-tip3p-H-O-H\" distance=\"1.5139006545247014 * angstrom ** 1\"&gt;&lt;/Constraint&gt;\n    &lt;/Constraints&gt;\n    &lt;Bonds version=\"0.4\" potential=\"harmonic\" fractional_bondorder_method=\"AM1-Wiberg\" fractional_bondorder_interpolation=\"linear\"&gt;\n        &lt;Bond smirks=\"[#6X4:1]-[#6X4:2]\" id=\"b1\" length=\"1.533682189836 * angstrom ** 1\" k=\"430.4753865522 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X4:1]-[#6X3:2]\" id=\"b2\" length=\"1.509906088505 * angstrom ** 1\" k=\"478.5938624291 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X4:1]-[#6X3:2]=[#8X1+0]\" id=\"b3\" length=\"1.529107327625 * angstrom ** 1\" k=\"404.5865966221 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X3:1]-[#6X3:2]\" id=\"b4\" length=\"1.467813669186 * angstrom ** 1\" k=\"534.9004011769 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X3:1]:[#6X3:2]\" id=\"b5\" length=\"1.400774190845 * angstrom ** 1\" k=\"753.9544105052 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X3:1]=[#6X3:2]\" id=\"b6\" length=\"1.373322617043 * angstrom ** 1\" k=\"904.1364741993 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6:1]-[#7:2]\" id=\"b7\" length=\"1.477165026987 * angstrom ** 1\" k=\"451.7828325538 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X3:1]-[#7X3:2]\" id=\"b8\" length=\"1.389594660959 * angstrom ** 1\" k=\"658.1801467822 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X4:1]-[#7X3:2]-[#6X3]=[#8X1+0]\" id=\"b9\" length=\"1.462245031202 * angstrom ** 1\" k=\"482.1993321972 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X3:1](=[#8X1+0])-[#7X3:2]\" id=\"b10\" length=\"1.383769967656 * angstrom ** 1\" k=\"653.6221669084 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X3:1]-[#7X2:2]\" id=\"b11\" length=\"1.386672489657 * angstrom ** 1\" k=\"591.2548047458 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X3:1]:[#7X2,#7X3+1:2]\" id=\"b12\" length=\"1.33886585269 * angstrom ** 1\" k=\"774.2142430322 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X3:1]=[#7X2,#7X3+1:2]\" id=\"b13\" length=\"1.309432162522 * angstrom ** 1\" k=\"1010.077064463 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X3:1](~!@[#7X3])(~!@[#7X3])~!@[#7X3:2]\" id=\"b13a\" length=\"1.304468222569 * angstrom ** 1\" k=\"1171.510786135 * angstrom ** -2 * kilocalorie ** 1 * mole ** -1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6:1]-[#8:2]\" id=\"b14\" length=\"1.426266491513 * angstrom ** 1\" k=\"517.8617699655 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X3:1]-[#8X1-1:2]\" id=\"b15\" length=\"1.277699358105 * angstrom ** 1\" k=\"1088.638846712 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X4:1]-[#8X2H0:2]\" id=\"b16\" length=\"1.436180856692 * angstrom ** 1\" k=\"454.1320522181 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X3:1]-[#8X2:2]\" id=\"b17\" length=\"1.363426903656 * angstrom ** 1\" k=\"587.3836433911 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X3:1]-[#8X2H1:2]\" id=\"b18\" length=\"1.360244387751 * angstrom ** 1\" k=\"693.0598968819 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X3a:1]-[#8X2H0:2]\" id=\"b19\" length=\"1.372247415038 * angstrom ** 1\" k=\"637.4545605882 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X3:1](=[#8X1])-[#8X2H0:2]\" id=\"b20\" length=\"1.356044214791 * angstrom ** 1\" k=\"582.6874028895 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6:1]=[#8X1+0,#8X2+1:2]\" id=\"b21\" length=\"1.224819310402 * angstrom ** 1\" k=\"1523.990238252 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X3:1](~[#8X1])~[#8X1:2]\" id=\"b22\" length=\"1.260025492548 * angstrom ** 1\" k=\"1181.508839358 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X3:1]~[#8X2+1:2]~[#6X3]\" id=\"b23\" length=\"1.3571444823426182 * angstrom ** 1\" k=\"609.7328918443294 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X2:1]-[#6:2]\" id=\"b24\" length=\"1.430850833679 * angstrom ** 1\" k=\"660.0008043418 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X2:1]-[#6X4:2]\" id=\"b25\" length=\"1.461040257452 * angstrom ** 1\" k=\"600.1706615503 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X2:1]=[#6X3:2]\" id=\"b26\" length=\"1.313765162018 * angstrom ** 1\" k=\"1338.466319779 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6:1]#[#7:2]\" id=\"b27\" length=\"1.166317608085 * angstrom ** 1\" k=\"2660.941283692 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X2:1]#[#6X2:2]\" id=\"b28\" length=\"1.214255538934 * angstrom ** 1\" k=\"2324.410781424 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X2:1]-[#8X2:2]\" id=\"b29\" length=\"1.3249753746973463 * angstrom ** 1\" k=\"922.9469338550109 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X2:1]-[#7:2]\" id=\"b30\" length=\"1.33623866496 * angstrom ** 1\" k=\"935.4808403561 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X2:1]=[#7:2]\" id=\"b31\" length=\"1.209556733419 * angstrom ** 1\" k=\"1902.880935456 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#16:1]=[#6:2]\" id=\"b32\" length=\"1.67086475081 * angstrom ** 1\" k=\"569.9316681373 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X2:1]=[#16:2]\" id=\"b33\" length=\"1.588783394248 * angstrom ** 1\" k=\"864.5085168584 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#7:1]-[#7:2]\" id=\"b34\" length=\"1.413402082302 * angstrom ** 1\" k=\"573.1834702609 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#7X3:1]-[#7X2:2]\" id=\"b35\" length=\"1.364452879632 * angstrom ** 1\" k=\"588.2894537984 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#7X2:1]-[#7X2:2]\" id=\"b36\" length=\"1.370341455252 * angstrom ** 1\" k=\"512.5290263764 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#7:1]:[#7:2]\" id=\"b37\" length=\"1.336901304472 * angstrom ** 1\" k=\"659.4018560802 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#7:1]=[#7:2]\" id=\"b38\" length=\"1.280676944646 * angstrom ** 1\" k=\"1031.645914785 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#7+1:1]=[#7-1:2]\" id=\"b39\" length=\"1.144263389406 * angstrom ** 1\" k=\"2474.020234655 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#7:1]#[#7:2]\" id=\"b40\" length=\"1.111280963473 * angstrom ** 1\" k=\"3236.575409522 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#7:1]-[#8X2:2]\" id=\"b41\" length=\"1.412052729728 * angstrom ** 1\" k=\"441.3107971392 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#7:1]~[#8X1:2]\" id=\"b42\" length=\"1.237752894763 * angstrom ** 1\" k=\"1180.621142197 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#8X2:1]-[#8X2,#8X1-1:2]\" id=\"b43\" length=\"1.4548541788200349 * angstrom ** 1\" k=\"428.0112402386294 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#16:1]-[#6:2]\" id=\"b44\" length=\"1.807204863403 * angstrom ** 1\" k=\"474.0210361996 * angstrom ** -2 * kilocalorie ** 1 * mole ** -1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#16:1]-[#1:2]\" id=\"b45\" length=\"1.349292030269 * angstrom ** 1\" k=\"588.8163728414 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#16:1]-[#16:2]\" id=\"b46\" length=\"2.098288181365 * angstrom ** 1\" k=\"274.1376613821 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#16:1]-[#9:2]\" id=\"b47\" length=\"1.6 * angstrom ** 1\" k=\"750.0 * angstrom ** -2 * kilocalorie ** 1 * mole ** -1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#16:1]-[#17:2]\" id=\"b48\" length=\"2.141076199528375 * angstrom ** 1\" k=\"175.81141016193482 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#16:1]-[#35:2]\" id=\"b49\" length=\"2.329705148471623 * angstrom ** 1\" k=\"162.5090863354354 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#16:1]-[#53:2]\" id=\"b50\" length=\"2.6 * angstrom ** 1\" k=\"150.0 * angstrom ** -2 * kilocalorie ** 1 * mole ** -1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#16X2,#16X1-1,#16X3+1:1]-[#6X4:2]\" id=\"b51\" length=\"1.836614464623 * angstrom ** 1\" k=\"287.678449631 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#16X2,#16X1-1,#16X3+1:1]-[#6X3:2]\" id=\"b52\" length=\"1.75673933277 * angstrom ** 1\" k=\"353.6530702952 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#16X2,#16X1-1:1]-[#7:2]\" id=\"b53\" length=\"1.719852084931 * angstrom ** 1\" k=\"186.0663980343 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#16X2:1]-[#8X2:2]\" id=\"b54\" length=\"1.668797717324 * angstrom ** 1\" k=\"389.1092339928 * angstrom ** -2 * kilocalorie ** 1 * mole ** -1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#16X2:1]=[#8X1,#7X2:2]\" id=\"b55\" length=\"1.5213240050039034 * angstrom ** 1\" k=\"992.5556417122765 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#16X4,#16X3!+1:1]-[#6:2]\" id=\"b56\" length=\"1.812975805996 * angstrom ** 1\" k=\"314.0415761306 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#16X4,#16X3:1]~[#7:2]\" id=\"b57\" length=\"1.717479258563 * angstrom ** 1\" k=\"351.2581324084 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#16X4,#16X3:1]~[#7X2:2]\" id=\"b57a\" length=\"1.642095752888 * angstrom ** 1\" k=\"479.5991180737 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#16X4,#16X3:1]-[#8X2:2]\" id=\"b58\" length=\"1.659164478024 * angstrom ** 1\" k=\"397.9089251091 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#16X4,#16X3:1]~[#8X1:2]\" id=\"b59\" length=\"1.46969058703 * angstrom ** 1\" k=\"1216.154559626 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#15:1]-[#1:2]\" id=\"b60\" length=\"1.4089320994682575 * angstrom ** 1\" k=\"499.55189102755895 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#15:1]~[#6:2]\" id=\"b61\" length=\"1.826927340264 * angstrom ** 1\" k=\"347.2377941457 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#15:1]-[#7:2]\" id=\"b62\" length=\"1.661591255022 * angstrom ** 1\" k=\"543.2245219816 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#15:1]=[#7:2]\" id=\"b63\" length=\"1.592080523668 * angstrom ** 1\" k=\"733.4505563743 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#15:1]~[#8X2:2]\" id=\"b64\" length=\"1.628101456213 * angstrom ** 1\" k=\"522.4575732407 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#15:1]~[#8X1:2]\" id=\"b65\" length=\"1.485498817759 * angstrom ** 1\" k=\"1310.271685059 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#16:1]-[#15:2]\" id=\"b66\" length=\"2.137200650192 * angstrom ** 1\" k=\"243.5535147648 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#15:1]=[#16X1:2]\" id=\"b67\" length=\"1.9335945395090406 * angstrom ** 1\" k=\"542.1913362393467 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6:1]-[#9:2]\" id=\"b68\" length=\"1.353671496358 * angstrom ** 1\" k=\"710.0636767657 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X4:1]-[#9:2]\" id=\"b69\" length=\"1.359259268774 * angstrom ** 1\" k=\"575.7183586585 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6:1]-[#17:2]\" id=\"b70\" length=\"1.749257102398 * angstrom ** 1\" k=\"366.3205004054 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X4:1]-[#17:2]\" id=\"b71\" length=\"1.802030789798 * angstrom ** 1\" k=\"243.3913804521 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6:1]-[#35:2]\" id=\"b72\" length=\"1.911622013876 * angstrom ** 1\" k=\"301.0104283935 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X4:1]-[#35:2]\" id=\"b73\" length=\"1.975296096024 * angstrom ** 1\" k=\"206.8718109756 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6:1]-[#53:2]\" id=\"b74\" length=\"2.198120530231 * angstrom ** 1\" k=\"72.94986778554 * angstrom ** -2 * kilocalorie ** 1 * mole ** -1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X4:1]-[#53:2]\" id=\"b75\" length=\"2.166 * angstrom ** 1\" k=\"296.0 * angstrom ** -2 * kilocalorie ** 1 * mole ** -1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#7:1]-[#9:2]\" id=\"b76\" length=\"1.45824019069 * angstrom ** 1\" k=\"454.2089733925 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#7:1]-[#17:2]\" id=\"b77\" length=\"1.788980256837101 * angstrom ** 1\" k=\"294.5006529255279 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#7:1]-[#35:2]\" id=\"b78\" length=\"1.8753894713826016 * angstrom ** 1\" k=\"322.51897014080373 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#7:1]-[#53:2]\" id=\"b79\" length=\"2.1 * angstrom ** 1\" k=\"160.0 * angstrom ** -2 * kilocalorie ** 1 * mole ** -1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#15:1]-[#9:2]\" id=\"b80\" length=\"1.64 * angstrom ** 1\" k=\"880.0 * angstrom ** -2 * kilocalorie ** 1 * mole ** -1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#15:1]-[#17:2]\" id=\"b81\" length=\"2.058924691819 * angstrom ** 1\" k=\"283.815729009 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#15:1]-[#35:2]\" id=\"b82\" length=\"2.2727694770502263 * angstrom ** 1\" k=\"232.77388221562418 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#15:1]-[#53:2]\" id=\"b83\" length=\"2.6 * angstrom ** 1\" k=\"140.0 * angstrom ** -2 * kilocalorie ** 1 * mole ** -1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X4:1]-[#1:2]\" id=\"b84\" length=\"1.093978891665 * angstrom ** 1\" k=\"715.7165017877 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X3:1]-[#1:2]\" id=\"b85\" length=\"1.085949904859 * angstrom ** 1\" k=\"772.640205351 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6X2:1]-[#1:2]\" id=\"b86\" length=\"1.070971786321 * angstrom ** 1\" k=\"932.0707186302 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#7:1]-[#1:2]\" id=\"b87\" length=\"1.01870119145 * angstrom ** 1\" k=\"962.1297531375 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#8:1]-[#1:2]\" id=\"b88\" length=\"0.9753748052379 * angstrom ** 1\" k=\"1076.782907601 * angstrom ** -2 * kilocalorie_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6:1](-[#6:2](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-91\" length=\"1.5208427891689413 * angstrom ** 1\" k=\"497.53293767438595 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6:1](-[H])(-[H])-[H:2])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-92\" length=\"1.0918573183070608 * angstrom ** 1\" k=\"741.9651349090036 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6:1](-[#6:2](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-93\" length=\"1.49519133856134 * angstrom ** 1\" k=\"430.6849447359533 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6:1](-[#6](-[H])(-[H])-[H])(-[H])-[H:2])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-94\" length=\"1.0918584595207022 * angstrom ** 1\" k=\"740.6838799766396 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6:1](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:2](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-95\" length=\"1.477680879664143 * angstrom ** 1\" k=\"407.7828986869679 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6:1](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H:2])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-96\" length=\"1.0949503278642443 * angstrom ** 1\" k=\"750.4558030195915 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:1](=[#8:2])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-97\" length=\"1.2146821336060651 * angstrom ** 1\" k=\"1536.0007524122434 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:1](=[#8])-[#7:2](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-98\" length=\"1.4008153069487617 * angstrom ** 1\" k=\"803.0393427592919 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7:1](-[#6:2]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-99\" length=\"1.4197187785170744 * angstrom ** 1\" k=\"997.8267898550689 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7:1](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H:2])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-100\" length=\"1.0229205675527235 * angstrom ** 1\" k=\"971.0917103362367 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6:1]1:[#6:2](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-101\" length=\"1.374866339786484 * angstrom ** 1\" k=\"777.7712561052119 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6:1]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7:2]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-102\" length=\"1.3341271261023253 * angstrom ** 1\" k=\"924.6498186623751 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6:1](:[#6:2](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-103\" length=\"1.3681924341122167 * angstrom ** 1\" k=\"819.4967003222578 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6:1](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H:2])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-104\" length=\"1.0840521195343937 * angstrom ** 1\" k=\"796.7992632434425 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:1](-[#7:2](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-105\" length=\"1.4020458227824957 * angstrom ** 1\" k=\"817.5505311751933 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:1](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:2](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-106\" length=\"1.3906654248066284 * angstrom ** 1\" k=\"832.9832108122494 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7:1](-[#6:2](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-107\" length=\"1.3836863937197594 * angstrom ** 1\" k=\"799.447626494647 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7:1](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H:2]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-108\" length=\"1.0173455449752844 * angstrom ** 1\" k=\"1038.6503777949404 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6:1](=[#8:2])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-109\" length=\"1.214312910184024 * angstrom ** 1\" k=\"1625.420184351204 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6:1](=[#8])-[#6:2]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-110\" length=\"1.497909606026356 * angstrom ** 1\" k=\"669.597312171532 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6:1]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6:2]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-111\" length=\"1.3557967857543811 * angstrom ** 1\" k=\"674.9625562311619 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6:1]:2-[#17:2])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-112\" length=\"1.7283754755631533 * angstrom ** 1\" k=\"495.9994237012452 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6:1](:[#6:2]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-113\" length=\"1.3667444610760813 * angstrom ** 1\" k=\"748.1295779809343 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6:1](:[#6:2](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-114\" length=\"1.373610407408978 * angstrom ** 1\" k=\"776.3804941769781 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6:1](:[#6]:2-[#17])-[H:2])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-115\" length=\"1.0822056119944796 * angstrom ** 1\" k=\"780.229759565817 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6:1](:[#6](:[#6]:2-[#17])-[H])-[H:2])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-116\" length=\"1.0770408107492557 * angstrom ** 1\" k=\"795.054113404625 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:1](:[#6:2](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-117\" length=\"1.3883875954653069 * angstrom ** 1\" k=\"787.47287463105 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:1](:[#6](:[#7]:1)-[H])-[H:2])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-118\" length=\"1.0854719167960736 * angstrom ** 1\" k=\"816.0891389709924 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6:1](:[#7:2]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-119\" length=\"1.3267819265420582 * angstrom ** 1\" k=\"838.8357267135502 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n        &lt;Bond smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6:1](:[#7]:1)-[H:2])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" id=\"l-bespoke-120\" length=\"1.0860253229507457 * angstrom ** 1\" k=\"775.5049182621947 * angstrom ** -2 * kilocalories_per_mole ** 1\"&gt;&lt;/Bond&gt;\n    &lt;/Bonds&gt;\n    &lt;Angles version=\"0.3\" potential=\"harmonic\"&gt;\n        &lt;Angle smirks=\"[*:1]~[#6X4:2]-[*:3]\" angle=\"109.9409749899 * degree ** 1\" k=\"133.6712195099 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a1\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#1:1]-[#6X4:2]-[#1:3]\" angle=\"108.3393844197 * degree ** 1\" k=\"73.3314112398 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a2\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*;r3:1]~;@[*;r3:2]~;!@[*:3]\" angle=\"117.4645323996 * degree ** 1\" k=\"115.755119696 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a4\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]~;!@[*;r3:2]~;!@[*:3]\" angle=\"115.0031312625 * degree ** 1\" k=\"148.6559718216 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a5\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#1:1]-[*;r3:2]~;!@[*:3]\" angle=\"115.1247188664 * degree ** 1\" k=\"55.70368633511 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a6\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6r4:1]-;@[#6r4:2]-;@[#6r4:3]\" angle=\"87.45923658469 * degree ** 1\" k=\"141.9439126263 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a7\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[!#1:1]-[#6r4:2]-;!@[!#1:3]\" angle=\"115.1603878581 * degree ** 1\" k=\"212.4788650455 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a8\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[!#1:1]-[#6r4:2]-;!@[#1:3]\" angle=\"113.7918134778 * degree ** 1\" k=\"115.4078393137 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a9\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]~[#6X3:2]~[*:3]\" angle=\"120.0864229254 * degree ** 1\" k=\"168.9220072776 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a10\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#1:1]-[#6X3:2]~[*:3]\" angle=\"119.8419459819 * degree ** 1\" k=\"65.2711960365 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a11\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#1:1]-[#6X3:2]-[#1:3]\" angle=\"117.6925665072 * degree ** 1\" k=\"43.38420697605 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a12\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*;r6:1]~;@[*;r5:2]~;@[*;r5;x2:3]\" angle=\"129.7027392435 * degree ** 1\" k=\"153.6919735998 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a13\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*;r6:1]~;@[*;r5;x4,*;r5;X4:2]~;@[*;r5;x2:3]\" angle=\"110.8116806056 * degree ** 1\" k=\"224.8121192281 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a13a\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]~;!@[*;X3;r5:2]~;@[*;r5:3]\" angle=\"124.7959315209 * degree ** 1\" k=\"101.2893818769 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a14\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#8X1:1]~[#6X3:2]~[#8:3]\" angle=\"123.6096806963 * degree ** 1\" k=\"126.6359553969 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a15\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]~[#6X2:2]~[*:3]\" angle=\"180.0 * degree ** 1\" k=\"99.58650888903 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a16\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]~[#7X2:2]~[*:3]\" angle=\"180.0 * degree ** 1\" k=\"89.96041175564783 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a17\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]~[#7X4,#7X3,#7X2-1:2]~[*:3]\" angle=\"113.2222214534 * degree ** 1\" k=\"248.3375519249 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a18\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]@-[r!r6;#7X4,#7X3,#7X2-1:2]@-[*:3]\" angle=\"95.20784214321 * degree ** 1\" k=\"198.0099332767 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a18a\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#1:1]-[#7X4,#7X3,#7X2-1:2]-[*:3]\" angle=\"109.2619847249 * degree ** 1\" k=\"107.9142540145 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a19\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]~[#7X3$(*~[#6X3,#6X2,#7X2+0]):2]~[*:3]\" angle=\"120.4676583223 * degree ** 1\" k=\"157.1195378369 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a20\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#1:1]-[#7X3$(*~[#6X3,#6X2,#7X2+0]):2]-[*:3]\" angle=\"118.0595097829 * degree ** 1\" k=\"74.21496242199 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a21\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]~[#7X2+0:2]~[*:3]\" angle=\"117.903841381 * degree ** 1\" k=\"289.9671007376 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a22\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]~[#7X2+0:2]~[#6X2:3](~[#16X1])\" angle=\"144.3131705527 * degree ** 1\" k=\"150.397683946 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a23\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#1:1]-[#7X2+0:2]~[*:3]\" angle=\"111.6183669797 * degree ** 1\" k=\"104.8179076935 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a24\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6,#7,#8:1]-[#7X3:2](~[#8X1])~[#8X1:3]\" angle=\"117.5704264709 * degree ** 1\" k=\"145.0343595181 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a25\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#8X1:1]~[#7X3:2]~[#8X1:3]\" angle=\"124.456980397 * degree ** 1\" k=\"140.3492233289 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a26\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]~[#7X2:2]~[#7X1:3]\" angle=\"180.0 * degree ** 1\" k=\"117.5666837972 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a27\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]-[#8:2]-[*:3]\" angle=\"112.856828381 * degree ** 1\" k=\"240.1667492914 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a28\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6X3,#7:1]~;@[#8;r:2]~;@[#6X3,#7:3]\" angle=\"109.8714055684 * degree ** 1\" k=\"329.9819058346 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a29\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]-[#8X2+1:2]=[*:3]\" angle=\"122.99227453817346 * degree ** 1\" k=\"323.7005670962272 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a30\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]~[#16X4:2]~[*:3]\" angle=\"120.4697998809 * degree ** 1\" k=\"188.6313595891 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a31\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]-[#16X4,#16X3+0:2]~[*:3]\" angle=\"107.212321927 * degree ** 1\" k=\"239.2023677282 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a32\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]~[#16X3$(*~[#8X1,#7X2]):2]~[*:3]\" angle=\"102.2019975106 * degree ** 1\" k=\"261.1458200111 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a33\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]~[#16X2,#16X3+1:2]~[*:3]\" angle=\"98.30940413757 * degree ** 1\" k=\"277.9243276376 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a34\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]=[#16X2:2]=[*:3]\" angle=\"180.0 * degree ** 1\" k=\"140.0 * kilocalorie ** 1 * mole ** -1 * radian ** -2\" id=\"a35\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]=[#16X2:2]=[#8:3]\" angle=\"112.6164646730111 * degree ** 1\" k=\"259.32893235640387 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a36\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6X3:1]-[#16X2:2]-[#6X3:3]\" angle=\"91.29240819333 * degree ** 1\" k=\"217.9549363893 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a37\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6X3:1]-[#16X2:2]-[#6X4:3]\" angle=\"101.8502222373 * degree ** 1\" k=\"350.2066166388 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a38\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6X3:1]-[#16X2:2]-[#1:3]\" angle=\"94.63983748334 * degree ** 1\" k=\"170.9519157743 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a39\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*:1]~[#15:2]~[*:3]\" angle=\"108.9068195211 * degree ** 1\" k=\"179.6718229837 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a40\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*;r5:1]1@[*;r5:2]@[*;r5:3]@[*;r5]@[*;r5]1\" angle=\"108.1330922927 * degree ** 1\" k=\"181.7481750351 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a41\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*;r5:1]1@[#16;r5:2]@[*;r5:3]@[*;r5]@[*;r5]1\" angle=\"90.69637664455 * degree ** 1\" k=\"298.9224379032 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a41a\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[*;r3:1]1~;@[*;r3:2]~;@[*;r3:3]1\" angle=\"59.99607663684 * degree ** 1\" k=\"111.0172352534 * kilocalorie_per_mole ** 1 * radian ** -2\" id=\"a3\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6:1](-[#6:2](-[#6:3](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"1.9166722178336082 * radian ** 1\" k=\"99.16733778321097 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-45\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6:2](-[#6:1](-[H])(-[H])-[H])(-[H])-[H:3])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"1.933860282942973 * radian ** 1\" k=\"98.68560120189079 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-46\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6:1](-[#6:2](-[H])(-[H])-[H:3])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"1.8219622946520209 * radian ** 1\" k=\"93.21953736778028 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-47\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6:1](-[#6:2](-[#6:3](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.0654431407351472 * radian ** 1\" k=\"120.20016006187379 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-48\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6:2](-[#6:1](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:3](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.012174528368001 * radian ** 1\" k=\"94.09184555786496 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-49\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6:2](-[#6:1](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H:3])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.1066211676261233 * radian ** 1\" k=\"79.89029824506842 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-50\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6:1](-[#6:2](-[#6](-[H])(-[H])-[H])(-[H])-[H:3])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"1.880838561567719 * radian ** 1\" k=\"80.451807756376 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-51\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6:1](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:2](=[#8:3])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.5714419595213966 * radian ** 1\" k=\"113.35070918069688 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-52\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6:1](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:2](=[#8])-[#7:3](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.3805897097693216 * radian ** 1\" k=\"125.07281866613349 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-53\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6:2](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:1](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H:3])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.138796231230111 * radian ** 1\" k=\"60.3007035985963 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-54\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:1](=[#8])-[#7:2](-[#6:3]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.078962463026661 * radian ** 1\" k=\"109.59394550157788 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-55\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:1](=[#8])-[#7:2](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H:3])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.069888301738732 * radian ** 1\" k=\"79.52952292227499 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-56\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:2](=[#8:1])-[#7:3](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.3773977560486337 * radian ** 1\" k=\"205.17140150356727 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-57\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7:1](-[#6:2]1:[#6:3](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.3806029249932337 * radian ** 1\" k=\"114.7228772976854 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-58\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7:1](-[#6:2]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7:3]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.25544221361981 * radian ** 1\" k=\"196.50416988683543 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-59\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7:2](-[#6:1]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H:3])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.0525023372708993 * radian ** 1\" k=\"90.29873495152901 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-60\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6:1]1:[#6:2](:[#6:3](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"1.7025278748130577 * radian ** 1\" k=\"92.4547269345372 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-61\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6:1]1:[#6:2](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H:3])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.070279893645297 * radian ** 1\" k=\"68.28645341172921 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-62\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6:1]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6:3](:[#7:2]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"1.9631835189336158 * radian ** 1\" k=\"100.30904098197067 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-63\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6:2]1:[#6:1](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7:3]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.301826811405087 * radian ** 1\" k=\"121.3404467419991 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-64\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6:1](:[#6:2](-[#7:3](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.2567244223497847 * radian ** 1\" k=\"130.93723884801682 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-65\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6:1](:[#6:2](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:3](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.187388708205121 * radian ** 1\" k=\"77.17135826238176 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-66\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6:2](:[#6:1](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H:3])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.0332132720399962 * radian ** 1\" k=\"69.9000326592039 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-67\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:1](-[#7:2](-[#6:3](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.0630176944030145 * radian ** 1\" k=\"102.78029329452963 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-68\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:1](-[#7:2](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H:3]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.0391839136295866 * radian ** 1\" k=\"75.55694981896592 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-69\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:1](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:2](:[#6:3](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.0300191233810554 * radian ** 1\" k=\"128.09710586120866 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-70\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:1](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:2](:[#6](:[#7]:1)-[H])-[H:3])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.0216426896287323 * radian ** 1\" k=\"58.29301531823134 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-71\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:2](-[#7:1](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:3](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.27310551561954 * radian ** 1\" k=\"120.9506648327752 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-72\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7:1](-[#6:2](=[#8:3])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.4259475615750454 * radian ** 1\" k=\"187.27900128861782 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-73\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7:1](-[#6:2](=[#8])-[#6:3]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.4888316720614276 * radian ** 1\" k=\"102.89120669930664 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-74\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7:2](-[#6:1](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H:3]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.0869175283826187 * radian ** 1\" k=\"87.4301287172865 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-75\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6:1](=[#8])-[#6:2]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6:3]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.1617310348223877 * radian ** 1\" k=\"77.68665876959399 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-76\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6:2](=[#8:1])-[#6:3]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.6098915932177618 * radian ** 1\" k=\"107.32464985078505 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-77\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6:1]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6:2]:2-[#17:3])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.1275018622241104 * radian ** 1\" k=\"93.52187845400822 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-78\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6:1]2:[#6](-[#17]):[#6](:[#6](:[#6:3](:[#6:2]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.1597157120273676 * radian ** 1\" k=\"128.65708772564574 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-79\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6:2]2:[#6:1](-[#17]):[#6](:[#6](:[#6](:[#6:3]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.0223932771502486 * radian ** 1\" k=\"61.057595398199794 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-80\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6:1](:[#6:2](:[#6:3]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.0612383793345517 * radian ** 1\" k=\"109.0112394802704 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-81\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6:2](:[#6:1]:2-[#17])-[H:3])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.0704940887099434 * radian ** 1\" k=\"69.22779185245761 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-82\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6:1](:[#6:2]:2-[#17:3])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.1909116191607563 * radian ** 1\" k=\"97.95404832913428 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-83\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6:1](:[#6:2](:[#6:3](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.1620240617367106 * radian ** 1\" k=\"106.08956802489362 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-84\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6:2](:[#6:1](:[#6]:2-[#17])-[H])-[H:3])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.097526472958004 * radian ** 1\" k=\"62.86593430684678 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-85\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6:1](:[#6:2](:[#6]:2-[#17])-[H:3])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.094139417750624 * radian ** 1\" k=\"72.10784789325234 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-86\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:1](:[#6:2](:[#7:3]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.331172419762513 * radian ** 1\" k=\"147.60886655221765 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-87\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:1](:[#6:2](:[#7]:1)-[H:3])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.5609494189974837 * radian ** 1\" k=\"37.80070618791597 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-88\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:2](:[#6:1](:[#7]:1)-[H])-[H:3])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.0845754102423966 * radian ** 1\" k=\"80.98403011714419 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-89\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6:2](:[#7:1]:1)-[H:3])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"2.191982611393868 * radian ** 1\" k=\"100.2054800037505 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-90\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6](-[#6:2](-[H])(-[H:1])-[H:3])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"1.7838962164755128 * radian ** 1\" k=\"87.45042951640174 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-91\"&gt;&lt;/Angle&gt;\n        &lt;Angle smirks=\"[#6](-[#6](-[#6](-[#6:2](-[#6](-[H])(-[H])-[H])(-[H:1])-[H:3])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" angle=\"1.9042137565667157 * radian ** 1\" k=\"68.58454079318203 * kilocalories_per_mole ** 1 * radian ** -2\" id=\"l-bespoke-92\"&gt;&lt;/Angle&gt;\n    &lt;/Angles&gt;\n    &lt;ProperTorsions version=\"0.4\" potential=\"k*(1+cos(periodicity*theta-phase))\" default_idivf=\"auto\" fractional_bondorder_method=\"AM1-Wiberg\" fractional_bondorder_interpolation=\"linear\"&gt;\n        &lt;Proper smirks=\"[*:1]-[#6X4:2]-[#6X4:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t1\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.1467399161891 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4:1]-[#6X4:2]-[#6X4:3]-[#6X4:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"180.0 * degree ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t2\" k1=\"0.974718587694 * kilocalorie ** 1 * mole ** -1\" k2=\"0.2203586562011 * kilocalorie ** 1 * mole ** -1\" k3=\"0.4237564743837 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#6X4:2]-[#6X4:3]-[#1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t3\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.2390393844711 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#6X4:2]-[#6X4:3]-[#6X4:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t4\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.08874370745149 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#8X2:1]-[#6X4:2]-[#6X4:3]-[#8X2:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t5\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.4214443354415 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.05405491043661 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#9:1]-[#6X4:2]-[#6X4:3]-[#9:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"180.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t6\" k1=\"-0.1944147116906 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.07205453448199 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#17:1]-[#6X4:2]-[#6X4:3]-[#17:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"180.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t7\" k1=\"-1.407167649148 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.6312732883552 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#35:1]-[#6X4:2]-[#6X4:3]-[#35:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"180.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t8\" k1=\"-0.1058809959451 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"1.078052395108 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#6X4:2]-[#6X4:3]-[#8X2:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t9\" k1=\"0.4985440816151 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.1455721298031 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#6X4:2]-[#6X4:3]-[#9:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t10\" k1=\"0.4538593748781 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.09388647854437 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#6X4:2]-[#6X4:3]-[#17:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t11\" k1=\"0.7325729971954 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.2373106241921 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#6X4:2]-[#6X4:3]-[#35:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t12\" k1=\"0.6076851605113 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.1338552866344 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#6X4:2]-[#6X4;r3:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t13\" k1=\"1.727703981075 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#6X4:2]-[#6X4;r3:3]-[#6X4;r3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t14\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.4337956418471 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#6X4;r3:2]-@[#6X4;r3:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t15\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"-2.743657257903 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4;r3:1]-[#6X4;r3:2]-[#6X4;r3:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t16\" k1=\"4.680796911719 * kilocalorie ** 1 * mole ** -1\" k2=\"-0.5830842991582 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#6X3:2]-[#6X4:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t17\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.2172538452775 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#6X4:2]-[#6X3:3]=[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t18\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"-0.458957400131 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#6X4:2]-[#6X3:3](~[#8X1])~[#8X1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t18a\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"-0.2045307565273 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#6X4:2]-[#6X3:3](~!@[#7X3])~!@[#7X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t18b\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"-0.1892404337724 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#6X4:2]-[#6X3:3]=[#8X1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"180.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t19\" k1=\"0.9319055975451 * kilocalorie ** 1 * mole ** -1\" k2=\"0.1982282188714 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.2165628209811 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#6X4:2]-[#6X3:3](~[#8X1])~[#8X1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"180.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t19a\" k1=\"-0.05752542044084 * kilocalorie ** 1 * mole ** -1\" k2=\"0.3423737582396 * kilocalorie ** 1 * mole ** -1\" k3=\"0.2544090180879 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#6X4:2]-[#6X3:3]=[#6X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"180.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t20\" k1=\"0.1842433198158 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.2427642411458 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X3:1]-[#6X4:2]-[#6X3:3]=[#6X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t21\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.521473125288 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.1504047723934 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#7X3:1]-[#6X4:2]-[#6X3:3]-[#7X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"180.0 * degree ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t22\" k1=\"-0.4432924282192 * kilocalorie ** 1 * mole ** -1\" k2=\"0.5490193236155 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4:1]-[#6X4:2]-[#6X3:3]-[#7X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0.0 * degree ** 1\" id=\"t23\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.2922622555403 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"-0.2953560374034 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#16X2,#16X1-1,#16X3+1:1]-[#6X3:2]-[#6X4:3]-[#1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"180.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t24\" k1=\"-0.2621083460452 * kilocalorie ** 1 * mole ** -1\" k2=\"-0.5992596150141 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#16X2,#16X1-1,#16X3+1:1]-[#6X3:2]-[#6X4:3]-[#7X4,#7X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"90.0 * degree ** 1\" phase2=\"270.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0.0 * degree ** 1\" id=\"t25\" k1=\"0.08677135962882 * kilocalorie ** 1 * mole ** -1\" k2=\"-0.01509680569559 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.3167708487189 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.171379176833 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#16X2,#16X1-1,#16X3+1:1]-[#6X3:2]-[#6X4:3]-[#7X3$(*-[#6X3,#6X2]):4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"270.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"270.0 * degree ** 1\" id=\"t26\" k1=\"-0.5786050420045 * kilocalorie ** 1 * mole ** -1\" k2=\"-0.1269241749199 * kilocalorie ** 1 * mole ** -1\" k3=\"0.02664064679363 * kilocalorie ** 1 * mole ** -1\" k4=\"0.1360690138462 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#6X4;r3:2]-[#6X3:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t27\" k1=\"0.4134198149477 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4:1]-[#6X4;r3:2]-[#6X3:3]~[#6X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"180.0 * degree ** 1\" id=\"t28\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.2563173689727 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0.4512391940713 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#6X4;r3:2]-[#6X3:3]~[#6X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"180.0 * degree ** 1\" id=\"t29\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"-0.16488194551 * kilocalorie ** 1 * mole ** -1\" k3=\"0.3077078974926 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.0500170614962 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X3:1]-[#6X4;r3:2]-[#6X3:3]-[#7X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"180.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"180.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t30\" k1=\"0.7214198085497 * kilocalorie ** 1 * mole ** -1\" k2=\"-0.4094047131311 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.4213069561783 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X3:1]-[#6X4;r3:2]-[#6X3:3]=[#8X1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"180.0 * degree ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"180.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t31\" k1=\"-0.6692050196481 * kilocalorie ** 1 * mole ** -1\" k2=\"1.161323035335 * kilocalorie ** 1 * mole ** -1\" k3=\"0.1058359374968 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X3:1]-[#6X4;r3:2]-[#6X3:3](~[#8X1])~[#8X1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"180.0 * degree ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"180.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t31a\" k1=\"-0.2242716785779 * kilocalorie ** 1 * mole ** -1\" k2=\"1.750120740459 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.08363610532366 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X3:1]-[#6X4;r3:2]-[#6X3:3]~[#6X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t32\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"-0.3445890122686 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#7X3:1]-[#6X4;r3:2]-[#6X3:3]~[#6X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"180.0 * degree ** 1\" id=\"t33\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"-0.3465174030848 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0.01273693857497 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4;r3:1]-;@[#6X4;r3:2]-[#6X3:3]~[#6X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"180.0 * degree ** 1\" id=\"t34\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"2.385349292774 * kilocalorie ** 1 * mole ** -1\" k3=\"-2.704706112512 * kilocalorie ** 1 * mole ** -1\" k4=\"0.3014218214697 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4;r3:1]-;@[#6X4;r3:2]-[#6X3;r6:3]:[#6X3;r6:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"180.0 * degree ** 1\" id=\"t35\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"1.526629433773 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"-0.01920059625467 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4;r3:1]-;@[#6X4;r3:2]-[#6X3;r5:3]-;@[#6X3;r5:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"180.0 * degree ** 1\" id=\"t36\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"2.340333055016 * kilocalorie ** 1 * mole ** -1\" k3=\"0.1424805506777 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.1548168935136 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4;r3:1]-;@[#6X4;r3:2]-[#6X3;r5:3]=;@[#6X3;r5:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"180.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t37\" k1=\"-0.364980636622 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4;r3:1]-;@[#6X4;r3:2]-[#6X3:3]-[#6X4:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t38\" k1=\"0.3474755640308 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4;r3:1]-;@[#6X4;r3:2]-[#6X3;r6:3]:[#7X2;r6:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"180.0 * degree ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t39\" k1=\"-0.4617422436786 * kilocalorie ** 1 * mole ** -1\" k2=\"2.136344812247 * kilocalorie ** 1 * mole ** -1\" k3=\"1.33682752389 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4;r3:1]-;@[#6X4;r3:2]-[#6X3:3]=[#7X2:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"180.0 * degree ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t40\" k1=\"-0.1027539401485 * kilocalorie ** 1 * mole ** -1\" k2=\"1.359979671884 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.872028150864 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4;r3:1]-;@[#6X4;r3:2]-[#6X3:3]-[#8X2:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"180.0 * degree ** 1\" id=\"t41\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"2.487261872336 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"-0.1427323289764 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4;r3:1]-;@[#6X4;r3:2]-[#6X3:3]=[#8X1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"320.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t42\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"-1.015985857683 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4;r3:1]-;@[#6X4;r3:2]-[#6X3:3](~[#8X1])~[#8X1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"320.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t42a\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"-0.4800223586904 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#6X3:2]-[#6X3:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t43\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"1.231905212431 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#6X3:2]:[#6X3:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t44\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"3.256398059414 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-,:[#6X3:2]=[#6X3:3]-,:[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t45\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"4.702324631505 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4:1]-[#6X3:2]=[#6X3:3]-[#6X4:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"180.0 * degree ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t46\" k1=\"-0.4171138742327 * kilocalorie ** 1 * mole ** -1\" k2=\"3.154324713915 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#6X3:2]-[#6X3$(*=[#8,#16,#7]):3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t47\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"1.063397665307 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X3:1]=[#6X3:2]-[#6X3:3]=[#8X1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t48\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"1.08608645122 * kilocalorie ** 1 * mole ** -1\" k3=\"0.6483737581119 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X3:1]=[#6X3:2]-[#6X3:3](~[#8X1])~[#8X1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t48a\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"-0.02403160784339 * kilocalorie ** 1 * mole ** -1\" k3=\"-1.083518405649 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#7a:2]:[#6a:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t49\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"4.305064155732 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#6X4:2]-[#7X4:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t50\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.1138888511889 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#6X4:2]-[#7X3:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t51\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.2943336584371 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#6X4:2]-[#7X3:3]-[#7X2:4]=[#6]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t52\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"-0.1873124540484 * kilocalorie ** 1 * mole ** -1\" k3=\"0.6335819847001 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#6X4:2]-[#7X3:3]-[#7X2:4]=[#6]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t53\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"-0.1854722762802 * kilocalorie ** 1 * mole ** -1\" k3=\"0.3708303970484 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#6X4:2]-[#7X3:3]-[#7X2:4]=[#7X2,#8X1]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t54\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"3.75082282135 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.4669934768519 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#6X4:2]-[#7X3:3]-[#7X2:4]=[#7X2,#8X1]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t55\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"4.587295758254 * kilocalorie ** 1 * mole ** -1\" k3=\"0.2344335149572 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#6X4:2]-[#7X3$(*@1-[*]=,:[*][*]=,:[*]@1):3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t56\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.5295359263247 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#6X4:2]-[#7X3$(*@1-[*]=,:[*][*]=,:[*]@1):3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t57\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.8606274134144 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4:1]-[#6X4:2]-[#7X4,#7X3:3]-[#6X4:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t58\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.2939247547072 * kilocalorie ** 1 * mole ** -1\" k3=\"0.09553382524722 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#7X4,#7X3:2]-[#6X4;r3:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t59\" k1=\"-1.365053924335 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#7X4,#7X3:2]-[#6X4;r3:3]-[#6X4;r3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t60\" k1=\"-0.0776789535402 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[!#1:1]-[#7X4,#7X3:2]-[#6X4;r3:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t61\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.3753597656431 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[!#1:1]-[#7X4,#7X3:2]-[#6X4;r3:3]-[#6X4;r3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t62\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"1.296375832192 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#7X4:2]-[#6X3:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t63\" k1=\"-0.003530437907433 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#6X4:2]-[#7X3$(*~[#6X3,#6X2]):3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t64\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.3596352002927 * kilocalorie ** 1 * mole ** -1\" k3=\"0.24966967007 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#6X4:2]-[#7X3:3](~[#8X1])~[#8X1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t65\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.09656685196282 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X3:1]-[#7X3:2]-[#6X4:3]-[#6X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t66\" k1=\"-0.6022313899026 * kilocalorie ** 1 * mole ** -1\" k2=\"-0.5241175382977 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4:1]-[#6X4:2]-[#7X3:3]-[#6X3:4]=[#8,#16,#7]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"180.0 * degree ** 1\" phase4=\"180.0 * degree ** 1\" id=\"t67\" k1=\"-0.1803815891159 * kilocalorie ** 1 * mole ** -1\" k2=\"0.8072102868649 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.2257619710209 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.08321356408489 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#8X2H0:1]-[#6X4:2]-[#7X3:3]-[#6X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t68\" k1=\"-0.8009301549922 * kilocalorie ** 1 * mole ** -1\" k2=\"1.937875720444 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X3:1]-[#7X3:2]-[#6X4;r3:3]-[#6X4;r3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t69\" k1=\"-1.077852934106 * kilocalorie ** 1 * mole ** -1\" k2=\"-1.23962493815 * kilocalorie ** 1 * mole ** -1\" k3=\"0.515146511797 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#7X2:2]-[#6X4:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t70\" k1=\"-0.5548578488879 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X3:1]=[#7X2,#7X3+1:2]-[#6X4:3]-[#1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t71\" k1=\"1.619592684103 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X3:1]=[#7X2,#7X3+1:2]-[#6X4:3]-[#6X3,#6X4:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t72\" k1=\"1.157564484198 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#7X3,#7X2-1:2]-[#6X3:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t73\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.7020804385738 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#7X3,#7X2-1:2]-!@[#6X3:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t74\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"1.422178506497 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#7X3:2]-[#6X3$(*=[#8,#16,#7]):3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t75\" k1=\"0.2423731897886 * kilocalorie ** 1 * mole ** -1\" k2=\"2.101471983363 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#7X3:2]-[#6X3:3]=[#8,#16,#7:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t76\" k1=\"1.312929690468 * kilocalorie ** 1 * mole ** -1\" k2=\"0.5920226923079 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#7X3:2]-!@[#6X3:3](=[#8,#16,#7:4])-[#6,#1]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t77\" k1=\"-0.4278560639972 * kilocalorie ** 1 * mole ** -1\" k2=\"2.441584414666 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#7X3:2]-!@[#6X3:3](=[#8,#16,#7:4])-[#6,#1]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t78\" k1=\"1.22511756632 * kilocalorie ** 1 * mole ** -1\" k2=\"1.295051102073 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#7X3:2]-!@[#6X3:3](=[#8,#16,#7:4])-[#7X3]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t79\" k1=\"0.8021641912182 * kilocalorie ** 1 * mole ** -1\" k2=\"1.106519495361 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#7X3;r5:2]-@[#6X3;r5:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t80\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"1.46856866731 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#8X1:1]~[#7X3:2]~[#6X3:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t81\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.4873119328207 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]=[#7X2,#7X3+1:2]-[#6X3:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t82\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"1.322804323788 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#6X3:2]-[#7X3:3](~[#8X1])~[#8X1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t82a\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.5001873969382 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]=[#7X2,#7X3+1:2]-[#6X3:3]=,:[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t83\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"1.387438862095 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]=,:[#6X3:2]-[#7X3:3](~[#8X1])~[#8X1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t83a\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"1.222121095925 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#7X2,#7X3$(*~[#8X1]):2]:[#6X3:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t84\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"2.340176728369 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X3:1]:[#7X2:2]:[#6X3:3]:[#6X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t85\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"5.590150698229 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-,:[#6X3:2]=[#7X2:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t86\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"8.052532732388 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#7X3+1:2]=,:[#6X3:3]-,:[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t87\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.8299171613339 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#7X3:2]~!@[#6X3:3](~!@[#7X3])~!@[#7X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t87a\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.809728596164 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#16X4,#16X3+0:1]-[#7X2:2]=[#6X3:3]-[#7X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t88\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"3.120029548599 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#16X4,#16X3+0:1]-[#7X2:2]=[#6X3:3]-[#16X2,#16X3+1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t89\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"3.602517565373 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#7X2:1]~[#7X2:2]-[#6X3:3]~[#6X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t90\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"2.02382092346 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#7X2:1]~[#7X2:2]-[#6X4:3]-[#6X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t91\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.4665728894532 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#7X2:1]~[#7X2:2]-[#6X4:3]~[#1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t92\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.4281195677846 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#6X4:2]-[#8X2:3]-[#1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t93\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"1.165193199114 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4:1]-[#6X4:2]-[#8X2H1:3]-[#1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t94\" k1=\"0.07126826475543 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.3984298290561 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#6X4:2]-[#8X2H0:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t95\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.7833226817578 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4:1]-[#6X4:2]-[#8X2H0:3]-[#6X4:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t96\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"-0.2917448244512 * kilocalorie ** 1 * mole ** -1\" k3=\"0.3902473626473 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4:1]-[#6X4:2]-[#8X2:3]-[#6X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"180.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t97\" k1=\"0.4372168266156 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.1346538071654 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4:1]-[#8X2:2]-[#6X4:3]-[#8X2:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"180.0 * degree ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t98\" k1=\"1.455760428617 * kilocalorie ** 1 * mole ** -1\" k2=\"0.5144735124296 * kilocalorie ** 1 * mole ** -1\" k3=\"0.1720285728221 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4:1]-[#8X2:2]-[#6X4:3]-[#7X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t99\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.4820644117625 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.08734386725638 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X3:1]-[#8X2:2]-[#6X4;r3:3]-@[#6X4;r3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t100\" k1=\"-1.811036800932 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X3:1]-[#8X2:2]-[#6X4;r3:3]-[#1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t101\" k1=\"-0.6734456899116 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#8X2:2]-[#6X4;r3:3]-[#1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t102\" k1=\"-0.2704273158186 * kilocalorie ** 1 * mole ** -1\" k2=\"0.04084162764025 * kilocalorie ** 1 * mole ** -1\" k3=\"0.4443053052505 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#8X2:2]-[#6X4;r3:3]-[#6X4:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t103\" k1=\"-0.46617693814 * kilocalorie ** 1 * mole ** -1\" k2=\"0.1013618113511 * kilocalorie ** 1 * mole ** -1\" k3=\"0.3743780733305 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#8X2:2]-[#6X4;r3:3]-[#6X4;r3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t104\" k1=\"-0.03646242852479 * kilocalorie ** 1 * mole ** -1\" k2=\"0.7616471343345 * kilocalorie ** 1 * mole ** -1\" k3=\"0.5601057121621 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#6X3:2]-[#8X2:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t105\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"1.571728744014 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#6X3:2]-[#8X2:3]-[#1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t106\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.9755785543418 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#6X3:2](=[#8,#16,#7])-[#8X2H0:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t107\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"3.579069909181 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#6X3:2](=[#8,#16,#7])-[#8:3]-[#1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t108\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"3.272712880983 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#8X2:2]-[#6X3:3]=[#8X1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t109\" k1=\"-0.3011060519329 * kilocalorie ** 1 * mole ** -1\" k2=\"2.710248893329 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#8,#16,#7:1]=[#6X3:2]-[#8X2H0:3]-[#6X4:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"180.0 * degree ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t110\" k1=\"1.304587134716 * kilocalorie ** 1 * mole ** -1\" k2=\"0.3963474597739 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#8X2:2]@[#6X3:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t111\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"1.829944959542 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#8X2+1:2]=[#6X3:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t112\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"7.917885966353 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]=[#8X2+1:2]-[#6:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t113\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.7350725741438 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#16:2]=,:[#6:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t114\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"-1.975848663415 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#16X2,#16X3+1:2]-[#6:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t115\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.3876819783286 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#16X2,#16X3+1:2]-[#6:3]-[#1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t116\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.4242182416678 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X3:1]-@[#16X2,#16X1-1,#16X3+1:2]-@[#6X3,#7X2;r5:3]=@[#6,#7;r5:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t117\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"8.980846475502 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#16X4,#16X3!+1:2]-[#6X4:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t118\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.2158853032989 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4:1]-[#16X4,#16X3+0:2]-[#6X4:3]-[#1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t119\" k1=\"-0.507132568442 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4:1]-[#16X4,#16X3+0:2]-[#6X4:3]~[#6X4:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t120\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"-0.1734534834063 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#16X4,#16X3+0:2]-[#6X3:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t121\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.3834960954121 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6:1]-[#16X4,#16X3+0:2]-[#6X3:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t122\" k1=\"0.5726575440705 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#15:2]-[#6X4:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t123a\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.1088195712635 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#15:2]-[#6X3:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t124\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"-2.191711783171 * kilocalorie ** 1 * mole ** -1\" k3=\"0.1920970820304 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#8:2]-[#8:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t125\" k1=\"2.070178120879 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#8:2]-[#8H1:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t126\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.9161192279719 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#8X2:2]-[#7:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t127\" k1=\"1.822277472367 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#8X2r5:2]-;@[#7X3r5:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t128\" k1=\"1.122808273354 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#8X2r5:2]-;@[#7X2r5:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t129\" k1=\"-19.9078720572 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#7X4,#7X3:2]-[#7X4,#7X3:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t130\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.7910784751852 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#1:1]-[#7X4,#7X3:2]-[#7X4,#7X3:3]-[#1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t131\" k1=\"0.3786985540616 * kilocalorie ** 1 * mole ** -1\" k2=\"0.6523687384077 * kilocalorie ** 1 * mole ** -1\" k3=\"0.02968882805477 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4:1]-[#7X4,#7X3:2]-[#7X4,#7X3:3]-[#1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t132\" k1=\"0.597648202619 * kilocalorie ** 1 * mole ** -1\" k2=\"0.2965141749644 * kilocalorie ** 1 * mole ** -1\" k3=\"0.3785391707946 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4:1]-[#7X4,#7X3:2]-[#7X4,#7X3:3]-[#6X4:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t133\" k1=\"0.7213563362058 * kilocalorie ** 1 * mole ** -1\" k2=\"0.3794029937248 * kilocalorie ** 1 * mole ** -1\" k3=\"0.04642650261749 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#7X4,#7X3:2]-[#7X3$(*~[#6X3,#6X2]):3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t134\" k1=\"-1.150675339358 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#7X3$(*-[#6X3,#6X2]):2]-[#7X3$(*-[#6X3,#6X2]):3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t135\" k1=\"-0.6805263211889 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#7X3$(*-[#6X3,#6X2])r5:2]-@[#7X3$(*-[#6X3,#6X2])r5:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t136\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"-0.5788847327104 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]@[#7X2:2]@[#7X2:3]@[#7X2,#6X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"180.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t137\" k1=\"4.605325210702 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#7X2:2]-[#7X3:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t138\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"2.08903784642 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.4621193109757 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#7X2:2]-[#7X4:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t138a\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"1.554435554256 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.09510851427019 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]=[#7X2:2]-[#7X2:3]=[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t139\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"4.45460236475 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#7X2:2]=,:[#7X2:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t140\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"15.78931647465 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#7X3+1:2]=,:[#7X2:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t141\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"10.57958597957 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#7x3:2]-[#7x3,#6x3:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t141a\" k1=\"-3.906902709944 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#7x2:2]-[#7x3:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t141b\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0.5022068651646 * kilocalorie ** 1 * mole ** -1\" k3=\"1.114119889873 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#6x3:2](~[#7,#8,#16])-[#6x3:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t141c\" k1=\"-3.525605054758 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#16X2,#16X3+1:2]-[!#6:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t142\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"-0.7231630385221 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#16X4,#16X3+0:2]-[#7:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"180.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t143\" k1=\"-1.303000356228 * kilocalorie ** 1 * mole ** -1\" k2=\"0.3587006779008 * kilocalorie ** 1 * mole ** -1\" k3=\"0.1443144661076 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4:1]-[#16X4,#16X3+0:2]-[#7X4,#7X3:3]-[#1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t144\" k1=\"-0.3632871001516 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X3:1]-[#16X4,#16X3+0:2]-[#7X4,#7X3:3]-[#1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t145\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.1810526543987 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4:1]-[#16X4,#16X3+0:2]-[#7X4,#7X3:3]-[#6X4:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t146\" k1=\"0.6392878968148 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.3219581870183 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X3:1]-[#16X4,#16X3+0:2]-[#7X4,#7X3:3]-[#6X4:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t147\" k1=\"1.229088527624 * kilocalorie ** 1 * mole ** -1\" k2=\"0.4298366693131 * kilocalorie ** 1 * mole ** -1\" k3=\"0.7370362153889 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#8X1:1]~[#16X4,#16X3+0:2]-[#7X4,#7X3:3]-[#1:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"180.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t148\" k1=\"-0.638807816079 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0.2663077670587 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#8X1:1]~[#16X4,#16X3+0:2]-[#7X4,#7X3:3]-[#6X4:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t149\" k1=\"1.597079917596 * kilocalorie ** 1 * mole ** -1\" k2=\"0.4733055988859 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.02291305030457 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X3:1]-[#16X4,#16X3+0:2]-[#7X3:3]-[#6X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t150\" k1=\"-0.5000049198338 * kilocalorie ** 1 * mole ** -1\" k2=\"0.587206663536 * kilocalorie ** 1 * mole ** -1\" k3=\"0.4603759126772 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4:1]-[#16X4,#16X3+0:2]-[#7X3:3]-[#6X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"90.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t151\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"1.253700545428 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.5144745734353 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#8X1:1]~[#16X4,#16X3+0:2]-[#7X3:3]-[#6X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t152\" k1=\"-0.1417999303222 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#8X1:1]~[#16X4,#16X3+0:2]-[#7X3:3]-[#7X2:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t153\" k1=\"2.469369631209 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#16X4,#16X3+0:2]=,:[#7X2:3]-,:[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t154\" k1=\"3.328486260004 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X4:1]-[#16X4,#16X3+0:2]-[#7X2:3]~[#6X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0.0 * degree ** 1\" id=\"t155\" k1=\"2.232346894325 * kilocalorie ** 1 * mole ** -1\" k2=\"-0.548530246569 * kilocalorie ** 1 * mole ** -1\" k3=\"0.1095265254519 * kilocalorie ** 1 * mole ** -1\" k4=\"0.1903041011064 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#8X1:1]~[#16X4,#16X3+0:2]-[#7X2:3]~[#6X3:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"180.0 * degree ** 1\" phase4=\"180.0 * degree ** 1\" id=\"t156\" k1=\"1.234113893332 * kilocalorie ** 1 * mole ** -1\" k2=\"0.6486260910948 * kilocalorie ** 1 * mole ** -1\" k3=\"1.204178258864 * kilocalorie ** 1 * mole ** -1\" k4=\"0.2496494771136 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#16X4,#16X3+0:2]-[#8X2:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t157\" k1=\"3.093854739734 * kilocalorie ** 1 * mole ** -1\" k2=\"-0.2639238904727 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#16X2,#16X3+1:2]-[#16X2,#16X3+1:3]-[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t158\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"3.627584495399 * kilocalorie ** 1 * mole ** -1\" k3=\"0.3719185183686 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#8X2:2]-[#15:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t159\" k1=\"9.275740185226 * kilocalorie ** 1 * mole ** -1\" k2=\"-1.840715562289 * kilocalorie ** 1 * mole ** -1\" k3=\"0.4356533725753 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#8X2:1]-[#15:2]-[#8X2:3]-[#6X4:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t160\" k1=\"8.330109136967 * kilocalorie ** 1 * mole ** -1\" k2=\"-1.564270368881 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.7101479481355 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#7:2]-[#15:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t161\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"1.265542041067 * kilocalorie ** 1 * mole ** -1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[#7:2]-[#15:3]=[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"180.0 * degree ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t162\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"2.012364097137 * kilocalorie ** 1 * mole ** -1\" k3=\"0.4145088037321 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6X3:1]-[#7:2]-[#15:3]=[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * degree ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0 * radian ** 1\" phase4=\"0 * radian ** 1\" id=\"t163\" k1=\"-1.94148850547 * kilocalorie ** 1 * mole ** -1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"0 * kilocalories_per_mole ** 1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[#7:2]=[#15:3]~[*:4]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0 * radian ** 1\" phase2=\"0 * radian ** 1\" phase3=\"0.0 * degree ** 1\" phase4=\"0 * radian ** 1\" id=\"t164\" k1=\"0 * kilocalories_per_mole ** 1\" k2=\"0 * kilocalories_per_mole ** 1\" k3=\"-0.9670595402247 * kilocalorie ** 1 * mole ** -1\" k4=\"0 * kilocalories_per_mole ** 1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]-[*:2]#[*:3]-[*:4]\" periodicity1=\"1\" phase1=\"0.0 * degree ** 1\" id=\"t165\" k1=\"0.0 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[*:2]-[*:3]#[*:4]\" periodicity1=\"1\" phase1=\"0.0 * degree ** 1\" id=\"t166\" k1=\"0.0 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[*:1]~[*:2]=[#6,#7,#16,#15;X2:3]=[*:4]\" periodicity1=\"1\" phase1=\"0.0 * degree ** 1\" id=\"t167\" k1=\"0.0 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6:1](-[#6:2](-[#6:3](-[#6:4](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"3.141592653589793 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-181\" k1=\"0.8606270172133289 * kilocalorie ** 1 * mole ** -1\" k2=\"0.31520338002668036 * kilocalorie ** 1 * mole ** -1\" k3=\"0.6115991577525811 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.12432761953006202 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6:3](-[#6:2](-[#6:1](-[H])(-[H])-[H])(-[H])-[H])(-[#6:4](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"0.0 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-182\" k1=\"-0.3205255926776576 * kilocalorie ** 1 * mole ** -1\" k2=\"-0.009962376617028382 * kilocalorie ** 1 * mole ** -1\" k3=\"0.2515388300580689 * kilocalorie ** 1 * mole ** -1\" k4=\"0.2503609162805 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6:3](-[#6:2](-[#6:1](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H:4])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"0.0 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-183\" k1=\"0.04951051932598409 * kilocalorie ** 1 * mole ** -1\" k2=\"0.14912344705964334 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.017503628217561976 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.12632955178129707 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6:3](-[#6:2](-[#6:1](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H:4])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"0.0 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-184\" k1=\"-0.4082364274782983 * kilocalorie ** 1 * mole ** -1\" k2=\"-0.03743302597146742 * kilocalorie ** 1 * mole ** -1\" k3=\"0.14165743475056206 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.08113289828547109 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6:2](-[#6:1](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:3](=[#8:4])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"0.0 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-185\" k1=\"-0.049355716515286516 * kilocalorie ** 1 * mole ** -1\" k2=\"-0.5453260523306571 * kilocalorie ** 1 * mole ** -1\" k3=\"0.09698942885912523 * kilocalorie ** 1 * mole ** -1\" k4=\"0.05293630535528944 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6:2](-[#6:1](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:3](=[#8])-[#7:4](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"0.0 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-186\" k1=\"-0.10159809716693262 * kilocalorie ** 1 * mole ** -1\" k2=\"-0.38657635099478066 * kilocalorie ** 1 * mole ** -1\" k3=\"0.11060969739560107 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.3382288067997527 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6:1](-[#6:2](-[#6:3](-[H])(-[H])-[H:4])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"0.0 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-187\" k1=\"-0.08008593989323039 * kilocalorie ** 1 * mole ** -1\" k2=\"0.0294647647513233 * kilocalorie ** 1 * mole ** -1\" k3=\"0.2723001668925355 * kilocalorie ** 1 * mole ** -1\" k4=\"0.34374428474874746 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6:1](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:2](=[#8])-[#7:3](-[#6:4]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-188\" k1=\"0.5219403032266566 * kilocalorie ** 1 * mole ** -1\" k2=\"2.503006703978132 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.027641604384268596 * kilocalorie ** 1 * mole ** -1\" k4=\"0.08998000171320178 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6:1](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:2](=[#8])-[#7:3](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H:4])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-189\" k1=\"0.5211552532577117 * kilocalorie ** 1 * mole ** -1\" k2=\"2.0137773614320937 * kilocalorie ** 1 * mole ** -1\" k3=\"0.3537218099965104 * kilocalorie ** 1 * mole ** -1\" k4=\"0.048657125926453035 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6:2](-[#6:3](-[#6](-[H])(-[H])-[H])(-[H])-[H:4])(-[#6:1](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"0.0 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-190\" k1=\"0.2529527161467897 * kilocalorie ** 1 * mole ** -1\" k2=\"0.14456486637374444 * kilocalorie ** 1 * mole ** -1\" k3=\"0.15626328248379062 * kilocalorie ** 1 * mole ** -1\" k4=\"0.17736847184770993 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:1](=[#8])-[#7:2](-[#6:3]1:[#6:4](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-191\" k1=\"0.006657394518918513 * kilocalorie ** 1 * mole ** -1\" k2=\"1.5453177264485995 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.026624216260825048 * kilocalorie ** 1 * mole ** -1\" k4=\"0.26609867050997954 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:1](=[#8])-[#7:2](-[#6:3]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7:4]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-192\" k1=\"-0.23656545748751892 * kilocalorie ** 1 * mole ** -1\" k2=\"1.6178958313771534 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.06456056945988524 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.018167361671344463 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6:3](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:2](=[#8:1])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H:4])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"0.0 * radian ** 1\" phase3=\"3.141592653589793 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-193\" k1=\"0.6392798859821752 * kilocalorie ** 1 * mole ** -1\" k2=\"-0.22501074383534062 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.1390509812073416 * kilocalorie ** 1 * mole ** -1\" k4=\"0.14584285770509392 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:2](=[#8:1])-[#7:3](-[#6:4]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-194\" k1=\"-0.8970574252920488 * kilocalorie ** 1 * mole ** -1\" k2=\"3.7039604117656544 * kilocalorie ** 1 * mole ** -1\" k3=\"0.1458625766933922 * kilocalorie ** 1 * mole ** -1\" k4=\"0.3870754623002588 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:2](=[#8:1])-[#7:3](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H:4])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-195\" k1=\"1.1964815374632785 * kilocalorie ** 1 * mole ** -1\" k2=\"2.3334426868952463 * kilocalorie ** 1 * mole ** -1\" k3=\"0.4322231424980534 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.3545184939713096 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6:3](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:2](=[#8])-[#7:1](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H:4])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"0.0 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-196\" k1=\"0.31406399420800407 * kilocalorie ** 1 * mole ** -1\" k2=\"-0.19870974813843686 * kilocalorie ** 1 * mole ** -1\" k3=\"0.05645000987081202 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.4313520710979445 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7:1](-[#6:2]1:[#6:3](:[#6:4](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-197\" k1=\"0.00019889471441992713 * kilocalorie ** 1 * mole ** -1\" k2=\"3.2534511427542903 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.01964908806883273 * kilocalorie ** 1 * mole ** -1\" k4=\"0.06463019125083476 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7:1](-[#6:2]1:[#6:3](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H:4])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-198\" k1=\"0.019600919064781282 * kilocalorie ** 1 * mole ** -1\" k2=\"3.1845569450724587 * kilocalorie ** 1 * mole ** -1\" k3=\"0.1405744332600418 * kilocalorie ** 1 * mole ** -1\" k4=\"0.20998827276205942 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7:1](-[#6:2]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6:4](:[#7:3]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-199\" k1=\"0.02478787109694161 * kilocalorie ** 1 * mole ** -1\" k2=\"2.435339261322068 * kilocalorie ** 1 * mole ** -1\" k3=\"0.20031902675403698 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.3241763070162773 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6:1]1:[#6:2](:[#6:3](-[#7:4](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-200\" k1=\"0.005648456069313899 * kilocalorie ** 1 * mole ** -1\" k2=\"3.2845340459720735 * kilocalorie ** 1 * mole ** -1\" k3=\"0.08232251009855357 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.1873364664153335 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6:1]1:[#6:2](:[#6:3](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:4](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-201\" k1=\"-0.0015751225081931752 * kilocalorie ** 1 * mole ** -1\" k2=\"3.2621486244564 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.01128391252261284 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.016600872722649384 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6:1]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:4](:[#6:3](:[#7:2]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-202\" k1=\"0.00605023470040965 * kilocalorie ** 1 * mole ** -1\" k2=\"5.566212103288272 * kilocalorie ** 1 * mole ** -1\" k3=\"0.05233516126644283 * kilocalorie ** 1 * mole ** -1\" k4=\"0.08884278100468963 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6:1]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6:3](:[#7:2]:1)-[H:4])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-203\" k1=\"0.06285657518511525 * kilocalorie ** 1 * mole ** -1\" k2=\"2.5727453127637374 * kilocalorie ** 1 * mole ** -1\" k3=\"0.4586634535266391 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.6745631182162726 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7:3](-[#6:2]1:[#6:1](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H:4])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-204\" k1=\"-0.6188478353416663 * kilocalorie ** 1 * mole ** -1\" k2=\"1.4746532260993885 * kilocalorie ** 1 * mole ** -1\" k3=\"0.2568564742163231 * kilocalorie ** 1 * mole ** -1\" k4=\"0.05744253547934446 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6:2]1:[#6:1](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6:4](:[#7:3]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-205\" k1=\"0.005309782630715451 * kilocalorie ** 1 * mole ** -1\" k2=\"5.570024021476035 * kilocalorie ** 1 * mole ** -1\" k3=\"0.04154083405822177 * kilocalorie ** 1 * mole ** -1\" k4=\"0.06587723013662755 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6:1](:[#6:2](-[#7:3](-[#6:4](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-206\" k1=\"0.15049014041994488 * kilocalorie ** 1 * mole ** -1\" k2=\"1.058345461389733 * kilocalorie ** 1 * mole ** -1\" k3=\"0.12164836352163488 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.02233727336664763 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6:1](:[#6:2](-[#7:3](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H:4]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-207\" k1=\"-0.1513087834294552 * kilocalorie ** 1 * mole ** -1\" k2=\"1.0889821684064174 * kilocalorie ** 1 * mole ** -1\" k3=\"0.2629089062735865 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.1299002015883882 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6:1](:[#6:2](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:3](:[#6:4](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-208\" k1=\"-0.0036890826527336542 * kilocalorie ** 1 * mole ** -1\" k2=\"3.27302418380181 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.043332773801392964 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.08743696683977682 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6:1](:[#6:2](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:3](:[#6](:[#7]:1)-[H])-[H:4])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-209\" k1=\"-0.007960106838038475 * kilocalorie ** 1 * mole ** -1\" k2=\"3.2234973509590406 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.07701426242075156 * kilocalorie ** 1 * mole ** -1\" k4=\"0.14148805445138687 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6:3]1:[#6:2](:[#6:1](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7:4]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-210\" k1=\"-0.019171557397740523 * kilocalorie ** 1 * mole ** -1\" k2=\"3.328653224767872 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.14654401712628434 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.22357560728855302 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:1](-[#7:2](-[#6:3](=[#8:4])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-211\" k1=\"-0.48539019321895244 * kilocalorie ** 1 * mole ** -1\" k2=\"3.352700968710151 * kilocalorie ** 1 * mole ** -1\" k3=\"0.20350811507602135 * kilocalorie ** 1 * mole ** -1\" k4=\"0.27326468378720586 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:1](-[#7:2](-[#6:3](=[#8])-[#6:4]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-212\" k1=\"-0.06482697727152012 * kilocalorie ** 1 * mole ** -1\" k2=\"2.4927780719868258 * kilocalorie ** 1 * mole ** -1\" k3=\"0.5237753019484767 * kilocalorie ** 1 * mole ** -1\" k4=\"0.8053562585919717 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:1](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:2](:[#6:3](:[#7:4]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-213\" k1=\"-0.017111085868870196 * kilocalorie ** 1 * mole ** -1\" k2=\"3.319738820562017 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.12478783314646362 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.1825835347426786 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:1](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:2](:[#6:3](:[#7]:1)-[H:4])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-214\" k1=\"-0.0004212201199904077 * kilocalorie ** 1 * mole ** -1\" k2=\"3.2454067599911713 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.05624987906061249 * kilocalorie ** 1 * mole ** -1\" k4=\"0.16800909662596433 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6:3](:[#6:2](-[#7:1](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H:4])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-215\" k1=\"-0.007905314284834273 * kilocalorie ** 1 * mole ** -1\" k2=\"3.283081247261361 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.0433385104500116 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.041644025080953086 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:2](-[#7:1](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:3](:[#6:4](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-216\" k1=\"-0.009382767663760375 * kilocalorie ** 1 * mole ** -1\" k2=\"3.2191028344610966 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.08307390743130884 * kilocalorie ** 1 * mole ** -1\" k4=\"0.14450194878488332 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:2](-[#7:1](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:3](:[#6](:[#7]:1)-[H])-[H:4])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-217\" k1=\"0.016968694144320087 * kilocalorie ** 1 * mole ** -1\" k2=\"3.1908788483413626 * kilocalorie ** 1 * mole ** -1\" k3=\"0.13904165606871924 * kilocalorie ** 1 * mole ** -1\" k4=\"0.22864681576511806 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7:1](-[#6:2](=[#8])-[#6:3]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6:4]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-218\" k1=\"0.6901897730351321 * kilocalorie ** 1 * mole ** -1\" k2=\"-0.21407508416579313 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.17879452305639457 * kilocalorie ** 1 * mole ** -1\" k4=\"0.054283899569552554 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:3](-[#7:2](-[#6:1](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:4](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-219\" k1=\"-0.05686843310160174 * kilocalorie ** 1 * mole ** -1\" k2=\"1.2842757297008816 * kilocalorie ** 1 * mole ** -1\" k3=\"0.20197688832492772 * kilocalorie ** 1 * mole ** -1\" k4=\"0.04191729953720923 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6:1](=[#8])-[#6:2]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6:3]:2-[#17:4])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-220\" k1=\"0.019398905831889836 * kilocalorie ** 1 * mole ** -1\" k2=\"3.1858492311773627 * kilocalorie ** 1 * mole ** -1\" k3=\"0.13403662067039585 * kilocalorie ** 1 * mole ** -1\" k4=\"0.18374118068747478 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6:1](=[#8])-[#6:2]2:[#6](-[#17]):[#6](:[#6](:[#6:4](:[#6:3]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-221\" k1=\"0.0034331001676940597 * kilocalorie ** 1 * mole ** -1\" k2=\"3.2706776217804308 * kilocalorie ** 1 * mole ** -1\" k3=\"0.03389795867752 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.0648476893076697 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7:3](-[#6:2](=[#8:1])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H:4]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-222\" k1=\"1.1752510964248193 * kilocalorie ** 1 * mole ** -1\" k2=\"2.8686195412305575 * kilocalorie ** 1 * mole ** -1\" k3=\"0.475536509967404 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.06305093206322737 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6:2](=[#8:1])-[#6:3]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6:4]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-223\" k1=\"-0.6936032861047049 * kilocalorie ** 1 * mole ** -1\" k2=\"0.6896625264108579 * kilocalorie ** 1 * mole ** -1\" k3=\"0.08587669721704949 * kilocalorie ** 1 * mole ** -1\" k4=\"0.03467853021174661 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7:3](-[#6:2](=[#8])-[#6:1]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H:4]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-224\" k1=\"0.7752547203281647 * kilocalorie ** 1 * mole ** -1\" k2=\"2.17093029467026 * kilocalorie ** 1 * mole ** -1\" k3=\"0.04037472019083508 * kilocalorie ** 1 * mole ** -1\" k4=\"0.399087775669728 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6:1]2:[#6](-[#17]):[#6](:[#6:4](:[#6:3](:[#6:2]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-225\" k1=\"-0.004508868503936107 * kilocalorie ** 1 * mole ** -1\" k2=\"3.2747832866863 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.04250662013566685 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.07701585047911863 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6:1]2:[#6](-[#17]):[#6](:[#6](:[#6:3](:[#6:2]:2-[#17])-[H:4])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-226\" k1=\"-0.0027492277812490107 * kilocalorie ** 1 * mole ** -1\" k2=\"3.2487368639645124 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.005712126130401645 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.01498868345633541 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6:3]2:[#6:2](-[#17]):[#6:1](:[#6](:[#6](:[#6:4]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-227\" k1=\"0.012781498097690322 * kilocalorie ** 1 * mole ** -1\" k2=\"3.2084168709695295 * kilocalorie ** 1 * mole ** -1\" k3=\"0.09605133660847862 * kilocalorie ** 1 * mole ** -1\" k4=\"0.143048977652822 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6:3]2:[#6:2](-[#17:1]):[#6](:[#6](:[#6](:[#6:4]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-228\" k1=\"0.009664877573914267 * kilocalorie ** 1 * mole ** -1\" k2=\"3.292709932337791 * kilocalorie ** 1 * mole ** -1\" k3=\"0.07434242633172969 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.11694342203656893 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6:1](:[#6:2](:[#6:3](:[#6:4]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-229\" k1=\"0.0022091160012120315 * kilocalorie ** 1 * mole ** -1\" k2=\"3.2458151324578273 * kilocalorie ** 1 * mole ** -1\" k3=\"0.0300973233666657 * kilocalorie ** 1 * mole ** -1\" k4=\"0.06848520886571226 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6:3](:[#6:2](:[#6:1]:2-[#17])-[H])-[H:4])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-230\" k1=\"0.009824834857044211 * kilocalorie ** 1 * mole ** -1\" k2=\"3.2884294017161815 * kilocalorie ** 1 * mole ** -1\" k3=\"0.04651940466890365 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.025439117150437573 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6:1](:[#6:2](:[#6:3]:2-[#17:4])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-231\" k1=\"-0.003690638446797146 * kilocalorie ** 1 * mole ** -1\" k2=\"3.2367074393508455 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.06016259615420032 * kilocalorie ** 1 * mole ** -1\" k4=\"0.13796166827279827 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6:3](:[#6:2]:2-[#17:1])-[H:4])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-232\" k1=\"0.01563479836126009 * kilocalorie ** 1 * mole ** -1\" k2=\"3.1990054521440525 * kilocalorie ** 1 * mole ** -1\" k3=\"0.11178936546550385 * kilocalorie ** 1 * mole ** -1\" k4=\"0.16210299318545446 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6:3](:[#6:2](:[#6:1](:[#6]:2-[#17])-[H])-[H])-[H:4])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-233\" k1=\"0.003551474607461126 * kilocalorie ** 1 * mole ** -1\" k2=\"3.2768300529759333 * kilocalorie ** 1 * mole ** -1\" k3=\"0.06630869138807473 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.15777176430392031 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6:3](:[#6:2](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:1](:[#6](:[#7]:1)-[H])-[H])-[H:4])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-234\" k1=\"0.007760723469535401 * kilocalorie ** 1 * mole ** -1\" k2=\"3.2874965816954327 * kilocalorie ** 1 * mole ** -1\" k3=\"0.07031666795060047 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.12492460119702138 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:2](-[#7:3](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H:4]):[#6:1](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-235\" k1=\"0.16576853520537307 * kilocalorie ** 1 * mole ** -1\" k2=\"1.4981043079265355 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.050329570386862144 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.22444927562396724 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7:3](-[#6:2]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7:1]:1)-[H])-[H])-[H])-[H:4])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-236\" k1=\"0.689562383972018 * kilocalorie ** 1 * mole ** -1\" k2=\"1.373603783264643 * kilocalorie ** 1 * mole ** -1\" k3=\"0.00011460436231980242 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.18769674522932098 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6:2]1:[#6:3](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7:1]:1)-[H])-[H])-[H:4])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-237\" k1=\"0.004503627363089683 * kilocalorie ** 1 * mole ** -1\" k2=\"3.27525978399777 * kilocalorie ** 1 * mole ** -1\" k3=\"0.0446828248266156 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.08331136237603448 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:3](:[#6:2](:[#7:1]:1)-[H])-[H:4])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-238\" k1=\"0.013103391039986187 * kilocalorie ** 1 * mole ** -1\" k2=\"3.302413907103409 * kilocalorie ** 1 * mole ** -1\" k3=\"0.08168113015699709 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.09832106386975531 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6:2](-[#6:3](-[H])(-[H])-[H:4])(-[H])-[H:1])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"0.0 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-239\" k1=\"0.0190889404029001 * kilocalorie ** 1 * mole ** -1\" k2=\"0.22087163315998906 * kilocalorie ** 1 * mole ** -1\" k3=\"0.08423000892099534 * kilocalorie ** 1 * mole ** -1\" k4=\"-0.017935610294130606 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6:2](-[#6:3](-[#6](-[H])(-[H])-[H])(-[H])-[H:4])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H:1])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"0.0 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-240\" k1=\"0.32820733293414606 * kilocalorie ** 1 * mole ** -1\" k2=\"0.138853976138163 * kilocalorie ** 1 * mole ** -1\" k3=\"-0.19720083455515006 * kilocalorie ** 1 * mole ** -1\" k4=\"0.08029322836146774 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6:2](:[#6:3](:[#6]:2-[#17])-[H:4])-[H:1])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-241\" k1=\"0.024652736824822472 * kilocalorie ** 1 * mole ** -1\" k2=\"3.171033624887499 * kilocalorie ** 1 * mole ** -1\" k3=\"0.14565534653783077 * kilocalorie ** 1 * mole ** -1\" k4=\"0.15573210262002582 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n        &lt;Proper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:2](:[#6:3](:[#7]:1)-[H:4])-[H:1])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"1\" periodicity2=\"2\" periodicity3=\"3\" periodicity4=\"4\" phase1=\"0.0 * radian ** 1\" phase2=\"3.141592653589793 * radian ** 1\" phase3=\"0.0 * radian ** 1\" phase4=\"0.0 * radian ** 1\" id=\"p-bespoke-242\" k1=\"0.009746640875525434 * kilocalorie ** 1 * mole ** -1\" k2=\"3.2050354989497505 * kilocalorie ** 1 * mole ** -1\" k3=\"0.1543904999525266 * kilocalorie ** 1 * mole ** -1\" k4=\"0.34472145806013743 * kilocalorie ** 1 * mole ** -1\" idivf1=\"1.0\" idivf2=\"1.0\" idivf3=\"1.0\" idivf4=\"1.0\"&gt;&lt;/Proper&gt;\n    &lt;/ProperTorsions&gt;\n    &lt;ImproperTorsions version=\"0.3\" potential=\"k*(1+cos(periodicity*theta-phase))\" default_idivf=\"auto\"&gt;\n        &lt;Improper smirks=\"[*:1]~[#6X3:2](~[*:3])~[*:4]\" periodicity1=\"2\" phase1=\"180.0 * degree ** 1\" k1=\"5.300125669502 * kilocalorie ** 1 * mole ** -1\" id=\"i1\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[*:1]~[#6X3:2](~[#8X1:3])~[#8:4]\" periodicity1=\"2\" phase1=\"180.0 * degree ** 1\" k1=\"13.03685427069 * kilocalorie ** 1 * mole ** -1\" id=\"i2\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[*:1]~[#7X3$(*~[#15,#16](!-[*])):2](~[*:3])~[*:4]\" periodicity1=\"2\" phase1=\"180.0 * degree ** 1\" k1=\"13.6446181897 * kilocalorie ** 1 * mole ** -1\" id=\"i3\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[*:1]~[#7X3$(*~[#6X3]):2](~[*:3])~[*:4]\" periodicity1=\"2\" phase1=\"180.0 * degree ** 1\" k1=\"1.279441128551 * kilocalorie ** 1 * mole ** -1\" id=\"i4\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[*:1]~[#7X3$(*~[#7X2]):2](~[*:3])~[*:4]\" periodicity1=\"2\" phase1=\"180.0 * degree ** 1\" k1=\"-2.249308190134 * kilocalorie ** 1 * mole ** -1\" id=\"i5\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[*:1]~[#7X3$(*@1-[*]=,:[*][*]=,:[*]@1):2](~[*:3])~[*:4]\" periodicity1=\"2\" phase1=\"180.0 * degree ** 1\" k1=\"15.97210794376 * kilocalorie ** 1 * mole ** -1\" id=\"i6\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[*:1]~[#6X3:2](=[#7X2,#7X3+1:3])~[#7:4]\" periodicity1=\"2\" phase1=\"180.0 * degree ** 1\" k1=\"10.02987224683 * kilocalorie ** 1 * mole ** -1\" id=\"i7\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6:1](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:2](=[#8:3])-[#7:4](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.308347814917832 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-8\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6:4](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:2](=[#8:1])-[#7:3](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.303404000350524 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-9\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6:3](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:2](=[#8:4])-[#7:1](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.273829918723874 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-10\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:1](=[#8])-[#7:2](-[#6:3]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H:4])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"1.2663936796991861 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-11\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:4](=[#8])-[#7:2](-[#6:1]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H:3])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"1.2339896777388866 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-12\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6:3](=[#8])-[#7:2](-[#6:4]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H:1])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"1.1810972614405628 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-13\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7:1](-[#6:2]1:[#6:3](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7:4]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.291518234022254 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-14\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7:4](-[#6:2]1:[#6:1](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7:3]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.290668535021713 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-15\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7:3](-[#6:2]1:[#6:4](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7:1]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.317939180460514 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-16\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6:1]1:[#6:2](:[#6:3](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H:4])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.302232751771291 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-17\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6:4]1:[#6:2](:[#6:1](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H:3])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.294777324204405 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-18\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6:3]1:[#6:2](:[#6:4](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H:1])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.305072253185927 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-19\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6:1](:[#6:2](-[#7:3](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:4](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.2964782556428345 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-20\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6:4](:[#6:2](-[#7:1](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:3](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.2964521764646895 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-21\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6:3](:[#6:2](-[#7:4](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:1](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.304230042677336 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-22\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:1](-[#7:2](-[#6:3](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H:4]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"1.2533726189818457 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-23\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:4](-[#7:2](-[#6:1](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H:3]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"1.26521442195085 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-24\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:3](-[#7:2](-[#6:4](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H:1]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"1.3384814921691284 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-25\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:1](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:2](:[#6:3](:[#7]:1)-[H])-[H:4])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.302371051920607 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-26\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:4](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:2](:[#6:1](:[#7]:1)-[H])-[H:3])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.280818547677885 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-27\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6:3](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:2](:[#6:4](:[#7]:1)-[H])-[H:1])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.308805377380421 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-28\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7:1](-[#6:2](=[#8:3])-[#6:4]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.314562629548419 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-29\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7:4](-[#6:2](=[#8:1])-[#6:3]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.267965409178792 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-30\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7:3](-[#6:2](=[#8:4])-[#6:1]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.339049367385834 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-31\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6:1](=[#8])-[#6:2]2:[#6:3](-[#17]):[#6](:[#6](:[#6](:[#6:4]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.307030430748156 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-32\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6:4](=[#8])-[#6:2]2:[#6:1](-[#17]):[#6](:[#6](:[#6](:[#6:3]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.3032948425878335 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-33\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6:3](=[#8])-[#6:2]2:[#6:4](-[#17]):[#6](:[#6](:[#6](:[#6:1]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.292303356238901 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-34\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6:1]2:[#6:2](-[#17:3]):[#6:4](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.34479819134072 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-35\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6:4]2:[#6:2](-[#17:1]):[#6:3](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.3465839404816995 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-36\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6:3]2:[#6:2](-[#17:4]):[#6:1](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.352233159054355 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-37\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6:1]2:[#6](-[#17]):[#6](:[#6](:[#6:3](:[#6:2]:2-[#17:4])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.232613062458237 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-38\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6:4]2:[#6](-[#17]):[#6](:[#6](:[#6:1](:[#6:2]:2-[#17:3])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.257267888166496 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-39\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6:3]2:[#6](-[#17]):[#6](:[#6](:[#6:4](:[#6:2]:2-[#17:1])-[H])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.261023122785338 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-40\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6:1](-[#17]):[#6:2](:[#6:3](:[#6](:[#6]:2-[#17])-[H])-[H])-[H:4])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.307143217578115 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-41\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6:4](-[#17]):[#6:2](:[#6:1](:[#6](:[#6]:2-[#17])-[H])-[H])-[H:3])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.303854067003725 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-42\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6:3](-[#17]):[#6:2](:[#6:4](:[#6](:[#6]:2-[#17])-[H])-[H])-[H:1])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.303864362614596 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-43\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6:1](:[#6:2](:[#6:3](:[#6]:2-[#17])-[H])-[H:4])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.29727272233261 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-44\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6:4](:[#6:2](:[#6:1](:[#6]:2-[#17])-[H])-[H:3])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.322176699600672 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-45\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6:3](:[#6:2](:[#6:4](:[#6]:2-[#17])-[H])-[H:1])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.277722511749948 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-46\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6:1](:[#6:2](:[#6:3]:2-[#17])-[H:4])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.299257381198674 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-47\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6:4](:[#6:2](:[#6:1]:2-[#17])-[H:3])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.303232952620007 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-48\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6:3](:[#6:2](:[#6:4]:2-[#17])-[H:1])-[H])-[H])-[H]):[#6](:[#6](:[#7]:1)-[H])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.284493506275252 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-49\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:1](:[#6:2](:[#7:3]:1)-[H:4])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.300629752643659 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-50\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:4](:[#6:2](:[#7:1]:1)-[H:3])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.308767345197126 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-51\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n        &lt;Improper smirks=\"[#6](-[#6](-[#6](-[#6](-[#6](-[H])(-[H])-[H])(-[H])-[H])(-[#6](=[#8])-[#7](-[#6]1:[#6](:[#6](-[#7](-[#6](=[#8])-[#6]2:[#6](-[#17]):[#6](:[#6](:[#6](:[#6]:2-[#17])-[H])-[H])-[H])-[H]):[#6:3](:[#6:2](:[#7:4]:1)-[H:1])-[H])-[H])-[H])-[H])(-[H])-[H])(-[H])(-[H])-[H]\" periodicity1=\"2\" phase1=\"3.141592653589793 * radian ** 1\" k1=\"5.292096048747545 * kilocalorie ** 1 * mole ** -1\" id=\"i-bespoke-52\" idivf1=\"3.0\"&gt;&lt;/Improper&gt;\n    &lt;/ImproperTorsions&gt;\n    &lt;vdW version=\"0.4\" potential=\"Lennard-Jones-12-6\" combining_rules=\"Lorentz-Berthelot\" scale12=\"0.0\" scale13=\"0.0\" scale14=\"0.5\" scale15=\"1.0\" cutoff=\"9.0 * angstrom ** 1\" switch_width=\"1.0 * angstrom ** 1\" periodic_method=\"cutoff\" nonperiodic_method=\"no-cutoff\"&gt;\n        &lt;Atom smirks=\"[#1:1]\" epsilon=\"0.0157 * kilocalorie ** 1 * mole ** -1\" id=\"n1\" rmin_half=\"0.6 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#1:1]-[#6X4]\" epsilon=\"0.01577948280971 * kilocalorie ** 1 * mole ** -1\" id=\"n2\" rmin_half=\"1.48419980825 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#1:1]-[#6X4]-[#7,#8,#9,#16,#17,#35]\" epsilon=\"0.01640924602775 * kilocalorie ** 1 * mole ** -1\" id=\"n3\" rmin_half=\"1.449786411317 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#1:1]-[#6X4](-[#7,#8,#9,#16,#17,#35])-[#7,#8,#9,#16,#17,#35]\" epsilon=\"0.0157 * kilocalorie ** 1 * mole ** -1\" id=\"n4\" rmin_half=\"1.287 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#1:1]-[#6X4](-[#7,#8,#9,#16,#17,#35])(-[#7,#8,#9,#16,#17,#35])-[#7,#8,#9,#16,#17,#35]\" epsilon=\"0.0157 * kilocalorie ** 1 * mole ** -1\" id=\"n5\" rmin_half=\"1.187 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#1:1]-[#6X4]~[*+1,*+2]\" epsilon=\"0.0157 * kilocalorie ** 1 * mole ** -1\" id=\"n6\" rmin_half=\"1.1 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#1:1]-[#6X3]\" epsilon=\"0.01561134320353 * kilocalorie ** 1 * mole ** -1\" id=\"n7\" rmin_half=\"1.443812569645 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#1:1]-[#6X3]~[#7,#8,#9,#16,#17,#35]\" epsilon=\"0.01310699839698 * kilocalorie ** 1 * mole ** -1\" id=\"n8\" rmin_half=\"1.377051329051 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#1:1]-[#6X3](~[#7,#8,#9,#16,#17,#35])~[#7,#8,#9,#16,#17,#35]\" epsilon=\"0.01479744504464 * kilocalorie ** 1 * mole ** -1\" id=\"n9\" rmin_half=\"1.370482808197 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#1:1]-[#6X2]\" epsilon=\"0.015 * kilocalorie ** 1 * mole ** -1\" id=\"n10\" rmin_half=\"1.459 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#1:1]-[#7]\" epsilon=\"0.01409081474669 * kilocalorie ** 1 * mole ** -1\" id=\"n11\" rmin_half=\"0.6192778454102 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#1:1]-[#8]\" epsilon=\"1.232599966667e-05 * kilocalorie ** 1 * mole ** -1\" id=\"n12\" rmin_half=\"0.2999999999997 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#1:1]-[#16]\" epsilon=\"0.0157 * kilocalorie ** 1 * mole ** -1\" id=\"n13\" rmin_half=\"0.6 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#6:1]\" epsilon=\"0.0868793154488 * kilocalorie ** 1 * mole ** -1\" id=\"n14\" rmin_half=\"1.953447017081 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#6X2:1]\" epsilon=\"0.21 * kilocalorie ** 1 * mole ** -1\" id=\"n15\" rmin_half=\"1.908 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#6X4:1]\" epsilon=\"0.1088406109251 * kilocalorie ** 1 * mole ** -1\" id=\"n16\" rmin_half=\"1.896698071741 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#8:1]\" epsilon=\"0.2102061007896 * kilocalorie ** 1 * mole ** -1\" id=\"n17\" rmin_half=\"1.706036917087 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#8X2H0+0:1]\" epsilon=\"0.1684651402602 * kilocalorie ** 1 * mole ** -1\" id=\"n18\" rmin_half=\"1.697783613804 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#8X2H1+0:1]\" epsilon=\"0.2094735324129 * kilocalorie ** 1 * mole ** -1\" id=\"n19\" rmin_half=\"1.682099169199 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#7:1]\" epsilon=\"0.1676915150424 * kilocalorie ** 1 * mole ** -1\" id=\"n20\" rmin_half=\"1.799798315098 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#16:1]\" epsilon=\"0.25 * kilocalorie ** 1 * mole ** -1\" id=\"n21\" rmin_half=\"2.0 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#15:1]\" epsilon=\"0.2 * kilocalorie ** 1 * mole ** -1\" id=\"n22\" rmin_half=\"2.1 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#9:1]\" epsilon=\"0.061 * kilocalorie ** 1 * mole ** -1\" id=\"n23\" rmin_half=\"1.75 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#17:1]\" epsilon=\"0.2656001046527 * kilocalorie ** 1 * mole ** -1\" id=\"n24\" rmin_half=\"1.85628721824 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#35:1]\" epsilon=\"0.3218986365974 * kilocalorie ** 1 * mole ** -1\" id=\"n25\" rmin_half=\"1.969806594135 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#53:1]\" epsilon=\"0.4 * kilocalorie ** 1 * mole ** -1\" id=\"n26\" rmin_half=\"2.35 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#3+1:1]\" epsilon=\"0.0279896 * kilocalorie ** 1 * mole ** -1\" id=\"n27\" rmin_half=\"1.025 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#11+1:1]\" epsilon=\"0.0874393 * kilocalorie ** 1 * mole ** -1\" id=\"n28\" rmin_half=\"1.369 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#19+1:1]\" epsilon=\"0.1936829 * kilocalorie ** 1 * mole ** -1\" id=\"n29\" rmin_half=\"1.705 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#37+1:1]\" epsilon=\"0.3278219 * kilocalorie ** 1 * mole ** -1\" id=\"n30\" rmin_half=\"1.813 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#55+1:1]\" epsilon=\"0.4065394 * kilocalorie ** 1 * mole ** -1\" id=\"n31\" rmin_half=\"1.976 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#9X0-1:1]\" epsilon=\"0.003364 * kilocalorie ** 1 * mole ** -1\" id=\"n32\" rmin_half=\"2.303 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#17X0-1:1]\" epsilon=\"0.035591 * kilocalorie ** 1 * mole ** -1\" id=\"n33\" rmin_half=\"2.513 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#35X0-1:1]\" epsilon=\"0.0586554 * kilocalorie ** 1 * mole ** -1\" id=\"n34\" rmin_half=\"2.608 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#53X0-1:1]\" epsilon=\"0.0536816 * kilocalorie ** 1 * mole ** -1\" id=\"n35\" rmin_half=\"2.86 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#1]-[#8X2H2+0:1]-[#1]\" epsilon=\"0.1521 * kilocalorie ** 1 * mole ** -1\" id=\"n-tip3p-O\" sigma=\"3.1507 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#1:1]-[#8X2H2+0]-[#1]\" epsilon=\"0.0 * kilocalorie ** 1 * mole ** -1\" id=\"n-tip3p-H\" sigma=\"1 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n        &lt;Atom smirks=\"[#54:1]\" epsilon=\"0.561 * kilocalorie ** 1 * mole ** -1\" id=\"n36\" sigma=\"4.363 * angstrom ** 1\"&gt;&lt;/Atom&gt;\n    &lt;/vdW&gt;\n    &lt;Electrostatics version=\"0.4\" scale12=\"0.0\" scale13=\"0.0\" scale14=\"0.8333333333\" scale15=\"1.0\" cutoff=\"9.0 * angstrom ** 1\" switch_width=\"0.0 * angstrom ** 1\" periodic_potential=\"Ewald3D-ConductingBoundary\" nonperiodic_potential=\"Coulomb\" exception_potential=\"Coulomb\"&gt;&lt;/Electrostatics&gt;\n    &lt;LibraryCharges version=\"0.3\"&gt;\n        &lt;LibraryCharge smirks=\"[#3+1:1]\" charge1=\"1.0 * elementary_charge ** 1\" id=\"Li+\"&gt;&lt;/LibraryCharge&gt;\n        &lt;LibraryCharge smirks=\"[#11+1:1]\" charge1=\"1.0 * elementary_charge ** 1\" id=\"Na+\"&gt;&lt;/LibraryCharge&gt;\n        &lt;LibraryCharge smirks=\"[#19+1:1]\" charge1=\"1.0 * elementary_charge ** 1\" id=\"K+\"&gt;&lt;/LibraryCharge&gt;\n        &lt;LibraryCharge smirks=\"[#37+1:1]\" charge1=\"1.0 * elementary_charge ** 1\" id=\"Rb+\"&gt;&lt;/LibraryCharge&gt;\n        &lt;LibraryCharge smirks=\"[#55+1:1]\" charge1=\"1.0 * elementary_charge ** 1\" id=\"Cs+\"&gt;&lt;/LibraryCharge&gt;\n        &lt;LibraryCharge smirks=\"[#9X0-1:1]\" charge1=\"-1.0 * elementary_charge ** 1\" id=\"F-\"&gt;&lt;/LibraryCharge&gt;\n        &lt;LibraryCharge smirks=\"[#17X0-1:1]\" charge1=\"-1.0 * elementary_charge ** 1\" id=\"Cl-\"&gt;&lt;/LibraryCharge&gt;\n        &lt;LibraryCharge smirks=\"[#35X0-1:1]\" charge1=\"-1.0 * elementary_charge ** 1\" id=\"Br-\"&gt;&lt;/LibraryCharge&gt;\n        &lt;LibraryCharge smirks=\"[#53X0-1:1]\" charge1=\"-1.0 * elementary_charge ** 1\" id=\"I-\"&gt;&lt;/LibraryCharge&gt;\n        &lt;LibraryCharge smirks=\"[#1]-[#8X2H2+0:1]-[#1]\" charge1=\"-0.834 * elementary_charge ** 1\" id=\"q-tip3p-O\"&gt;&lt;/LibraryCharge&gt;\n        &lt;LibraryCharge smirks=\"[#1:1]-[#8X2H2+0]-[#1]\" charge1=\"0.417 * elementary_charge ** 1\" id=\"q-tip3p-H\"&gt;&lt;/LibraryCharge&gt;\n        &lt;LibraryCharge smirks=\"[#54:1]\" charge1=\"0.0 * elementary_charge ** 1\" id=\"Xe\"&gt;&lt;/LibraryCharge&gt;\n    &lt;/LibraryCharges&gt;\n    &lt;ToolkitAM1BCC version=\"0.3\"&gt;&lt;/ToolkitAM1BCC&gt;\n&lt;/SMIRNOFF&gt;</pre> <p>We can check out the standard plots to get more information on how well the fitting has gone and how the parameters have changed -- take a look in <code>plots</code>:</p> In\u00a0[8]: Copied! <pre>! ls plots\n</pre> ! ls plots <pre>correlation.png\t\t       loss.png\nerror_distributions.png        parameter_differences.png\nforce_error_by_atom_index.png  parameter_values.png\n</pre> <p>For example, <code>loss.png</code> displays how the training loss (computed on the training set) and the test loss (computed on a seperate set of samples generated with the initial molecular mechanics force field) changes during training at each iteration (indexed from 0). Our loss looks well-converged.</p> In\u00a0[10]: Copied! <pre>from IPython.display import Image, display\n\ndisplay(Image(filename='plots/loss.png'))\n</pre> from IPython.display import Image, display  display(Image(filename='plots/loss.png')) In\u00a0[\u00a0]: Copied! <pre>from openff.toolkit import Molecule, ForceField, Topology\n\nforce_field = ForceField('training_iteration_2/bespoke_ff.offxml')\nmolecule = Molecule.from_smiles('CCC(CC)C(=O)Nc2cc(NC(=O)c1c(Cl)cccc1Cl)ccn2')\nmolecule.generate_conformers(n_conformers=1)\n\ninterchange = force_field.create_interchange(molecule.to_topology())\n</pre> from openff.toolkit import Molecule, ForceField, Topology  force_field = ForceField('training_iteration_2/bespoke_ff.offxml') molecule = Molecule.from_smiles('CCC(CC)C(=O)Nc2cc(NC(=O)c1c(Cl)cccc1Cl)ccn2') molecule.generate_conformers(n_conformers=1)  interchange = force_field.create_interchange(molecule.to_topology()) <pre>2025-12-03 15:34:25.649 | INFO     | bespokefit_smee.utils.rdkit_bespoke_wrapper:__init__:148 - Using RDKitBespokeToolkitWrapper with symmetry-aware SMARTS matching. This will significantly speed up matching for molecules where each type  matches only one set of symmetry-equivalent atoms.\n</pre> <p>Now we can run MD with OpenMM:</p> In\u00a0[24]: Copied! <pre>import openmm\nimport openmm.unit\nfrom openff.interchange import Interchange\nimport mdtraj\nimport nglview\n\n\ndef run_openmm(\n    interchange: Interchange,\n    reporter_frequency: int = 1000, # Decrease this to save more frames!\n    trajectory_name: str = \"small_mol_solvated.pdb\",\n):\n    simulation = interchange.to_openmm_simulation(\n        integrator=openmm.LangevinMiddleIntegrator(\n            300 * openmm.unit.kelvin,\n            1 / openmm.unit.picosecond,\n            0.002 * openmm.unit.picoseconds,\n        ),\n    )\n\n    pdb_reporter = openmm.app.PDBReporter(trajectory_name, reporter_frequency)\n    simulation.reporters.append(pdb_reporter)\n\n    simulation.context.setVelocitiesToTemperature(300 * openmm.unit.kelvin)\n    simulation.runForClockTime(10 * openmm.unit.second)\n\n\ndef visualise_traj(\n    topology: Topology, filename: str = \"small_mol_solvated.pdb\"\n) -&gt; nglview.NGLWidget:\n    \"\"\"Visualise a trajectory using nglview.\"\"\"\n    traj = mdtraj.load(\n        filename,\n        top=mdtraj.Topology.from_openmm(topology.to_openmm()),\n    )\n\n    view = nglview.show_mdtraj(traj)\n    view.add_representation(\"licorice\", selection=\"water\")\n\n    return view\n\n\nrun_openmm(interchange)\nvisualise_traj(interchange.topology)\n</pre> import openmm import openmm.unit from openff.interchange import Interchange import mdtraj import nglview   def run_openmm(     interchange: Interchange,     reporter_frequency: int = 1000, # Decrease this to save more frames!     trajectory_name: str = \"small_mol_solvated.pdb\", ):     simulation = interchange.to_openmm_simulation(         integrator=openmm.LangevinMiddleIntegrator(             300 * openmm.unit.kelvin,             1 / openmm.unit.picosecond,             0.002 * openmm.unit.picoseconds,         ),     )      pdb_reporter = openmm.app.PDBReporter(trajectory_name, reporter_frequency)     simulation.reporters.append(pdb_reporter)      simulation.context.setVelocitiesToTemperature(300 * openmm.unit.kelvin)     simulation.runForClockTime(10 * openmm.unit.second)   def visualise_traj(     topology: Topology, filename: str = \"small_mol_solvated.pdb\" ) -&gt; nglview.NGLWidget:     \"\"\"Visualise a trajectory using nglview.\"\"\"     traj = mdtraj.load(         filename,         top=mdtraj.Topology.from_openmm(topology.to_openmm()),     )      view = nglview.show_mdtraj(traj)     view.add_representation(\"licorice\", selection=\"water\")      return view   run_openmm(interchange) visualise_traj(interchange.topology) <pre>NGLWidget(max_frame=431)</pre> In\u00a0[25]: Copied! <pre>! bespokefit_smee clean workflow_settings.yaml\n</pre> ! bespokefit_smee clean workflow_settings.yaml <pre>Warning: importing 'simtk.openmm' is deprecated.  Import 'openmm' instead.\n2025-12-03 15:37:57.848 | INFO     | bespokefit_smee.utils.rdkit_bespoke_wrapper:__init__:148 - Using RDKitBespokeToolkitWrapper with symmetry-aware SMARTS matching. This will significantly speed up matching for molecules where each type  matches only one set of symmetry-equivalent atoms.\n2025-12-03 15:37:57.855 | INFO     | bespokefit_smee._cli:cli_cmd:77 - Cleaning output directory with settings from workflow_settings.yaml\n</pre>"},{"location":"examples/basic-walk-through-cli/#basic-walk-through-command-line-interface","title":"Basic Walk-Through: Command-Line Interface\u00b6","text":"<p>This example shows basic usage of <code>bespokefit_smee</code> through its command line interface. We'll run a ligand of TYK2 (a common benchmark system for FEP) with the SMILES <code>CCC(CC)C(=O)Nc2cc(NC(=O)c1c(Cl)cccc1Cl)ccn2</code>. The entire workflow can be run in a single line (after activating the environment):</p> <pre>bespokefit_smee train --parameterisation-settings.smiles \"CCC(CC)C(=O)Nc2cc(NC(=O)c1c(Cl)cccc1Cl)ccn2\"\n</pre> <p>but we'll go through this in more detail below.</p> Note: <code>!</code> and <code>%</code> symbols appear before commands in notebook cells to get them to behave as if they were run on the command line. If you're following along, you can ignore them and run the commands directly on the command line."},{"location":"examples/basic-walk-through-cli/#setup","title":"Setup\u00b6","text":"<p>After activating your environment (e.g. with <code>pixi shell</code>), navigate to a new directory and use <code>bespokefit_smee write-default-yaml</code> to write a default settings file:</p>"},{"location":"examples/basic-walk-through-cli/#execution","title":"Execution\u00b6","text":"<p>Run the fitting with <code>bespokefit_smee train-from-yaml</code>. This takes around 4 minutes with a GPU and around an hour using only CPUs.</p>"},{"location":"examples/basic-walk-through-cli/#analysis","title":"Analysis\u00b6","text":"<p>We now have a bespoke force field: check out <code>training_iteration_2/bespoke_ff.offxml</code>. Have a look for the bespoke types at the end of each section:</p>"},{"location":"examples/basic-walk-through-cli/#using-your-bespoke-force-field","title":"Using your bespoke force field\u00b6","text":"<p>Now we have our bespoke force field, we can use it in our intended application. As a quick illustration, we can easily run some vacuum MD with OpenFF's Toolkit and Interchange packages, and OpenMM. First, we can create an <code>Interchange</code> object which contains all of the information requied to start molecular dynamics.</p>"},{"location":"examples/basic-walk-through-cli/#cleaning-up","title":"Cleaning up\u00b6","text":"<p>To remove all files created by <code>bespokefit_smee</code>, you can run <code>bespokefit_smee clean workflow_settings.yaml</code>. This does not remove <code>workflow_settings.yaml</code>, rather uses it to find the expected files and remove them. This will raise an error and exit if it comes across any files it did not generate in directories it would otherwise delete.</p>"},{"location":"reference/","title":"Index","text":""},{"location":"reference/#bespokefit_smee","title":"bespokefit_smee","text":"<p>Fast parameterisation of MM force fields using MLPs.</p> <p>Modules:</p> <ul> <li> <code>analyse</code>           \u2013            <p>Functionality for analysing the results of a BespokeFitSMEE run.</p> </li> <li> <code>convert</code>           \u2013            <p>Convert OpenFF ForceField &lt;--&gt; smee TensorForceField.</p> </li> <li> <code>create_types</code>           \u2013            <p>Create new tagged SMARTS parameter types for molecules of interest.</p> </li> <li> <code>find_torsions</code>           \u2013            <p>Functionality for finding and sampling torsions in a molecule.</p> </li> <li> <code>hessian</code>           \u2013            <p>Functionality for computing the Hessian, closely based on https://github.com/qubekit/QUBEKit/blob/bdccc28d1ad8c0fb4eeb01467bfe8365396c411c/qubekit/engines/openmm.py#L174.</p> </li> <li> <code>loss</code>           \u2013            <p>Loss functions for tuning the forcefield</p> </li> <li> <code>metadynamics</code>           \u2013            <p>The code below is slightly modified from the original in OpenMM</p> </li> <li> <code>mlp</code>           \u2013            <p>Functionality for creating and managing ML potentials.</p> </li> <li> <code>models</code>           \u2013            <p>Compiled models</p> </li> <li> <code>msm</code>           \u2013            <p>Functionality for applying the modified Seminario method.</p> </li> <li> <code>outputs</code>           \u2013            <p>Functionality for handling the outputs of a workflow.</p> </li> <li> <code>sample</code>           \u2013            <p>Functionality to obtain samples to fit the force field to.</p> </li> <li> <code>settings</code>           \u2013            <p>Pydantic models which control/validate the settings.</p> </li> <li> <code>train</code>           \u2013            <p>Apply OpenFF parameters to molecule, cluster conformers by RMSD and train</p> </li> <li> <code>utils</code>           \u2013            <p>Utilities for the bespokefit_smee package.</p> </li> <li> <code>workflow</code>           \u2013            <p>Implements the overall workflow for fitting a bespoke force field.</p> </li> <li> <code>writers</code>           \u2013            <p>WRITERS:</p> </li> </ul>"},{"location":"reference/SUMMARY/","title":"SUMMARY","text":"<ul> <li>bespokefit_smee<ul> <li>analyse</li> <li>convert</li> <li>create_types</li> <li>find_torsions</li> <li>hessian</li> <li>loss</li> <li>metadynamics</li> <li>mlp</li> <li>models<ul> <li>compile_aimnet2_ens_models</li> </ul> </li> <li>msm</li> <li>outputs</li> <li>sample</li> <li>settings</li> <li>train</li> <li>utils<ul> <li>aimnet2</li> <li>gpu</li> <li>register</li> <li>typing</li> </ul> </li> <li>workflow</li> <li>writers</li> </ul> </li> </ul>"},{"location":"reference/analyse/","title":"analyse","text":""},{"location":"reference/analyse/#bespokefit_smee.analyse","title":"analyse","text":"<p>Functionality for analysing the results of a BespokeFitSMEE run.</p> <p>Functions:</p> <ul> <li> <code>read_errors</code>             \u2013              <p>Read all energy and force data from the HDF5 files.</p> </li> <li> <code>load_force_fields</code>             \u2013              <p>Load the .offxml files from the given paths.</p> </li> <li> <code>plot_energy_correlation</code>             \u2013              <p>Plot the correlation between reference and predicted values. For</p> </li> <li> <code>get_mol_image_with_atom_idxs</code>             \u2013              <p>Generate a PIL Image of the molecule with atom indices labeled.</p> </li> <li> <code>plot_force_error_by_atom_idx</code>             \u2013              <p>Plot a seaborn swarmplot of the force errors by atom index.</p> </li> <li> <code>plot_error_statistics</code>             \u2013              <p>Plot the error statistics for the energy and force errors.</p> </li> <li> <code>analyse_workflow</code>             \u2013              <p>Analyse the results of a BespokeFitSMEE workflow.</p> </li> </ul>"},{"location":"reference/analyse/#bespokefit_smee.analyse._add_legend_if_labels","title":"_add_legend_if_labels","text":"<pre><code>_add_legend_if_labels(ax: Axes, **kwargs: Any) -&gt; None\n</code></pre> <p>Add a legend to the axes only if there are labeled artists.</p> Source code in <code>bespokefit_smee/analyse.py</code> <pre><code>def _add_legend_if_labels(ax: Axes, **kwargs: Any) -&gt; None:\n    \"\"\"Add a legend to the axes only if there are labeled artists.\"\"\"\n    handles, labels = ax.get_legend_handles_labels()\n    if labels:\n        ax.legend(**kwargs)\n</code></pre>"},{"location":"reference/analyse/#bespokefit_smee.analyse.read_errors","title":"read_errors","text":"<pre><code>read_errors(\n    paths_by_iter: dict[int, Path],\n) -&gt; dict[str, dict[int, NDArray[float64]]]\n</code></pre> <p>Read all energy and force data from the HDF5 files.</p> <p>Returns:     Dictionary with keys: 'energy_reference', 'energy_predicted', 'energy_differences',     'forces_reference', 'forces_predicted', 'forces_differences'.     Each value is a dict mapping iteration number to numpy array.</p> Source code in <code>bespokefit_smee/analyse.py</code> <pre><code>def read_errors(\n    paths_by_iter: dict[int, Path],\n) -&gt; dict[str, dict[int, npt.NDArray[np.float64]]]:\n    \"\"\"Read all energy and force data from the HDF5 files.\n\n    Returns:\n        Dictionary with keys: 'energy_reference', 'energy_predicted', 'energy_differences',\n        'forces_reference', 'forces_predicted', 'forces_differences'.\n        Each value is a dict mapping iteration number to numpy array.\n    \"\"\"\n\n    results: dict[str, dict[int, npt.NDArray[np.float64]]] = {\n        \"energy_reference\": {},\n        \"energy_predicted\": {},\n        \"energy_differences\": {},\n        \"forces_reference\": {},\n        \"forces_predicted\": {},\n        \"forces_differences\": {},\n    }\n\n    for i, filepath in paths_by_iter.items():\n        with h5py.File(filepath, \"r\") as f:\n            results[\"energy_reference\"][i] = f[\"energy_reference\"][:]\n            results[\"energy_predicted\"][i] = f[\"energy_predicted\"][:]\n            results[\"energy_differences\"][i] = f[\"energy_differences\"][:]\n            results[\"forces_reference\"][i] = f[\"forces_reference\"][:]\n            results[\"forces_predicted\"][i] = f[\"forces_predicted\"][:]\n            results[\"forces_differences\"][i] = f[\"forces_differences\"][:]\n            results[\"n_atoms\"] = f.attrs[\"n_atoms\"]\n            results[\"n_conformers\"] = f.attrs[\"n_conformers\"]\n\n    return results\n</code></pre>"},{"location":"reference/analyse/#bespokefit_smee.analyse.load_force_fields","title":"load_force_fields","text":"<pre><code>load_force_fields(\n    paths_by_iter: dict[int, Path],\n) -&gt; dict[int, str]\n</code></pre> <p>Load the .offxml files from the given paths.</p> Source code in <code>bespokefit_smee/analyse.py</code> <pre><code>def load_force_fields(paths_by_iter: dict[int, Path]) -&gt; dict[int, str]:\n    \"\"\"Load the .offxml files from the given paths.\"\"\"\n    return {i: ForceField(p) for i, p in paths_by_iter.items()}\n</code></pre>"},{"location":"reference/analyse/#bespokefit_smee.analyse.plot_energy_correlation","title":"plot_energy_correlation","text":"<pre><code>plot_energy_correlation(\n    fig: Figure,\n    ax: Axes,\n    reference: dict[int, NDArray[float64]],\n    predicted: dict[int, NDArray[float64]],\n) -&gt; None\n</code></pre> <p>Plot the correlation between reference and predicted values. For forces, convert to the magnitude of the forces.</p> Source code in <code>bespokefit_smee/analyse.py</code> <pre><code>def plot_energy_correlation(\n    fig: Figure,\n    ax: Axes,\n    reference: dict[int, npt.NDArray[np.float64]],\n    predicted: dict[int, npt.NDArray[np.float64]],\n) -&gt; None:\n    \"\"\"Plot the correlation between reference and predicted values. For\n    forces, convert to the magnitude of the forces.\"\"\"\n\n    for i in reference.keys():\n        ax.scatter(reference[i], predicted[i], alpha=0.5, label=f\"Iteration {i}\")\n    all_values = np.concatenate(list(reference.values()) + list(predicted.values()))\n    min_val = all_values.min()\n    max_val = all_values.max()\n    ax.plot([min_val, max_val], [min_val, max_val], color=\"red\", linestyle=\"--\")\n    ax.set_xlabel(\"Reference Energy / kcal mol$^{-1}$\")\n    ax.set_ylabel(\"Predicted Energy / kcal mol$^{-1}$\")\n    ax.set_title(\"Energy Correlation Plot\")\n    ax.legend(bbox_to_anchor=(1.05, 1), loc=\"upper left\")\n</code></pre>"},{"location":"reference/analyse/#bespokefit_smee.analyse.get_mol_image_with_atom_idxs","title":"get_mol_image_with_atom_idxs","text":"<pre><code>get_mol_image_with_atom_idxs(\n    molecule: Molecule, width: int = 300, height: int = 300\n) -&gt; Image\n</code></pre> <p>Generate a PIL Image of the molecule with atom indices labeled.</p> Source code in <code>bespokefit_smee/analyse.py</code> <pre><code>def get_mol_image_with_atom_idxs(\n    molecule: Molecule, width: int = 300, height: int = 300\n) -&gt; Image.Image:\n    \"\"\"Generate a PIL Image of the molecule with atom indices labeled.\"\"\"\n    molecule_copy = Molecule(molecule)\n    molecule_copy._conformers = None\n\n    rdmol = molecule_copy.to_rdkit()\n\n    # Build labels like \"C:0\", \"C:1\", \"C:2\", ...\n    atom_labels = {\n        atom.GetIdx(): f\"{atom.GetSymbol()}:{atom.GetIdx()}\"\n        for atom in rdmol.GetAtoms()\n    }\n\n    drawer = Draw.MolDraw2DCairo(width, height)\n    opts = drawer.drawOptions()\n    for idx, label in atom_labels.items():\n        opts.atomLabels[idx] = label\n\n    Draw.rdMolDraw2D.PrepareAndDrawMolecule(drawer, rdmol)\n    drawer.FinishDrawing()\n\n    # Convert PNG bytes to PIL Image\n    png_data = drawer.GetDrawingText()\n    img = Image.open(io.BytesIO(png_data))\n\n    return img\n</code></pre>"},{"location":"reference/analyse/#bespokefit_smee.analyse.plot_force_error_by_atom_idx","title":"plot_force_error_by_atom_idx","text":"<pre><code>plot_force_error_by_atom_idx(\n    fig: Figure,\n    ax: Axes,\n    errors: dict[int, NDArray[float64]],\n    mol: Molecule,\n) -&gt; None\n</code></pre> <p>Plot a seaborn swarmplot of the force errors by atom index.</p> Source code in <code>bespokefit_smee/analyse.py</code> <pre><code>def plot_force_error_by_atom_idx(\n    fig: Figure,\n    ax: Axes,\n    errors: dict[int, npt.NDArray[np.float64]],\n    mol: Molecule,\n) -&gt; None:\n    \"\"\"Plot a seaborn swarmplot of the force errors by atom index.\"\"\"\n    import seaborn as sns\n\n    for iteration, force_errors in errors.items():\n        # Create an array of atom indices\n        atom_indices = np.arange(len(force_errors)) % mol.n_atoms\n        df = pd.DataFrame(\n            {\n                \"atom_index\": atom_indices,\n                \"force_error\": np.linalg.norm(force_errors, axis=1),\n                \"iteration\": np.ones_like(atom_indices) * iteration,\n            }\n        )\n        sns.stripplot(\n            x=\"atom_index\",\n            y=\"force_error\",\n            data=df,\n            ax=ax,\n            label=f\"Iteration {iteration}\",\n            alpha=0.4,\n        )\n\n    # Get molecule image\n    mol_image = get_mol_image_with_atom_idxs(mol, width=1800, height=600)\n\n    # Create an inset axes above the main plot for the molecule\n    from mpl_toolkits.axes_grid1.inset_locator import inset_axes\n\n    ax_inset = inset_axes(\n        ax,\n        width=\"400%\",\n        height=\"120%\",\n        loc=\"upper center\",\n        bbox_to_anchor=(0, 1.15, 1, 0.3),\n        bbox_transform=ax.transAxes,\n    )\n    ax_inset.imshow(mol_image)\n    ax_inset.axis(\"off\")\n\n    ax.set_xlabel(\"Atom Index\")\n    ax.set_ylabel(\"Force Error / kcal mol$^{-1}$ \u00c5$^{-1}$\")\n\n    # Deduplicate legend entries\n    handles, labels = ax.get_legend_handles_labels()\n    by_label = dict(zip(labels, handles, strict=False))\n    ax.legend(\n        by_label.values(), by_label.keys(), bbox_to_anchor=(1.05, 1), loc=\"upper left\"\n    )\n</code></pre>"},{"location":"reference/analyse/#bespokefit_smee.analyse.plot_error_statistics","title":"plot_error_statistics","text":"<pre><code>plot_error_statistics(\n    fig: Figure,\n    axs: NDArray[Any],\n    errors: dict[\n        Literal[\"energy_differences\", \"forces_differences\"],\n        dict[int, NDArray[float64]],\n    ],\n) -&gt; None\n</code></pre> <p>Plot the error statistics for the energy and force errors.</p> Source code in <code>bespokefit_smee/analyse.py</code> <pre><code>def plot_error_statistics(\n    fig: Figure,\n    axs: npt.NDArray[Any],\n    errors: dict[\n        Literal[\"energy_differences\", \"forces_differences\"],\n        dict[int, npt.NDArray[np.float64]],\n    ],\n) -&gt; None:\n    \"\"\"Plot the error statistics for the energy and force errors.\"\"\"\n\n    axs = axs.flatten()\n    plot_distributions_of_errors(fig, axs[0], errors[\"energy_differences\"], \"energy\")\n    plot_distributions_of_errors(fig, axs[1], errors[\"forces_differences\"], \"force\")\n    # Hide the legend in the first plot\n    axs[0].legend().set_visible(False)\n\n    # Plot the rmsds of the errors\n    plot_rmse_of_errors(fig, axs[2], errors[\"energy_differences\"], \"energy\")\n    plot_rmse_of_errors(fig, axs[3], errors[\"forces_differences\"], \"force\")\n</code></pre>"},{"location":"reference/analyse/#bespokefit_smee.analyse.analyse_workflow","title":"analyse_workflow","text":"<pre><code>analyse_workflow(\n    workflow_settings: WorkflowSettings,\n) -&gt; None\n</code></pre> <p>Analyse the results of a BespokeFitSMEE workflow.</p> Source code in <code>bespokefit_smee/analyse.py</code> <pre><code>def analyse_workflow(workflow_settings: WorkflowSettings) -&gt; None:\n    \"\"\"Analyse the results of a BespokeFitSMEE workflow.\"\"\"\n\n    mols = workflow_settings.parameterisation_settings.molecules\n\n    with plt.style.context(PLT_STYLE):\n        # Plot the losses\n        path_manager = workflow_settings.get_path_manager()\n        stage = OutputStage(StageKind.PLOTS)\n        path_manager.mk_stage_dir(stage)\n\n        output_paths_by_type = path_manager.get_all_output_paths_by_output_type()\n        output_paths_by_type_by_mol = (\n            path_manager.get_all_output_paths_by_output_type_by_molecule()\n        )\n\n        training_metric_paths = dict(\n            enumerate(output_paths_by_type[OutputType.TRAINING_METRICS])\n        )\n        losses = read_losses(training_metric_paths)\n        fig, ax = plt.subplots(figsize=(10, 6))\n        plot_loss(fig, ax, losses)\n        fig.savefig(\n            str(path_manager.get_output_path(stage, OutputType.LOSS_PLOT)),\n            dpi=300,\n            bbox_inches=\"tight\",\n        )\n        plt.close(fig)\n\n        # Get scatter paths organized by molecule\n        scatter_paths_by_mol = output_paths_by_type_by_mol.get(OutputType.SCATTER, {})\n        assert isinstance(scatter_paths_by_mol, dict)\n\n        # Plot for each molecule\n        for mol_idx, mol in enumerate(mols):\n            if mol_idx not in scatter_paths_by_mol:\n                logger.warning(f\"No scatter paths found for molecule {mol_idx}\")\n                continue\n\n            # Convert list of paths to dict indexed by iteration\n            scatter_paths_for_mol = dict(enumerate(scatter_paths_by_mol[mol_idx]))\n            errors = read_errors(scatter_paths_for_mol)\n\n            # Plot the errors\n            fig, axs = plt.subplots(2, 2, figsize=(13, 12))\n            plot_error_statistics(fig, axs, errors)  # type: ignore[arg-type]\n            error_plot_path = path_manager.get_output_path(stage, OutputType.ERROR_PLOT)\n            error_plot_path_mol = get_mol_path(error_plot_path, mol_idx)\n            fig.savefig(str(error_plot_path_mol), dpi=300, bbox_inches=\"tight\")\n            plt.close(fig)\n\n            # Plot the correlation plots\n            fig, ax = plt.subplots(1, 1, figsize=(6.5, 6))\n            plot_energy_correlation(\n                fig,\n                ax,\n                errors[\"energy_reference\"],\n                errors[\"energy_predicted\"],\n            )\n            corr_plot_path = path_manager.get_output_path(\n                stage, OutputType.CORRELATION_PLOT\n            )\n            corr_plot_path_mol = get_mol_path(corr_plot_path, mol_idx)\n            fig.savefig(str(corr_plot_path_mol), dpi=300, bbox_inches=\"tight\")\n            plt.close(fig)\n\n            # Plot the force error by atom index\n            fig, ax = plt.subplots(1, 1, figsize=(0.5 * mol.n_atoms, 6))\n            plot_force_error_by_atom_idx(fig, ax, errors[\"forces_differences\"], mol)\n            force_error_plot_path = path_manager.get_output_path(\n                stage, OutputType.FORCE_ERROR_BY_ATOM_INDEX_PLOT\n            )\n            force_error_plot_path_mol = get_mol_path(force_error_plot_path, mol_idx)\n            fig.savefig(str(force_error_plot_path_mol), dpi=300, bbox_inches=\"tight\")\n            plt.close(fig)\n\n        # Plot the force field changes for each molecule\n        offxml_paths = output_paths_by_type.get(OutputType.OFFXML, [])\n        assert isinstance(offxml_paths, list)\n        ff_paths = load_force_fields(dict(enumerate(offxml_paths)))\n\n        for mol_idx, mol in enumerate(mols):\n            fig, axs = plot_all_ffs(ff_paths, mol, \"values\")\n            param_values_plot_path = path_manager.get_output_path(\n                stage, OutputType.PARAMETER_VALUES_PLOT\n            )\n            param_values_plot_path_mol = get_mol_path(param_values_plot_path, mol_idx)\n            fig.savefig(str(param_values_plot_path_mol), dpi=300, bbox_inches=\"tight\")\n            plt.close(fig)\n\n            fig, axs = plot_all_ffs(ff_paths, mol, \"differences\")\n            param_diff_plot_path = path_manager.get_output_path(\n                stage, OutputType.PARAMETER_DIFFERENCES_PLOT\n            )\n            param_diff_plot_path_mol = get_mol_path(param_diff_plot_path, mol_idx)\n            fig.savefig(str(param_diff_plot_path_mol), dpi=300, bbox_inches=\"tight\")\n            plt.close(fig)\n</code></pre>"},{"location":"reference/convert/","title":"convert","text":""},{"location":"reference/convert/#bespokefit_smee.convert","title":"convert","text":"<p>Convert OpenFF ForceField &lt;--&gt; smee TensorForceField.</p> <p>Functions:</p> <ul> <li> <code>convert_to_smirnoff</code>             \u2013              <p>Convert a tensor force field that contains bespoke valence parameters to</p> </li> <li> <code>parameterise</code>             \u2013              <p>Prepare a Trainable object that contains a force field with</p> </li> <li> <code>parameterise_old</code>             \u2013              <p>Old implementation of parameterise using _prepare_potential.</p> </li> <li> <code>linearise_harmonics_force_field</code>             \u2013              <p>Linearize the harmonic potential parameters in the forcefield.</p> </li> <li> <code>linearise_harmonics_topology</code>             \u2013              <p>Linearize harmonic potential parameters in the topology.</p> </li> </ul>"},{"location":"reference/convert/#bespokefit_smee.convert._reflect_angle","title":"_reflect_angle","text":"<pre><code>_reflect_angle(angle: float) -&gt; float\n</code></pre> <p>Reflect an angle (in radians) to be in the range [0, pi).</p> Source code in <code>bespokefit_smee/convert.py</code> <pre><code>def _reflect_angle(angle: float) -&gt; float:\n    \"\"\"Reflect an angle (in radians) to be in the range [0, pi).\"\"\"\n    return math.pi - abs((angle % (2 * math.pi)) - math.pi)\n</code></pre>"},{"location":"reference/convert/#bespokefit_smee.convert.convert_to_smirnoff","title":"convert_to_smirnoff","text":"<pre><code>convert_to_smirnoff(\n    ff: TensorForceField, base: ForceField | None = None\n) -&gt; ForceField\n</code></pre> <p>Convert a tensor force field that contains bespoke valence parameters to SMIRNOFF format. Args:     ff: The force field containing the bespoke valence terms.     base: The (optional) original SMIRNOFF force field to add the bespoke         parameters to. If no specified, a force field containing only the bespoke         parameters will be returned. Returns:     A SMIRNOFF force field containing the valence terms of the input force field.</p> Source code in <code>bespokefit_smee/convert.py</code> <pre><code>def convert_to_smirnoff(\n    ff: smee.TensorForceField, base: openff.toolkit.ForceField | None = None\n) -&gt; openff.toolkit.ForceField:\n    \"\"\"Convert a tensor force field that *contains bespoke valence parameters* to\n    SMIRNOFF format.\n    Args:\n        ff: The force field containing the bespoke valence terms.\n        base: The (optional) original SMIRNOFF force field to add the bespoke\n            parameters to. If no specified, a force field containing only the bespoke\n            parameters will be returned.\n    Returns:\n        A SMIRNOFF force field containing the valence terms of the input force field.\n    \"\"\"\n    ff_smirnoff = openff.toolkit.ForceField() if base is None else copy.deepcopy(base)\n\n    for potential in ff.potentials:\n        if potential.type in {\"Bonds\", \"Angles\", \"ProperTorsions\", \"ImproperTorsions\"}:\n            assert potential.attribute_cols is None\n            parameters_by_smarts: dict[str, dict[int | None, torch.Tensor]] = (\n                collections.defaultdict(dict)\n            )\n            for parameter, parameter_key in zip(\n                potential.parameters, potential.parameter_keys, strict=True\n            ):\n                assert parameter_key.mult not in parameters_by_smarts[parameter_key.id]\n                parameters_by_smarts[parameter_key.id][parameter_key.mult] = parameter\n            handler = ff_smirnoff.get_parameter_handler(potential.type)\n            for smarts, parameters_by_mult in parameters_by_smarts.items():\n                mults = {*parameters_by_mult}\n                if None in mults and len(mults) &gt; 1:\n                    raise NotImplementedError(\"unexpected parameters found\")\n                if None not in mults and mults != {*range(len(mults))}:\n                    raise NotImplementedError(\"unexpected parameters found\")\n                counter = len(handler.parameters) + 1\n                parameter_id = f\"{potential.type[0].lower()}-bespoke-{counter}\"\n                parameter_dict: dict[str, str | Quantity] = {\n                    \"smirks\": smarts,\n                    \"id\": parameter_id,\n                }\n                parameter_dict.update(\n                    {\n                        (col if mult is None else f\"{col}{mult + 1}\"): float(\n                            parameter[col_idx]\n                        )\n                        * potential.parameter_units[col_idx]\n                        for mult, parameter in parameters_by_mult.items()\n                        for col_idx, col in enumerate(potential.parameter_cols)\n                    }\n                )\n                _add_parameter_with_overwrite(handler, parameter_dict)\n\n        elif potential.type == \"LinearBonds\":\n            assert potential.attribute_cols is None\n            parameters_by_smarts = collections.defaultdict(dict)\n            new_params = []\n            for param in potential.parameters:\n                k1 = param[0].item()\n                k2 = param[1].item()\n                b1 = param[2].item()\n                b2 = param[3].item()\n                k = k1 + k2\n                b = (k1 * b1 + k2 * b2) / k\n                dt = param.dtype\n                new_params.append([k, b])\n            reconstructed_param = torch.tensor(new_params, dtype=dt)\n            reconstructed_units = (_KCAL_PER_MOL_ANGSQ, _ANGSTROM)\n            reconstructed_cols = (\"k\", \"length\")\n            for parameter, parameter_key in zip(\n                reconstructed_param, potential.parameter_keys, strict=True\n            ):\n                assert parameter_key.mult not in parameters_by_smarts[parameter_key.id]\n                parameters_by_smarts[parameter_key.id][parameter_key.mult] = parameter\n            handler = ff_smirnoff.get_parameter_handler(\"Bonds\")\n            for smarts, parameters_by_mult in parameters_by_smarts.items():\n                mults = {*parameters_by_mult}\n                if None in mults and len(mults) &gt; 1:\n                    raise NotImplementedError(\"unexpected parameters found\")\n                if None not in mults and mults != {*range(len(mults))}:\n                    raise NotImplementedError(\"unexpected parameters found\")\n                counter = len(handler.parameters) + 1\n                parameter_id = f\"{potential.type[0].lower()}-bespoke-{counter}\"\n                parameter_dict = {\"smirks\": smarts, \"id\": parameter_id}\n                parameter_dict.update(\n                    {\n                        (col if mult is None else f\"{col}{mult + 1}\"): float(\n                            parameter[col_idx]\n                        )\n                        * reconstructed_units[col_idx]\n                        for mult, parameter in parameters_by_mult.items()\n                        for col_idx, col in enumerate(reconstructed_cols)\n                    }\n                )\n                _add_parameter_with_overwrite(handler, parameter_dict)\n        elif potential.type == \"LinearAngles\":\n            assert potential.attribute_cols is None\n            parameters_by_smarts = collections.defaultdict(dict)\n            new_params = []\n            for param in potential.parameters:\n                k1 = param[0].item()\n                k2 = param[1].item()\n                a1 = param[2].item()\n                a2 = param[3].item()\n                k = k1 + k2\n                # Set k and angle to 0 if very close\n                a = (k1 * a1 + k2 * a2) / k\n                # Ensure that the angle is in the range [0, pi)\n                a = _reflect_angle(a)\n                dt = param.dtype\n                new_params.append([k, a])\n            reconstructed_param = torch.tensor(new_params, dtype=dt)\n            reconstructed_units = (_KCAL_PER_MOL_RADSQ, _RADIANS)\n            reconstructed_cols = (\"k\", \"angle\")\n            for parameter, parameter_key in zip(\n                reconstructed_param, potential.parameter_keys, strict=True\n            ):\n                assert parameter_key.mult not in parameters_by_smarts[parameter_key.id]\n                parameters_by_smarts[parameter_key.id][parameter_key.mult] = parameter\n            handler = ff_smirnoff.get_parameter_handler(\"Angles\")\n            for smarts, parameters_by_mult in parameters_by_smarts.items():\n                mults = {*parameters_by_mult}\n                if None in mults and len(mults) &gt; 1:\n                    raise NotImplementedError(\"unexpected parameters found\")\n                if None not in mults and mults != {*range(len(mults))}:\n                    raise NotImplementedError(\"unexpected parameters found\")\n                counter = len(handler.parameters) + 1\n                parameter_id = f\"{potential.type[0].lower()}-bespoke-{counter}\"\n                parameter_dict = {\"smirks\": smarts, \"id\": parameter_id}\n                parameter_dict.update(\n                    {\n                        (col if mult is None else f\"{col}{mult + 1}\"): float(\n                            parameter[col_idx]\n                        )\n                        * reconstructed_units[col_idx]\n                        for mult, parameter in parameters_by_mult.items()\n                        for col_idx, col in enumerate(reconstructed_cols)\n                    }\n                )\n                _add_parameter_with_overwrite(handler, parameter_dict)\n        elif potential.type == \"LinearProperTorsions\":\n            assert potential.attribute_cols is None\n            parameters_by_smarts = collections.defaultdict(dict)\n            new_params = []\n            for param in potential.parameters:\n                k1 = param[0].item()\n                k2 = param[1].item()\n                periodicity = param[2].item()\n                # Params 3 and 4 are phase1 and phase2\n                idivf = param[5].item()\n                k = k1 + k2\n                if k == 0.0:\n                    phase = 0.0\n                else:\n                    phase = math.acos((k1 - k2) / k)\n                dt = param.dtype\n                new_params.append([k, periodicity, phase, idivf])\n            reconstructed_param = torch.tensor(new_params, dtype=dt)\n            reconstructed_torsion_units = (\n                _KCAL_PER_MOL,\n                _UNITLESS,\n                _RADIANS,\n                _UNITLESS,\n            )\n            reconstructed_torsion_cols = (\"k\", \"periodicity\", \"phase\", \"idivf\")\n            for parameter, parameter_key in zip(\n                reconstructed_param, potential.parameter_keys, strict=True\n            ):\n                assert parameter_key.mult not in parameters_by_smarts[parameter_key.id]\n                parameters_by_smarts[parameter_key.id][parameter_key.mult] = parameter\n            handler = ff_smirnoff.get_parameter_handler(\"ProperTorsions\")\n            for smarts, parameters_by_mult in parameters_by_smarts.items():\n                mults = {*parameters_by_mult}\n                if None in mults and len(mults) &gt; 1:\n                    raise NotImplementedError(\"unexpected parameters found\")\n                if None not in mults and mults != {*range(len(mults))}:\n                    raise NotImplementedError(\"unexpected parameters found\")\n                counter = len(handler.parameters) + 1\n                parameter_id = f\"{potential.type[0].lower()}-bespoke-{counter}\"\n                parameter_dict = {\"smirks\": smarts, \"id\": parameter_id}\n                parameter_dict.update(\n                    {\n                        (col if mult is None else f\"{col}{mult + 1}\"): float(\n                            parameter[col_idx]\n                        )\n                        * reconstructed_torsion_units[col_idx]\n                        for mult, parameter in parameters_by_mult.items()\n                        for col_idx, col in enumerate(reconstructed_torsion_cols)\n                    }\n                )\n                _add_parameter_with_overwrite(handler, parameter_dict)\n        elif potential.type == \"LinearImproperTorsions\":\n            assert potential.attribute_cols is None\n            parameters_by_smarts = collections.defaultdict(dict)\n            new_params = []\n            for param in potential.parameters:\n                k1 = param[0].item()\n                k2 = param[1].item()\n                periodicity = param[2].item()\n                # Params 3 and 4 are phase1 and phase2\n                idivf = param[5].item()\n                k = k1 + k2\n                if k == 0.0:\n                    phase = 0.0\n                else:\n                    phase = math.acos((k1 - k2) / k)\n                #                    phase = math.acos((k1 * math.cos(phase1) + k2 * math.cos(phase2))/k)\n                dt = param.dtype\n                new_params.append([k, periodicity, phase, idivf])\n            reconstructed_param = torch.tensor(new_params, dtype=dt)\n            reconstructed_torsion_units = (\n                _KCAL_PER_MOL,\n                _UNITLESS,\n                _RADIANS,\n                _UNITLESS,\n            )\n            reconstructed_torsion_cols = (\"k\", \"periodicity\", \"phase\", \"idivf\")\n            for parameter, parameter_key in zip(\n                reconstructed_param, potential.parameter_keys, strict=True\n            ):\n                assert parameter_key.mult not in parameters_by_smarts[parameter_key.id]\n                parameters_by_smarts[parameter_key.id][parameter_key.mult] = parameter\n            handler = ff_smirnoff.get_parameter_handler(\"ImproperTorsions\")\n            for smarts, parameters_by_mult in parameters_by_smarts.items():\n                mults = {*parameters_by_mult}\n                if None in mults and len(mults) &gt; 1:\n                    raise NotImplementedError(\"unexpected parameters found\")\n                if None not in mults and mults != {*range(len(mults))}:\n                    raise NotImplementedError(\"unexpected parameters found\")\n                counter = len(handler.parameters) + 1\n                parameter_id = f\"{potential.type[0].lower()}-bespoke-{counter}\"\n                parameter_dict = {\"smirks\": smarts, \"id\": parameter_id}\n                parameter_dict.update(\n                    {\n                        (col if mult is None else f\"{col}{mult + 1}\"): float(\n                            parameter[col_idx]\n                        )\n                        * reconstructed_torsion_units[col_idx]\n                        for mult, parameter in parameters_by_mult.items()\n                        for col_idx, col in enumerate(reconstructed_torsion_cols)\n                    }\n                )\n                _add_parameter_with_overwrite(handler, parameter_dict)\n\n    return ff_smirnoff\n</code></pre>"},{"location":"reference/convert/#bespokefit_smee.convert._prepare_potential","title":"_prepare_potential","text":"<pre><code>_prepare_potential(\n    mol: Molecule,\n    symmetries: list[int],\n    potential: TensorPotential,\n    parameter_map: ValenceParameterMap,\n    max_extend_distance: int = -1,\n    excluded_smirks: list[str] | None = None,\n) -&gt; None\n</code></pre> <p>Prepare a potential to use bespoke parameters for each 'slot'.</p> Source code in <code>bespokefit_smee/convert.py</code> <pre><code>def _prepare_potential(\n    mol: openff.toolkit.Molecule,\n    symmetries: list[int],\n    potential: smee.TensorPotential,\n    parameter_map: smee.ValenceParameterMap,\n    max_extend_distance: int = -1,\n    excluded_smirks: list[str] | None = None,\n) -&gt; None:\n    \"\"\"Prepare a potential to use bespoke parameters for each 'slot'.\"\"\"\n\n    if not max_extend_distance == -1:\n        raise NotImplementedError(\"max_extend_distance is not implemented yet.\")\n\n    excluded_smirks = excluded_smirks or []\n\n    is_indexed = any(key.mult is not None for key in potential.parameter_keys)\n\n    ids_to_parameter_idxs = collections.defaultdict(set)\n    ids_to_particle_idxs = collections.defaultdict(set)\n\n    ids_to_smarts = {}\n\n    excluded_smirks_to_ids = {}\n\n    for particle_idxs, assignment_row in zip(\n        parameter_map.particle_idxs,\n        parameter_map.assignment_matrix.to_dense(),\n        strict=True,\n    ):\n        particle_idxs = tuple(int(idx) for idx in particle_idxs)\n        particle_ids = tuple(symmetries[idx] for idx in particle_idxs)\n\n        if potential.type != \"ImproperTorsions\" and particle_ids[-1] &lt; particle_ids[0]:\n            particle_ids = particle_ids[::-1]\n\n        parameter_idxs = [\n            parameter_idx\n            for parameter_idx, value in enumerate(assignment_row)\n            if int(value) != 0\n        ]\n        assert len(parameter_idxs) == 1\n\n        initial_smarts = potential.parameter_keys[parameter_idxs[0]].id\n\n        if initial_smarts in excluded_smirks:\n            if initial_smarts not in excluded_smirks_to_ids:\n                excluded_smirks_to_ids[initial_smarts] = particle_ids\n            else:\n                particle_ids = excluded_smirks_to_ids[initial_smarts]\n\n        ids_to_parameter_idxs[particle_ids].add(parameter_idxs[0])\n        ids_to_particle_idxs[particle_ids].add(particle_idxs)\n\n        if potential.type == \"ImproperTorsions\":\n            particle_idxs = (\n                particle_idxs[1],\n                particle_idxs[0],\n                particle_idxs[2],\n                particle_idxs[3],\n            )\n\n        if initial_smarts in excluded_smirks:\n            ids_to_smarts[particle_ids] = initial_smarts\n        else:\n            ids_to_smarts[particle_ids] = _create_smarts(mol, particle_idxs)\n\n    sorted_ids_to_parameter_idxs = {\n        particle_ids: sorted(parameter_idxs)\n        for particle_ids, parameter_idxs in ids_to_parameter_idxs.items()\n    }\n\n    parameter_ids = [\n        (particle_ids, parameter_idx)\n        for particle_ids, parameter_idxs in sorted_ids_to_parameter_idxs.items()\n        for parameter_idx in parameter_idxs\n    ]\n    potential.parameters = potential.parameters[\n        [parameter_idx for _, parameter_idx in parameter_ids]\n    ]\n    potential.parameter_keys = [\n        openff.interchange.models.PotentialKey(\n            id=ids_to_smarts[particle_ids],\n            mult=(\n                sorted_ids_to_parameter_idxs[particle_ids].index(parameter_idx)\n                if is_indexed\n                else None\n            ),\n            associated_handler=potential.type,\n            bond_order=None,\n            virtual_site_type=None,\n            cosmetic_attributes={},\n        )\n        for particle_ids, parameter_idx in parameter_ids\n    ]\n\n    assignment_matrix = smee.utils.zeros_like(\n        (len(parameter_map.particle_idxs), len(potential.parameters)),\n        parameter_map.assignment_matrix,\n    )\n\n    particle_idxs_updated: list[tuple[int, ...]] = []\n\n    for particle_ids, particle_idxs in ids_to_particle_idxs.items():\n        for particle_idx in particle_idxs:\n            for parameter_idx in sorted_ids_to_parameter_idxs[particle_ids]:\n                j = parameter_ids.index((particle_ids, parameter_idx))\n\n                assignment_matrix[len(particle_idxs_updated), j] = 1\n                particle_idxs_updated.append(particle_idx)\n\n    parameter_map.particle_idxs = smee.utils.tensor_like(\n        particle_idxs_updated, parameter_map.particle_idxs\n    )\n    parameter_map.assignment_matrix = assignment_matrix.to_sparse()\n</code></pre>"},{"location":"reference/convert/#bespokefit_smee.convert.parameterise","title":"parameterise","text":"<pre><code>parameterise(\n    settings: ParameterisationSettings,\n    device: TorchDevice = \"cuda\",\n) -&gt; tuple[\n    list[Molecule],\n    ForceField,\n    list[TensorTopology],\n    TensorForceField,\n]\n</code></pre> <p>Prepare a Trainable object that contains a force field with unique parameters for each topologically symmetric term across multiple molecules.</p> <p>Parameters:</p> <ul> <li> <code>settings</code>               (<code>ParameterisationSettings</code>)           \u2013            <p>The settings for the parameterisation.</p> </li> <li> <code>device</code>               (<code>TorchDevice</code>, default:                   <code>'cuda'</code> )           \u2013            <p>The device to use for the force field and topology.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>mols</code> (              <code>list[Molecule]</code> )          \u2013            <p>The molecules that have been parameterised.</p> </li> <li> <code>off_ff</code> (              <code>ForceField</code> )          \u2013            <p>The original force field, used as a base for the bespoke force field.</p> </li> <li> <code>tensor_tops</code> (              <code>list[TensorTopology]</code> )          \u2013            <p>The topologies of the molecules.</p> </li> <li> <code>tensor_ff</code> (              <code>TensorForceField</code> )          \u2013            <p>The force field with unique parameters for each topologically symmetric term.</p> </li> </ul> Source code in <code>bespokefit_smee/convert.py</code> <pre><code>def parameterise(\n    settings: ParameterisationSettings,\n    device: TorchDevice = \"cuda\",\n) -&gt; tuple[\n    list[openff.toolkit.Molecule],\n    openff.toolkit.ForceField,\n    list[smee.TensorTopology],\n    smee.TensorForceField,\n]:\n    \"\"\"Prepare a Trainable object that contains a force field with\n    unique parameters for each topologically symmetric term across multiple molecules.\n\n    Parameters\n    ----------\n    settings: ParameterisationSettings\n        The settings for the parameterisation.\n\n    device: TorchDevice, default \"cuda\"\n        The device to use for the force field and topology.\n\n    Returns\n    -------\n    mols: list[openff.toolkit.Molecule]\n        The molecules that have been parameterised.\n    off_ff: openff.toolkit.ForceField\n        The original force field, used as a base for the bespoke force field.\n    tensor_tops: list[smee.TensorTopology]\n        The topologies of the molecules.\n    tensor_ff: smee.TensorForceField\n        The force field with unique parameters for each topologically\n        symmetric term.\n    \"\"\"\n    # Create molecules from SMILES\n    mols = settings.molecules\n\n    off_ff = openff.toolkit.ForceField(settings.initial_force_field)\n\n    if \"[#1:1]-[*:2]\" in off_ff[\"Constraints\"].parameters:\n        logger.warning(\n            \"The force field contains a constraint for [#1:1]-[*:2] which \"\n            \"is not supported. Removing this constraint.\"\n        )\n        del off_ff[\"Constraints\"].parameters[\"[#1:1]-[*:2]\"]\n\n    if settings.expand_torsions:\n        torsion_generation_settings = settings.type_generation_settings.get(\n            \"ProperTorsions\"\n        )\n        excluded_smirks = (\n            torsion_generation_settings.exclude\n            if torsion_generation_settings is not None\n            else None\n        )\n        off_ff = _expand_torsions(off_ff, excluded_smirks=excluded_smirks)\n\n    # Add bespoke parameters to the force field (deduplicated across all molecules)\n    bespoke_ff = add_types_to_forcefield(\n        mols,\n        off_ff,\n        settings.type_generation_settings,\n    )\n\n    if settings.msm_settings is not None:\n        bespoke_ff = apply_msm_to_molecules(\n            mols=mols,\n            off_ff=bespoke_ff,\n            settings=settings.msm_settings,\n        )\n\n    # Create separate Interchange objects for each molecule\n    interchanges = [\n        openff.interchange.Interchange.from_smirnoff(bespoke_ff, mol.to_topology())\n        for mol in mols\n    ]\n\n    # Convert all interchanges at once to get a shared force field\n    # and separate topologies that all reference the same parameters\n    force_field, tensor_tops = smee.converters.convert_interchange(interchanges)\n    force_field = force_field.to(device)\n\n    # Move each topology to the device\n    tensor_tops = [top.to(device) for top in tensor_tops]\n\n    if settings.linearise_harmonics:\n        force_field = linearise_harmonics_force_field(force_field, device)\n        for i in range(len(tensor_tops)):\n            tensor_tops[i] = linearise_harmonics_topology(tensor_tops[i], device)\n\n    return (\n        mols,\n        bespoke_ff,\n        tensor_tops,\n        force_field,\n    )\n</code></pre>"},{"location":"reference/convert/#bespokefit_smee.convert.parameterise_old","title":"parameterise_old","text":"<pre><code>parameterise_old(\n    settings: ParameterisationSettings,\n    device: TorchDevice = \"cuda\",\n) -&gt; tuple[\n    Molecule, ForceField, TensorTopology, TensorForceField\n]\n</code></pre> <p>Old implementation of parameterise using _prepare_potential.</p> <p>This is kept for comparison/testing purposes.</p> <p>Parameters:</p> <ul> <li> <code>settings</code>               (<code>ParameterisationSettings</code>)           \u2013            <p>The settings for the parameterisation.</p> </li> <li> <code>device</code>               (<code>TorchDevice</code>, default:                   <code>'cuda'</code> )           \u2013            <p>The device to use for the force field and topology.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>mol</code> (              <code>Molecule</code> )          \u2013            <p>The molecule that has been parameterised.</p> </li> <li> <code>off_ff</code> (              <code>ForceField</code> )          \u2013            <p>The original force field, used as a base for the bespoke force field.</p> </li> <li> <code>tensor_top</code> (              <code>TensorTopology</code> )          \u2013            <p>The topology of the molecule.</p> </li> <li> <code>tensor_ff</code> (              <code>TensorForceField</code> )          \u2013            <p>The force field with unique parameters for each topologically symmetric term.</p> </li> </ul> Source code in <code>bespokefit_smee/convert.py</code> <pre><code>def parameterise_old(\n    settings: ParameterisationSettings,\n    device: TorchDevice = \"cuda\",\n) -&gt; tuple[\n    openff.toolkit.Molecule,\n    openff.toolkit.ForceField,\n    smee.TensorTopology,\n    smee.TensorForceField,\n]:\n    \"\"\"Old implementation of parameterise using _prepare_potential.\n\n    This is kept for comparison/testing purposes.\n\n    Parameters\n    ----------\n    settings: ParameterisationSettings\n        The settings for the parameterisation.\n\n    device: TorchDevice, default \"cuda\"\n        The device to use for the force field and topology.\n\n    Returns\n    -------\n    mol: openff.toolkit.Molecule\n        The molecule that has been parameterised.\n    off_ff: openff.toolkit.ForceField\n        The original force field, used as a base for the bespoke force field.\n    tensor_top: smee.TensorTopology\n        The topology of the molecule.\n    tensor_ff: smee.TensorForceField\n        The force field with unique parameters for each topologically\n        symmetric term.\n    \"\"\"\n    mol = openff.toolkit.Molecule.from_smiles(\n        settings.smiles,\n        allow_undefined_stereo=True,\n        hydrogens_are_explicit=False,\n    )\n    off_ff = openff.toolkit.ForceField(settings.initial_force_field)\n\n    if \"[#1:1]-[*:2]\" in off_ff[\"Constraints\"].parameters:\n        logger.warning(\n            \"The force field contains a constraint for [#1:1]-[*:2] which \"\n            \"is not supported. Removing this constraint.\"\n        )\n        del off_ff[\"Constraints\"].parameters[\"[#1:1]-[*:2]\"]\n\n    if settings.expand_torsions:\n        torsion_generation_settings = settings.type_generation_settings.get(\n            \"ProperTorsions\"\n        )\n        excluded_smirks = (\n            torsion_generation_settings.exclude\n            if torsion_generation_settings is not None\n            else None\n        )\n        off_ff = _expand_torsions(off_ff, excluded_smirks=excluded_smirks)\n\n    force_field, [topology] = smee.converters.convert_interchange(\n        openff.interchange.Interchange.from_smirnoff(off_ff, mol.to_topology())\n    )\n\n    # Move the force field and topology to the requested device\n    force_field = force_field.to(device)\n    topology = topology.to(device)\n\n    symmetries = list(Chem.CanonicalRankAtoms(mol.to_rdkit(), breakTies=False))\n    if topology.n_v_sites != 0:\n        raise NotImplementedError(\"virtual sites are not supported yet.\")\n\n    for (\n        potential_type,\n        type_generation_settings,\n    ) in settings.type_generation_settings.items():\n        potential = force_field.potentials_by_type.get(potential_type)\n\n        if potential is None:\n            logger.warning(\n                f\"No potential of type {potential_type} found in the \"\n                f\"force field. Skipping bespoke parameterisation for this \"\n                f\"type.\"\n            )\n            continue\n\n        parameter_map = topology.parameters[potential_type]\n\n        # Can only be a ValenceParameterMap here because we validate\n        # that we only have valence terms in the settings\n        parameter_map = cast(smee.ValenceParameterMap, parameter_map)\n\n        _prepare_potential(\n            mol,\n            symmetries,\n            potential,\n            parameter_map,\n            type_generation_settings.max_extend_distance,\n            type_generation_settings.exclude,\n        )\n\n    if settings.linearise_harmonics:\n        force_field = linearise_harmonics_force_field(force_field, device)\n        topology = linearise_harmonics_topology(topology, device)\n\n    return (\n        mol,\n        off_ff,\n        topology,\n        force_field,\n    )\n</code></pre>"},{"location":"reference/convert/#bespokefit_smee.convert._expand_torsions","title":"_expand_torsions","text":"<pre><code>_expand_torsions(\n    ff: ForceField, excluded_smirks: list[str] | None = None\n) -&gt; ForceField\n</code></pre> <p>Expand the torsion potential to include K0-4 for proper torsions</p> Source code in <code>bespokefit_smee/convert.py</code> <pre><code>def _expand_torsions(\n    ff: openff.toolkit.ForceField, excluded_smirks: list[str] | None = None\n) -&gt; openff.toolkit.ForceField:\n    \"\"\"Expand the torsion potential to include K0-4 for proper torsions\"\"\"\n    excluded_smirks = excluded_smirks or []\n    ff_copy = copy.deepcopy(ff)\n    torsion_handler = ff_copy.get_parameter_handler(\"ProperTorsions\")\n    for parameter in torsion_handler:\n        # Avoid expanding any excluded smarts\n        if parameter.smirks in excluded_smirks:\n            continue\n        # set the defaults\n        parameter.idivf = [1.0] * 4\n        default_k = [0 * _KCAL_PER_MOL] * 4\n        default_phase = [0 * _RADIANS] * 4\n        default_p = [1, 2, 3, 4]\n        # update the existing k values for the correct phase and p\n        for i, p in enumerate(parameter.periodicity):\n            try:\n                default_k[p - 1] = parameter.k[i]\n                default_phase[p - 1] = parameter.phase[i]\n            except IndexError:\n                continue\n        # update with new parameters\n        parameter.k = default_k\n        parameter.phase = default_phase\n        parameter.periodicity = default_p\n    return ff_copy\n</code></pre>"},{"location":"reference/convert/#bespokefit_smee.convert._add_angle_within_range","title":"_add_angle_within_range","text":"<pre><code>_add_angle_within_range(\n    initial_angle: float, diff: float\n) -&gt; float\n</code></pre> <p>Add a difference to an angle cap to be within [0, pi]</p> Source code in <code>bespokefit_smee/convert.py</code> <pre><code>def _add_angle_within_range(initial_angle: float, diff: float) -&gt; float:\n    \"\"\"Add a difference to an angle cap to be within [0, pi]\"\"\"\n    new_angle = initial_angle + diff\n    if diff &gt; 0:\n        return min(new_angle, math.pi)\n    else:\n        return max(new_angle, 0.0)\n</code></pre>"},{"location":"reference/convert/#bespokefit_smee.convert._compute_linear_harmonic_params","title":"_compute_linear_harmonic_params","text":"<pre><code>_compute_linear_harmonic_params(\n    k: float,\n    eq_value: float,\n    compute_lower_bound: Callable[[float], float],\n    compute_upper_bound: Callable[[float], float],\n) -&gt; tuple[float, float, float, float]\n</code></pre> <p>Compute linearized harmonic parameters from standard parameters.</p> <p>This generic function distributes a force constant across two bounds, inversely proportional to the distance from each bound.</p> <p>Args:     k: Force constant (e.g., kcal/mol/\u00c5\u00b2 or kcal/mol/rad\u00b2)     eq_value: Equilibrium value (e.g., bond length or angle)     compute_lower_bound: Function that takes eq_value and returns         lower bound     compute_upper_bound: Function that takes eq_value and returns         upper bound</p> <p>Returns:     Tuple of (k1, k2, eq1, eq2) where:     - k1, k2: Distributed force constants     - eq1, eq2: Lower and upper equilibrium value bounds</p> Source code in <code>bespokefit_smee/convert.py</code> <pre><code>def _compute_linear_harmonic_params(\n    k: float,\n    eq_value: float,\n    compute_lower_bound: Callable[[float], float],\n    compute_upper_bound: Callable[[float], float],\n) -&gt; tuple[float, float, float, float]:\n    \"\"\"Compute linearized harmonic parameters from standard parameters.\n\n    This generic function distributes a force constant across two bounds,\n    inversely proportional to the distance from each bound.\n\n    Args:\n        k: Force constant (e.g., kcal/mol/\u00c5\u00b2 or kcal/mol/rad\u00b2)\n        eq_value: Equilibrium value (e.g., bond length or angle)\n        compute_lower_bound: Function that takes eq_value and returns\n            lower bound\n        compute_upper_bound: Function that takes eq_value and returns\n            upper bound\n\n    Returns:\n        Tuple of (k1, k2, eq1, eq2) where:\n        - k1, k2: Distributed force constants\n        - eq1, eq2: Lower and upper equilibrium value bounds\n    \"\"\"\n    eq1 = compute_lower_bound(eq_value)\n    eq2 = compute_upper_bound(eq_value)\n    d = eq2 - eq1\n    # Distribute force constant inversely proportional to distance from bounds\n    k1 = k * (eq2 - eq_value) / d\n    k2 = k * (eq_value - eq1) / d\n    return k1, k2, eq1, eq2\n</code></pre>"},{"location":"reference/convert/#bespokefit_smee.convert._linearize_bond_parameters","title":"_linearize_bond_parameters","text":"<pre><code>_linearize_bond_parameters(\n    potential: TensorPotential, device_type: str\n) -&gt; TensorPotential\n</code></pre> <p>Linearize bond potential parameters.</p> <p>Converts standard harmonic bond parameters (k, length) to linearized form (k1, k2, b1, b2) where the equilibrium bond length range is [0.5length, 1.5length].</p> Source code in <code>bespokefit_smee/convert.py</code> <pre><code>def _linearize_bond_parameters(\n    potential: smee.TensorPotential, device_type: str\n) -&gt; smee.TensorPotential:\n    \"\"\"Linearize bond potential parameters.\n\n    Converts standard harmonic bond parameters (k, length) to linearized\n    form (k1, k2, b1, b2) where the equilibrium bond length range is\n    [0.5*length, 1.5*length].\n    \"\"\"\n    new_potential = copy.deepcopy(potential)\n    new_potential.type = \"LinearBonds\"\n    new_potential.fn = \"(k1+k2)/2*(r-(k1*length1+k2*length2)/(k1+k2))**2\"\n    new_potential.parameter_cols = (\"k1\", \"k2\", \"b1\", \"b2\")\n\n    # Get dtype from the first parameter\n    dtype = potential.parameters.dtype\n\n    new_params = [\n        _compute_linear_harmonic_params(\n            param[0].item(),\n            param[1].item(),\n            lambda b: b - 0.4,  # Lower bound: current length - 0.4 \u00c5\n            lambda b: b + 0.4,  # Upper bound: current length + 0.4 \u00c5\n        )\n        for param in potential.parameters\n    ]\n\n    new_potential.parameters = torch.tensor(\n        new_params, dtype=dtype, requires_grad=False, device=device_type\n    )\n    new_potential.parameter_units = (\n        _KCAL_PER_MOL_ANGSQ,\n        _KCAL_PER_MOL_ANGSQ,\n        _ANGSTROM,\n        _ANGSTROM,\n    )\n    return new_potential\n</code></pre>"},{"location":"reference/convert/#bespokefit_smee.convert._linearize_angle_parameters","title":"_linearize_angle_parameters","text":"<pre><code>_linearize_angle_parameters(\n    potential: TensorPotential, device_type: str\n) -&gt; TensorPotential\n</code></pre> <p>Linearize angle potential parameters.</p> <p>Converts standard harmonic angle parameters (k, angle) to linearized form (k1, k2, angle1, angle2) where the equilibrium angle range is [0, \u03c0].</p> Source code in <code>bespokefit_smee/convert.py</code> <pre><code>def _linearize_angle_parameters(\n    potential: smee.TensorPotential, device_type: str\n) -&gt; smee.TensorPotential:\n    \"\"\"Linearize angle potential parameters.\n\n    Converts standard harmonic angle parameters (k, angle) to linearized form\n    (k1, k2, angle1, angle2) where the equilibrium angle range is [0, \u03c0].\n    \"\"\"\n    new_potential = copy.deepcopy(potential)\n    new_potential.type = \"LinearAngles\"\n    new_potential.fn = \"(k1+k2)/2*(r-(k1*angle1+k2*angle2)/(k1+k2))**2\"\n    new_potential.parameter_cols = (\"k1\", \"k2\", \"angle1\", \"angle2\")\n\n    # Get dtype from the first parameter\n    dtype = potential.parameters.dtype\n\n    new_params = [\n        _compute_linear_harmonic_params(\n            param[0].item(),\n            param[1].item(),\n            lambda a: max(0.0, a - math.pi / 3),  # Lower bound: max(0, angle - \u03c0/3)\n            lambda a: min(math.pi, a + math.pi / 3),  # Upper bound: min(\u03c0, angle + \u03c0/3)\n        )\n        for param in potential.parameters\n    ]\n\n    new_potential.parameters = torch.tensor(\n        new_params, dtype=dtype, requires_grad=False, device=device_type\n    )\n    new_potential.parameter_units = (\n        _KCAL_PER_MOL_RADSQ,\n        _KCAL_PER_MOL_RADSQ,\n        _RADIANS,\n        _RADIANS,\n    )\n    return new_potential\n</code></pre>"},{"location":"reference/convert/#bespokefit_smee.convert.linearise_harmonics_force_field","title":"linearise_harmonics_force_field","text":"<pre><code>linearise_harmonics_force_field(\n    ff: TensorForceField, device_type: str\n) -&gt; TensorForceField\n</code></pre> <p>Linearize the harmonic potential parameters in the forcefield.</p> <p>This converts Bonds and Angles potentials to their linearized forms (LinearBonds and LinearAngles) for more robust optimization.</p> Source code in <code>bespokefit_smee/convert.py</code> <pre><code>def linearise_harmonics_force_field(\n    ff: smee.TensorForceField, device_type: str\n) -&gt; smee.TensorForceField:\n    \"\"\"Linearize the harmonic potential parameters in the forcefield.\n\n    This converts Bonds and Angles potentials to their linearized forms\n    (LinearBonds and LinearAngles) for more robust optimization.\n    \"\"\"\n    ff_copy = copy.deepcopy(ff)\n    ff_copy.potentials = []\n\n    for potential in ff.potentials:\n        if potential.type == \"Bonds\":\n            ff_copy.potentials.append(\n                _linearize_bond_parameters(potential, device_type)\n            )\n        elif potential.type == \"Angles\":\n            ff_copy.potentials.append(\n                _linearize_angle_parameters(potential, device_type)\n            )\n        else:\n            ff_copy.potentials.append(potential)\n\n    return ff_copy\n</code></pre>"},{"location":"reference/convert/#bespokefit_smee.convert.linearise_harmonics_topology","title":"linearise_harmonics_topology","text":"<pre><code>linearise_harmonics_topology(\n    topology: TensorTopology, device_type: TorchDevice\n) -&gt; TensorTopology\n</code></pre> <p>Linearize harmonic potential parameters in the topology.</p> <p>This updates the topology to use LinearBonds and LinearAngles parameter maps instead of Bonds and Angles.</p> Source code in <code>bespokefit_smee/convert.py</code> <pre><code>def linearise_harmonics_topology(\n    topology: smee.TensorTopology, device_type: TorchDevice\n) -&gt; smee.TensorTopology:\n    \"\"\"Linearize harmonic potential parameters in the topology.\n\n    This updates the topology to use LinearBonds and LinearAngles\n    parameter maps instead of Bonds and Angles.\n    \"\"\"\n    topology_copy = topology.to(device_type)\n    topology_copy.parameters[\"LinearBonds\"] = copy.deepcopy(\n        topology_copy.parameters[\"Bonds\"]\n    )\n    topology_copy.parameters[\"LinearAngles\"] = copy.deepcopy(\n        topology.parameters[\"Angles\"]\n    )\n    del topology_copy.parameters[\"Bonds\"]\n    del topology_copy.parameters[\"Angles\"]\n    return topology_copy\n</code></pre>"},{"location":"reference/create_types/","title":"create_types","text":""},{"location":"reference/create_types/#bespokefit_smee.create_types","title":"create_types","text":"<p>Create new tagged SMARTS parameter types for molecules of interest.</p> <p>Functions:</p> <ul> <li> <code>add_types_to_forcefield</code>             \u2013              <p>Add bespoke types to a force field based on multiple molecules and type generation settings.</p> </li> </ul>"},{"location":"reference/create_types/#bespokefit_smee.create_types._add_parameter_with_overwrite","title":"_add_parameter_with_overwrite","text":"<pre><code>_add_parameter_with_overwrite(\n    handler: ParameterHandler,\n    parameter_dict: Mapping[str, str | Quantity],\n) -&gt; None\n</code></pre> <p>Add a parameter to a handler, overwriting any existing parameter with the same smirks.</p> Source code in <code>bespokefit_smee/create_types.py</code> <pre><code>def _add_parameter_with_overwrite(\n    handler: openff.toolkit.typing.engines.smirnoff.parameters.ParameterHandler,\n    parameter_dict: Mapping[str, str | Quantity],\n) -&gt; None:\n    \"\"\"Add a parameter to a handler, overwriting any existing parameter with the same smirks.\"\"\"\n    old_parameter = handler.get_parameter({\"smirks\": parameter_dict[\"smirks\"]})\n    new_parameter = handler._INFOTYPE(**parameter_dict)\n    if old_parameter:\n        assert len(old_parameter) == 1\n        old_parameter = old_parameter[0]\n        # Keep the old ID if overwriting\n        new_parameter.id = old_parameter.id\n        logger.info(\n            f\"Overwriting existing parameter with id {new_parameter.id} with smirks {parameter_dict['smirks']}.\"\n        )\n        idx = handler._index_of_parameter(old_parameter)\n        handler._parameters[idx] = new_parameter\n    else:\n        handler._parameters.append(new_parameter)\n</code></pre>"},{"location":"reference/create_types/#bespokefit_smee.create_types._create_smarts","title":"_create_smarts","text":"<pre><code>_create_smarts(\n    mol: Molecule,\n    idxs: tuple[int, ...],\n    max_extend_distance: int = -1,\n) -&gt; str\n</code></pre> <p>Create a mapped SMARTS representation of a molecule. Crucially, this uses MergeQueryHs to merge non-mapped hydrogens into their heavy atom. This dramatically increases the speed of SMARTS matching in RDKit for complex SMARTS patterns (thanks to Niels Maeder for suggesting this!).</p> <p>Parameters:</p> <ul> <li> <code>mol</code>               (<code>Molecule</code>)           \u2013            <p>The molecule to create SMARTS for.</p> </li> <li> <code>idxs</code>               (<code>tuple[int, ...]</code>)           \u2013            <p>Indices of the atoms to map (and from which to extend).</p> </li> <li> <code>max_extend_distance</code>               (<code>int</code>, default:                   <code>-1</code> )           \u2013            <p>Maximum number of bonds to extend from the mapped atoms. If -1, include the entire molecule.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>str</code>           \u2013            <p>The SMARTS pattern with atom maps.</p> </li> </ul> Source code in <code>bespokefit_smee/create_types.py</code> <pre><code>def _create_smarts(\n    mol: openff.toolkit.Molecule,\n    idxs: tuple[int, ...],\n    max_extend_distance: int = -1,\n) -&gt; str:\n    \"\"\"Create a mapped SMARTS representation of a molecule.\n    Crucially, this uses MergeQueryHs to merge non-mapped\n    hydrogens into their heavy atom. This dramatically increases\n    the speed of SMARTS matching in RDKit for complex SMARTS patterns\n    (thanks to Niels Maeder for suggesting this!).\n\n    Parameters\n    ----------\n    mol: openff.toolkit.Molecule\n        The molecule to create SMARTS for.\n    idxs: tuple[int, ...]\n        Indices of the atoms to map (and from which to extend).\n    max_extend_distance: int, default -1\n        Maximum number of bonds to extend from the mapped atoms.\n        If -1, include the entire molecule.\n\n    Returns\n    -------\n    str\n        The SMARTS pattern with atom maps.\n    \"\"\"\n\n    mol_rdkit = mol.to_rdkit()\n\n    # Determine which atoms to include in the SMARTS\n    if max_extend_distance == -1:\n        # Include all atoms\n        atoms_to_include = set(range(mol_rdkit.GetNumAtoms()))\n    else:\n        # Include atoms within max_extend_distance bonds from the mapped atoms\n        atoms_to_include = set(idxs)\n        for _ in range(max_extend_distance):\n            new_atoms = set()\n            for atom_idx in atoms_to_include:\n                atom = mol_rdkit.GetAtomWithIdx(atom_idx)\n                for neighbor in atom.GetNeighbors():\n                    new_atoms.add(neighbor.GetIdx())\n            atoms_to_include.update(new_atoms)\n\n    # Create a copy of the molecule with only the atoms to include\n    if max_extend_distance != -1 and atoms_to_include != set(\n        range(mol_rdkit.GetNumAtoms())\n    ):\n        # Create an editable molecule\n        edit_mol = Chem.RWMol(mol_rdkit)\n\n        # Remove atoms not in atoms_to_include (reverse order for indices)\n        atoms_to_remove = sorted(\n            [i for i in range(mol_rdkit.GetNumAtoms()) if i not in atoms_to_include],\n            reverse=True,\n        )\n        for atom_idx in atoms_to_remove:\n            edit_mol.RemoveAtom(atom_idx)\n\n        # Create mapping from old to new indices\n        old_to_new = {}\n        new_idx = 0\n        for old_idx in range(mol_rdkit.GetNumAtoms()):\n            if old_idx in atoms_to_include:\n                old_to_new[old_idx] = new_idx\n                new_idx += 1\n\n        mol_rdkit = edit_mol.GetMol()\n        idxs = tuple(old_to_new[idx] for idx in idxs)\n\n    # Set atom maps for the key atoms\n    for i, idx in enumerate(idxs):\n        atom = mol_rdkit.GetAtomWithIdx(idx)\n        atom.SetAtomMapNum(i + 1)\n\n    # Merge non-mapped hydrogens into their heavy atoms to\n    # speed up SMARTS matching\n    h_merged_mol_rdkit = Chem.MergeQueryHs(mol_rdkit, True)\n    smarts = Chem.MolToSmarts(h_merged_mol_rdkit)\n\n    return smarts\n</code></pre>"},{"location":"reference/create_types/#bespokefit_smee.create_types._remove_redundant_smarts","title":"_remove_redundant_smarts","text":"<pre><code>_remove_redundant_smarts(\n    mols: Molecule | list[Molecule],\n    force_field: ForceField,\n    id_substring: str | None = None,\n) -&gt; ForceField\n</code></pre> <p>Remove redundant SMARTS parameters that are not used by any molecule.</p> <p>This function labels all molecules with the force field and identifies which parameters are actually applied. Parameters that are not used by any molecule and have an ID containing the specified substring are removed. This works because the a given substructure should always be matched by the last equivalent mapped-SMARTS in the force field.</p> <p>Parameters:</p> <ul> <li> <code>mols</code>               (<code>Molecule | list[Molecule]</code>)           \u2013            <p>Molecule or list of molecules to check parameter usage against</p> </li> <li> <code>force_field</code>               (<code>ForceField</code>)           \u2013            <p>Force field to remove redundant parameters from</p> </li> <li> <code>id_substring</code>               (<code>str | None</code>, default:                   <code>None</code> )           \u2013            <p>Only remove parameters whose ID contains this substring. If None, no parameters are removed.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>ForceField</code>           \u2013            <p>Force field with redundant parameters removed</p> </li> </ul> Source code in <code>bespokefit_smee/create_types.py</code> <pre><code>def _remove_redundant_smarts(\n    mols: openff.toolkit.Molecule | list[openff.toolkit.Molecule],\n    force_field: openff.toolkit.ForceField,\n    id_substring: str | None = None,\n) -&gt; openff.toolkit.ForceField:\n    \"\"\"Remove redundant SMARTS parameters that are not used by any molecule.\n\n    This function labels all molecules with the force field and identifies which\n    parameters are actually applied. Parameters that are not used by any molecule\n    and have an ID containing the specified substring are removed. This works because\n    the a given substructure should always be matched by the last equivalent mapped-SMARTS\n    in the force field.\n\n    Parameters\n    ----------\n    mols : openff.toolkit.Molecule | list[openff.toolkit.Molecule]\n        Molecule or list of molecules to check parameter usage against\n    force_field : openff.toolkit.ForceField\n        Force field to remove redundant parameters from\n    id_substring : str | None, default None\n        Only remove parameters whose ID contains this substring.\n        If None, no parameters are removed.\n\n    Returns\n    -------\n    openff.toolkit.ForceField\n        Force field with redundant parameters removed\n    \"\"\"\n    if id_substring is None:\n        return force_field\n\n    # Convert single molecule to list\n    if isinstance(mols, openff.toolkit.Molecule):\n        mols = [mols]\n\n    # Create a copy to avoid modifying the original\n    ff_copy = copy.deepcopy(force_field)\n\n    # Label all molecules and collect used parameter IDs for each handler\n    used_param_ids: dict[str, set[str]] = defaultdict(set)\n\n    for mol in mols:\n        labels = ff_copy.label_molecules(mol.to_topology())[0]\n        for handler_name, param_dict in labels.items():\n            for param in param_dict.values():\n                used_param_ids[handler_name].add(param.id)\n\n    # If no molecules, we need to check all handlers for bespoke parameters\n    if not mols:\n        # Get all handler names from the force field\n        for handler_name in ff_copy.registered_parameter_handlers:\n            used_param_ids[handler_name] = set()\n\n    # Remove unused parameters that contain the id_substring\n    for handler_name, used_ids in used_param_ids.items():\n        handler = ff_copy.get_parameter_handler(handler_name)\n        params_to_remove = []\n\n        for param in handler.parameters:\n            # Check if parameter has id_substring and is not used\n            if id_substring in param.id and param.id not in used_ids:\n                params_to_remove.append(param)\n\n        # Remove the parameters\n        for param in params_to_remove:\n            handler._parameters.remove(param)\n            logger.debug(\n                f\"Removed unused parameter {param.id} with SMIRKS {param.smirks} from {handler_name}\"\n            )\n\n    return ff_copy\n</code></pre>"},{"location":"reference/create_types/#bespokefit_smee.create_types._add_types_to_parameter_handler","title":"_add_types_to_parameter_handler","text":"<pre><code>_add_types_to_parameter_handler(\n    mol: Molecule,\n    parameter_handler: _T,\n    handler_name: str,\n    max_extend_distance: int = -1,\n    excluded_smirks: list[str] | None = None,\n    included_smirks: list[str] | None = None,\n) -&gt; _T\n</code></pre> <p>Add bespoke parameters to the parameter handler based on the molecule.</p> <p>This:</p> <p>a) Labels the molecule with the original parameter types from the    parameter handler (using <code>find_matches</code>). b) For each set of atoms labelled using the original parameters:     i) Check that it is not excluded (if <code>excluded_smirks</code> is        provided) or is included (if <code>included_smirks</code> is provided).     ii) Create a SMARTS pattern that extends from the labelled atoms up         to <code>max_extend_distance</code> bonds.     iii) Add a new parameter to the parameter handler with the created          SMARTS pattern. If a parameter with the same SMARTS pattern          already exists, log a warning and skip adding the new parameter.</p> <p>Parameters:</p> <ul> <li> <code>mol</code>               (<code>Molecule</code>)           \u2013            <p>The molecule to parameterise.</p> </li> <li> <code>parameter_handler</code>               (<code>_T</code>)           \u2013            <p>openff.toolkit.typing.engines.smirnoff.parameters.ParameterHandler</p> </li> <li> <code>handler_name</code>               (<code>str</code>)           \u2013            <p>The name of the parameter handler.</p> </li> <li> <code>max_extend_distance</code>               (<code>int</code>, default:                   <code>-1</code> )           \u2013            <p>The maximum distance (in bonds) to extend the SMARTS patterns from the atoms which determine the energy for the parameter. If -1, the SMARTS patterns will include the entire molecule.</p> </li> <li> <code>excluded_smirks</code>               (<code>list[str] | None</code>, default:                   <code>None</code> )           \u2013            <p>A list of SMIRKS patterns to exclude from bespoke type generation. This is mutually exclusive with <code>included_smirks</code>.</p> </li> <li> <code>included_smirks</code>               (<code>list[str] | None</code>, default:                   <code>None</code> )           \u2013            <p>A list of SMIRKS patterns to include in bespoke type generation. This is mutually exclusive with <code>excluded_smirks</code>.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>ParameterHandler</code>           \u2013            <p>The parameter handler with bespoke parameters added.</p> </li> </ul> Source code in <code>bespokefit_smee/create_types.py</code> <pre><code>def _add_types_to_parameter_handler(\n    mol: openff.toolkit.Molecule,\n    parameter_handler: _T,\n    handler_name: str,\n    max_extend_distance: int = -1,\n    excluded_smirks: list[str] | None = None,\n    included_smirks: list[str] | None = None,\n) -&gt; _T:\n    \"\"\"\n    Add bespoke parameters to the parameter handler based on the molecule.\n\n    This:\n\n    a) Labels the molecule with the original parameter types from the\n       parameter handler (using `find_matches`).\n    b) For each set of atoms labelled using the original parameters:\n        i) Check that it is not excluded (if `excluded_smirks` is\n           provided) or is included (if `included_smirks` is provided).\n        ii) Create a SMARTS pattern that extends from the labelled atoms up\n            to `max_extend_distance` bonds.\n        iii) Add a new parameter to the parameter handler with the created\n             SMARTS pattern. If a parameter with the same SMARTS pattern\n             already exists, log a warning and skip adding the new parameter.\n\n    Parameters\n    ----------\n    mol: openff.toolkit.Molecule\n        The molecule to parameterise.\n    parameter_handler: (\n        openff.toolkit.typing.engines.smirnoff.parameters.ParameterHandler\n    )\n        The parameter handler to add bespoke parameters to.\n    handler_name: str\n        The name of the parameter handler.\n    max_extend_distance: int = -1\n        The maximum distance (in bonds) to extend the SMARTS patterns from\n        the atoms which determine the energy for the parameter. If -1, the\n        SMARTS patterns will include the entire molecule.\n    excluded_smirks: list[str] | None, default None\n        A list of SMIRKS patterns to exclude from bespoke type generation.\n        This is mutually exclusive with `included_smirks`.\n    included_smirks: list[str] | None, default None\n        A list of SMIRKS patterns to include in bespoke type generation.\n        This is mutually exclusive with `excluded_smirks`.\n\n    Returns\n    -------\n    openff.toolkit.typing.engines.smirnoff.parameters.ParameterHandler\n        The parameter handler with bespoke parameters added.\n    \"\"\"\n\n    # Validate that excluded_smirks and included_smirks are mutually exclusive\n    if excluded_smirks and included_smirks:\n        raise ValueError(\n            \"excluded_smirks and included_smirks are mutually exclusive. \"\n            \"Please provide only one.\"\n        )\n\n    excluded_smirks = excluded_smirks or []\n    included_smirks = included_smirks or []\n\n    # Create a copy of the parameter handler to avoid modifying the original\n    handler_copy = copy.deepcopy(parameter_handler)\n\n    # Find all matches for this handler on the molecule\n    matches = handler_copy.find_matches(mol.to_topology())\n\n    # First pass: collect all bespoke SMARTS patterns and their corresponding parameters\n    bespoke_smarts_list: list[str] = []\n    smarts_to_param: dict[\n        str, openff.toolkit.typing.engines.smirnoff.parameters.ParameterType\n    ] = {}\n\n    for match_key, match in matches.items():\n        # match_key is a tuple of atom indices\n        atom_indices = match_key\n\n        # Get the parameter from the match object\n        param = match.parameter_type\n\n        # Get the original parameter's SMIRKS\n        original_smirks = param.smirks\n\n        # Check if this parameter should be excluded\n        if excluded_smirks and original_smirks in excluded_smirks:\n            continue\n\n        # Check if this parameter should be included (if include list exists)\n        if included_smirks and original_smirks not in included_smirks:\n            continue\n\n        # Create a bespoke SMARTS pattern for this specific set of atoms\n        bespoke_smarts = _create_smarts(mol, atom_indices, max_extend_distance)\n\n        # Store the SMARTS and associated parameter\n        if bespoke_smarts not in smarts_to_param:\n            bespoke_smarts_list.append(bespoke_smarts)\n            smarts_to_param[bespoke_smarts] = param\n\n    logger.info(\n        f\"Generated {len(bespoke_smarts_list)} bespoke SMARTS patterns for handler {handler_name}.\"\n    )\n\n    # Second pass: add the SMARTS patterns to the handler\n    for bespoke_smarts in bespoke_smarts_list:\n        # Get the original parameter to copy attributes from\n        param = smarts_to_param[bespoke_smarts]\n\n        # Create a new parameter dict based on the original parameter\n        new_param_dict = {\"smirks\": bespoke_smarts}\n\n        # Copy over all the parameter attributes from the original\n        for attr_name in param.to_dict().keys():\n            if attr_name not in [\"smirks\", \"id\"]:\n                attr_value = getattr(param, attr_name)\n                new_param_dict[attr_name] = attr_value\n\n        # Generate a unique ID for the new parameter\n        counter = len(handler_copy.parameters) + 1\n        new_param_dict[\"id\"] = f\"{handler_name[0].lower()}-bespoke-{counter}\"\n\n        # Add the new parameter to the handler\n        _add_parameter_with_overwrite(handler_copy, new_param_dict)\n\n    return handler_copy\n</code></pre>"},{"location":"reference/create_types/#bespokefit_smee.create_types.add_types_to_forcefield","title":"add_types_to_forcefield","text":"<pre><code>add_types_to_forcefield(\n    mols: Molecule | list[Molecule],\n    force_field: ForceField,\n    type_generation_settings: dict[\n        NonLinearValenceType, TypeGenerationSettings\n    ],\n) -&gt; ForceField\n</code></pre> <p>Add bespoke types to a force field based on multiple molecules and type generation settings.</p> <p>Parameters:</p> <ul> <li> <code>mols</code>               (<code>Molecule | list[Molecule]</code>)           \u2013            <p>Molecule or list of molecules to parameterize</p> </li> <li> <code>force_field</code>               (<code>ForceField</code>)           \u2013            <p>The base force field to add bespoke parameters to</p> </li> <li> <code>type_generation_settings</code>               (<code>dict[NonLinearValenceType, TypeGenerationSettings]</code>)           \u2013            <p>Settings for generating tagged SMARTS types for each valence type</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>ForceField</code>           \u2013            <p>Force field with bespoke parameters added, deduplicated across all molecules</p> </li> </ul> Source code in <code>bespokefit_smee/create_types.py</code> <pre><code>def add_types_to_forcefield(\n    mols: openff.toolkit.Molecule | list[openff.toolkit.Molecule],\n    force_field: openff.toolkit.ForceField,\n    type_generation_settings: dict[NonLinearValenceType, TypeGenerationSettings],\n) -&gt; openff.toolkit.ForceField:\n    \"\"\"Add bespoke types to a force field based on multiple molecules and type generation settings.\n\n    Parameters\n    ----------\n    mols : openff.toolkit.Molecule | list[openff.toolkit.Molecule]\n        Molecule or list of molecules to parameterize\n    force_field : openff.toolkit.ForceField\n        The base force field to add bespoke parameters to\n    type_generation_settings : dict[NonLinearValenceType, TypeGenerationSettings]\n        Settings for generating tagged SMARTS types for each valence type\n\n    Returns\n    -------\n    openff.toolkit.ForceField\n        Force field with bespoke parameters added, deduplicated across all molecules\n    \"\"\"\n    # Convert single molecule to list for backward compatibility\n    if isinstance(mols, openff.toolkit.Molecule):\n        mols = [mols]\n\n    # Create a copy of the force field to avoid modifying the original\n    ff_copy = copy.deepcopy(force_field)\n\n    for handler_name, settings in type_generation_settings.items():\n        parameter_handler = ff_copy.get_parameter_handler(handler_name)\n\n        # Collect all SMARTS patterns from all molecules\n        all_bespoke_smarts: list[str] = []\n        smarts_to_param: dict[\n            str, openff.toolkit.typing.engines.smirnoff.parameters.ParameterType\n        ] = {}\n\n        for mol in mols:\n            # Find all matches for this handler on the molecule\n            matches = parameter_handler.find_matches(mol.to_topology())\n\n            for match_key, match in matches.items():\n                param = match.parameter_type\n                atom_indices = match_key\n\n                # Get the original parameter's SMIRKS\n                original_smirks = param.smirks\n\n                # Check if this parameter should be excluded\n                if settings.exclude and original_smirks in settings.exclude:\n                    continue\n\n                # Check if this parameter should be included (if include list exists)\n                if settings.include and original_smirks not in settings.include:\n                    continue\n\n                # Create bespoke SMARTS pattern\n                bespoke_smarts = _create_smarts(\n                    mol, atom_indices, settings.max_extend_distance\n                )\n\n                if bespoke_smarts not in smarts_to_param:\n                    all_bespoke_smarts.append(bespoke_smarts)\n                    smarts_to_param[bespoke_smarts] = param\n\n        logger.info(\n            f\"Generated {len(all_bespoke_smarts)} bespoke SMARTS patterns for handler {handler_name} across {len(mols)} molecules.\"\n        )\n\n        # Add the SMARTS patterns to the handler\n        handler_copy = copy.deepcopy(parameter_handler)\n\n        for bespoke_smarts in all_bespoke_smarts:\n            param = smarts_to_param[bespoke_smarts]\n\n            # Create a new parameter dict based on the original parameter\n            new_param_dict = {\"smirks\": bespoke_smarts}\n\n            # Copy over all parameter attributes from the original\n            for attr_name in param.to_dict().keys():\n                if attr_name not in [\"smirks\", \"id\"]:\n                    attr_value = getattr(param, attr_name)\n                    new_param_dict[attr_name] = attr_value\n\n            # Generate a unique ID for the new parameter\n            counter = len(handler_copy.parameters) + 1\n            new_param_dict[\"id\"] = f\"{handler_name[0].lower()}-bespoke-{counter}\"\n\n            # Add the new parameter to the handler\n            _add_parameter_with_overwrite(handler_copy, new_param_dict)\n\n        # Update the force field with the modified parameter handler\n        ff_copy.deregister_parameter_handler(handler_name)\n        ff_copy.register_parameter_handler(handler_copy)\n\n    # Remove redundant parameters that are not used by any molecule\n    ff_copy = _remove_redundant_smarts(mols, ff_copy, id_substring=\"bespoke\")\n\n    return ff_copy\n</code></pre>"},{"location":"reference/find_torsions/","title":"find_torsions","text":""},{"location":"reference/find_torsions/#bespokefit_smee.find_torsions","title":"find_torsions","text":"<p>Functionality for finding and sampling torsions in a molecule.</p> <p>Functions:</p> <ul> <li> <code>get_single_torsion_by_rot_bond</code>             \u2013              <p>Get a single torsion for each rotatable bond matching the provided SMARTS pattern.</p> </li> <li> <code>get_unwanted_bonds</code>             \u2013              <p>Get a set of unwanted bonds in the molecule based on the provided SMARTS patterns.</p> </li> <li> <code>get_rot_torsions_by_rot_bond</code>             \u2013              <p>Find rotatable torsions in the molecule based on SMARTS patterns.</p> </li> </ul>"},{"location":"reference/find_torsions/#bespokefit_smee.find_torsions.get_single_torsion_by_rot_bond","title":"get_single_torsion_by_rot_bond","text":"<pre><code>get_single_torsion_by_rot_bond(\n    mol: Molecule, smarts: str\n) -&gt; dict[tuple[int, int], tuple[int, int, int, int]]\n</code></pre> <p>Get a single torsion for each rotatable bond matching the provided SMARTS pattern.</p> <p>Parameters:</p> <ul> <li> <code>mol</code>               (<code>Molecule</code>)           \u2013            <p>The molecule to search.</p> </li> <li> <code>smarts</code>               (<code>str</code>)           \u2013            <p>SMARTS pattern to match rotatable bonds. This should specify the entire torsion, not just the rotatable bond.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>dict of tuple of int to tuple of int</code>           \u2013            <p>A dictionary mapping each rotatable bond (as a tuple of atom indices) to a single torsion (as a tuple of four atom indices).</p> </li> </ul> Source code in <code>bespokefit_smee/find_torsions.py</code> <pre><code>def get_single_torsion_by_rot_bond(\n    mol: Molecule,\n    smarts: str,\n) -&gt; dict[tuple[int, int], tuple[int, int, int, int]]:\n    \"\"\"\n    Get a single torsion for each rotatable bond matching the provided SMARTS pattern.\n\n    Parameters\n    ----------\n    mol : openff.toolkit.topology.Molecule\n        The molecule to search.\n    smarts : str\n        SMARTS pattern to match rotatable bonds. This should specify the entire\n        torsion, not just the rotatable bond.\n\n    Returns\n    -------\n    dict of tuple of int to tuple of int\n        A dictionary mapping each rotatable bond (as a tuple of atom indices) to a single torsion\n        (as a tuple of four atom indices).\n    \"\"\"\n    all_torsions = mol.chemical_environment_matches(smarts, unique=True)\n    torsions_by_rot_bonds = {}\n\n    for torsion in all_torsions:\n        if len(torsion) != 4:\n            raise ValueError(\n                f\"Expected torsion to have 4 atoms, but got {len(torsion)}: {torsion}.\"\n                \" Ensure the SMARTS patterns match full torsions.\"\n            )\n\n        rot_bond = tuple(\n            sorted((torsion[1], torsion[2]))\n        )  # Middle two atoms are the rotatable bond\n        if rot_bond not in torsions_by_rot_bonds:\n            torsions_by_rot_bonds[rot_bond] = torsion\n        else:\n            # If we already have a torsion for this rotatable bond, skip it\n            continue\n\n    return torsions_by_rot_bonds\n</code></pre>"},{"location":"reference/find_torsions/#bespokefit_smee.find_torsions.get_unwanted_bonds","title":"get_unwanted_bonds","text":"<pre><code>get_unwanted_bonds(\n    mol: Molecule, smarts: str\n) -&gt; set[tuple[int, int]]\n</code></pre> <p>Get a set of unwanted bonds in the molecule based on the provided SMARTS patterns.</p> <p>Parameters:</p> <ul> <li> <code>mol</code>               (<code>Molecule</code>)           \u2013            <p>The molecule to search.</p> </li> <li> <code>smarts</code>               (<code>str</code>)           \u2013            <p>SMARTS pattern to match unwanted bonds. This should match only the rotatable bond, not the full torsion.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>set of tuple of int</code>           \u2013            <p>A set of tuples representing the unwanted bonds, where each tuple contains the indices of the two atoms forming the bond.</p> </li> </ul> Source code in <code>bespokefit_smee/find_torsions.py</code> <pre><code>def get_unwanted_bonds(mol: Molecule, smarts: str) -&gt; set[tuple[int, int]]:\n    \"\"\"\n    Get a set of unwanted bonds in the molecule based on the provided SMARTS patterns.\n\n    Parameters\n    ----------\n    mol : openff.toolkit.topology.Molecule\n        The molecule to search.\n    smarts : str\n        SMARTS pattern to match unwanted bonds. This should match only the rotatable bond,\n        not the full torsion.\n\n    Returns\n    -------\n    set of tuple of int\n        A set of tuples representing the unwanted bonds, where each tuple contains the indices of the two\n        atoms forming the bond.\n    \"\"\"\n    bonds = mol.chemical_environment_matches(smarts, unique=True)\n    for bond in bonds:\n        if len(bond) != 2:\n            raise ValueError(\n                f\"Expected bond to have 2 atoms, but got {len(bond)}: {bond}.\"\n                \" Ensure the SMARTS pattern matches only the rotatable bond.\"\n            )\n\n    return {tuple(sorted(bond)) for bond in bonds}\n</code></pre>"},{"location":"reference/find_torsions/#bespokefit_smee.find_torsions.get_rot_torsions_by_rot_bond","title":"get_rot_torsions_by_rot_bond","text":"<pre><code>get_rot_torsions_by_rot_bond(\n    molecule: Molecule,\n    include_smarts: list[str] = _TORSIONS_TO_INCLUDE_SMARTS,\n    exclude_smarts: list[str] = _TORSIONS_TO_EXCLUDE_SMARTS,\n) -&gt; dict[tuple[int, int], tuple[int, int, int, int]]\n</code></pre> <p>Find rotatable torsions in the molecule based on SMARTS patterns.</p> <p>Parameters:</p> <ul> <li> <code>molecule</code>               (<code>Molecule</code>)           \u2013            <p>The molecule to search.</p> </li> <li> <code>include_smarts</code>               (<code>list of str</code>, default:                   <code>_TORSIONS_TO_INCLUDE_SMARTS</code> )           \u2013            <p>List of SMARTS patterns to include. Defaults to _TORSIONS_TO_INCLUDE_SMARTS. These should match the entire torsion, not just the rotatable bond.</p> </li> <li> <code>exclude_smarts</code>               (<code>list of str</code>, default:                   <code>_TORSIONS_TO_EXCLUDE_SMARTS</code> )           \u2013            <p>List of SMARTS patterns to exclude. Defaults to _TORSIONS_TO_EXCLUDE_SMARTS. These should match only the rotatable bond, not the full torsion.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>dict of tuple of int to tuple of int</code>           \u2013            <p>A dictionary mapping each rotatable bond (as a tuple of atom indices) to a single torsion (as a tuple of four atom indices).</p> </li> </ul> Source code in <code>bespokefit_smee/find_torsions.py</code> <pre><code>def get_rot_torsions_by_rot_bond(\n    molecule: Molecule,\n    include_smarts: list[str] = _TORSIONS_TO_INCLUDE_SMARTS,\n    exclude_smarts: list[str] = _TORSIONS_TO_EXCLUDE_SMARTS,\n) -&gt; dict[tuple[int, int], tuple[int, int, int, int]]:\n    \"\"\"\n    Find rotatable torsions in the molecule based on SMARTS patterns.\n\n    Parameters\n    ----------\n    molecule : openff.toolkit.topology.Molecule\n        The molecule to search.\n    include_smarts : list of str, optional\n        List of SMARTS patterns to include. Defaults to _TORSIONS_TO_INCLUDE_SMARTS.\n        These should match the entire torsion, not just the rotatable bond.\n    exclude_smarts : list of str, optional\n        List of SMARTS patterns to exclude. Defaults to _TORSIONS_TO_EXCLUDE_SMARTS.\n        These should match only the rotatable bond, not the full torsion.\n\n    Returns\n    -------\n    dict of tuple of int to tuple of int\n        A dictionary mapping each rotatable bond (as a tuple of atom indices) to a single torsion\n        (as a tuple of four atom indices).\n    \"\"\"\n\n    torsions_by_rot_bonds = {}\n\n    for smarts in include_smarts:\n        torsions = get_single_torsion_by_rot_bond(molecule, smarts)\n        torsions_by_rot_bonds.update(torsions)\n\n    for smarts in exclude_smarts:\n        unwanted_bonds = get_unwanted_bonds(molecule, smarts)\n        print(f\"Excluding unwanted bonds: {unwanted_bonds}\")\n        for rot_bond in unwanted_bonds:\n            torsions_by_rot_bonds.pop(rot_bond, None)\n\n    return torsions_by_rot_bonds\n</code></pre>"},{"location":"reference/hessian/","title":"hessian","text":""},{"location":"reference/hessian/#bespokefit_smee.hessian","title":"hessian","text":"<p>Functionality for computing the Hessian, closely based on https://github.com/qubekit/QUBEKit/blob/bdccc28d1ad8c0fb4eeb01467bfe8365396c411c/qubekit/engines/openmm.py#L174.</p> <p>Functions:</p> <ul> <li> <code>calculate_hessian</code>             \u2013              <p>Using finite displacement calculate the hessian matrix of the molecule</p> </li> </ul>"},{"location":"reference/hessian/#bespokefit_smee.hessian._get_forces","title":"_get_forces","text":"<pre><code>_get_forces(\n    simulation: Simulation, positions: ndarray\n) -&gt; ndarray\n</code></pre> <p>Compute the forces on the system at the given positions</p> Source code in <code>bespokefit_smee/hessian.py</code> <pre><code>def _get_forces(simulation: Simulation, positions: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\n    Compute the forces on the system at the given positions\n    \"\"\"\n    simulation.context.setPositions(positions * _LENGTH_UNIT)\n    forces: np.ndarray = (\n        simulation.context.getState(getForces=True)\n        .getForces(asNumpy=True)\n        .value_in_unit(_FORCE_UNIT)\n    )\n    return forces\n</code></pre>"},{"location":"reference/hessian/#bespokefit_smee.hessian.calculate_hessian","title":"calculate_hessian","text":"<pre><code>calculate_hessian(\n    simulation: Simulation,\n    input_coords: Quantity,\n    finite_step: Quantity = 0.0005291772 * nanometers,\n) -&gt; Quantity\n</code></pre> <p>Using finite displacement calculate the hessian matrix of the molecule using a seminumerical scheme. See https://mattermodeling.stackexchange.com/questions/10358/numerical-evaluation-of-hessian for a brief description of the method.</p> <p>Args:     simulation (Simulation): The OpenMM Simulation object.     input_coords (unit.Quantity): The coordinates of the molecule.     finite_step (unit.Quantity): The finite step size for displacement.</p> <p>Returns:     unit.Quantity: The Hessian matrix in appropriate units.</p> Source code in <code>bespokefit_smee/hessian.py</code> <pre><code>def calculate_hessian(\n    simulation: Simulation,\n    input_coords: unit.Quantity,\n    finite_step: unit.Quantity = 0.0005291772 * unit.nanometers,\n) -&gt; unit.Quantity:\n    \"\"\"\n    Using finite displacement calculate the hessian matrix of the molecule\n    using a seminumerical scheme. See https://mattermodeling.stackexchange.com/questions/10358/numerical-evaluation-of-hessian\n    for a brief description of the method.\n\n    Args:\n        simulation (Simulation): The OpenMM Simulation object.\n        input_coords (unit.Quantity): The coordinates of the molecule.\n        finite_step (unit.Quantity): The finite step size for displacement.\n\n    Returns:\n        unit.Quantity: The Hessian matrix in appropriate units.\n    \"\"\"\n\n    # Perform all operations in _LENGTH_UNIT\n    input_coords = input_coords.value_in_unit(_LENGTH_UNIT)\n    finite_step = finite_step.value_in_unit(_LENGTH_UNIT)\n    n_atoms = simulation.topology.getNumAtoms()\n\n    # Check we have coordinates corresponding to a single conformation\n    if input_coords.shape != (n_atoms, 3):\n        raise ValueError(\n            f\"Input coordinates must have shape ({n_atoms}, 3), got {input_coords.shape}\"\n        )\n\n    # Calculate the full Hessian elements with finite difference\n    hessian = np.zeros((3 * n_atoms, 3 * n_atoms))\n\n    for j in range(0, n_atoms):\n        for _dimension, offset_j in _DIMENSION_TO_OFFSET.items():\n            coords = input_coords.copy()\n            # Get gi + hej\n            coords[j, offset_j] += finite_step\n            gi_plus = -_get_forces(simulation, coords)\n            # Get gi - hej\n            coords[j, offset_j] -= 2 * finite_step\n            gi_minus = -_get_forces(simulation, coords)\n\n            for i in range(0, n_atoms):\n                for _dimension, offset_i in _DIMENSION_TO_OFFSET.items():\n                    # Compute hessian element\n                    hessian[i * 3 + offset_i, j * 3 + offset_j] = (\n                        gi_plus[i, offset_i] - gi_minus[i, offset_i]\n                    ) / (2 * finite_step)\n\n    # Symmetrise the Hessian by averaging with its transpose\n    hessian = 0.5 * (hessian + hessian.T)\n\n    return hessian * _HESSIAN_UNIT\n</code></pre>"},{"location":"reference/loss/","title":"loss","text":""},{"location":"reference/loss/#bespokefit_smee.loss","title":"loss","text":"<p>Loss functions for tuning the forcefield</p> <p>Classes:</p> <ul> <li> <code>LossRecord</code>           \u2013            <p>Container for different loss components</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>prediction_loss</code>             \u2013              <p>Predict the loss function for a guess forcefield against datasets for multiple molecules.</p> </li> <li> <code>compute_regularisation_loss</code>             \u2013              <p>Compute regularisation penalty</p> </li> <li> <code>get_loss_closure_fn</code>             \u2013              <p>Return a closure function for use with Levenberg-Marquardt optimizer.</p> </li> <li> <code>predict</code>             \u2013              <p>Predict the relative energies [kcal/mol] and forces [kcal/mol/\u00c5] of a dataset.</p> </li> <li> <code>predict_with_weights</code>             \u2013              <p>Predict the relative energies and forces with associated weights from the dataset.</p> </li> </ul>"},{"location":"reference/loss/#bespokefit_smee.loss.LossRecord","title":"LossRecord","text":"<p>               Bases: <code>NamedTuple</code></p> <p>Container for different loss components</p>"},{"location":"reference/loss/#bespokefit_smee.loss._compute_molecule_energy_force_loss","title":"_compute_molecule_energy_force_loss","text":"<pre><code>_compute_molecule_energy_force_loss(\n    energy_ref: Tensor,\n    energy_pred: Tensor,\n    forces_ref: Tensor,\n    forces_pred: Tensor,\n    energy_weights: Tensor,\n    forces_weights: Tensor,\n    n_atoms: int,\n    device: device | str,\n) -&gt; tuple[Tensor, Tensor]\n</code></pre> <p>Compute weighted energy and force loss for a single molecule.</p> <p>Args:     energy_ref: Reference energies with shape (n_confs,).     energy_pred: Predicted energies with shape (n_confs,).     forces_ref: Reference forces with shape (n_confs * n_atoms, 3).     forces_pred: Predicted forces with shape (n_confs * n_atoms, 3).     energy_weights: Per-conformation energy weights with shape (n_confs,).     forces_weights: Per-conformation force weights with shape (n_confs,).     n_atoms: Number of atoms in the molecule.     device: Device for tensor creation.</p> <p>Returns:     Tuple of (energy_loss, force_loss) for this molecule.</p> Source code in <code>bespokefit_smee/loss.py</code> <pre><code>def _compute_molecule_energy_force_loss(\n    energy_ref: torch.Tensor,\n    energy_pred: torch.Tensor,\n    forces_ref: torch.Tensor,\n    forces_pred: torch.Tensor,\n    energy_weights: torch.Tensor,\n    forces_weights: torch.Tensor,\n    n_atoms: int,\n    device: torch.device | str,\n) -&gt; tuple[torch.Tensor, torch.Tensor]:\n    \"\"\"Compute weighted energy and force loss for a single molecule.\n\n    Args:\n        energy_ref: Reference energies with shape (n_confs,).\n        energy_pred: Predicted energies with shape (n_confs,).\n        forces_ref: Reference forces with shape (n_confs * n_atoms, 3).\n        forces_pred: Predicted forces with shape (n_confs * n_atoms, 3).\n        energy_weights: Per-conformation energy weights with shape (n_confs,).\n        forces_weights: Per-conformation force weights with shape (n_confs,).\n        n_atoms: Number of atoms in the molecule.\n        device: Device for tensor creation.\n\n    Returns:\n        Tuple of (energy_loss, force_loss) for this molecule.\n    \"\"\"\n    n_confs = energy_ref.shape[0]\n\n    # Energy loss (weighted per conformation, then averaged)\n    energy_diff_sq = ((energy_ref - energy_pred) / n_atoms) ** 2\n    weighted_energy_loss = (energy_diff_sq * energy_weights).sum()\n\n    # Effective sample size for weighted average\n    effective_energy_sample_size = torch.sum(energy_weights) ** 2 / torch.sum(\n        energy_weights**2\n    )\n    if effective_energy_sample_size &gt; 0:\n        energy_loss = weighted_energy_loss / effective_energy_sample_size\n    else:\n        energy_loss = torch.tensor(0.0, dtype=torch.float64, device=device)\n\n    # Force loss (weighted per conformation, then averaged)\n    forces_ref_reshaped = forces_ref.reshape(n_confs, n_atoms, 3)\n    forces_pred_reshaped = forces_pred.reshape(n_confs, n_atoms, 3)\n    forces_diff_sq = (forces_ref_reshaped - forces_pred_reshaped) ** 2\n\n    # Sum over atoms and dimensions for each conformation\n    forces_loss_per_conf = forces_diff_sq.sum(dim=[1, 2]) / (3 * n_atoms)\n    weighted_force_loss = (forces_loss_per_conf * forces_weights).sum()\n\n    effective_force_sample_size = torch.sum(forces_weights) ** 2 / torch.sum(\n        forces_weights**2\n    )\n    if effective_force_sample_size &gt; 0:\n        force_loss = weighted_force_loss / effective_force_sample_size\n    else:\n        force_loss = torch.tensor(0.0, dtype=torch.float64, device=device)\n\n    return energy_loss, force_loss\n</code></pre>"},{"location":"reference/loss/#bespokefit_smee.loss._compute_total_loss","title":"_compute_total_loss","text":"<pre><code>_compute_total_loss(\n    force_field: TensorForceField,\n    datasets_list: list[Dataset],\n    topologies: list[TensorTopology],\n    device_type: str,\n) -&gt; tuple[Tensor, Tensor]\n</code></pre> <p>Compute total energy and force loss across all molecules.</p> <p>Args:     force_field: The force field to use for predictions.     datasets_list: List of datasets for each molecule.     topologies: List of topologies for each molecule.     device_type: Device type for computations.</p> <p>Returns:     Tuple of (avg_energy_loss, avg_force_loss) averaged across molecules.</p> Source code in <code>bespokefit_smee/loss.py</code> <pre><code>def _compute_total_loss(\n    force_field: smee.TensorForceField,\n    datasets_list: list[datasets.Dataset],\n    topologies: list[smee.TensorTopology],\n    device_type: str,\n) -&gt; tuple[torch.Tensor, torch.Tensor]:\n    \"\"\"Compute total energy and force loss across all molecules.\n\n    Args:\n        force_field: The force field to use for predictions.\n        datasets_list: List of datasets for each molecule.\n        topologies: List of topologies for each molecule.\n        device_type: Device type for computations.\n\n    Returns:\n        Tuple of (avg_energy_loss, avg_force_loss) averaged across molecules.\n    \"\"\"\n    energy_losses = []\n    force_losses = []\n\n    for dataset, topology in zip(datasets_list, topologies, strict=True):\n        (\n            energy_ref,\n            energy_pred,\n            forces_ref,\n            forces_pred,\n            energy_weights,\n            forces_weights,\n        ) = predict_with_weights(\n            dataset,\n            force_field,\n            {dataset[0][\"smiles\"]: topology},\n            device_type=device_type,\n            normalize=False,\n            create_graph=False,\n        )\n\n        energy_loss, force_loss = _compute_molecule_energy_force_loss(\n            energy_ref,\n            energy_pred,\n            forces_ref,\n            forces_pred,\n            energy_weights,\n            forces_weights,\n            topology.n_atoms,\n            device_type,\n        )\n\n        energy_losses.append(energy_loss)\n        force_losses.append(force_loss)\n\n    total_energy_loss = torch.stack(energy_losses).mean()\n    total_force_loss = torch.stack(force_losses).mean()\n\n    return total_energy_loss, total_force_loss\n</code></pre>"},{"location":"reference/loss/#bespokefit_smee.loss.prediction_loss","title":"prediction_loss","text":"<pre><code>prediction_loss(\n    datasets_list: list[Dataset],\n    trainable: Trainable,\n    trainable_parameters: Tensor,\n    initial_parameters: Tensor,\n    topologies: list[TensorTopology],\n    regularisation_target: Literal[\"initial\", \"zero\"],\n    device_type: str,\n) -&gt; LossRecord\n</code></pre> <p>Predict the loss function for a guess forcefield against datasets for multiple molecules.</p> <p>Energy and force weights are read from the dataset entries (energy_weights and forces_weights columns). If these columns are not present, default weights of 1.0 are used.</p> <p>Args:     datasets_list: List of datasets to predict the energies and forces of.     trainable: The trainable object containing the force field.     trainable_parameters: The parameters to be optimized.     initial_parameters: The initial parameters before training.     topologies: List of topologies of the molecules in the datasets.     regularisation_target: The type of regularisation to apply ('initial' or 'zero').     device_type: The device type (e.g., 'cpu' or 'cuda').</p> <p>Returns:     The computed loss as a LossRecord.</p> Source code in <code>bespokefit_smee/loss.py</code> <pre><code>def prediction_loss(\n    datasets_list: list[datasets.Dataset],\n    trainable: descent.train.Trainable,\n    trainable_parameters: torch.Tensor,\n    initial_parameters: torch.Tensor,\n    topologies: list[smee.TensorTopology],\n    regularisation_target: typing.Literal[\"initial\", \"zero\"],\n    device_type: str,\n) -&gt; LossRecord:\n    \"\"\"Predict the loss function for a guess forcefield against datasets for multiple molecules.\n\n    Energy and force weights are read from the dataset entries (energy_weights and\n    forces_weights columns). If these columns are not present, default weights of 1.0\n    are used.\n\n    Args:\n        datasets_list: List of datasets to predict the energies and forces of.\n        trainable: The trainable object containing the force field.\n        trainable_parameters: The parameters to be optimized.\n        initial_parameters: The initial parameters before training.\n        topologies: List of topologies of the molecules in the datasets.\n        regularisation_target: The type of regularisation to apply ('initial' or 'zero').\n        device_type: The device type (e.g., 'cpu' or 'cuda').\n\n    Returns:\n        The computed loss as a LossRecord.\n    \"\"\"\n    force_field = trainable.to_force_field(trainable_parameters)\n\n    avg_energy_loss, avg_force_loss = _compute_total_loss(\n        force_field,\n        datasets_list,\n        topologies,\n        device_type,\n    )\n\n    # Compute regularization once for all molecules\n    regularisation_loss = compute_regularisation_loss(\n        trainable,\n        trainable_parameters,\n        initial_parameters,\n        regularisation_target,\n    )\n\n    logger.info(\n        f\"Loss: Energy={avg_energy_loss.item():.4f} Forces={avg_force_loss.item():.4f} Reg={regularisation_loss.item():.4f}\"\n    )\n\n    return LossRecord(\n        energy=avg_energy_loss,\n        forces=avg_force_loss,\n        regularisation=regularisation_loss,\n    )\n</code></pre>"},{"location":"reference/loss/#bespokefit_smee.loss.compute_regularisation_loss","title":"compute_regularisation_loss","text":"<pre><code>compute_regularisation_loss(\n    trainable: Trainable,\n    trainable_parameters: Tensor,\n    initial_parameters: Tensor,\n    regularisation_target: Literal[\"initial\", \"zero\"],\n) -&gt; Tensor\n</code></pre> <p>Compute regularisation penalty</p> Source code in <code>bespokefit_smee/loss.py</code> <pre><code>def compute_regularisation_loss(\n    trainable: descent.train.Trainable,\n    trainable_parameters: torch.Tensor,\n    initial_parameters: torch.Tensor,\n    regularisation_target: typing.Literal[\"initial\", \"zero\"],\n) -&gt; torch.Tensor:\n    \"\"\"Compute regularisation penalty\"\"\"\n    reg_loss = torch.tensor(0.0, device=trainable_parameters.device)\n\n    regularised_idxs = trainable.regularized_idxs\n    regularisation_weights = trainable.regularization_weights\n\n    if len(regularised_idxs) == 0:\n        return reg_loss\n\n    if all(weight == 0.0 for weight in regularisation_weights):\n        return reg_loss\n\n    if regularisation_target == \"initial\":\n        target = initial_parameters[regularised_idxs]\n    elif regularisation_target == \"zero\":\n        target = torch.zeros_like(trainable_parameters[regularised_idxs])\n    else:\n        raise NotImplementedError(\n            f\"regularisation value {regularisation_target} not implemented\"\n        )\n\n    effective_sample_size = torch.sum(regularisation_weights) ** 2 / torch.sum(\n        regularisation_weights**2\n    )\n\n    # L2 regularisation on all parameters\n    reg_loss += (\n        ((trainable_parameters[regularised_idxs] - target) ** 2)\n        * regularisation_weights\n    ).sum() / effective_sample_size\n\n    return reg_loss\n</code></pre>"},{"location":"reference/loss/#bespokefit_smee.loss.get_loss_closure_fn","title":"get_loss_closure_fn","text":"<pre><code>get_loss_closure_fn(\n    datasets_list: list[Dataset],\n    trainable: Trainable,\n    trainable_parameters: Tensor,\n    initial_parameters: Tensor,\n    topologies: list[TensorTopology],\n    loss_energy_weight: float,\n    loss_force_weight: float,\n    regularisation_target: Literal[\"initial\", \"zero\"],\n) -&gt; ClosureFn\n</code></pre> <p>Return a closure function for use with Levenberg-Marquardt optimizer.</p> <p>This closure reuses the same loss computation as <code>prediction_loss</code> but wraps it in a format suitable for the LM optimizer, which requires computing gradients and Hessians.</p> <p>Args:     datasets_list: List of datasets to predict the energies and forces of.     trainable: The trainable object containing the force field.     trainable_parameters: The parameters to be optimized.     initial_parameters: The initial parameters before training.     topologies: List of topologies of the molecules in the datasets.     loss_energy_weight: Weight for the energy loss term.     loss_force_weight: Weight for the force loss term.     regularisation_target: The type of regularisation to apply ('initial' or 'zero').</p> <p>Returns:     A closure function that takes a tensor and returns the loss, gradient     (if requested), and Hessian (if requested).</p> Source code in <code>bespokefit_smee/loss.py</code> <pre><code>def get_loss_closure_fn(\n    datasets_list: list[datasets.Dataset],\n    trainable: descent.train.Trainable,\n    trainable_parameters: torch.Tensor,\n    initial_parameters: torch.Tensor,\n    topologies: list[smee.TensorTopology],\n    loss_energy_weight: float,\n    loss_force_weight: float,\n    regularisation_target: typing.Literal[\"initial\", \"zero\"],\n) -&gt; descent.optim.ClosureFn:\n    \"\"\"Return a closure function for use with Levenberg-Marquardt optimizer.\n\n    This closure reuses the same loss computation as `prediction_loss` but wraps it\n    in a format suitable for the LM optimizer, which requires computing gradients\n    and Hessians.\n\n    Args:\n        datasets_list: List of datasets to predict the energies and forces of.\n        trainable: The trainable object containing the force field.\n        trainable_parameters: The parameters to be optimized.\n        initial_parameters: The initial parameters before training.\n        topologies: List of topologies of the molecules in the datasets.\n        loss_energy_weight: Weight for the energy loss term.\n        loss_force_weight: Weight for the force loss term.\n        regularisation_target: The type of regularisation to apply ('initial' or 'zero').\n\n    Returns:\n        A closure function that takes a tensor and returns the loss, gradient\n        (if requested), and Hessian (if requested).\n    \"\"\"\n\n    def closure_fn(\n        x: torch.Tensor,\n        compute_gradient: bool,\n        compute_hessian: bool,\n    ) -&gt; tuple[torch.Tensor, torch.Tensor | None, torch.Tensor | None]:\n        gradient, hessian = None, None\n\n        def loss_fn(_x: torch.Tensor) -&gt; torch.Tensor:\n            \"\"\"Compute the total loss for the given trainable parameters.\"\"\"\n            ff = trainable.to_force_field(_x)\n\n            avg_energy_loss, avg_force_loss = _compute_total_loss(\n                ff,\n                datasets_list,\n                topologies,\n                _x.device.type,\n            )\n\n            # Apply loss weights\n            total_loss = (\n                loss_energy_weight * avg_energy_loss\n                + loss_force_weight * avg_force_loss\n            )\n\n            # Add regularisation\n            regularisation_penalty = compute_regularisation_loss(\n                trainable,\n                _x,\n                initial_parameters,\n                regularisation_target=regularisation_target,\n            )\n            total_loss = total_loss + regularisation_penalty\n\n            return total_loss\n\n        # Compute Hessian first (needs fresh graph each time it's called internally)\n        if compute_hessian:\n            hessian = torch.autograd.functional.hessian(  # type: ignore[no-untyped-call]\n                loss_fn, x, vectorize=True, create_graph=False\n            ).detach()\n\n        # Compute loss and gradient together\n        if compute_gradient:\n            loss = loss_fn(x)\n            (gradient,) = torch.autograd.grad(loss, x, create_graph=False)\n            gradient = gradient.detach()\n            loss = loss.detach()\n        else:\n            # If no gradient needed, just compute loss without graph\n            with torch.no_grad():\n                loss = loss_fn(x)\n\n        # Free GPU memory explicitly\n        if x.device.type == \"cuda\":\n            torch.cuda.synchronize()\n            torch.cuda.empty_cache()\n\n        return loss, gradient, hessian\n\n    return closure_fn\n</code></pre>"},{"location":"reference/loss/#bespokefit_smee.loss.predict","title":"predict","text":"<pre><code>predict(\n    dataset: Dataset,\n    force_field: TensorForceField,\n    topologies: dict[str, TensorTopology],\n    reference: Literal[\"mean\", \"min\"] = \"mean\",\n    normalize: bool = True,\n    device_type: str = \"cpu\",\n) -&gt; tuple[Tensor, Tensor, Tensor, Tensor]\n</code></pre> <p>Predict the relative energies [kcal/mol] and forces [kcal/mol/\u00c5] of a dataset.</p> <p>Args:     dataset: The dataset to predict the energies and forces of.     force_field: The force field to use to predict the energies and forces.     topologies: The topologies of the molecules in the dataset. Each key should be         a fully indexed SMILES string.     reference: The reference energy to compute the relative energies with respect         to. This should be either the \"mean\" energy of all conformers, or the         energy of the conformer with the lowest reference energy (\"min\").     normalize: Whether to scale the relative energies by <code>1/sqrt(n_confs_i)</code>         and the forces by <code>1/sqrt(n_confs_i * n_atoms_per_conf_i * 3)</code> This         is useful when wanting to compute the MSE per entry.</p> <p>Returns:     The predicted and reference relative energies [kcal/mol] with     <code>shape=(n_confs,)</code>, and predicted and reference forces [kcal/mol/\u00c5] with     <code>shape=(n_confs * n_atoms_per_conf, 3)</code>.</p> Source code in <code>bespokefit_smee/loss.py</code> <pre><code>def predict(\n    dataset: datasets.Dataset,\n    force_field: smee.TensorForceField,\n    topologies: dict[str, smee.TensorTopology],\n    reference: typing.Literal[\"mean\", \"min\"] = \"mean\",\n    normalize: bool = True,\n    device_type: str = \"cpu\",\n) -&gt; tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor]:\n    \"\"\"Predict the relative energies [kcal/mol] and forces [kcal/mol/\u00c5] of a dataset.\n\n    Args:\n        dataset: The dataset to predict the energies and forces of.\n        force_field: The force field to use to predict the energies and forces.\n        topologies: The topologies of the molecules in the dataset. Each key should be\n            a fully indexed SMILES string.\n        reference: The reference energy to compute the relative energies with respect\n            to. This should be either the \"mean\" energy of all conformers, or the\n            energy of the conformer with the lowest reference energy (\"min\").\n        normalize: Whether to scale the relative energies by ``1/sqrt(n_confs_i)``\n            and the forces by ``1/sqrt(n_confs_i * n_atoms_per_conf_i * 3)`` This\n            is useful when wanting to compute the MSE per entry.\n\n    Returns:\n        The predicted and reference relative energies [kcal/mol] with\n        ``shape=(n_confs,)``, and predicted and reference forces [kcal/mol/\u00c5] with\n        ``shape=(n_confs * n_atoms_per_conf, 3)``.\n    \"\"\"\n    energy_ref_all, energy_pred_all = [], []\n    forces_ref_all, forces_pred_all = [], []\n\n    for entry in dataset:\n        smiles = entry[\"smiles\"]\n\n        energy_ref = entry[\"energy\"].to(device_type)\n        forces_ref = entry[\"forces\"].reshape(len(energy_ref), -1, 3).to(device_type)\n\n        coords_flat = smee.utils.tensor_like(\n            entry[\"coords\"], force_field.potentials[0].parameters\n        )\n\n        coords = (\n            (coords_flat.reshape(len(energy_ref), -1, 3))\n            .to(device_type)\n            .detach()\n            .requires_grad_(True)\n        )\n        topology = topologies[smiles]\n\n        energy_pred = smee.compute_energy(topology, force_field, coords)\n        forces_pred = -torch.autograd.grad(\n            energy_pred.sum(),\n            coords,\n            create_graph=True,\n            retain_graph=True,\n            allow_unused=True,\n        )[0]\n\n        if reference.lower() == \"mean\":\n            energy_ref_0 = energy_ref.mean()\n            energy_pred_0 = energy_pred.mean()\n        elif reference.lower() == \"min\":\n            min_idx = energy_ref.argmin()\n\n            energy_ref_0 = energy_ref[min_idx]\n            energy_pred_0 = energy_pred[min_idx]\n        else:\n            raise NotImplementedError(f\"invalid reference energy {reference}\")\n\n        scale_energy, scale_forces = 1.0, 1.0\n\n        if normalize:\n            scale_energy = 1.0 / torch.sqrt(torch.tensor(energy_pred.numel()))\n            scale_forces = 1.0 / torch.sqrt(torch.tensor(forces_pred.numel()))\n\n        energy_ref_all.append(scale_energy * (energy_ref - energy_ref_0))\n        forces_ref_all.append(scale_forces * forces_ref.reshape(-1, 3))\n\n        energy_pred_all.append(scale_energy * (energy_pred - energy_pred_0))\n        forces_pred_all.append(scale_forces * forces_pred.reshape(-1, 3))\n\n    energy_pred_all_tensor = torch.cat(energy_pred_all)\n    forces_pred_all_tensor = torch.cat(forces_pred_all)\n\n    energy_ref_all_tensor = torch.cat(energy_ref_all)\n    energy_ref_all_tensor = smee.utils.tensor_like(\n        energy_ref_all_tensor, energy_pred_all_tensor\n    )\n\n    forces_ref_all_tensor = torch.cat(forces_ref_all)\n    forces_ref_all_tensor = smee.utils.tensor_like(\n        forces_ref_all_tensor, forces_pred_all_tensor\n    )\n\n    return (\n        energy_ref_all_tensor,\n        energy_pred_all_tensor,\n        forces_ref_all_tensor,\n        forces_pred_all_tensor,\n    )\n</code></pre>"},{"location":"reference/loss/#bespokefit_smee.loss.predict_with_weights","title":"predict_with_weights","text":"<pre><code>predict_with_weights(\n    dataset: Dataset,\n    force_field: TensorForceField,\n    topologies: dict[str, TensorTopology],\n    reference: Literal[\"mean\", \"min\", \"median\"] = \"mean\",\n    normalize: bool = True,\n    device_type: str = \"cpu\",\n    create_graph: bool = False,\n) -&gt; tuple[Tensor, Tensor, Tensor, Tensor, Tensor, Tensor]\n</code></pre> <p>Predict the relative energies and forces with associated weights from the dataset.</p> <p>This function is similar to <code>predict</code> but also returns the energy and force weights from the dataset entries.</p> <p>Args:     dataset: The dataset to predict the energies and forces of.     force_field: The force field to use to predict the energies and forces.     topologies: The topologies of the molecules in the dataset.     reference: The reference energy to compute the relative energies with respect to.     normalize: Whether to scale the relative energies and forces.     device_type: The device type (e.g., 'cpu' or 'cuda').     create_graph: Whether to create a computation graph for gradients.</p> <p>Returns:     Tuple of (energy_ref, energy_pred, forces_ref, forces_pred, energy_weights, forces_weights)</p> Source code in <code>bespokefit_smee/loss.py</code> <pre><code>def predict_with_weights(\n    dataset: datasets.Dataset,\n    force_field: smee.TensorForceField,\n    topologies: dict[str, smee.TensorTopology],\n    reference: typing.Literal[\"mean\", \"min\", \"median\"] = \"mean\",\n    normalize: bool = True,\n    device_type: str = \"cpu\",\n    create_graph: bool = False,\n) -&gt; tuple[\n    torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor\n]:\n    \"\"\"Predict the relative energies and forces with associated weights from the dataset.\n\n    This function is similar to `predict` but also returns the energy and force weights\n    from the dataset entries.\n\n    Args:\n        dataset: The dataset to predict the energies and forces of.\n        force_field: The force field to use to predict the energies and forces.\n        topologies: The topologies of the molecules in the dataset.\n        reference: The reference energy to compute the relative energies with respect to.\n        normalize: Whether to scale the relative energies and forces.\n        device_type: The device type (e.g., 'cpu' or 'cuda').\n        create_graph: Whether to create a computation graph for gradients.\n\n    Returns:\n        Tuple of (energy_ref, energy_pred, forces_ref, forces_pred, energy_weights, forces_weights)\n    \"\"\"\n    energy_ref_all, energy_pred_all = [], []\n    forces_ref_all, forces_pred_all = [], []\n    energy_weights_all, forces_weights_all = [], []\n\n    for entry in dataset:\n        smiles = entry[\"smiles\"]\n\n        energy_ref = entry[\"energy\"].to(device_type)\n        forces_ref = entry[\"forces\"].reshape(len(energy_ref), -1, 3).to(device_type)\n\n        # Get weights from entry\n        energy_weights, forces_weights = get_weights_from_entry(entry)\n        energy_weights = energy_weights.to(device_type)\n        forces_weights = forces_weights.to(device_type)\n\n        coords_flat = smee.utils.tensor_like(\n            entry[\"coords\"], force_field.potentials[0].parameters\n        )\n\n        coords = (\n            (coords_flat.reshape(len(energy_ref), -1, 3))\n            .to(device_type)\n            .detach()\n            .requires_grad_(True)\n        )\n        topology = topologies[smiles]\n\n        energy_pred = smee.compute_energy(topology, force_field, coords)\n        forces_pred = -torch.autograd.grad(\n            energy_pred.sum(),\n            coords,\n            create_graph=create_graph,\n            retain_graph=True,  # Need to retain connection to FF parameters\n            allow_unused=True,\n        )[0]\n\n        if reference.lower() == \"mean\":\n            energy_ref_0 = energy_ref.mean()\n            energy_pred_0 = energy_pred.mean()\n        elif reference.lower() == \"min\":\n            min_idx = energy_ref.argmin()\n            energy_ref_0 = energy_ref[min_idx]\n            energy_pred_0 = energy_pred[min_idx]\n        elif reference.lower() == \"median\":\n            energy_ref_0 = energy_ref.median()\n            energy_pred_0 = energy_pred.median()\n        else:\n            raise NotImplementedError(f\"invalid reference energy {reference}\")\n\n        scale_energy, scale_forces = 1.0, 1.0\n\n        if normalize:\n            scale_energy = 1.0 / torch.sqrt(torch.tensor(energy_pred.numel()))\n            scale_forces = 1.0 / torch.sqrt(torch.tensor(forces_pred.numel()))\n\n        energy_ref_all.append(scale_energy * (energy_ref - energy_ref_0))\n        forces_ref_all.append(scale_forces * forces_ref.reshape(-1, 3))\n\n        energy_pred_all.append(scale_energy * (energy_pred - energy_pred_0))\n        forces_pred_all.append(scale_forces * forces_pred.reshape(-1, 3))\n\n        energy_weights_all.append(energy_weights)\n        forces_weights_all.append(forces_weights)\n\n    energy_pred_all_tensor = torch.cat(energy_pred_all)\n    forces_pred_all_tensor = torch.cat(forces_pred_all)\n\n    energy_ref_all_tensor = torch.cat(energy_ref_all)\n    energy_ref_all_tensor = smee.utils.tensor_like(\n        energy_ref_all_tensor, energy_pred_all_tensor\n    )\n\n    forces_ref_all_tensor = torch.cat(forces_ref_all)\n    forces_ref_all_tensor = smee.utils.tensor_like(\n        forces_ref_all_tensor, forces_pred_all_tensor\n    )\n\n    energy_weights_tensor = torch.cat(energy_weights_all)\n    forces_weights_tensor = torch.cat(forces_weights_all)\n\n    return (\n        energy_ref_all_tensor,\n        energy_pred_all_tensor,\n        forces_ref_all_tensor,\n        forces_pred_all_tensor,\n        energy_weights_tensor,\n        forces_weights_tensor,\n    )\n</code></pre>"},{"location":"reference/metadynamics/","title":"metadynamics","text":""},{"location":"reference/metadynamics/#bespokefit_smee.metadynamics","title":"metadynamics","text":"<p>The code below is slightly modified from the original in OpenMM at https://github.com/openmm/openmm/blob/master/wrappers/python/openmm/app/metadynamics.py. The original code is licensed under the MIT License and is reproduced here:</p> <p>metadynamics.py: Well-tempered metadynamics</p> <p>This is part of the OpenMM molecular simulation toolkit originating from Simbios, the NIH National Center for Physics-Based Simulation of Biological Structures at Stanford, funded under the NIH Roadmap for Medical Research, grant U54 GM072970. See https://simtk.org.</p> <p>Portions copyright (c) 2018-2019 Stanford University and the Authors. Authors: Peter Eastman</p> <p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p> <p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p> <p>THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS, CONTRIBUTORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p> <p>Classes:</p> <ul> <li> <code>Metadynamics</code>           \u2013            <p>Performs metadynamics.</p> </li> </ul>"},{"location":"reference/metadynamics/#bespokefit_smee.metadynamics.Metadynamics","title":"Metadynamics","text":"<pre><code>Metadynamics(\n    system,\n    variables,\n    temperature,\n    biasFactor,\n    height,\n    frequency,\n    saveFrequency=None,\n    biasDir=None,\n    independentCVs=False,\n)\n</code></pre> <p>               Bases: <code>object</code></p> <p>Performs metadynamics.</p> <p>This class implements well-tempered metadynamics, as described in Barducci et al., \"Well-Tempered Metadynamics: A Smoothly Converging and Tunable Free-Energy Method\" (https://doi.org/10.1103/PhysRevLett.100.020603).  You specify from one to three collective variables whose sampling should be accelerated.  A biasing force that depends on the collective variables is added to the simulation.  Initially the bias is zero.  As the simulation runs, Gaussian bumps are periodically added to the bias at the current location of the simulation.  This pushes the simulation away from areas it has already explored, encouraging it to sample other regions.  At the end of the simulation, the bias function can be used to calculate the system's free energy as a function of the collective variables.</p> <p>To use the class you create a Metadynamics object, passing to it the System you want to simulate and a list of BiasVariable objects defining the collective variables. It creates a biasing force and adds it to the System.  You then run the simulation as usual, but call step() on the Metadynamics object instead of on the Simulation.</p> <p>You can optionally specify a directory on disk where the current bias function should periodically be written.  In addition, it loads biases from any other files in the same directory and includes them in the simulation.  It loads files when the Metqdynamics object is first created, and also checks for any new files every time it updates its own bias on disk.</p> <p>This serves two important functions.  First, it lets you stop a metadynamics run and resume it later.  When you begin the new simulation, it will load the biases computed in the earlier simulation and continue adding to them.  Second, it provides an easy way to parallelize metadynamics sampling across many computers.  Just point all of them to a shared directory on disk.  Each process will save its biases to that directory, and also load in and apply the biases added by other processes.</p> <p>Parameters:</p> <ul> <li> <code>system</code>           \u2013            <p>the System to simulate.  A CustomCVForce implementing the bias is created and added to the System.</p> </li> <li> <code>variables</code>           \u2013            <p>the collective variables to sample</p> </li> <li> <code>temperature</code>           \u2013            <p>the temperature at which the simulation is being run.  This is used in computing the free energy.</p> </li> <li> <code>biasFactor</code>           \u2013            <p>used in scaling the height of the Gaussians added to the bias.  The collective variables are sampled as if the effective temperature of the simulation were temperature*biasFactor.</p> </li> <li> <code>height</code>           \u2013            <p>the initial height of the Gaussians to add</p> </li> <li> <code>frequency</code>           \u2013            <p>the interval in time steps at which Gaussians should be added to the bias potential</p> </li> <li> <code>saveFrequency</code>           \u2013            <p>the interval in time steps at which to write out the current biases to disk.  At the same time it writes biases, it also checks for updated biases written by other processes and loads them in.  This must be a multiple of frequency.</p> </li> <li> <code>biasDir</code>           \u2013            <p>the directory to which biases should be written, and from which biases written by other processes should be loaded</p> </li> <li> <code>independentCVs</code>           \u2013            <p>whether to treat each collective variable independently or not - if True, the collective variables are treated as independent, and the bias is added to each variable separately.  If False, the collective variables are treated as dependent, and the bias is added to the joint distribution of all variables.</p> </li> </ul> <p>Methods:</p> <ul> <li> <code>step</code>             \u2013              <p>Advance the simulation by integrating a specified number of time steps.</p> </li> <li> <code>getFreeEnergy</code>             \u2013              <p>Get the free energy of the system as a function of the collective variables.</p> </li> <li> <code>getCollectiveVariables</code>             \u2013              <p>Get the current values of all collective variables in a Simulation.</p> </li> </ul> Source code in <code>bespokefit_smee/metadynamics.py</code> <pre><code>def __init__(\n    self,\n    system,\n    variables,\n    temperature,\n    biasFactor,\n    height,\n    frequency,\n    saveFrequency=None,\n    biasDir=None,\n    independentCVs=False,\n):\n    \"\"\"Create a Metadynamics object.\n\n    Parameters\n    ----------\n    system: System\n        the System to simulate.  A CustomCVForce implementing the bias is created and\n        added to the System.\n    variables: list of BiasVariables\n        the collective variables to sample\n    temperature: temperature\n        the temperature at which the simulation is being run.  This is used in computing\n        the free energy.\n    biasFactor: float\n        used in scaling the height of the Gaussians added to the bias.  The collective\n        variables are sampled as if the effective temperature of the simulation were\n        temperature*biasFactor.\n    height: energy\n        the initial height of the Gaussians to add\n    frequency: int\n        the interval in time steps at which Gaussians should be added to the bias potential\n    saveFrequency: int (optional)\n        the interval in time steps at which to write out the current biases to disk.  At\n        the same time it writes biases, it also checks for updated biases written by other\n        processes and loads them in.  This must be a multiple of frequency.\n    biasDir: str (optional)\n        the directory to which biases should be written, and from which biases written by\n        other processes should be loaded\n    independentCVs: bool\n        whether to treat each collective variable independently or not - if True, the\n        collective variables are treated as independent, and the bias is added to each\n        variable separately.  If False, the collective variables are treated as dependent,\n        and the bias is added to the joint distribution of all variables.\n    \"\"\"\n    if not unit.is_quantity(temperature):\n        temperature = temperature * unit.kelvin\n    if not unit.is_quantity(height):\n        height = height * unit.kilojoules_per_mole\n    if biasFactor &lt;= 1.0:\n        raise ValueError(\"biasFactor must be &gt; 1\")\n    if (saveFrequency is None and biasDir is not None) or (\n        saveFrequency is not None and biasDir is None\n    ):\n        raise ValueError(\"Must specify both saveFrequency and biasDir\")\n    if saveFrequency is not None and (\n        saveFrequency &lt; frequency or saveFrequency % frequency != 0\n    ):\n        raise ValueError(\"saveFrequency must be a multiple of frequency\")\n    self.variables = variables\n    self.temperature = temperature\n    self.biasFactor = biasFactor\n    self.height = height\n    self.frequency = frequency\n    self.biasDir = biasDir\n    self.saveFrequency = saveFrequency\n    self._id = np.random.randint(0x7FFFFFFF)\n    self._saveIndex = 0\n    self._independentCVs = independentCVs\n    if self._independentCVs:\n        # For the moment, only allow equal number of grid points for all variables\n        gridWidth = variables[0].gridWidth\n        if not all(v.gridWidth == gridWidth for v in variables):\n            raise ValueError(\n                \"All variables must have the same number of grid points when independentCVs is True\"\n            )\n        self._selfBias = np.zeros((len(variables), gridWidth))\n        self._totalBias = np.zeros((len(variables), gridWidth))\n\n    else:\n        self._selfBias = np.zeros(tuple(v.gridWidth for v in reversed(variables)))\n        self._totalBias = np.zeros(tuple(v.gridWidth for v in reversed(variables)))\n    self._loadedBiases = {}\n    self._syncWithDisk()\n    self._deltaT = temperature * (biasFactor - 1)\n    varNames = [\"cv%d\" % i for i in range(len(variables))]\n    if self._independentCVs:\n        self._force = mm.CustomCVForce(\n            \" + \".join(f\"table{i}({name})\" for i, name in enumerate(varNames))\n        )\n    else:\n        self._force = mm.CustomCVForce(\"table(%s)\" % \", \".join(varNames))\n    for name, var in zip(varNames, variables, strict=False):\n        self._force.addCollectiveVariable(name, var.force)\n    self._widths = [v.gridWidth for v in variables]\n    self._limits = sum(([v.minValue, v.maxValue] for v in variables), [])\n    numPeriodics = sum(v.periodic for v in variables)\n    if numPeriodics not in [0, len(variables)]:\n        raise ValueError(\n            \"Metadynamics cannot handle mixed periodic/non-periodic variables\"\n        )\n    periodic = numPeriodics == len(variables)\n\n    if self._independentCVs:\n        self._tables = []\n\n        for i, _ in enumerate(variables):\n            table = mm.Continuous1DFunction(\n                self._totalBias[i].flatten(),\n                self._limits[i * 2],\n                self._limits[i * 2 + 1],\n                periodic,\n            )\n\n            self._tables.append(table)\n\n            self._force.addTabulatedFunction(\"table%d\" % i, table)\n\n    else:\n        if len(variables) == 1:\n            self._table = mm.Continuous1DFunction(\n                self._totalBias.flatten(), *self._limits, periodic\n            )\n        elif len(variables) == 2:\n            self._table = mm.Continuous2DFunction(\n                *self._widths, self._totalBias.flatten(), *self._limits, periodic\n            )\n        elif len(variables) == 3:\n            self._table = mm.Continuous3DFunction(\n                *self._widths, self._totalBias.flatten(), *self._limits, periodic\n            )\n        else:\n            raise ValueError(\n                \"Metadynamics requires 1, 2, or 3 collective variables\"\n            )\n\n        self._force.addTabulatedFunction(\"table\", self._table)\n\n    freeGroups = set(range(32)) - {\n        force.getForceGroup() for force in system.getForces()\n    }\n    if len(freeGroups) == 0:\n        raise RuntimeError(\n            \"Cannot assign a force group to the metadynamics force. \"\n            \"The maximum number (32) of the force groups is already used.\"\n        )\n    self._force.setForceGroup(max(freeGroups))\n    system.addForce(self._force)\n</code></pre>"},{"location":"reference/metadynamics/#bespokefit_smee.metadynamics.Metadynamics.step","title":"step","text":"<pre><code>step(simulation, steps)\n</code></pre> <p>Advance the simulation by integrating a specified number of time steps.</p> <p>Parameters:</p> <ul> <li> <code>simulation</code>           \u2013            <p>the Simulation to advance</p> </li> <li> <code>steps</code>           \u2013            <p>the number of time steps to integrate</p> </li> </ul> Source code in <code>bespokefit_smee/metadynamics.py</code> <pre><code>def step(self, simulation, steps):\n    \"\"\"Advance the simulation by integrating a specified number of time steps.\n\n    Parameters\n    ----------\n    simulation: Simulation\n        the Simulation to advance\n    steps: int\n        the number of time steps to integrate\n    \"\"\"\n    stepsToGo = steps\n    forceGroup = self._force.getForceGroup()\n    while stepsToGo &gt; 0:\n        nextSteps = stepsToGo\n        if simulation.currentStep % self.frequency == 0:\n            nextSteps = min(nextSteps, self.frequency)\n        else:\n            nextSteps = min(\n                nextSteps, self.frequency - simulation.currentStep % self.frequency\n            )\n        simulation.step(nextSteps)\n        if simulation.currentStep % self.frequency == 0:\n            position = self._force.getCollectiveVariableValues(simulation.context)\n            energy = simulation.context.getState(\n                energy=True, groups={forceGroup}\n            ).getPotentialEnergy()\n            height = self.height * np.exp(\n                -energy / (unit.MOLAR_GAS_CONSTANT_R * self._deltaT)\n            )\n            self._addGaussian(position, height, simulation.context)\n        if (\n            self.saveFrequency is not None\n            and simulation.currentStep % self.saveFrequency == 0\n        ):\n            self._syncWithDisk()\n        stepsToGo -= nextSteps\n</code></pre>"},{"location":"reference/metadynamics/#bespokefit_smee.metadynamics.Metadynamics.getFreeEnergy","title":"getFreeEnergy","text":"<pre><code>getFreeEnergy()\n</code></pre> <p>Get the free energy of the system as a function of the collective variables.</p> <p>The result is returned as a N-dimensional NumPy array, where N is the number of collective variables.  The values are in kJ/mole.  The i'th position along an axis corresponds to minValue + i*(maxValue-minValue)/gridWidth.</p> Source code in <code>bespokefit_smee/metadynamics.py</code> <pre><code>def getFreeEnergy(self):\n    \"\"\"Get the free energy of the system as a function of the collective variables.\n\n    The result is returned as a N-dimensional NumPy array, where N is the number of collective\n    variables.  The values are in kJ/mole.  The i'th position along an axis corresponds to\n    minValue + i*(maxValue-minValue)/gridWidth.\n    \"\"\"\n    return (\n        -((self.temperature + self._deltaT) / self._deltaT)\n        * self._totalBias\n        * unit.kilojoules_per_mole\n    )\n</code></pre>"},{"location":"reference/metadynamics/#bespokefit_smee.metadynamics.Metadynamics.getCollectiveVariables","title":"getCollectiveVariables","text":"<pre><code>getCollectiveVariables(simulation)\n</code></pre> <p>Get the current values of all collective variables in a Simulation.</p> Source code in <code>bespokefit_smee/metadynamics.py</code> <pre><code>def getCollectiveVariables(self, simulation):\n    \"\"\"Get the current values of all collective variables in a Simulation.\"\"\"\n    return self._force.getCollectiveVariableValues(simulation.context)\n</code></pre>"},{"location":"reference/metadynamics/#bespokefit_smee.metadynamics.Metadynamics._addGaussian","title":"_addGaussian","text":"<pre><code>_addGaussian(position, height, context)\n</code></pre> <p>Add a Gaussian to the bias function.</p> Source code in <code>bespokefit_smee/metadynamics.py</code> <pre><code>def _addGaussian(self, position, height, context):\n    \"\"\"Add a Gaussian to the bias function.\"\"\"\n    # Compute a Gaussian along each axis.\n\n    axisGaussians = []\n    for i, v in enumerate(self.variables):\n        x = (position[i] - v.minValue) / (v.maxValue - v.minValue)\n        if v.periodic:\n            x = x % 1.0\n        dist = np.abs(np.linspace(0, 1.0, num=v.gridWidth) - x)\n        if v.periodic:\n            dist = np.min(np.array([dist, np.abs(dist - 1)]), axis=0)\n            dist[-1] = dist[0]\n        axisGaussians.append(np.exp(-0.5 * dist * dist / v._scaledVariance))\n\n    # Compute their outer product.\n\n    if len(self.variables) == 1:\n        gaussian = axisGaussians[0]\n    elif self._independentCVs:\n        gaussian = np.array(axisGaussians)\n    elif not self._independentCVs:\n        gaussian = reduce(np.multiply.outer, reversed(axisGaussians))\n\n    # Add it to the bias.\n\n    height = height.value_in_unit(unit.kilojoules_per_mole)\n    self._selfBias += height * gaussian\n    self._totalBias += height * gaussian\n    if self._independentCVs:\n        for i, table in enumerate(self._tables):\n            table.setFunctionParameters(\n                self._totalBias[i], self._limits[i * 2], self._limits[i * 2 + 1]\n            )\n\n    else:\n        if len(self.variables) == 1:\n            self._table.setFunctionParameters(\n                self._totalBias.flatten(), *self._limits\n            )\n        else:\n            self._table.setFunctionParameters(\n                *self._widths, self._totalBias.flatten(), *self._limits\n            )\n    self._force.updateParametersInContext(context)\n</code></pre>"},{"location":"reference/metadynamics/#bespokefit_smee.metadynamics.Metadynamics._syncWithDisk","title":"_syncWithDisk","text":"<pre><code>_syncWithDisk()\n</code></pre> <p>Save biases to disk, and check for updated files created by other processes.</p> Source code in <code>bespokefit_smee/metadynamics.py</code> <pre><code>def _syncWithDisk(self):\n    \"\"\"Save biases to disk, and check for updated files created by other processes.\"\"\"\n    if self.biasDir is None:\n        return\n\n    # Use a safe save to write out the biases to disk, then delete the older file.\n\n    oldName = os.path.join(\n        self.biasDir, \"bias_%d_%d.npy\" % (self._id, self._saveIndex)\n    )\n    self._saveIndex += 1\n    tempName = os.path.join(\n        self.biasDir, \"temp_%d_%d.npy\" % (self._id, self._saveIndex)\n    )\n    fileName = os.path.join(\n        self.biasDir, \"bias_%d_%d.npy\" % (self._id, self._saveIndex)\n    )\n    np.save(tempName, self._selfBias)\n    os.rename(tempName, fileName)\n    if os.path.exists(oldName):\n        os.remove(oldName)\n\n    # Check for any files updated by other processes.\n\n    fileLoaded = False\n    pattern = re.compile(r\"bias_(.*)_(.*)\\.npy\")\n    for filename in os.listdir(self.biasDir):\n        match = pattern.match(filename)\n        if match is not None:\n            matchId = int(match.group(1))\n            matchIndex = int(match.group(2))\n            if matchId != self._id and (\n                matchId not in self._loadedBiases\n                or matchIndex &gt; self._loadedBiases[matchId].index\n            ):\n                try:\n                    data = np.load(os.path.join(self.biasDir, filename))\n                    self._loadedBiases[matchId] = _LoadedBias(\n                        matchId, matchIndex, data\n                    )\n                    fileLoaded = True\n                except IOError:\n                    # There's a tiny chance the file could get deleted by another process between when\n                    # we check the directory and when we try to load it.  If so, just ignore the error\n                    # and keep using whatever version of that process' biases we last loaded.\n                    pass\n\n    # If we loaded any files, recompute the total bias from all processes.\n\n    if fileLoaded:\n        self._totalBias = np.copy(self._selfBias)\n        for bias in self._loadedBiases.values():\n            self._totalBias += bias.bias\n</code></pre>"},{"location":"reference/mlp/","title":"mlp","text":""},{"location":"reference/mlp/#bespokefit_smee.mlp","title":"mlp","text":"<p>Functionality for creating and managing ML potentials.</p> <p>Functions:</p> <ul> <li> <code>supports_charges</code>             \u2013              <p>Check if a given ML potential model supports charged molecules.</p> </li> <li> <code>validate_model_charge_compatibility</code>             \u2013              <p>Validate that a charged molecule is only used with compatible ML potentials.</p> </li> <li> <code>load_egret_1</code>             \u2013              <p>Load the Egret-1 MLPotential from local package resources.</p> </li> <li> <code>get_mlp</code>             \u2013              <p>Get the MLPotential model based on the specified model name.</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>AvailableModels</code>           \u2013            <p>Available MLPotential models.</p> </li> </ul>"},{"location":"reference/mlp/#bespokefit_smee.mlp.AvailableModels","title":"AvailableModels  <code>module-attribute</code>","text":"<pre><code>AvailableModels = Literal[\n    \"aceff-2.0\",\n    \"mace-off23-small\",\n    \"mace-off23-medium\",\n    \"mace-off23-large\",\n    \"egret-1\",\n    \"aimnet2_b973c_d3_ens\",\n    \"aimnet2_wb97m_d3_ens\",\n]\n</code></pre> <p>Available MLPotential models.</p>"},{"location":"reference/mlp/#bespokefit_smee.mlp.supports_charges","title":"supports_charges","text":"<pre><code>supports_charges(model: AvailableModels) -&gt; bool\n</code></pre> <p>Check if a given ML potential model supports charged molecules.</p> <p>Parameters:</p> <ul> <li> <code>model</code>               (<code>AvailableModels</code>)           \u2013            <p>The model name to check.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>bool</code>           \u2013            <p>True if the model supports charged molecules, False otherwise.</p> </li> </ul> Source code in <code>bespokefit_smee/mlp.py</code> <pre><code>def supports_charges(model: AvailableModels) -&gt; bool:\n    \"\"\"Check if a given ML potential model supports charged molecules.\n\n    Parameters\n    ----------\n    model : AvailableModels\n        The model name to check.\n\n    Returns\n    -------\n    bool\n        True if the model supports charged molecules, False otherwise.\n    \"\"\"\n    return model in _CHARGE_SUPPORTING_MODELS\n</code></pre>"},{"location":"reference/mlp/#bespokefit_smee.mlp.validate_model_charge_compatibility","title":"validate_model_charge_compatibility","text":"<pre><code>validate_model_charge_compatibility(\n    model: AvailableModels, mol: Molecule\n) -&gt; None\n</code></pre> <p>Validate that a charged molecule is only used with compatible ML potentials.</p> <p>Parameters:</p> <ul> <li> <code>model</code>               (<code>AvailableModels</code>)           \u2013            <p>The ML potential model to use.</p> </li> <li> <code>mol</code>               (<code>Molecule</code>)           \u2013            <p>The molecule to check.</p> </li> </ul> <p>Raises:</p> <ul> <li> <code>InvalidSettingsError</code>             \u2013            <p>If the molecule is charged but the model does not support charges.</p> </li> </ul> Source code in <code>bespokefit_smee/mlp.py</code> <pre><code>def validate_model_charge_compatibility(\n    model: AvailableModels, mol: openff.toolkit.Molecule\n) -&gt; None:\n    \"\"\"Validate that a charged molecule is only used with compatible ML potentials.\n\n    Parameters\n    ----------\n    model : AvailableModels\n        The ML potential model to use.\n    mol : openff.toolkit.Molecule\n        The molecule to check.\n\n    Raises\n    ------\n    InvalidSettingsError\n        If the molecule is charged but the model does not support charges.\n    \"\"\"\n    charge = mol.total_charge.m_as(off_unit.e)\n\n    if abs(charge) &gt; 1e-6 and not supports_charges(model):\n        raise InvalidSettingsError(\n            f\"Model '{model}' does not support charged molecules. \"\n            f\"Molecule has charge {charge:.2f}. \"\n            f\"Only the following models support charges: {sorted(_CHARGE_SUPPORTING_MODELS)}. \"\n            f\"Please use a compatible model or ensure your molecule is neutral.\"\n        )\n</code></pre>"},{"location":"reference/mlp/#bespokefit_smee.mlp.load_egret_1","title":"load_egret_1","text":"<pre><code>load_egret_1() -&gt; MLPotential\n</code></pre> <p>Load the Egret-1 MLPotential from local package resources.</p> Source code in <code>bespokefit_smee/mlp.py</code> <pre><code>def load_egret_1() -&gt; MLPotential:\n    \"\"\"Load the Egret-1 MLPotential from local package resources.\"\"\"\n    filename = \"EGRET_1.model\"\n    with resources.path(\"bespokefit_smee.models\", filename) as model_path:\n        return MLPotential(\"mace\", modelPath=str(model_path))\n</code></pre>"},{"location":"reference/mlp/#bespokefit_smee.mlp.get_mlp","title":"get_mlp","text":"<pre><code>get_mlp(model: AvailableModels) -&gt; MLPotential\n</code></pre> <p>Get the MLPotential model based on the specified model name.</p> Source code in <code>bespokefit_smee/mlp.py</code> <pre><code>def get_mlp(model: AvailableModels) -&gt; MLPotential:\n    \"\"\"Get the MLPotential model based on the specified model name.\"\"\"\n\n    if model not in get_args(AvailableModels):\n        raise ValueError(\n            f\"Invalid model name: {model}. Available models are: {get_args(AvailableModels)}\"\n        )\n\n    if model not in _cache:\n        if model in aimnet2._AVAILABLE_MODELS:\n            # Ensure AIMNet2 models registered\n            aimnet2._register_aimnet2_potentials()\n        if model == \"egret-1\":\n            _cache[model] = load_egret_1()\n        else:\n            _cache[model] = MLPotential(model)\n\n    return _cache[model]\n</code></pre>"},{"location":"reference/msm/","title":"msm","text":""},{"location":"reference/msm/#bespokefit_smee.msm","title":"msm","text":"<p>Functionality for applying the modified Seminario method.</p> <p>Originally written by Alice E. A. Allen, TCM, University of Cambridge Modified by Joshua T. Horton and rewritten by Chris Ringrose, Newcastle University Further adapted for bespokefit_smee.</p> <p>Reference: AEA Allen, MC Payne, DJ Cole, J. Chem. Theory Comput. (2018), doi:10.1021/acs.jctc.7b00785</p> <p>Classes:</p> <ul> <li> <code>BondParams</code>           \u2013            <p>Parameters for a harmonic bond potential with explicit units.</p> </li> <li> <code>AngleParams</code>           \u2013            <p>Parameters for a harmonic angle potential with explicit units.</p> </li> <li> <code>AngleScalingCalculator</code>           \u2013            <p>Calculator for Modified Seminario Method scaling factors.</p> </li> <li> <code>HessianDecomposer</code>           \u2013            <p>Decomposes a molecular Hessian matrix into atom-pair contributions.</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>unit_vector_along_bond</code>             \u2013              <p>Calculate unit vector along a bond from atom_a to atom_b.</p> </li> <li> <code>unit_vector_normal_to_plane</code>             \u2013              <p>Calculate unit vector normal to the plane defined by two vectors.</p> </li> <li> <code>compute_perpendicular_vector_in_plane</code>             \u2013              <p>Compute vector in angle plane and perpendicular to the first bond.</p> </li> <li> <code>calculate_bond_force_constant</code>             \u2013              <p>Calculate force constant for a bond using the Seminario method.</p> </li> <li> <code>calculate_angle_force_constant</code>             \u2013              <p>Calculate force constant and equilibrium angle using Modified Seminario Method.</p> </li> <li> <code>calculate_bond_params</code>             \u2013              <p>Calculate bond parameters using the Modified Seminario Method.</p> </li> <li> <code>calculate_angle_params</code>             \u2013              <p>Calculate angle parameters using the Modified Seminario Method.</p> </li> <li> <code>apply_msm_to_molecule</code>             \u2013              <p>Apply Modified Seminario Method to calculate bond and angle parameters.</p> </li> <li> <code>apply_msm_to_molecules</code>             \u2013              <p>Apply Modified Seminario Method to molecules and update force field.</p> </li> </ul>"},{"location":"reference/msm/#bespokefit_smee.msm.BondParams","title":"BondParams  <code>dataclass</code>","text":"<pre><code>BondParams(force_constant: Any, length: Any)\n</code></pre> <p>Parameters for a harmonic bond potential with explicit units.</p> <p>Force constant is in kcal/mol/nm\u00b2 and length is in nm. Both are stored as OpenFF Quantity objects with explicit units.</p> <p>Methods:</p> <ul> <li> <code>from_values</code>             \u2013              <p>Create BondParams from raw float values (assumed kcal/mol/nm\u00b2 and nm).</p> </li> </ul>"},{"location":"reference/msm/#bespokefit_smee.msm.BondParams.from_values","title":"from_values  <code>classmethod</code>","text":"<pre><code>from_values(\n    force_constant: float, length: float\n) -&gt; BondParams\n</code></pre> <p>Create BondParams from raw float values (assumed kcal/mol/nm\u00b2 and nm).</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>@classmethod\ndef from_values(cls, force_constant: float, length: float) -&gt; \"BondParams\":\n    \"\"\"Create BondParams from raw float values (assumed kcal/mol/nm\u00b2 and nm).\"\"\"\n    return cls(\n        force_constant=force_constant * _BOND_K_UNIT,\n        length=length * _BOND_LENGTH_UNIT,\n    )\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm.AngleParams","title":"AngleParams  <code>dataclass</code>","text":"<pre><code>AngleParams(force_constant: Any, angle: Any)\n</code></pre> <p>Parameters for a harmonic angle potential with explicit units.</p> <p>Force constant is in kcal/mol/rad\u00b2 and angle is in radians. Both are stored as OpenFF Quantity objects with explicit units.</p> <p>Methods:</p> <ul> <li> <code>from_values</code>             \u2013              <p>Create AngleParams from raw float values (assumed kcal/mol/rad\u00b2 and radians).</p> </li> </ul>"},{"location":"reference/msm/#bespokefit_smee.msm.AngleParams.from_values","title":"from_values  <code>classmethod</code>","text":"<pre><code>from_values(\n    force_constant: float, angle: float\n) -&gt; AngleParams\n</code></pre> <p>Create AngleParams from raw float values (assumed kcal/mol/rad\u00b2 and radians).</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>@classmethod\ndef from_values(cls, force_constant: float, angle: float) -&gt; \"AngleParams\":\n    \"\"\"Create AngleParams from raw float values (assumed kcal/mol/rad\u00b2 and radians).\"\"\"\n    return cls(\n        force_constant=force_constant * _ANGLE_K_UNIT,\n        angle=angle * _ANGLE_UNIT,\n    )\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm.AngleScalingCalculator","title":"AngleScalingCalculator","text":"<pre><code>AngleScalingCalculator(\n    angles: list[tuple[int, int, int]],\n    coords: NDArray[floating],\n    n_atoms: int,\n)\n</code></pre> <p>Calculator for Modified Seminario Method scaling factors.</p> <p>The scaling factors account for the contribution of other angles sharing the same central atom and bond.</p> <p>Args:     angles: List of angle tuples (atom_a, atom_b, atom_c).     coords: Atomic coordinates.     n_atoms: Number of atoms in the molecule.</p> <p>Methods:</p> <ul> <li> <code>compute_scaling_factors</code>             \u2013              <p>Compute scaling factors for all angles.</p> </li> </ul> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def __init__(\n    self,\n    angles: list[tuple[int, int, int]],\n    coords: npt.NDArray[np.floating],\n    n_atoms: int,\n):\n    \"\"\"Initialize the scaling factor calculator.\n\n    Args:\n        angles: List of angle tuples (atom_a, atom_b, atom_c).\n        coords: Atomic coordinates.\n        n_atoms: Number of atoms in the molecule.\n    \"\"\"\n    self.angles = angles\n    self.coords = coords\n    self.n_atoms = n_atoms\n\n    # Build data structures for efficient lookup\n    self._build_central_atom_lookup()\n    self._compute_perpendicular_vectors()\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm.AngleScalingCalculator._build_central_atom_lookup","title":"_build_central_atom_lookup","text":"<pre><code>_build_central_atom_lookup() -&gt; None\n</code></pre> <p>Build lookup structure for angles organized by central atom.</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def _build_central_atom_lookup(self) -&gt; None:\n    \"\"\"Build lookup structure for angles organized by central atom.\"\"\"\n    # central_atoms_angles[b] = [(a, c, angle_idx), (c, a, angle_idx), ...]\n    self.central_atoms_angles: list[list[tuple[int, int, int]]] = [\n        [] for _ in range(self.n_atoms)\n    ]\n\n    for angle_idx, (atom_a, atom_b, atom_c) in enumerate(self.angles):\n        # Add both orderings for the angle\n        self.central_atoms_angles[atom_b].append((atom_a, atom_c, angle_idx))\n        self.central_atoms_angles[atom_b].append((atom_c, atom_a, angle_idx))\n\n    # Sort by first atom for consistent ordering\n    for coord in range(self.n_atoms):\n        self.central_atoms_angles[coord] = sorted(\n            self.central_atoms_angles[coord], key=itemgetter(0)\n        )\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm.AngleScalingCalculator._compute_perpendicular_vectors","title":"_compute_perpendicular_vectors","text":"<pre><code>_compute_perpendicular_vectors() -&gt; None\n</code></pre> <p>Compute perpendicular vectors for all angle contributions.</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def _compute_perpendicular_vectors(self) -&gt; None:\n    \"\"\"Compute perpendicular vectors for all angle contributions.\"\"\"\n    self.unit_pa_all_angles: list[list[npt.NDArray[np.floating]]] = [\n        [] for _ in range(self.n_atoms)\n    ]\n\n    for central_atom in range(self.n_atoms):\n        for entry in self.central_atoms_angles[central_atom]:\n            first_atom, third_atom, _ = entry\n            angle = (first_atom, central_atom, third_atom)\n            u_pa = compute_perpendicular_vector_in_plane(self.coords, angle)\n            self.unit_pa_all_angles[central_atom].append(u_pa)\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm.AngleScalingCalculator.compute_scaling_factors","title":"compute_scaling_factors","text":"<pre><code>compute_scaling_factors() -&gt; list[tuple[float, float]]\n</code></pre> <p>Compute scaling factors for all angles.</p> <p>Returns:     List of (scale_ab, scale_cb) tuples for each angle.</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def compute_scaling_factors(self) -&gt; list[tuple[float, float]]:\n    \"\"\"Compute scaling factors for all angles.\n\n    Returns:\n        List of (scale_ab, scale_cb) tuples for each angle.\n    \"\"\"\n    # Compute raw scaling factors organized by central atom\n    scaling_factor_all_angles: list[list[tuple[float, int]]] = [\n        [] for _ in range(self.n_atoms)\n    ]\n\n    for central_atom in range(self.n_atoms):\n        n_entries = len(self.central_atoms_angles[central_atom])\n\n        for j in range(n_entries):\n            angle_idx = self.central_atoms_angles[central_atom][j][2]\n            first_atom = self.central_atoms_angles[central_atom][j][0]\n\n            # Count additional contributions from angles sharing the same bond\n            extra_contribs = 0.0\n            n_neighbors = 0\n\n            # Forward direction\n            n = 1\n            while (\n                j + n &lt; n_entries\n                and self.central_atoms_angles[central_atom][j + n][0] == first_atom\n            ):\n                dot_val = np.dot(\n                    self.unit_pa_all_angles[central_atom][j],\n                    self.unit_pa_all_angles[central_atom][j + n],\n                )\n                extra_contribs += abs(dot_val) ** 2\n                n += 1\n                n_neighbors += 1\n\n            # Backward direction\n            m = 1\n            while (\n                j - m &gt;= 0\n                and self.central_atoms_angles[central_atom][j - m][0] == first_atom\n            ):\n                dot_val = np.dot(\n                    self.unit_pa_all_angles[central_atom][j],\n                    self.unit_pa_all_angles[central_atom][j - m],\n                )\n                extra_contribs += abs(dot_val) ** 2\n                m += 1\n                n_neighbors += 1\n\n            # Compute scaling factor\n            scale = 1.0\n            if n_neighbors &gt; 0:\n                scale += extra_contribs / n_neighbors\n\n            scaling_factor_all_angles[central_atom].append((scale, angle_idx))\n\n    # Reorganize scaling factors by angle index\n    scaling_factors_by_angle: list[list[float]] = [\n        [] for _ in range(len(self.angles))\n    ]\n\n    for central_atom in range(self.n_atoms):\n        for scale, angle_idx in scaling_factor_all_angles[central_atom]:\n            scaling_factors_by_angle[angle_idx].append(scale)\n\n    # Return as list of tuples\n    return [\n        (scales[0], scales[1]) if len(scales) &gt;= 2 else (1.0, 1.0)\n        for scales in scaling_factors_by_angle\n    ]\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm.HessianDecomposer","title":"HessianDecomposer","text":"<pre><code>HessianDecomposer(\n    hessian: NDArray[floating], coords: NDArray[floating]\n)\n</code></pre> <p>Decomposes a molecular Hessian matrix into atom-pair contributions.</p> <p>Args:     hessian: Full Hessian matrix of shape (3n_atoms, 3n_atoms).     coords: Atomic coordinates of shape (n_atoms, 3).</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def __init__(\n    self, hessian: npt.NDArray[np.floating], coords: npt.NDArray[np.floating]\n):\n    \"\"\"Initialize with Hessian and coordinates.\n\n    Args:\n        hessian: Full Hessian matrix of shape (3*n_atoms, 3*n_atoms).\n        coords: Atomic coordinates of shape (n_atoms, 3).\n    \"\"\"\n    self.hessian = hessian\n    self.coords = coords\n    self.n_atoms = len(coords)\n\n    # Compute eigenvalues, eigenvectors, and bond lengths\n    self._decompose()\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm.HessianDecomposer._decompose","title":"_decompose","text":"<pre><code>_decompose() -&gt; None\n</code></pre> <p>Compute eigendecomposition of partial Hessian matrices.</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def _decompose(self) -&gt; None:\n    \"\"\"Compute eigendecomposition of partial Hessian matrices.\"\"\"\n    n = self.n_atoms\n\n    self.eigenvecs = np.empty((3, 3, n, n), dtype=complex)\n    self.eigenvals = np.empty((n, n, 3), dtype=complex)\n    self.bond_lengths = np.zeros((n, n))\n\n    for i in range(n):\n        for j in range(n):\n            diff_i_j = self.coords[i] - self.coords[j]\n            self.bond_lengths[i, j] = np.linalg.norm(diff_i_j)\n\n            partial_hessian = self.hessian[\n                (i * 3) : ((i + 1) * 3), (j * 3) : ((j + 1) * 3)\n            ]\n\n            self.eigenvals[i, j, :], self.eigenvecs[:, :, i, j] = np.linalg.eig(\n                partial_hessian\n            )\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm.unit_vector_along_bond","title":"unit_vector_along_bond","text":"<pre><code>unit_vector_along_bond(\n    coords: NDArray[floating], atom_a: int, atom_b: int\n) -&gt; NDArray[floating]\n</code></pre> <p>Calculate unit vector along a bond from atom_a to atom_b.</p> <p>Args:     coords: Atomic coordinates array of shape (n_atoms, 3).     atom_a: Index of first atom.     atom_b: Index of second atom.</p> <p>Returns:     Unit vector from atom_a to atom_b.</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def unit_vector_along_bond(\n    coords: npt.NDArray[np.floating], atom_a: int, atom_b: int\n) -&gt; npt.NDArray[np.floating]:\n    \"\"\"Calculate unit vector along a bond from atom_a to atom_b.\n\n    Args:\n        coords: Atomic coordinates array of shape (n_atoms, 3).\n        atom_a: Index of first atom.\n        atom_b: Index of second atom.\n\n    Returns:\n        Unit vector from atom_a to atom_b.\n    \"\"\"\n    diff_ab = coords[atom_b] - coords[atom_a]\n    result: npt.NDArray[np.floating[Any]] = diff_ab / np.linalg.norm(diff_ab)\n    return result\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm.unit_vector_normal_to_plane","title":"unit_vector_normal_to_plane","text":"<pre><code>unit_vector_normal_to_plane(\n    u_bc: NDArray[floating], u_ab: NDArray[floating]\n) -&gt; NDArray[floating]\n</code></pre> <p>Calculate unit vector normal to the plane defined by two vectors.</p> <p>Args:     u_bc: First unit vector.     u_ab: Second unit vector.</p> <p>Returns:     Unit vector normal to the plane defined by u_bc and u_ab.</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def unit_vector_normal_to_plane(\n    u_bc: npt.NDArray[np.floating], u_ab: npt.NDArray[np.floating]\n) -&gt; npt.NDArray[np.floating]:\n    \"\"\"Calculate unit vector normal to the plane defined by two vectors.\n\n    Args:\n        u_bc: First unit vector.\n        u_ab: Second unit vector.\n\n    Returns:\n        Unit vector normal to the plane defined by u_bc and u_ab.\n    \"\"\"\n    cross = np.cross(u_bc, u_ab)\n    norm = np.linalg.norm(cross)\n    if norm &lt; 1e-10:\n        # Vectors are nearly parallel; return arbitrary perpendicular vector\n        return _get_arbitrary_perpendicular(u_ab)\n    result: npt.NDArray[np.floating[Any]] = cross / norm\n    return result\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm._get_arbitrary_perpendicular","title":"_get_arbitrary_perpendicular","text":"<pre><code>_get_arbitrary_perpendicular(\n    u: NDArray[floating],\n) -&gt; NDArray[floating]\n</code></pre> <p>Get an arbitrary unit vector perpendicular to the given vector.</p> <p>Args:     u: Input unit vector.</p> <p>Returns:     Unit vector perpendicular to u.</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def _get_arbitrary_perpendicular(\n    u: npt.NDArray[np.floating],\n) -&gt; npt.NDArray[np.floating]:\n    \"\"\"Get an arbitrary unit vector perpendicular to the given vector.\n\n    Args:\n        u: Input unit vector.\n\n    Returns:\n        Unit vector perpendicular to u.\n    \"\"\"\n    # Find a vector not parallel to u\n    if abs(u[0]) &lt; 0.9:\n        v = np.array([1.0, 0.0, 0.0])\n    else:\n        v = np.array([0.0, 1.0, 0.0])\n\n    # Use Gram-Schmidt\n    perp = v - np.dot(v, u) * u\n    result: npt.NDArray[np.floating[Any]] = perp / np.linalg.norm(perp)\n    return result\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm.compute_perpendicular_vector_in_plane","title":"compute_perpendicular_vector_in_plane","text":"<pre><code>compute_perpendicular_vector_in_plane(\n    coords: NDArray[floating], angle: tuple[int, int, int]\n) -&gt; NDArray[floating]\n</code></pre> <p>Compute vector in angle plane and perpendicular to the first bond.</p> <p>For angle a-b-c, computes the vector in plane abc that is perpendicular to the bond a-b.</p> <p>Args:     coords: Atomic coordinates array.     angle: Tuple of (atom_a, atom_b, atom_c) indices.</p> <p>Returns:     Unit vector in the plane perpendicular to bond a-b.</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def compute_perpendicular_vector_in_plane(\n    coords: npt.NDArray[np.floating], angle: tuple[int, int, int]\n) -&gt; npt.NDArray[np.floating]:\n    \"\"\"Compute vector in angle plane and perpendicular to the first bond.\n\n    For angle a-b-c, computes the vector in plane abc that is perpendicular\n    to the bond a-b.\n\n    Args:\n        coords: Atomic coordinates array.\n        angle: Tuple of (atom_a, atom_b, atom_c) indices.\n\n    Returns:\n        Unit vector in the plane perpendicular to bond a-b.\n    \"\"\"\n    atom_a, atom_b, atom_c = angle\n\n    u_ab = unit_vector_along_bond(coords, atom_a, atom_b)\n    u_cb = unit_vector_along_bond(coords, atom_c, atom_b)\n\n    u_n = unit_vector_normal_to_plane(u_cb, u_ab)\n\n    return unit_vector_normal_to_plane(u_n, u_ab)\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm.calculate_bond_force_constant","title":"calculate_bond_force_constant","text":"<pre><code>calculate_bond_force_constant(\n    bond: tuple[int, int],\n    eigenvals: NDArray[complexfloating],\n    eigenvecs: NDArray[complexfloating],\n    coords: NDArray[floating],\n) -&gt; float\n</code></pre> <p>Calculate force constant for a bond using the Seminario method.</p> <p>Implements Equation 10 from the Seminario paper.</p> <p>Args:     bond: Tuple of (atom_a, atom_b) indices.     eigenvals: Eigenvalues array of shape (n_atoms, n_atoms, 3).     eigenvecs: Eigenvectors array of shape (3, 3, n_atoms, n_atoms).     coords: Atomic coordinates in Angstroms.</p> <p>Returns:     Force constant in kcal/mol/\u00c5^2.</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def calculate_bond_force_constant(\n    bond: tuple[int, int],\n    eigenvals: npt.NDArray[np.complexfloating],\n    eigenvecs: npt.NDArray[np.complexfloating],\n    coords: npt.NDArray[np.floating],\n) -&gt; float:\n    \"\"\"Calculate force constant for a bond using the Seminario method.\n\n    Implements Equation 10 from the Seminario paper.\n\n    Args:\n        bond: Tuple of (atom_a, atom_b) indices.\n        eigenvals: Eigenvalues array of shape (n_atoms, n_atoms, 3).\n        eigenvecs: Eigenvectors array of shape (3, 3, n_atoms, n_atoms).\n        coords: Atomic coordinates in Angstroms.\n\n    Returns:\n        Force constant in kcal/mol/\u00c5^2.\n    \"\"\"\n    atom_a, atom_b = bond\n    eigenvals_ab = eigenvals[atom_a, atom_b, :]\n    eigenvecs_ab = eigenvecs[:, :, atom_a, atom_b]\n\n    u_ab = unit_vector_along_bond(coords, atom_a, atom_b)\n\n    # Sum over eigenvalues weighted by projection onto bond direction\n    k_bond = -1 * sum(\n        eigenvals_ab[i] * abs(np.dot(u_ab, eigenvecs_ab[:, i])) for i in range(3)\n    )\n\n    return float(np.real(k_bond))\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm.calculate_angle_force_constant","title":"calculate_angle_force_constant","text":"<pre><code>calculate_angle_force_constant(\n    angle: tuple[int, int, int],\n    bond_lengths: NDArray[floating],\n    eigenvals: NDArray[complexfloating],\n    eigenvecs: NDArray[complexfloating],\n    coords: NDArray[floating],\n    scalings: tuple[float, float],\n) -&gt; tuple[float, float]\n</code></pre> <p>Calculate force constant and equilibrium angle using Modified Seminario Method.</p> <p>Implements Equation 14 from the Seminario paper with modifications for additional angle contributions.</p> <p>Args:     angle: Tuple of (atom_a, atom_b, atom_c) indices.     bond_lengths: Matrix of bond lengths.     eigenvals: Eigenvalues array.     eigenvecs: Eigenvectors array.     coords: Atomic coordinates in Angstroms.     scalings: Scaling factors (scale_ab, scale_cb) for Modified Seminario.</p> <p>Returns:     Tuple of (force_constant, equilibrium_angle) where force constant is     in kcal/mol/rad^2 and angle is in degrees.</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def calculate_angle_force_constant(\n    angle: tuple[int, int, int],\n    bond_lengths: npt.NDArray[np.floating],\n    eigenvals: npt.NDArray[np.complexfloating],\n    eigenvecs: npt.NDArray[np.complexfloating],\n    coords: npt.NDArray[np.floating],\n    scalings: tuple[float, float],\n) -&gt; tuple[float, float]:\n    \"\"\"Calculate force constant and equilibrium angle using Modified Seminario Method.\n\n    Implements Equation 14 from the Seminario paper with modifications for\n    additional angle contributions.\n\n    Args:\n        angle: Tuple of (atom_a, atom_b, atom_c) indices.\n        bond_lengths: Matrix of bond lengths.\n        eigenvals: Eigenvalues array.\n        eigenvecs: Eigenvectors array.\n        coords: Atomic coordinates in Angstroms.\n        scalings: Scaling factors (scale_ab, scale_cb) for Modified Seminario.\n\n    Returns:\n        Tuple of (force_constant, equilibrium_angle) where force constant is\n        in kcal/mol/rad^2 and angle is in degrees.\n    \"\"\"\n    atom_a, atom_b, atom_c = angle\n\n    u_ab = unit_vector_along_bond(coords, atom_a, atom_b)\n    u_cb = unit_vector_along_bond(coords, atom_c, atom_b)\n\n    bond_len_ab = bond_lengths[atom_a, atom_b]\n    eigenvals_ab = eigenvals[atom_a, atom_b, :]\n    eigenvecs_ab = eigenvecs[:3, :3, atom_a, atom_b]\n\n    bond_len_bc = bond_lengths[atom_b, atom_c]\n    eigenvals_cb = eigenvals[atom_c, atom_b, :]\n    eigenvecs_cb = eigenvecs[:3, :3, atom_c, atom_b]\n\n    # Check for linear angle\n    diff_norm = abs(np.linalg.norm(u_cb - u_ab))\n    if diff_norm &lt; 0.01 or (1.99 &lt; diff_norm &lt; 2.01):\n        return _calculate_linear_angle_force_constant(\n            u_ab,\n            u_cb,\n            (bond_len_ab, bond_len_bc),\n            (eigenvals_ab, eigenvals_cb),\n            (eigenvecs_ab, eigenvecs_cb),\n        )\n\n    # Normal case: compute perpendicular vectors\n    u_n = unit_vector_normal_to_plane(u_cb, u_ab)\n    u_pa = unit_vector_normal_to_plane(u_n, u_ab)\n    u_pc = unit_vector_normal_to_plane(u_cb, u_n)\n\n    # Compute weighted sums with scaling factors\n    sum_first = (\n        sum(\n            eigenvals_ab[i] * abs(_dot_product(u_pa, eigenvecs_ab[:, i]))\n            for i in range(3)\n        )\n        / scalings[0]\n    )\n    sum_second = (\n        sum(\n            eigenvals_cb[i] * abs(_dot_product(u_pc, eigenvecs_cb[:, i]))\n            for i in range(3)\n        )\n        / scalings[1]\n    )\n\n    # Combine as two springs in series\n    k_theta = 1.0 / (\n        (1 / ((bond_len_ab**2) * sum_first)) + (1 / ((bond_len_bc**2) * sum_second))\n    )\n\n    k_theta = abs(float(np.real(k_theta)))\n\n    # Equilibrium angle\n    theta_0 = np.degrees(np.arccos(np.clip(np.dot(u_ab, u_cb), -1.0, 1.0)))\n\n    return k_theta, theta_0\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm._calculate_linear_angle_force_constant","title":"_calculate_linear_angle_force_constant","text":"<pre><code>_calculate_linear_angle_force_constant(\n    u_ab: NDArray[floating],\n    u_cb: NDArray[floating],\n    bond_lens: tuple[float, float],\n    eigenvals: tuple[\n        NDArray[complexfloating], NDArray[complexfloating]\n    ],\n    eigenvecs: tuple[\n        NDArray[complexfloating], NDArray[complexfloating]\n    ],\n    n_samples: int = 200,\n) -&gt; tuple[float, float]\n</code></pre> <p>Calculate force constant for a linear or near-linear angle.</p> <p>For linear angles (e.g., nitrile groups), the perpendicular vector is not uniquely defined. We sample different perpendicular directions and average.</p> <p>Args:     u_ab: Unit vector along bond a-b.     u_cb: Unit vector along bond c-b.     bond_lens: Tuple of (bond_len_ab, bond_len_bc).     eigenvals: Tuple of eigenvalue arrays for (a-b, c-b).     eigenvecs: Tuple of eigenvector arrays for (a-b, c-b).     n_samples: Number of samples around the bond direction.</p> <p>Returns:     Tuple of (force_constant, equilibrium_angle).</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def _calculate_linear_angle_force_constant(\n    u_ab: npt.NDArray[np.floating],\n    u_cb: npt.NDArray[np.floating],\n    bond_lens: tuple[float, float],\n    eigenvals: tuple[npt.NDArray[np.complexfloating], npt.NDArray[np.complexfloating]],\n    eigenvecs: tuple[npt.NDArray[np.complexfloating], npt.NDArray[np.complexfloating]],\n    n_samples: int = 200,\n) -&gt; tuple[float, float]:\n    \"\"\"Calculate force constant for a linear or near-linear angle.\n\n    For linear angles (e.g., nitrile groups), the perpendicular vector is not\n    uniquely defined. We sample different perpendicular directions and average.\n\n    Args:\n        u_ab: Unit vector along bond a-b.\n        u_cb: Unit vector along bond c-b.\n        bond_lens: Tuple of (bond_len_ab, bond_len_bc).\n        eigenvals: Tuple of eigenvalue arrays for (a-b, c-b).\n        eigenvecs: Tuple of eigenvector arrays for (a-b, c-b).\n        n_samples: Number of samples around the bond direction.\n\n    Returns:\n        Tuple of (force_constant, equilibrium_angle).\n    \"\"\"\n    k_theta_array = np.zeros(n_samples)\n\n    for theta_idx in range(n_samples):\n        theta = 2 * np.pi * theta_idx / n_samples\n        # Generate a sample normal vector\n        u_n = np.array(\n            [\n                np.sin(theta) * np.cos(theta),\n                np.sin(theta) * np.sin(theta),\n                np.cos(theta),\n            ]\n        )\n\n        u_pa = unit_vector_normal_to_plane(u_n, u_ab)\n        u_pc = unit_vector_normal_to_plane(u_cb, u_n)\n\n        sum_first = sum(\n            eigenvals[0][i] * abs(_dot_product(u_pa, eigenvecs[0][:, i]))\n            for i in range(3)\n        )\n        sum_second = sum(\n            eigenvals[1][i] * abs(_dot_product(u_pc, eigenvecs[1][:, i]))\n            for i in range(3)\n        )\n\n        k_theta_i = 1.0 / (\n            (1 / ((bond_lens[0] ** 2) * sum_first))\n            + (1 / ((bond_lens[1] ** 2) * sum_second))\n        )\n        k_theta_array[theta_idx] = abs(float(np.real(k_theta_i)) * 0.5)\n\n    k_theta = float(np.mean(k_theta_array))\n    theta_0 = np.degrees(np.arccos(np.clip(np.dot(u_ab, u_cb), -1.0, 1.0)))\n\n    return k_theta, theta_0\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm._dot_product","title":"_dot_product","text":"<pre><code>_dot_product(\n    u_pa: NDArray[floating[Any]],\n    eig_vec: NDArray[complexfloating[Any, Any]],\n) -&gt; complex\n</code></pre> <p>Compute dot product handling complex eigenvectors.</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def _dot_product(\n    u_pa: npt.NDArray[np.floating[Any]],\n    eig_vec: npt.NDArray[np.complexfloating[Any, Any]],\n) -&gt; complex:\n    \"\"\"Compute dot product handling complex eigenvectors.\"\"\"\n    return complex(sum(u_pa[i] * eig_vec[i].conjugate() for i in range(3)))\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm.calculate_bond_params","title":"calculate_bond_params","text":"<pre><code>calculate_bond_params(\n    bond_indices: list[tuple[int, int]],\n    hessian_decomposer: HessianDecomposer,\n    vib_scaling: float,\n) -&gt; dict[tuple[int, int], BondParams]\n</code></pre> <p>Calculate bond parameters using the Modified Seminario Method.</p> <p>Args:     bond_indices: List of bond tuples (atom_i, atom_j).     hessian_decomposer: Decomposed Hessian data (in internal units: kcal/mol/nm\u00b2).     vib_scaling: Vibrational scaling factor.</p> <p>Returns:     Dictionary mapping bond indices to BondParams.</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def calculate_bond_params(\n    bond_indices: list[tuple[int, int]],\n    hessian_decomposer: HessianDecomposer,\n    vib_scaling: float,\n) -&gt; dict[tuple[int, int], BondParams]:\n    \"\"\"Calculate bond parameters using the Modified Seminario Method.\n\n    Args:\n        bond_indices: List of bond tuples (atom_i, atom_j).\n        hessian_decomposer: Decomposed Hessian data (in internal units: kcal/mol/nm\u00b2).\n        vib_scaling: Vibrational scaling factor.\n\n    Returns:\n        Dictionary mapping bond indices to BondParams.\n    \"\"\"\n    bond_params: dict[tuple[int, int], BondParams] = {}\n\n    for bond in bond_indices:\n        # Calculate force constant in both directions and average\n        k_ab = calculate_bond_force_constant(\n            bond,\n            hessian_decomposer.eigenvals,\n            hessian_decomposer.eigenvecs,\n            hessian_decomposer.coords,\n        )\n        k_ba = calculate_bond_force_constant(\n            (bond[1], bond[0]),\n            hessian_decomposer.eigenvals,\n            hessian_decomposer.eigenvecs,\n            hessian_decomposer.coords,\n        )\n\n        # Average and apply vibrational scaling\n        # Force constant is in kcal/mol/nm\u00b2 (from internal units)\n        k_bond = ((k_ab + k_ba) / 2.0) * (vib_scaling**2)\n\n        # Get equilibrium length in nm (from internal units)\n        bond_length_nm = hessian_decomposer.bond_lengths[bond[0], bond[1]]\n\n        bond_params[bond] = BondParams.from_values(\n            force_constant=k_bond, length=bond_length_nm\n        )\n\n    return bond_params\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm.calculate_angle_params","title":"calculate_angle_params","text":"<pre><code>calculate_angle_params(\n    angle_indices: list[tuple[int, int, int]],\n    hessian_decomposer: HessianDecomposer,\n    vib_scaling: float,\n) -&gt; dict[tuple[int, int, int], AngleParams]\n</code></pre> <p>Calculate angle parameters using the Modified Seminario Method.</p> <p>Args:     angle_indices: List of angle tuples (atom_i, atom_j, atom_k).     hessian_decomposer: Decomposed Hessian data (in internal units: kcal/mol/nm\u00b2).     vib_scaling: Vibrational scaling factor.</p> <p>Returns:     Dictionary mapping angle indices to AngleParams.</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def calculate_angle_params(\n    angle_indices: list[tuple[int, int, int]],\n    hessian_decomposer: HessianDecomposer,\n    vib_scaling: float,\n) -&gt; dict[tuple[int, int, int], AngleParams]:\n    \"\"\"Calculate angle parameters using the Modified Seminario Method.\n\n    Args:\n        angle_indices: List of angle tuples (atom_i, atom_j, atom_k).\n        hessian_decomposer: Decomposed Hessian data (in internal units: kcal/mol/nm\u00b2).\n        vib_scaling: Vibrational scaling factor.\n\n    Returns:\n        Dictionary mapping angle indices to AngleParams.\n    \"\"\"\n    if not angle_indices:\n        return {}\n\n    # Compute scaling factors for all angles\n    scaling_calculator = AngleScalingCalculator(\n        angle_indices, hessian_decomposer.coords, hessian_decomposer.n_atoms\n    )\n    all_scaling_factors = scaling_calculator.compute_scaling_factors()\n\n    angle_params: dict[tuple[int, int, int], AngleParams] = {}\n\n    for angle_idx, angle in enumerate(angle_indices):\n        scalings = all_scaling_factors[angle_idx]\n\n        # Calculate in both directions and average\n        k_theta_ab, theta_0_ab = calculate_angle_force_constant(\n            angle,\n            hessian_decomposer.bond_lengths,\n            hessian_decomposer.eigenvals,\n            hessian_decomposer.eigenvecs,\n            hessian_decomposer.coords,\n            scalings,\n        )\n        k_theta_ba, theta_0_ba = calculate_angle_force_constant(\n            (angle[2], angle[1], angle[0]),\n            hessian_decomposer.bond_lengths,\n            hessian_decomposer.eigenvals,\n            hessian_decomposer.eigenvecs,\n            hessian_decomposer.coords,\n            (scalings[1], scalings[0]),\n        )\n\n        # Average and apply vibrational scaling\n        # Force constant is in kcal/mol/rad\u00b2 (derived from internal units)\n        k_theta = ((k_theta_ab + k_theta_ba) / 2.0) * (vib_scaling**2)\n\n        # Angle is returned in degrees, convert to radians\n        theta_0_rad = np.radians((theta_0_ab + theta_0_ba) / 2.0)\n\n        angle_params[angle] = AngleParams.from_values(\n            force_constant=k_theta, angle=theta_0_rad\n        )\n\n    return angle_params\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm.apply_msm_to_molecule","title":"apply_msm_to_molecule","text":"<pre><code>apply_msm_to_molecule(\n    mol: Molecule,\n    bond_indices: list[tuple[int, int]],\n    angle_indices: list[tuple[int, int, int]],\n    settings: MSMSettings,\n) -&gt; tuple[\n    dict[tuple[int, int], BondParams],\n    dict[tuple[int, int, int], AngleParams],\n]\n</code></pre> <p>Apply Modified Seminario Method to calculate bond and angle parameters.</p> <p>Sets up an ML potential simulation, minimizes the structure, computes the Hessian, and calculates force field parameters. If settings.n_conformers &gt; 1, parameters are calculated for each conformer and averaged.</p> <p>Args:     mol: OpenFF Molecule to parameterize.     bond_indices: List of bond indices to calculate parameters for.     angle_indices: List of angle indices to calculate parameters for.     settings: MSM settings including ML potential, scaling factors, and n_conformers.</p> <p>Returns:     Tuple of (bond_params_dict, angle_params_dict). If multiple conformers are used,     the parameters are averaged over all conformers.</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def apply_msm_to_molecule(\n    mol: openff.toolkit.Molecule,\n    bond_indices: list[tuple[int, int]],\n    angle_indices: list[tuple[int, int, int]],\n    settings: MSMSettings,\n) -&gt; tuple[dict[tuple[int, int], BondParams], dict[tuple[int, int, int], AngleParams]]:\n    \"\"\"Apply Modified Seminario Method to calculate bond and angle parameters.\n\n    Sets up an ML potential simulation, minimizes the structure, computes the\n    Hessian, and calculates force field parameters. If settings.n_conformers &gt; 1,\n    parameters are calculated for each conformer and averaged.\n\n    Args:\n        mol: OpenFF Molecule to parameterize.\n        bond_indices: List of bond indices to calculate parameters for.\n        angle_indices: List of angle indices to calculate parameters for.\n        settings: MSM settings including ML potential, scaling factors, and n_conformers.\n\n    Returns:\n        Tuple of (bond_params_dict, angle_params_dict). If multiple conformers are used,\n        the parameters are averaged over all conformers.\n    \"\"\"\n    # Generate conformers\n    mol_with_conformers = _copy_mol_and_add_conformers(\n        mol, n_conformers=settings.n_conformers\n    )\n    ml_system = _get_ml_omm_system(mol_with_conformers, settings.ml_potential)\n    integrator = _get_integrator(300 * _OMM_KELVIN, 1.0 * _OMM_FEMTOSECOND)\n    simulation = Simulation(\n        mol_with_conformers.to_topology().to_openmm(), ml_system, integrator\n    )\n\n    # Collect parameters from each conformer\n    all_bond_params: defaultdict[tuple[int, int], list[BondParams]] = defaultdict(list)\n    all_angle_params: defaultdict[tuple[int, int, int], list[AngleParams]] = (\n        defaultdict(list)\n    )\n\n    for conf_idx in tqdm(\n        range(settings.n_conformers),\n        desc=\"Finding MSM parameters for conformers\",\n        leave=False,\n    ):\n        # Set positions for this conformer\n        simulation.context.setPositions(\n            mol_with_conformers.conformers[conf_idx].to_openmm()\n        )\n\n        # Minimize to local energy minimum\n        simulation.minimizeEnergy(maxIterations=0, tolerance=settings.tolerance)\n        positions = simulation.context.getState(getPositions=True).getPositions(\n            asNumpy=True\n        )\n\n        # Convert positions to internal units (nm)\n        coords = positions.value_in_unit(_INTERNAL_LENGTH_UNIT)\n\n        # Compute Hessian at the minimum and convert to internal units (kcal/mol/nm\u00b2)\n        # The hessian is returned with OpenMM units attached, so we use automatic\n        # unit conversion to our internal standard units\n        hessian_with_units = calculate_hessian(\n            simulation,\n            positions,\n            finite_step=settings.finite_step,\n        )\n        hessian = hessian_with_units.value_in_unit(_INTERNAL_HESSIAN_UNIT)\n\n        # Decompose Hessian (works with unitless numpy arrays in internal units)\n        hessian_decomposer = HessianDecomposer(hessian, coords)\n\n        # Calculate bond and angle parameters for this conformer\n        conformer_bond_params = calculate_bond_params(\n            bond_indices, hessian_decomposer, settings.vib_scaling\n        )\n        conformer_angle_params = calculate_angle_params(\n            angle_indices, hessian_decomposer, settings.vib_scaling\n        )\n\n        # Collect parameters\n        for bond_idx, bond_param in conformer_bond_params.items():\n            all_bond_params[bond_idx].append(bond_param)\n        for angle_idx, angle_param in conformer_angle_params.items():\n            all_angle_params[angle_idx].append(angle_param)\n\n    # Clean up OpenMM objects to free GPU memory\n    cleanup_simulation(simulation, integrator)\n\n    # Average parameters over all conformers\n    bond_params = {\n        bond_idx: _mean_bond_params(params_list)\n        for bond_idx, params_list in all_bond_params.items()\n    }\n    angle_params = {\n        angle_idx: _mean_angle_params(params_list)\n        for angle_idx, params_list in all_angle_params.items()\n    }\n\n    return bond_params, angle_params\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm._mean_bond_params","title":"_mean_bond_params","text":"<pre><code>_mean_bond_params(\n    params_list: list[BondParams],\n) -&gt; BondParams\n</code></pre> <p>Calculate mean bond parameters from a list.</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def _mean_bond_params(params_list: list[BondParams]) -&gt; BondParams:\n    \"\"\"Calculate mean bond parameters from a list.\"\"\"\n    if not params_list:\n        raise ValueError(\"No bond parameters provided for averaging.\")\n    n = len(params_list)\n    mean_k = sum(p.force_constant for p in params_list) / n\n    mean_length = sum(p.length for p in params_list) / n\n    return BondParams(force_constant=mean_k, length=mean_length)\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm._mean_angle_params","title":"_mean_angle_params","text":"<pre><code>_mean_angle_params(\n    params_list: list[AngleParams],\n) -&gt; AngleParams\n</code></pre> <p>Calculate mean angle parameters from a list.</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def _mean_angle_params(params_list: list[AngleParams]) -&gt; AngleParams:\n    \"\"\"Calculate mean angle parameters from a list.\"\"\"\n    if not params_list:\n        raise ValueError(\"No angle parameters provided for averaging.\")\n    n = len(params_list)\n    mean_k = sum(p.force_constant for p in params_list) / n\n    mean_angle = sum(p.angle for p in params_list) / n\n    return AngleParams(force_constant=mean_k, angle=mean_angle)\n</code></pre>"},{"location":"reference/msm/#bespokefit_smee.msm.apply_msm_to_molecules","title":"apply_msm_to_molecules","text":"<pre><code>apply_msm_to_molecules(\n    mols: list[Molecule],\n    off_ff: ForceField,\n    settings: MSMSettings,\n) -&gt; ForceField\n</code></pre> <p>Apply Modified Seminario Method to molecules and update force field.</p> <p>Calculates bond and angle parameters for all molecules, averages parameters that share the same SMIRKS pattern, and updates the force field accordingly.</p> <p>Args:     mols: List of molecules to parameterize.     off_ff: OpenFF ForceField to modify.     settings: MSM settings.</p> <p>Returns:     Modified ForceField with MSM-derived parameters.</p> <p>Reference:     AEA Allen, MC Payne, DJ Cole, J. Chem. Theory Comput. (2018),     doi:10.1021/acs.jctc.7b00785</p> Source code in <code>bespokefit_smee/msm.py</code> <pre><code>def apply_msm_to_molecules(\n    mols: list[openff.toolkit.Molecule],\n    off_ff: openff.toolkit.ForceField,\n    settings: MSMSettings,\n) -&gt; openff.toolkit.ForceField:\n    \"\"\"Apply Modified Seminario Method to molecules and update force field.\n\n    Calculates bond and angle parameters for all molecules, averages parameters\n    that share the same SMIRKS pattern, and updates the force field accordingly.\n\n    Args:\n        mols: List of molecules to parameterize.\n        off_ff: OpenFF ForceField to modify.\n        settings: MSM settings.\n\n    Returns:\n        Modified ForceField with MSM-derived parameters.\n\n    Reference:\n        AEA Allen, MC Payne, DJ Cole, J. Chem. Theory Comput. (2018),\n        doi:10.1021/acs.jctc.7b00785\n    \"\"\"\n    # Make a copy of the force field to avoid modifying the original\n    off_ff = copy.deepcopy(off_ff)\n\n    # Collect parameters by SMIRKS across all molecules\n    bond_params_by_smirks: defaultdict[str, list[BondParams]] = defaultdict(list)\n    angle_params_by_smirks: defaultdict[str, list[AngleParams]] = defaultdict(list)\n\n    for mol in tqdm(mols, desc=\"Applying MSM to molecules\", leave=False):\n        # Get parameter labels for this molecule\n        labels = off_ff.label_molecules(mol.to_topology())[0]\n\n        # Build index-to-SMIRKS mappings\n        bond_indices_to_smirks = {\n            bond_indices: bond_param.smirks\n            for (bond_indices, bond_param) in labels[\"Bonds\"].items()\n        }\n        angle_indices_to_smirks = {\n            angle_indices: angle_param.smirks\n            for (angle_indices, angle_param) in labels[\"Angles\"].items()\n        }\n\n        bond_indices = list(bond_indices_to_smirks.keys())\n        angle_indices = list(angle_indices_to_smirks.keys())\n\n        # Calculate MSM parameters for this molecule\n        mol_bond_params, mol_angle_params = apply_msm_to_molecule(\n            mol, bond_indices, angle_indices, settings\n        )\n\n        # Collect parameters by SMIRKS\n        for bond_idx, bond_params in mol_bond_params.items():\n            smirks = bond_indices_to_smirks[bond_idx]\n            bond_params_by_smirks[smirks].append(bond_params)\n\n        for angle_idx, angle_params in mol_angle_params.items():\n            smirks = angle_indices_to_smirks[angle_idx]\n            angle_params_by_smirks[smirks].append(angle_params)\n\n    # Average parameters and update force field\n    bond_handler: BondHandler = off_ff.get_parameter_handler(\"Bonds\")\n    for smirks, bond_params_list in bond_params_by_smirks.items():\n        mean_bond_params = _mean_bond_params(bond_params_list)\n        bond_param = bond_handler.get_parameter({\"smirks\": smirks})[0]\n\n        # Get the original units from the force field parameter\n        original_k_units = bond_param.k.units\n        original_length_units = bond_param.length.units\n\n        # Params already have units, just convert to original force field units\n        bond_param.k = mean_bond_params.force_constant.to(original_k_units)\n        bond_param.length = mean_bond_params.length.to(original_length_units)\n\n        logger.debug(\n            f\"Updated bond {smirks}: k={bond_param.k}, length={bond_param.length}\"\n        )\n\n    angle_handler: AngleHandler = off_ff.get_parameter_handler(\"Angles\")\n    for smirks, angle_params_list in angle_params_by_smirks.items():\n        mean_angle_params = _mean_angle_params(angle_params_list)\n        angle_param = angle_handler.get_parameter({\"smirks\": smirks})[0]\n\n        # Get the original units from the force field parameter\n        original_k_units = angle_param.k.units\n        original_angle_units = angle_param.angle.units\n\n        # Params already have units, just convert to original force field units\n        angle_param.k = mean_angle_params.force_constant.to(original_k_units)\n        angle_param.angle = mean_angle_params.angle.to(original_angle_units)\n\n        logger.debug(\n            f\"Updated angle {smirks}: k={angle_param.k}, angle={angle_param.angle}\"\n        )\n\n    return off_ff\n</code></pre>"},{"location":"reference/outputs/","title":"outputs","text":""},{"location":"reference/outputs/#bespokefit_smee.outputs","title":"outputs","text":"<p>Functionality for handling the outputs of a workflow.</p> <p>Classes:</p> <ul> <li> <code>OutputType</code>           \u2013            <p>An enumeration of the different types of outputs produced by bespoke fitting functions</p> </li> <li> <code>WorkflowPathManager</code>           \u2013            <p>Manages paths for workflow outputs based on WorkflowSettings.</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>delete_path</code>             \u2013              <p>Delete an output file or directory if it exists. Deletes the entire contents of</p> </li> <li> <code>get_mol_path</code>             \u2013              <p>Get a molecule-specific path from a base path.</p> </li> </ul>"},{"location":"reference/outputs/#bespokefit_smee.outputs.OutputType","title":"OutputType","text":"<p>               Bases: <code>Enum</code></p> <p>An enumeration of the different types of outputs produced by bespoke fitting functions</p>"},{"location":"reference/outputs/#bespokefit_smee.outputs.WorkflowPathManager","title":"WorkflowPathManager  <code>dataclass</code>","text":"<pre><code>WorkflowPathManager(\n    output_dir: Path,\n    n_iterations: int = 1,\n    n_mols: int = 1,\n    training_settings: TrainingSettings | None = None,\n    training_sampling_settings: (\n        SamplingSettings | None\n    ) = None,\n    testing_sampling_settings: (\n        SamplingSettings | None\n    ) = None,\n)\n</code></pre> <p>Manages paths for workflow outputs based on WorkflowSettings.</p> <p>Methods:</p> <ul> <li> <code>get_stage_path</code>             \u2013              <p>Get the directory path for a workflow stage.</p> </li> <li> <code>mk_stage_dir</code>             \u2013              <p>Create the directory for a workflow stage.</p> </li> <li> <code>get_output_path</code>             \u2013              <p>Get the path for an output type in a stage.</p> </li> <li> <code>get_output_path_for_mol</code>             \u2013              <p>Get the path for a per-molecule output type in a stage.</p> </li> <li> <code>get_all_output_paths</code>             \u2013              <p>Get all expected output paths organized by stage.</p> </li> <li> <code>get_all_output_paths_by_output_type</code>             \u2013              <p>Get all expected output paths organized by output type.</p> </li> <li> <code>get_all_output_paths_by_output_type_by_molecule</code>             \u2013              <p>Get all expected output paths organized by output type and molecule.</p> </li> <li> <code>clean</code>             \u2013              <p>Remove all output files and empty stage directories.</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>outputs_by_stage</code>               (<code>dict[OutputStage, set[OutputType]]</code>)           \u2013            <p>Return a dictionary mapping each stage to expected output types.</p> </li> </ul>"},{"location":"reference/outputs/#bespokefit_smee.outputs.WorkflowPathManager.outputs_by_stage","title":"outputs_by_stage  <code>property</code>","text":"<pre><code>outputs_by_stage: dict[OutputStage, set[OutputType]]\n</code></pre> <p>Return a dictionary mapping each stage to expected output types.</p>"},{"location":"reference/outputs/#bespokefit_smee.outputs.WorkflowPathManager.get_stage_path","title":"get_stage_path","text":"<pre><code>get_stage_path(stage: OutputStage) -&gt; Path\n</code></pre> <p>Get the directory path for a workflow stage.</p> Source code in <code>bespokefit_smee/outputs.py</code> <pre><code>def get_stage_path(self, stage: OutputStage) -&gt; Path:\n    \"\"\"Get the directory path for a workflow stage.\"\"\"\n    if stage not in self.outputs_by_stage:\n        raise ValueError(f\"Unknown stage: {stage}\")\n    return self.output_dir / str(stage)\n</code></pre>"},{"location":"reference/outputs/#bespokefit_smee.outputs.WorkflowPathManager.mk_stage_dir","title":"mk_stage_dir","text":"<pre><code>mk_stage_dir(stage: OutputStage) -&gt; None\n</code></pre> <p>Create the directory for a workflow stage.</p> Source code in <code>bespokefit_smee/outputs.py</code> <pre><code>def mk_stage_dir(self, stage: OutputStage) -&gt; None:\n    \"\"\"Create the directory for a workflow stage.\"\"\"\n    path = self.get_stage_path(stage)\n    path.mkdir(parents=True, exist_ok=True)\n</code></pre>"},{"location":"reference/outputs/#bespokefit_smee.outputs.WorkflowPathManager.get_output_path","title":"get_output_path","text":"<pre><code>get_output_path(\n    stage: OutputStage, output_type: OutputType\n) -&gt; Path\n</code></pre> <p>Get the path for an output type in a stage.</p> <p>Note: For per-molecule output types (those in PER_MOLECULE_OUTPUT_TYPES), use get_output_path_for_mol instead.</p> Source code in <code>bespokefit_smee/outputs.py</code> <pre><code>def get_output_path(self, stage: OutputStage, output_type: OutputType) -&gt; Path:\n    \"\"\"Get the path for an output type in a stage.\n\n    Note: For per-molecule output types (those in PER_MOLECULE_OUTPUT_TYPES),\n    use get_output_path_for_mol instead.\n    \"\"\"\n    if stage not in self.outputs_by_stage:\n        raise ValueError(f\"Unknown stage: {stage}\")\n    if output_type not in self.outputs_by_stage.get(stage, set()):\n        raise ValueError(f\"Output type {output_type} not expected in stage {stage}\")\n\n    return self.get_stage_path(stage) / output_type.value\n</code></pre>"},{"location":"reference/outputs/#bespokefit_smee.outputs.WorkflowPathManager.get_output_path_for_mol","title":"get_output_path_for_mol","text":"<pre><code>get_output_path_for_mol(\n    stage: OutputStage,\n    output_type: OutputType,\n    mol_idx: int,\n) -&gt; Path\n</code></pre> <p>Get the path for a per-molecule output type in a stage.</p> <p>Parameters:</p> <ul> <li> <code>stage</code>               (<code>OutputStage</code>)           \u2013            <p>The workflow stage.</p> </li> <li> <code>output_type</code>               (<code>OutputType</code>)           \u2013            <p>The type of output (must be a per-molecule output type).</p> </li> <li> <code>mol_idx</code>               (<code>int</code>)           \u2013            <p>The molecule index.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>Path</code>           \u2013            <p>The path for the per-molecule output.</p> </li> </ul> <p>Raises:</p> <ul> <li> <code>ValueError</code>             \u2013            <p>If the output type is not a per-molecule output type, or if mol_idx is out of range.</p> </li> </ul> Source code in <code>bespokefit_smee/outputs.py</code> <pre><code>def get_output_path_for_mol(\n    self, stage: OutputStage, output_type: OutputType, mol_idx: int\n) -&gt; Path:\n    \"\"\"Get the path for a per-molecule output type in a stage.\n\n    Parameters\n    ----------\n    stage : OutputStage\n        The workflow stage.\n    output_type : OutputType\n        The type of output (must be a per-molecule output type).\n    mol_idx : int\n        The molecule index.\n\n    Returns\n    -------\n    Path\n        The path for the per-molecule output.\n\n    Raises\n    ------\n    ValueError\n        If the output type is not a per-molecule output type, or if mol_idx\n        is out of range.\n    \"\"\"\n    if output_type not in PER_MOLECULE_OUTPUT_TYPES:\n        raise ValueError(\n            f\"Output type {output_type} is not a per-molecule output type. \"\n            f\"Use get_output_path instead.\"\n        )\n    if mol_idx &lt; 0 or mol_idx &gt;= self.n_mols:\n        raise ValueError(\n            f\"mol_idx {mol_idx} is out of range for n_mols={self.n_mols}\"\n        )\n\n    base_path = self.get_output_path(stage, output_type)\n\n    # For directory-type outputs (no suffix), just append _mol{mol_idx}\n    return get_mol_path(base_path, mol_idx)\n</code></pre>"},{"location":"reference/outputs/#bespokefit_smee.outputs.WorkflowPathManager.get_all_output_paths","title":"get_all_output_paths","text":"<pre><code>get_all_output_paths(\n    only_if_exists: bool = True,\n) -&gt; dict[OutputStage, dict[OutputType, Path | list[Path]]]\n</code></pre> <p>Get all expected output paths organized by stage.</p> <p>For per-molecule output types, returns a list of paths (one per molecule). For other output types, returns a single path.</p> Source code in <code>bespokefit_smee/outputs.py</code> <pre><code>def get_all_output_paths(\n    self, only_if_exists: bool = True\n) -&gt; dict[OutputStage, dict[OutputType, Path | list[Path]]]:\n    \"\"\"Get all expected output paths organized by stage.\n\n    For per-molecule output types, returns a list of paths (one per molecule).\n    For other output types, returns a single path.\n    \"\"\"\n    all_paths: dict[OutputStage, dict[OutputType, Path | list[Path]]] = {}\n\n    for stage in self.outputs_by_stage:\n        paths_for_stage: dict[OutputType, Path | list[Path]] = {}\n        for output_type in self.outputs_by_stage.get(stage, set()):\n            if output_type in PER_MOLECULE_OUTPUT_TYPES:\n                # Collect paths for all molecules\n                mol_paths = []\n                for mol_idx in range(self.n_mols):\n                    path = self.get_output_path_for_mol(stage, output_type, mol_idx)\n                    if not only_if_exists or path.exists():\n                        mol_paths.append(path)\n                if mol_paths:\n                    paths_for_stage[output_type] = mol_paths\n            else:\n                path = self.get_output_path(stage, output_type)\n                if not only_if_exists or path.exists():\n                    paths_for_stage[output_type] = path\n\n        if paths_for_stage:\n            all_paths[stage] = paths_for_stage\n\n    return all_paths\n</code></pre>"},{"location":"reference/outputs/#bespokefit_smee.outputs.WorkflowPathManager.get_all_output_paths_by_output_type","title":"get_all_output_paths_by_output_type","text":"<pre><code>get_all_output_paths_by_output_type(\n    only_if_exists: bool = True,\n) -&gt; dict[OutputType, list[Path]]\n</code></pre> <p>Get all expected output paths organized by output type.</p> <p>Note: For per-molecule output types, paths from all molecules are flattened into a single list. Use get_all_output_paths_by_output_type_by_molecule for per-molecule organization.</p> Source code in <code>bespokefit_smee/outputs.py</code> <pre><code>def get_all_output_paths_by_output_type(\n    self, only_if_exists: bool = True\n) -&gt; dict[OutputType, list[Path]]:\n    \"\"\"Get all expected output paths organized by output type.\n\n    Note: For per-molecule output types, paths from all molecules are flattened\n    into a single list. Use get_all_output_paths_by_output_type_by_molecule\n    for per-molecule organization.\n    \"\"\"\n    all_paths = self.get_all_output_paths(only_if_exists=only_if_exists)\n    paths_by_output_type: dict[OutputType, list[Path]] = defaultdict(list)\n\n    for _, paths in all_paths.items():\n        for output_type, path_or_paths in paths.items():\n            if isinstance(path_or_paths, list):\n                paths_by_output_type[output_type].extend(path_or_paths)\n            else:\n                paths_by_output_type[output_type].append(path_or_paths)\n\n    return paths_by_output_type\n</code></pre>"},{"location":"reference/outputs/#bespokefit_smee.outputs.WorkflowPathManager.get_all_output_paths_by_output_type_by_molecule","title":"get_all_output_paths_by_output_type_by_molecule","text":"<pre><code>get_all_output_paths_by_output_type_by_molecule(\n    only_if_exists: bool = True,\n) -&gt; dict[OutputType, dict[int, list[Path]] | list[Path]]\n</code></pre> <p>Get all expected output paths organized by output type and molecule.</p> <p>For per-molecule output types, returns a dict mapping mol_idx to list of paths. For non-per-molecule output types, returns a flat list of paths.</p> <p>Parameters:</p> <ul> <li> <code>only_if_exists</code>               (<code>bool</code>, default:                   <code>True</code> )           \u2013            <p>If True, only return paths that exist on disk, by default True.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>dict[OutputType, dict[int, list[Path]] | list[Path]]</code>           \u2013            <p>A dictionary mapping output types to either: - For per-molecule types: dict mapping mol_idx -&gt; list of paths (one per stage) - For other types: list of paths (one per stage)</p> </li> </ul> Source code in <code>bespokefit_smee/outputs.py</code> <pre><code>def get_all_output_paths_by_output_type_by_molecule(\n    self, only_if_exists: bool = True\n) -&gt; dict[OutputType, dict[int, list[Path]] | list[Path]]:\n    \"\"\"Get all expected output paths organized by output type and molecule.\n\n    For per-molecule output types, returns a dict mapping mol_idx to list of paths.\n    For non-per-molecule output types, returns a flat list of paths.\n\n    Parameters\n    ----------\n    only_if_exists : bool, optional\n        If True, only return paths that exist on disk, by default True.\n\n    Returns\n    -------\n    dict[OutputType, dict[int, list[Path]] | list[Path]]\n        A dictionary mapping output types to either:\n        - For per-molecule types: dict mapping mol_idx -&gt; list of paths (one per stage)\n        - For other types: list of paths (one per stage)\n    \"\"\"\n    all_paths = self.get_all_output_paths(only_if_exists=only_if_exists)\n    result: dict[OutputType, dict[int, list[Path]] | list[Path]] = {}\n\n    for _stage, paths in all_paths.items():\n        for output_type, path_or_paths in paths.items():\n            if output_type in PER_MOLECULE_OUTPUT_TYPES:\n                # Per-molecule type: organize by molecule index\n                if output_type not in result:\n                    result[output_type] = {}\n                mol_dict = result[output_type]\n                assert isinstance(mol_dict, dict)\n\n                # path_or_paths is a list of paths for each molecule\n                if isinstance(path_or_paths, list):\n                    for path in path_or_paths:\n                        # Extract mol_idx from path\n                        mol_idx = self._extract_mol_idx_from_path(path)\n                        if mol_idx not in mol_dict:\n                            mol_dict[mol_idx] = []\n                        mol_dict[mol_idx].append(path)\n            else:\n                # Non-per-molecule type: flat list\n                if output_type not in result:\n                    result[output_type] = []\n                path_list = result[output_type]\n                assert isinstance(path_list, list)\n                if isinstance(path_or_paths, list):\n                    path_list.extend(path_or_paths)\n                else:\n                    path_list.append(path_or_paths)\n\n    return result\n</code></pre>"},{"location":"reference/outputs/#bespokefit_smee.outputs.WorkflowPathManager._extract_mol_idx_from_path","title":"_extract_mol_idx_from_path","text":"<pre><code>_extract_mol_idx_from_path(path: Path) -&gt; int\n</code></pre> <p>Extract molecule index from a per-molecule path.</p> <p>Parameters:</p> <ul> <li> <code>path</code>               (<code>Path</code>)           \u2013            <p>A path with the _mol{idx} naming convention.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>int</code>           \u2013            <p>The molecule index.</p> </li> </ul> Source code in <code>bespokefit_smee/outputs.py</code> <pre><code>def _extract_mol_idx_from_path(self, path: Path) -&gt; int:\n    \"\"\"Extract molecule index from a per-molecule path.\n\n    Parameters\n    ----------\n    path : Path\n        A path with the _mol{idx} naming convention.\n\n    Returns\n    -------\n    int\n        The molecule index.\n    \"\"\"\n    stem = path.stem if path.suffix else path.name\n    if \"_mol\" in stem:\n        mol_idx_str = stem.split(\"_mol\")[-1]\n        return int(mol_idx_str)\n    return 0  # Default for backward compatibility\n</code></pre>"},{"location":"reference/outputs/#bespokefit_smee.outputs.WorkflowPathManager.clean","title":"clean","text":"<pre><code>clean() -&gt; None\n</code></pre> <p>Remove all output files and empty stage directories.</p> Source code in <code>bespokefit_smee/outputs.py</code> <pre><code>def clean(self) -&gt; None:\n    \"\"\"Remove all output files and empty stage directories.\"\"\"\n\n    # Delete all output files\n    all_paths = self.get_all_output_paths(only_if_exists=True)\n\n    for paths in all_paths.values():\n        for output_type, path_or_paths in paths.items():\n            if output_type == OutputType.WORKFLOW_SETTINGS:\n                continue  # Don't delete workflow settings\n            if isinstance(path_or_paths, list):\n                for path in path_or_paths:\n                    delete_path(path, recursive=True)\n            else:\n                delete_path(path_or_paths, recursive=True)\n\n    # Remove empty stage directories\n    for stage in self.outputs_by_stage.keys():\n        if stage.kind == StageKind.BASE:\n            continue\n        delete_path(self.get_stage_path(stage), recursive=False)\n</code></pre>"},{"location":"reference/outputs/#bespokefit_smee.outputs.delete_path","title":"delete_path","text":"<pre><code>delete_path(path: Path, recursive: bool = False) -&gt; None\n</code></pre> <p>Delete an output file or directory if it exists. Deletes the entire contents of a directory.</p> <p>Parameters:</p> <ul> <li> <code>path</code>               (<code>Path</code>)           \u2013            <p>The path to delete.</p> </li> <li> <code>recursive</code>               (<code>bool</code>, default:                   <code>False</code> )           \u2013            <p>Whether to delete directories recursively, by default False. If False, only empty directories will be deleted.</p> </li> </ul> Source code in <code>bespokefit_smee/outputs.py</code> <pre><code>def delete_path(path: Path, recursive: bool = False) -&gt; None:\n    \"\"\"Delete an output file or directory if it exists. Deletes the entire contents of\n    a directory.\n\n    Parameters\n    ----------\n    path : Path\n        The path to delete.\n\n    recursive : bool, optional\n        Whether to delete directories recursively, by default False. If False, only\n        empty directories will be deleted.\n    \"\"\"\n    if not path.exists():\n        return\n\n    if path.is_dir():\n        if recursive:\n            for child in path.iterdir():\n                delete_path(child, recursive=True)\n        path.rmdir()  # Will only remove if empty\n    else:\n        path.unlink()\n</code></pre>"},{"location":"reference/outputs/#bespokefit_smee.outputs.get_mol_path","title":"get_mol_path","text":"<pre><code>get_mol_path(base_path: Path, mol_idx: int) -&gt; Path\n</code></pre> <p>Get a molecule-specific path from a base path.</p> <p>This function applies the standard naming convention for per-molecule outputs, where the molecule index is appended to the filename/directory name.</p> <p>Parameters:</p> <ul> <li> <code>base_path</code>               (<code>Path</code>)           \u2013            <p>The base path (e.g., from get_output_path or output_paths dict).</p> </li> <li> <code>mol_idx</code>               (<code>int</code>)           \u2013            <p>The molecule index.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>Path</code>           \u2013            <p>The path with the molecule index appended.</p> </li> </ul> <p>Examples:</p> <pre><code>&gt;&gt;&gt; get_mol_path(Path(\"output/scatter.hdf5\"), 0)\nPosixPath('output/scatter_mol0.hdf5')\n&gt;&gt;&gt; get_mol_path(Path(\"output/energy_data\"), 1)\nPosixPath('output/energy_data_mol1')\n</code></pre> Source code in <code>bespokefit_smee/outputs.py</code> <pre><code>def get_mol_path(base_path: Path, mol_idx: int) -&gt; Path:\n    \"\"\"Get a molecule-specific path from a base path.\n\n    This function applies the standard naming convention for per-molecule outputs,\n    where the molecule index is appended to the filename/directory name.\n\n    Parameters\n    ----------\n    base_path : Path\n        The base path (e.g., from get_output_path or output_paths dict).\n    mol_idx : int\n        The molecule index.\n\n    Returns\n    -------\n    Path\n        The path with the molecule index appended.\n\n    Examples\n    --------\n    &gt;&gt;&gt; get_mol_path(Path(\"output/scatter.hdf5\"), 0)\n    PosixPath('output/scatter_mol0.hdf5')\n    &gt;&gt;&gt; get_mol_path(Path(\"output/energy_data\"), 1)\n    PosixPath('output/energy_data_mol1')\n    \"\"\"\n    if not base_path.suffix:\n        # Directory-type output\n        return base_path.parent / f\"{base_path.name}_mol{mol_idx}\"\n    else:\n        # File-type output\n        return base_path.parent / f\"{base_path.stem}_mol{mol_idx}{base_path.suffix}\"\n</code></pre>"},{"location":"reference/sample/","title":"sample","text":""},{"location":"reference/sample/#bespokefit_smee.sample","title":"sample","text":"<p>Functionality to obtain samples to fit the force field to.</p> <p>Classes:</p> <ul> <li> <code>SampleFnArgs</code>           \u2013            <p>Arguments for sampling functions.</p> </li> <li> <code>SampleFn</code>           \u2013            <p>A protocol for sampling functions.</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>recalculate_energies_and_forces</code>             \u2013              <p>Recalculate energies and forces for a dataset using a given OpenMM simulation.</p> </li> <li> <code>sample_mmmd</code>             \u2013              <p>Generate datasets of samples from MD with the given MM force field for multiple molecules.</p> </li> <li> <code>sample_mlmd</code>             \u2013              <p>Generate datasets of samples from MD with an ML potential for multiple molecules.</p> </li> <li> <code>sample_mmmd_metadynamics</code>             \u2013              <p>Generate datasets using metadynamics for multiple molecules.</p> </li> <li> <code>generate_torsion_minimised_dataset</code>             \u2013              <p>Generate a dataset of torsion-restrained minimised structures.</p> </li> <li> <code>sample_mmmd_metadynamics_with_torsion_minimisation</code>             \u2013              <p>Generate datasets using metadynamics with additional torsion-minimised structures.</p> </li> <li> <code>load_precomputed_dataset</code>             \u2013              <p>Load pre-computed dataset(s) from disk.</p> </li> </ul>"},{"location":"reference/sample/#bespokefit_smee.sample._SAMPLING_FNS_REGISTRY","title":"_SAMPLING_FNS_REGISTRY  <code>module-attribute</code>","text":"<pre><code>_SAMPLING_FNS_REGISTRY: dict[\n    type[SamplingSettings], SampleFn\n] = {}\n</code></pre> <p>Registry of sampling functions for different sampling settings types.</p>"},{"location":"reference/sample/#bespokefit_smee.sample.SampleFnArgs","title":"SampleFnArgs","text":"<p>               Bases: <code>TypedDict</code></p> <p>Arguments for sampling functions.</p>"},{"location":"reference/sample/#bespokefit_smee.sample.SampleFn","title":"SampleFn","text":"<p>               Bases: <code>Protocol</code></p> <p>A protocol for sampling functions.</p>"},{"location":"reference/sample/#bespokefit_smee.sample._copy_mol_and_add_conformers","title":"_copy_mol_and_add_conformers","text":"<pre><code>_copy_mol_and_add_conformers(\n    mol: Molecule, n_conformers: int\n) -&gt; Molecule\n</code></pre> <p>Copy a molecule and add conformers to it.</p> Source code in <code>bespokefit_smee/sample.py</code> <pre><code>def _copy_mol_and_add_conformers(\n    mol: openff.toolkit.Molecule,\n    n_conformers: int,\n) -&gt; openff.toolkit.Molecule:\n    \"\"\"Copy a molecule and add conformers to it.\"\"\"\n    mol = copy.deepcopy(mol)\n    mol.generate_conformers(n_conformers=n_conformers, rms_cutoff=0.0 * _ANGSTROM)\n    n_gen_conformers = len(mol.conformers)\n    if n_gen_conformers &lt; n_conformers:\n        logger.warning(\n            f\"Only {n_gen_conformers} conformers were generated, which is less than the requested {n_conformers}.\"\n            f\" As a result, {n_gen_conformers / n_conformers * 100:.1f}% of the requested samples will be generated.\"\n        )\n    return mol\n</code></pre>"},{"location":"reference/sample/#bespokefit_smee.sample._run_md","title":"_run_md","text":"<pre><code>_run_md(\n    mol: Molecule,\n    simulation: Simulation,\n    step_fn: Callable[[int], None],\n    equilibration_n_steps_per_conformer: int,\n    production_n_snapshots_per_conformer: int,\n    production_n_steps_per_snapshot_per_conformer: int,\n    pdb_reporter_path: str | None = None,\n) -&gt; Dataset\n</code></pre> <p>Run MD on a molecule and return a dataset of the coordinates, energies, and forces of the snapshots.</p> <p>Parameters:</p> <ul> <li> <code>mol</code>               (<code>Molecule</code>)           \u2013            <p>The molecule to run MD on. Should have conformers already generated.</p> </li> <li> <code>simulation</code>               (<code>Simulation</code>)           \u2013            <p>The OpenMM simulation to use for MD.</p> </li> <li> <code>step_fn</code>               (<code>Callable[[int], None]</code>)           \u2013            <p>A function that takes the number of steps to run and runs them in the simulation. This is to allow for different types of MD (e.g. with or without metadynamics).</p> </li> <li> <code>equilibration_n_steps_per_conformer</code>               (<code>int</code>)           \u2013            <p>The number of equilibration steps to run per conformer.</p> </li> <li> <code>production_n_snapshots_per_conformer</code>               (<code>int</code>)           \u2013            <p>The number of production snapshots to take per conformer.</p> </li> <li> <code>production_n_steps_per_snapshot_per_conformer</code>               (<code>int</code>)           \u2013            <p>The number of production steps to run between each snapshot per conformer.</p> </li> <li> <code>pdb_reporter_path</code>               (<code>str | None</code>, default:                   <code>None</code> )           \u2013            <p>The path to write a PDB trajectory of the MD simulation to. The frames saved correspond to the production snapshots. If None, no trajectory is saved.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>Dataset</code>           \u2013            <p>The dataset of snapshots with coordinates, energies, and forces.</p> </li> </ul> Source code in <code>bespokefit_smee/sample.py</code> <pre><code>def _run_md(\n    mol: openff.toolkit.Molecule,\n    simulation: Simulation,\n    step_fn: Callable[[int], None],\n    equilibration_n_steps_per_conformer: int,\n    production_n_snapshots_per_conformer: int,\n    production_n_steps_per_snapshot_per_conformer: int,\n    pdb_reporter_path: str | None = None,\n) -&gt; datasets.Dataset:\n    \"\"\"Run MD on a molecule and return a dataset of the coordinates,\n    energies, and forces of the snapshots.\n\n    Parameters\n    ----------\n    mol : openff.toolkit.Molecule\n        The molecule to run MD on. Should have conformers already generated.\n\n    simulation : openmm.app.Simulation\n        The OpenMM simulation to use for MD.\n\n    step_fn : Callable[[int], None]\n        A function that takes the number of steps to run and runs them\n        in the simulation. This is to allow for different types of MD\n        (e.g. with or without metadynamics).\n\n    equilibration_n_steps_per_conformer : int\n        The number of equilibration steps to run per conformer.\n\n    production_n_snapshots_per_conformer : int\n        The number of production snapshots to take per conformer.\n\n    production_n_steps_per_snapshot_per_conformer : int\n        The number of production steps to run between each snapshot\n        per conformer.\n\n    pdb_reporter_path : str | None, optional\n        The path to write a PDB trajectory of the MD\n        simulation to. The frames saved correspond\n        to the production snapshots. If None, no trajectory is saved.\n\n    Returns\n    -------\n    datasets.Dataset\n        The dataset of snapshots with coordinates, energies, and forces.\n    \"\"\"\n\n    coords, energy, forces = [], [], []\n    if pdb_reporter_path is not None:\n        reporter = PDBReporter(\n            pdb_reporter_path, production_n_steps_per_snapshot_per_conformer\n        )\n\n    for conf_idx, initial_positions in tqdm(\n        enumerate(mol.conformers),\n        leave=False,\n        colour=\"green\",\n        desc=\"Generating Snapshots\",\n        total=len(mol.conformers),\n    ):\n        simulation.context.setPositions(initial_positions.to_openmm())\n\n        # Equilibration\n        simulation.minimizeEnergy(maxIterations=100)\n        step_fn(equilibration_n_steps_per_conformer)\n\n        # Production\n        if pdb_reporter_path is not None:\n            simulation.reporters.append(reporter)\n\n        for _ in tqdm(\n            range(production_n_snapshots_per_conformer),\n            leave=False,\n            colour=\"red\",\n            desc=f\"Running MD for conformer {conf_idx + 1}\",\n        ):\n            step_fn(production_n_steps_per_snapshot_per_conformer)\n            state = simulation.context.getState(\n                getEnergy=True, getForces=True, getPositions=True\n            )\n            coords.append(state.getPositions().value_in_unit(_OMM_ANGS))\n            energy.append(state.getPotentialEnergy().value_in_unit(_OMM_KCAL_PER_MOL))\n            forces.append(\n                state.getForces(asNumpy=True).value_in_unit(_OMM_KCAL_PER_MOL_ANGS)\n            )\n\n        # Remove the reporter to avoid the next round of equilibration sampling\n        if pdb_reporter_path is not None:\n            simulation.reporters.remove(reporter)\n\n    # Return a Dataset with energies relative to the first snapshot\n    smiles = mol.to_smiles(isomeric=True, explicit_hydrogens=True, mapped=True)\n    coords_out = torch.tensor(np.array(coords))\n    energy_0 = energy[0]\n    energy_out = torch.tensor(np.array([x - energy_0 for x in energy]))\n    forces_out = torch.tensor(np.array(forces))\n\n    return descent.targets.energy.create_dataset(\n        [\n            {\n                \"smiles\": smiles,\n                \"coords\": coords_out,\n                \"energy\": energy_out,\n                \"forces\": forces_out,\n            }\n        ]\n    )\n</code></pre>"},{"location":"reference/sample/#bespokefit_smee.sample._get_ml_omm_system","title":"_get_ml_omm_system","text":"<pre><code>_get_ml_omm_system(\n    mol: Molecule, mlp_name: AvailableModels\n) -&gt; System\n</code></pre> <p>Get an OpenMM system for a molecule using a machine learning potential.</p> <p>Parameters:</p> <ul> <li> <code>mol</code>               (<code>Molecule</code>)           \u2013            <p>The molecule for which to create the system.</p> </li> <li> <code>mlp_name</code>               (<code>AvailableModels</code>)           \u2013            <p>The name of the ML potential to use.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>System</code>           \u2013            <p>The OpenMM system for the molecule.</p> </li> </ul> <p>Raises:</p> <ul> <li> <code>InvalidSettingsError</code>             \u2013            <p>If the molecule is charged and the ML potential does not support charges.</p> </li> </ul> Source code in <code>bespokefit_smee/sample.py</code> <pre><code>def _get_ml_omm_system(\n    mol: openff.toolkit.Molecule, mlp_name: mlp.AvailableModels\n) -&gt; openmm.System:\n    \"\"\"Get an OpenMM system for a molecule using a machine learning potential.\n\n    Parameters\n    ----------\n    mol : openff.toolkit.Molecule\n        The molecule for which to create the system.\n    mlp_name : mlp.AvailableModels\n        The name of the ML potential to use.\n\n    Returns\n    -------\n    openmm.System\n        The OpenMM system for the molecule.\n\n    Raises\n    ------\n    InvalidSettingsError\n        If the molecule is charged and the ML potential does not support charges.\n    \"\"\"\n    # Validate that charged molecules are only used with compatible models\n    mlp.validate_model_charge_compatibility(mlp_name, mol)\n\n    potential = mlp.get_mlp(mlp_name)\n    charge = mol.total_charge.m_as(off_unit.e)\n\n    # Always pass charge argument for consistency, even for neutral molecules\n    system = potential.createSystem(\n        mol.to_topology().to_openmm(),\n        charge=charge,\n    )\n\n    return system\n</code></pre>"},{"location":"reference/sample/#bespokefit_smee.sample.recalculate_energies_and_forces","title":"recalculate_energies_and_forces","text":"<pre><code>recalculate_energies_and_forces(\n    dataset: Dataset, simulation: Simulation\n) -&gt; Dataset\n</code></pre> <p>Recalculate energies and forces for a dataset using a given OpenMM simulation.</p> Source code in <code>bespokefit_smee/sample.py</code> <pre><code>def recalculate_energies_and_forces(\n    dataset: datasets.Dataset, simulation: Simulation\n) -&gt; datasets.Dataset:\n    \"\"\"Recalculate energies and forces for a dataset using a given OpenMM simulation.\"\"\"\n\n    recalc_energies = []\n    recalc_forces = []\n\n    assert len(dataset) == 1, \"Dataset should contain exactly one entry.\"\n\n    entry = dataset[0]\n    n_conf = len(entry[\"energy\"])\n    coords = entry[\"coords\"].reshape(n_conf, -1, 3)\n\n    for i in tqdm(\n        range(n_conf),\n        leave=False,\n        colour=\"blue\",\n        desc=\"Recalculating energies and forces\",\n    ):\n        my_pos = Quantity(numpy.array(coords[i]), angstrom)\n        simulation.context.setPositions(my_pos)\n        state = simulation.context.getState(getEnergy=True, getForces=True)\n        recalc_energies.append(\n            state.getPotentialEnergy().value_in_unit(_OMM_KCAL_PER_MOL)\n        )\n        recalc_forces.append(\n            state.getForces(asNumpy=True).value_in_unit(_OMM_KCAL_PER_MOL_ANGS)\n        )\n\n    return descent.targets.energy.create_dataset(\n        [\n            {\n                \"smiles\": entry[\"smiles\"],\n                \"coords\": entry[\"coords\"],\n                \"energy\": torch.tensor(np.array(recalc_energies)),\n                \"forces\": torch.tensor(np.array(recalc_forces)),\n            }\n        ]\n    )\n</code></pre>"},{"location":"reference/sample/#bespokefit_smee.sample.sample_mmmd","title":"sample_mmmd","text":"<pre><code>sample_mmmd(\n    mols: list[Molecule],\n    off_ff: ForceField,\n    device: device,\n    settings: MMMDSamplingSettings,\n    output_paths: dict[OutputType, Path],\n) -&gt; list[Dataset]\n</code></pre> <p>Generate datasets of samples from MD with the given MM force field for multiple molecules.</p> <p>Parameters:</p> <ul> <li> <code>mols</code>               (<code>list[Molecule]</code>)           \u2013            <p>The molecules to sample.</p> </li> <li> <code>off_ff</code>               (<code>ForceField</code>)           \u2013            <p>The MM force field to use for sampling.</p> </li> <li> <code>device</code>               (<code>device</code>)           \u2013            <p>The device to use for any MD or ML calculations.</p> </li> <li> <code>settings</code>               (<code>_SamplingSettings</code>)           \u2013            <p>The sampling settings to use.</p> </li> <li> <code>output_paths</code>               (<code>dict[OutputType, Path]</code>)           \u2013            <p>A mapping of output types to filesystem paths.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>list[Dataset]</code>           \u2013            <p>The generated datasets of samples with energies and forces, one per molecule.</p> </li> </ul> Source code in <code>bespokefit_smee/sample.py</code> <pre><code>@_register_sampling_fn(settings.MMMDSamplingSettings)\ndef sample_mmmd(\n    mols: list[openff.toolkit.Molecule],\n    off_ff: openff.toolkit.ForceField,\n    device: torch.device,\n    settings: settings.MMMDSamplingSettings,\n    output_paths: dict[OutputType, pathlib.Path],\n) -&gt; list[datasets.Dataset]:\n    \"\"\"Generate datasets of samples from MD with the given MM force field for multiple molecules.\n\n    Parameters\n    ----------\n    mols : list[openff.toolkit.Molecule]\n        The molecules to sample.\n    off_ff : openff.toolkit.ForceField\n        The MM force field to use for sampling.\n    device : torch.device\n        The device to use for any MD or ML calculations.\n    settings : _SamplingSettings\n        The sampling settings to use.\n    output_paths: dict[OutputType, PathLike]\n        A mapping of output types to filesystem paths.\n\n    Returns\n    -------\n    list[datasets.Dataset]\n        The generated datasets of samples with energies and forces, one per molecule.\n    \"\"\"\n    if set(output_paths.keys()) != settings.output_types:\n        raise ValueError(\n            f\"Output paths must contain exactly the keys {settings.output_types}\"\n        )\n\n    all_datasets = []\n\n    for mol_idx, mol in enumerate(mols):\n        mol_with_conformers = _copy_mol_and_add_conformers(mol, settings.n_conformers)\n        interchange = openff.interchange.Interchange.from_smirnoff(\n            off_ff, openff.toolkit.Topology.from_molecules(mol_with_conformers)\n        )\n\n        system = interchange.to_openmm_system()\n        integrator = _get_integrator(settings.temperature, settings.timestep)\n        simulation = Simulation(interchange.topology.to_openmm(), system, integrator)\n\n        # Create molecule-specific PDB path\n        pdb_path = None\n        if OutputType.PDB_TRAJECTORY in output_paths:\n            base_path = output_paths[OutputType.PDB_TRAJECTORY]\n            pdb_path = str(get_mol_path(base_path, mol_idx))\n\n        mm_dataset = _run_md(\n            mol_with_conformers,\n            simulation,\n            simulation.step,\n            settings.equilibration_n_steps_per_conformer,\n            settings.production_n_snapshots_per_conformer,\n            settings.production_n_steps_per_snapshot_per_conformer,\n            pdb_path,\n        )\n\n        # Clean up MM simulation to free GPU memory\n        cleanup_simulation(simulation, integrator)\n\n        # Recalculate energies and forces using the ML potential\n        ml_system = _get_ml_omm_system(mol_with_conformers, settings.ml_potential)\n        ml_integrator = _get_integrator(settings.temperature, settings.timestep)\n        ml_simulation = Simulation(\n            interchange.topology,\n            ml_system,\n            ml_integrator,\n        )\n        ml_dataset = recalculate_energies_and_forces(mm_dataset, ml_simulation)\n\n        # Clean up ML simulation to free GPU memory\n        cleanup_simulation(ml_simulation, ml_integrator)\n\n        # Convert to weighted dataset\n        entry = ml_dataset[0]\n        n_confs = len(entry[\"energy\"])\n        weighted_dataset = create_dataset_with_uniform_weights(\n            smiles=entry[\"smiles\"],\n            coords=entry[\"coords\"].reshape(n_confs, -1, 3),\n            energy=entry[\"energy\"],\n            forces=entry[\"forces\"].reshape(n_confs, -1, 3),\n            energy_weight=settings.loss_energy_weight,\n            forces_weight=settings.loss_force_weight,\n        )\n\n        all_datasets.append(weighted_dataset)\n\n    return all_datasets\n</code></pre>"},{"location":"reference/sample/#bespokefit_smee.sample.sample_mlmd","title":"sample_mlmd","text":"<pre><code>sample_mlmd(\n    mols: list[Molecule],\n    off_ff: ForceField,\n    device: device,\n    settings: MLMDSamplingSettings,\n    output_paths: dict[OutputType, Path],\n) -&gt; list[Dataset]\n</code></pre> <p>Generate datasets of samples from MD with an ML potential for multiple molecules.</p> <p>Parameters:</p> <ul> <li> <code>mols</code>               (<code>list[Molecule]</code>)           \u2013            <p>The molecules to sample.</p> </li> <li> <code>off_ff</code>               (<code>ForceField</code>)           \u2013            <p>The MM force field (kept for consistency).</p> </li> <li> <code>device</code>               (<code>device</code>)           \u2013            <p>The device to use for any MD or ML calculations.</p> </li> <li> <code>settings</code>               (<code>_SamplingSettings</code>)           \u2013            <p>The sampling settings to use.</p> </li> <li> <code>output_paths</code>               (<code>dict[OutputType, Path]</code>)           \u2013            <p>A mapping of output types to filesystem paths.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>list[Dataset]</code>           \u2013            <p>The generated datasets of samples with energies and forces, one per molecule.</p> </li> </ul> Source code in <code>bespokefit_smee/sample.py</code> <pre><code>@_register_sampling_fn(settings.MLMDSamplingSettings)\ndef sample_mlmd(\n    mols: list[openff.toolkit.Molecule],\n    off_ff: openff.toolkit.ForceField,\n    device: torch.device,\n    settings: settings.MLMDSamplingSettings,\n    output_paths: dict[OutputType, pathlib.Path],\n) -&gt; list[datasets.Dataset]:\n    \"\"\"Generate datasets of samples from MD with an ML potential for multiple molecules.\n\n    Parameters\n    ----------\n    mols : list[openff.toolkit.Molecule]\n        The molecules to sample.\n    off_ff : openff.toolkit.ForceField\n        The MM force field (kept for consistency).\n    device : torch.device\n        The device to use for any MD or ML calculations.\n    settings : _SamplingSettings\n        The sampling settings to use.\n    output_paths: dict[OutputType, PathLike]\n        A mapping of output types to filesystem paths.\n\n    Returns\n    -------\n    list[datasets.Dataset]\n        The generated datasets of samples with energies and forces, one per molecule.\n    \"\"\"\n    if set(output_paths.keys()) != settings.output_types:\n        raise ValueError(\n            f\"Output paths must contain exactly the keys {settings.output_types}\"\n        )\n\n    all_datasets = []\n\n    for mol_idx, mol in enumerate(mols):\n        mol_with_conformers = _copy_mol_and_add_conformers(mol, settings.n_conformers)\n        ml_system = _get_ml_omm_system(mol_with_conformers, settings.ml_potential)\n        integrator = _get_integrator(settings.temperature, settings.timestep)\n        ml_simulation = Simulation(\n            mol_with_conformers.to_topology().to_openmm(), ml_system, integrator\n        )\n\n        # Create molecule-specific PDB path\n        pdb_path = None\n        if OutputType.PDB_TRAJECTORY in output_paths:\n            base_path = output_paths[OutputType.PDB_TRAJECTORY]\n            pdb_path = str(get_mol_path(base_path, mol_idx))\n\n        ml_dataset = _run_md(\n            mol_with_conformers,\n            ml_simulation,\n            ml_simulation.step,\n            settings.equilibration_n_steps_per_conformer,\n            settings.production_n_snapshots_per_conformer,\n            settings.production_n_steps_per_snapshot_per_conformer,\n            pdb_path,\n        )\n\n        # Clean up ML simulation to free GPU memory\n        cleanup_simulation(ml_simulation, integrator)\n\n        # Convert to weighted dataset\n        entry = ml_dataset[0]\n        n_confs = len(entry[\"energy\"])\n        weighted_dataset = create_dataset_with_uniform_weights(\n            smiles=entry[\"smiles\"],\n            coords=entry[\"coords\"].reshape(n_confs, -1, 3),\n            energy=entry[\"energy\"],\n            forces=entry[\"forces\"].reshape(n_confs, -1, 3),\n            energy_weight=settings.loss_energy_weight,\n            forces_weight=settings.loss_force_weight,\n        )\n\n        all_datasets.append(weighted_dataset)\n\n    return all_datasets\n</code></pre>"},{"location":"reference/sample/#bespokefit_smee.sample._get_torsion_bias_forces","title":"_get_torsion_bias_forces","text":"<pre><code>_get_torsion_bias_forces(\n    mol: Molecule,\n    torsions_to_include: list[\n        str\n    ] = _TORSIONS_TO_INCLUDE_SMARTS,\n    torsions_to_exclude: list[\n        str\n    ] = _TORSIONS_TO_EXCLUDE_SMARTS,\n    bias_width: float = pi / 10,\n) -&gt; list[BiasVariable]\n</code></pre> <p>Find important torsions in a molecule and return a list of BiasVariable objects - one for each torsion.</p> <p>Args:     mol: OpenFF Molecule.     torsions_to_include: List of SMARTS patterns to include.     torsions_to_exclude: List of SMARTS patterns to exclude.     bias_width: Width of the bias to apply to each torsion.</p> <p>Returns:     List of BiasVariable objects for each torsion.</p> Source code in <code>bespokefit_smee/sample.py</code> <pre><code>def _get_torsion_bias_forces(\n    mol: openff.toolkit.Molecule,\n    torsions_to_include: list[str] = _TORSIONS_TO_INCLUDE_SMARTS,\n    torsions_to_exclude: list[str] = _TORSIONS_TO_EXCLUDE_SMARTS,\n    bias_width: float = np.pi / 10,\n) -&gt; list[openmm.app.metadynamics.BiasVariable]:\n    \"\"\"\n    Find important torsions in a molecule and return a list of BiasVariable objects -\n    one for each torsion.\n\n    Args:\n        mol: OpenFF Molecule.\n        torsions_to_include: List of SMARTS patterns to include.\n        torsions_to_exclude: List of SMARTS patterns to exclude.\n        bias_width: Width of the bias to apply to each torsion.\n\n    Returns:\n        List of BiasVariable objects for each torsion.\n    \"\"\"\n    torsions = get_rot_torsions_by_rot_bond(\n        mol,\n        include_smarts=torsions_to_include,\n        exclude_smarts=torsions_to_exclude,\n    )\n\n    bias_variables = []\n\n    for torsion in torsions.values():\n        # Creat a custom torsion force for each torsion\\\n        torsion_force = openmm.CustomTorsionForce(\"theta\")\n        torsion_force.addTorsion(*torsion, [])\n\n        # Create a BiasVariable for this torsion\n        bias_variable = openmm.app.metadynamics.BiasVariable(\n            force=torsion_force,\n            biasWidth=bias_width,\n            minValue=-numpy.pi,  # Torsions are periodic, so -pi to pi\n            maxValue=numpy.pi,\n            periodic=True,\n        )\n\n        bias_variables.append(bias_variable)\n\n    return bias_variables\n</code></pre>"},{"location":"reference/sample/#bespokefit_smee.sample.sample_mmmd_metadynamics","title":"sample_mmmd_metadynamics","text":"<pre><code>sample_mmmd_metadynamics(\n    mols: list[Molecule],\n    off_ff: ForceField,\n    device: device,\n    settings: MMMDMetadynamicsSamplingSettings,\n    output_paths: dict[OutputType, Path],\n) -&gt; list[Dataset]\n</code></pre> <p>Generate datasets using metadynamics for multiple molecules.</p> <p>Parameters:</p> <ul> <li> <code>mols</code>               (<code>list[Molecule]</code>)           \u2013            <p>The molecules to sample.</p> </li> <li> <code>off_ff</code>               (<code>ForceField</code>)           \u2013            <p>The MM force field to use.</p> </li> <li> <code>device</code>               (<code>device</code>)           \u2013            <p>The device to use for any MD or ML calculations.</p> </li> <li> <code>settings</code>               (<code>MMMDMetadynamicsSamplingSettings</code>)           \u2013            <p>The sampling settings to use.</p> </li> <li> <code>output_paths</code>               (<code>dict[OutputType, Path]</code>)           \u2013            <p>A mapping of output types to filesystem paths.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>list[Dataset]</code>           \u2013            <p>The generated datasets of samples with energies and forces, one per molecule.</p> </li> </ul> Source code in <code>bespokefit_smee/sample.py</code> <pre><code>@_register_sampling_fn(settings.MMMDMetadynamicsSamplingSettings)\ndef sample_mmmd_metadynamics(\n    mols: list[openff.toolkit.Molecule],\n    off_ff: openff.toolkit.ForceField,\n    device: torch.device,\n    settings: settings.MMMDMetadynamicsSamplingSettings,\n    output_paths: dict[OutputType, pathlib.Path],\n) -&gt; list[datasets.Dataset]:\n    \"\"\"Generate datasets using metadynamics for multiple molecules.\n\n    Parameters\n    ----------\n    mols : list[openff.toolkit.Molecule]\n        The molecules to sample.\n    off_ff : openff.toolkit.ForceField\n        The MM force field to use.\n    device : torch.device\n        The device to use for any MD or ML calculations.\n    settings : MMMDMetadynamicsSamplingSettings\n        The sampling settings to use.\n    output_paths: dict[OutputType, PathLike]\n        A mapping of output types to filesystem paths.\n\n    Returns\n    -------\n    list[datasets.Dataset]\n        The generated datasets of samples with energies and forces, one per molecule.\n    \"\"\"\n    if set(output_paths.keys()) != settings.output_types:\n        raise ValueError(\n            f\"Output paths must contain exactly the keys {settings.output_types}\"\n        )\n\n    all_datasets = []\n\n    for mol_idx, mol in enumerate(mols):\n        mol_with_conformers = _copy_mol_and_add_conformers(mol, settings.n_conformers)\n        interchange = openff.interchange.Interchange.from_smirnoff(\n            off_ff, openff.toolkit.Topology.from_molecules(mol_with_conformers)\n        )\n\n        torsions = get_rot_torsions_by_rot_bond(mol_with_conformers)\n        if not torsions:\n            logger.warning(\n                f\"No rotatable bonds found in molecule {mol_idx}. Skipping metadynamics.\"\n            )\n            # Fall back to regular MD for this molecule\n            system = interchange.to_openmm_system()\n            integrator = _get_integrator(settings.temperature, settings.timestep)\n            simulation = Simulation(\n                interchange.topology.to_openmm(), system, integrator\n            )\n\n            pdb_path = None\n            if OutputType.PDB_TRAJECTORY in output_paths:\n                base_path = output_paths[OutputType.PDB_TRAJECTORY]\n                pdb_path = str(get_mol_path(base_path, mol_idx))\n\n            mm_dataset = _run_md(\n                mol_with_conformers,\n                simulation,\n                simulation.step,\n                settings.equilibration_n_steps_per_conformer,\n                settings.production_n_snapshots_per_conformer,\n                settings.production_n_steps_per_snapshot_per_conformer,\n                pdb_path,\n            )\n\n            # Clean up MM simulation to free GPU memory\n            cleanup_simulation(simulation, integrator)\n        else:\n            # Setup metadynamics\n            bias_variables = _get_torsion_bias_forces(\n                mol_with_conformers,\n                torsions_to_include=_TORSIONS_TO_INCLUDE_SMARTS,\n                torsions_to_exclude=_TORSIONS_TO_EXCLUDE_SMARTS,\n                bias_width=settings.bias_width,\n            )\n\n            system = interchange.to_openmm_system()\n\n            # Create molecule-specific bias directory\n            base_bias_dir = output_paths[OutputType.METADYNAMICS_BIAS]\n            bias_dir = get_mol_path(base_bias_dir, mol_idx)\n            bias_dir.mkdir(parents=True, exist_ok=True)\n\n            metad = Metadynamics(  # type: ignore[no-untyped-call]\n                system=system,\n                variables=bias_variables,\n                temperature=settings.temperature,\n                biasFactor=settings.bias_factor,\n                height=settings.bias_height,\n                frequency=settings.n_steps_per_bias,\n                saveFrequency=settings.n_steps_per_bias_save,\n                biasDir=bias_dir,\n                independentCVs=True,\n            )\n\n            simulation = Simulation(\n                interchange.topology.to_openmm(),\n                system,\n                _get_integrator(settings.temperature, settings.timestep),\n            )\n\n            step_fn = functools.partial(metad.step, simulation)\n\n            # Create molecule-specific PDB path\n            pdb_path = None\n            if OutputType.PDB_TRAJECTORY in output_paths:\n                base_path = output_paths[OutputType.PDB_TRAJECTORY]\n                pdb_path = str(get_mol_path(base_path, mol_idx))\n\n            mm_dataset = _run_md(\n                mol_with_conformers,\n                simulation,\n                step_fn,\n                settings.equilibration_n_steps_per_conformer,\n                settings.production_n_snapshots_per_conformer,\n                settings.production_n_steps_per_snapshot_per_conformer,\n                pdb_path,\n            )\n\n            # Clean up MM simulation to free GPU memory\n            cleanup_simulation(simulation)\n\n        # Recalculate with ML potential\n        ml_system = _get_ml_omm_system(mol_with_conformers, settings.ml_potential)\n        ml_integrator = _get_integrator(settings.temperature, settings.timestep)\n        ml_simulation = Simulation(\n            interchange.topology.to_openmm(),\n            ml_system,\n            ml_integrator,\n        )\n        ml_dataset = recalculate_energies_and_forces(mm_dataset, ml_simulation)\n\n        # Clean up ML simulation to free GPU memory\n        cleanup_simulation(ml_simulation, ml_integrator)\n\n        # Convert to weighted dataset\n        entry = ml_dataset[0]\n        n_confs = len(entry[\"energy\"])\n        weighted_dataset = create_dataset_with_uniform_weights(\n            smiles=entry[\"smiles\"],\n            coords=entry[\"coords\"].reshape(n_confs, -1, 3),\n            energy=entry[\"energy\"],\n            forces=entry[\"forces\"].reshape(n_confs, -1, 3),\n            energy_weight=settings.loss_energy_weight,\n            forces_weight=settings.loss_force_weight,\n        )\n\n        all_datasets.append(weighted_dataset)\n\n    return all_datasets\n</code></pre>"},{"location":"reference/sample/#bespokefit_smee.sample._get_molecule_from_dataset","title":"_get_molecule_from_dataset","text":"<pre><code>_get_molecule_from_dataset(dataset: Dataset) -&gt; Molecule\n</code></pre> <p>Extract molecule from dataset using SMILES.</p> <p>Parameters:</p> <ul> <li> <code>dataset</code>               (<code>Dataset</code>)           \u2013            <p>Dataset containing SMILES string</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>Molecule</code>           \u2013            <p>Reconstructed molecule from SMILES</p> </li> </ul> Source code in <code>bespokefit_smee/sample.py</code> <pre><code>def _get_molecule_from_dataset(\n    dataset: datasets.Dataset,\n) -&gt; openff.toolkit.Molecule:\n    \"\"\"Extract molecule from dataset using SMILES.\n\n    Parameters\n    ----------\n    dataset : datasets.Dataset\n        Dataset containing SMILES string\n\n    Returns\n    -------\n    openff.toolkit.Molecule\n        Reconstructed molecule from SMILES\n    \"\"\"\n    assert len(dataset) == 1, \"Dataset should contain exactly one entry.\"\n    entry = dataset[0]\n    smiles = entry[\"smiles\"]\n    return openff.toolkit.Molecule.from_smiles(smiles, allow_undefined_stereo=True)\n</code></pre>"},{"location":"reference/sample/#bespokefit_smee.sample._find_available_force_group","title":"_find_available_force_group","text":"<pre><code>_find_available_force_group(simulation: Simulation) -&gt; int\n</code></pre> <p>Find an unused force group in the simulation system.</p> <p>Parameters:</p> <ul> <li> <code>simulation</code>               (<code>Simulation</code>)           \u2013            <p>OpenMM simulation object</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>int</code>           \u2013            <p>An available force group number (0-31)</p> </li> </ul> <p>Raises:</p> <ul> <li> <code>RuntimeError</code>             \u2013            <p>If all force groups (0-31) are in use</p> </li> </ul> Source code in <code>bespokefit_smee/sample.py</code> <pre><code>def _find_available_force_group(simulation: Simulation) -&gt; int:\n    \"\"\"Find an unused force group in the simulation system.\n\n    Parameters\n    ----------\n    simulation : Simulation\n        OpenMM simulation object\n\n    Returns\n    -------\n    int\n        An available force group number (0-31)\n\n    Raises\n    ------\n    RuntimeError\n        If all force groups (0-31) are in use\n    \"\"\"\n    used_groups = set()\n    for i in range(simulation.system.getNumForces()):\n        force = simulation.system.getForce(i)\n        used_groups.add(force.getForceGroup())\n\n    # Find first available group\n    for group in range(32):\n        if group not in used_groups:\n            return group\n\n    raise RuntimeError(\"All force groups (0-31) are in use\")\n</code></pre>"},{"location":"reference/sample/#bespokefit_smee.sample._add_torsion_restraint_forces","title":"_add_torsion_restraint_forces","text":"<pre><code>_add_torsion_restraint_forces(\n    simulation: Simulation,\n    torsion_atoms_list: list[tuple[int, int, int, int]],\n    force_constant: float,\n    initial_angles: list[float] | None = None,\n) -&gt; tuple[list[int], int]\n</code></pre> <p>Add torsion restraint forces to the simulation system.</p> <p>This adds CustomTorsionForce objects that can be updated later without reinitializing the context. All restraints are added to a dedicated force group.</p> <p>Parameters:</p> <ul> <li> <code>simulation</code>               (<code>Simulation</code>)           \u2013            <p>OpenMM simulation object</p> </li> <li> <code>torsion_atoms_list</code>               (<code>list[tuple[int, int, int, int]]</code>)           \u2013            <p>List of torsion atom indices to freeze</p> </li> <li> <code>force_constant</code>               (<code>float</code>)           \u2013            <p>Force constant for torsion restraints (in kJ/mol/rad^2)</p> </li> <li> <code>initial_angles</code>               (<code>list[float] | None</code>, default:                   <code>None</code> )           \u2013            <p>Initial target angles for each torsion (in radians). If None, defaults to 0.0 for all torsions.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>tuple[list[int], int]</code>           \u2013            <p>Tuple of (list of force indices that were added, force group number)</p> </li> </ul> Source code in <code>bespokefit_smee/sample.py</code> <pre><code>def _add_torsion_restraint_forces(\n    simulation: Simulation,\n    torsion_atoms_list: list[tuple[int, int, int, int]],\n    force_constant: float,\n    initial_angles: list[float] | None = None,\n) -&gt; tuple[list[int], int]:\n    \"\"\"Add torsion restraint forces to the simulation system.\n\n    This adds CustomTorsionForce objects that can be updated later\n    without reinitializing the context. All restraints are added to\n    a dedicated force group.\n\n    Parameters\n    ----------\n    simulation : Simulation\n        OpenMM simulation object\n    torsion_atoms_list : list[tuple[int, int, int, int]]\n        List of torsion atom indices to freeze\n    force_constant : float\n        Force constant for torsion restraints (in kJ/mol/rad^2)\n    initial_angles : list[float] | None, optional\n        Initial target angles for each torsion (in radians).\n        If None, defaults to 0.0 for all torsions.\n\n    Returns\n    -------\n    tuple[list[int], int]\n        Tuple of (list of force indices that were added, force group number)\n    \"\"\"\n    if initial_angles is None:\n        initial_angles = [0.0] * len(torsion_atoms_list)\n\n    # Find an available force group for the restraints\n    restraint_force_group = _find_available_force_group(simulation)\n    logger.debug(f\"Adding torsion restraints to force group {restraint_force_group}\")\n\n    force_indices = []\n\n    for torsion_atoms, target_angle in zip(\n        torsion_atoms_list, initial_angles, strict=True\n    ):\n        restraint_force = openmm.CustomTorsionForce(\n            \"0.5*k*min(dtheta, 2*pi-dtheta)^2; \"\n            \"dtheta = abs(theta-theta0); pi = 3.1415926535\"\n        )\n        restraint_force.addPerTorsionParameter(\"k\")\n        restraint_force.addPerTorsionParameter(\"theta0\")\n        restraint_force.addTorsion(*torsion_atoms, [force_constant, target_angle])\n\n        # Assign to dedicated force group\n        restraint_force.setForceGroup(restraint_force_group)\n\n        force_idx: int = simulation.system.addForce(restraint_force)\n        force_indices.append(force_idx)\n\n    # Only reinitialize once after adding all forces\n    simulation.context.reinitialize(preserveState=True)\n\n    return force_indices, restraint_force_group\n</code></pre>"},{"location":"reference/sample/#bespokefit_smee.sample._update_torsion_restraints","title":"_update_torsion_restraints","text":"<pre><code>_update_torsion_restraints(\n    simulation: Simulation,\n    force_indices: list[int],\n    target_angles: list[float],\n    force_constant: float,\n) -&gt; None\n</code></pre> <p>Update the target angles for torsion restraints without reinitializing.</p> <p>Parameters:</p> <ul> <li> <code>simulation</code>               (<code>Simulation</code>)           \u2013            <p>OpenMM simulation object</p> </li> <li> <code>force_indices</code>               (<code>list[int]</code>)           \u2013            <p>List of force indices for the torsion restraints</p> </li> <li> <code>target_angles</code>               (<code>list[float]</code>)           \u2013            <p>New target angles (in radians) for each torsion</p> </li> <li> <code>force_constant</code>               (<code>float</code>)           \u2013            <p>Force constant for torsion restraints (in kJ/mol/rad^2)</p> </li> </ul> Source code in <code>bespokefit_smee/sample.py</code> <pre><code>def _update_torsion_restraints(\n    simulation: Simulation,\n    force_indices: list[int],\n    target_angles: list[float],\n    force_constant: float,\n) -&gt; None:\n    \"\"\"Update the target angles for torsion restraints without reinitializing.\n\n    Parameters\n    ----------\n    simulation : Simulation\n        OpenMM simulation object\n    force_indices : list[int]\n        List of force indices for the torsion restraints\n    target_angles : list[float]\n        New target angles (in radians) for each torsion\n    force_constant : float\n        Force constant for torsion restraints (in kJ/mol/rad^2)\n    \"\"\"\n    for force_idx, target_angle in zip(force_indices, target_angles, strict=True):\n        force = simulation.system.getForce(force_idx)\n        p1, p2, p3, p4, _ = force.getTorsionParameters(0)\n        force.setTorsionParameters(0, p1, p2, p3, p4, [force_constant, target_angle])\n\n    # Update parameters in context without full reinitialize\n    for force_idx in force_indices:\n        force = simulation.system.getForce(force_idx)\n        force.updateParametersInContext(simulation.context)\n</code></pre>"},{"location":"reference/sample/#bespokefit_smee.sample._remove_torsion_restraint_forces","title":"_remove_torsion_restraint_forces","text":"<pre><code>_remove_torsion_restraint_forces(\n    simulation: Simulation, force_indices: list[int]\n) -&gt; None\n</code></pre> <p>Remove torsion restraint forces from the simulation.</p> <p>Parameters:</p> <ul> <li> <code>simulation</code>               (<code>Simulation</code>)           \u2013            <p>OpenMM simulation object</p> </li> <li> <code>force_indices</code>               (<code>list[int]</code>)           \u2013            <p>List of force indices to remove</p> </li> </ul> Source code in <code>bespokefit_smee/sample.py</code> <pre><code>def _remove_torsion_restraint_forces(\n    simulation: Simulation, force_indices: list[int]\n) -&gt; None:\n    \"\"\"Remove torsion restraint forces from the simulation.\n\n    Parameters\n    ----------\n    simulation : Simulation\n        OpenMM simulation object\n    force_indices : list[int]\n        List of force indices to remove\n    \"\"\"\n    # Remove in reverse order to maintain correct indices\n    for force_idx in sorted(force_indices, reverse=True):\n        simulation.system.removeForce(force_idx)\n\n    # Only reinitialize once after removing all forces\n    simulation.context.reinitialize(preserveState=True)\n</code></pre>"},{"location":"reference/sample/#bespokefit_smee.sample._calculate_torsion_angles","title":"_calculate_torsion_angles","text":"<pre><code>_calculate_torsion_angles(\n    coords: Tensor, torsion_atoms: tuple[int, int, int, int]\n) -&gt; Tensor\n</code></pre> <p>Calculate torsion angles for a given set of atom indices.</p> <p>Parameters:</p> <ul> <li> <code>coords</code>               (<code>Tensor</code>)           \u2013            <p>Coordinates tensor of shape (n_snapshots, n_atoms, 3)</p> </li> <li> <code>torsion_atoms</code>               (<code>tuple[int, int, int, int]</code>)           \u2013            <p>Indices of the four atoms defining the torsion</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>Tensor</code>           \u2013            <p>Torsion angles in radians for each snapshot, shape (n_snapshots,)</p> </li> </ul> Source code in <code>bespokefit_smee/sample.py</code> <pre><code>def _calculate_torsion_angles(\n    coords: torch.Tensor, torsion_atoms: tuple[int, int, int, int]\n) -&gt; torch.Tensor:\n    \"\"\"Calculate torsion angles for a given set of atom indices.\n\n    Parameters\n    ----------\n    coords : torch.Tensor\n        Coordinates tensor of shape (n_snapshots, n_atoms, 3)\n    torsion_atoms : tuple[int, int, int, int]\n        Indices of the four atoms defining the torsion\n\n    Returns\n    -------\n    torch.Tensor\n        Torsion angles in radians for each snapshot, shape (n_snapshots,)\n    \"\"\"\n    i, j, k, m = torsion_atoms\n\n    # Extract coordinates for the four atoms\n    r1 = coords[:, i, :]\n    r2 = coords[:, j, :]\n    r3 = coords[:, k, :]\n    r4 = coords[:, m, :]\n\n    # Calculate vectors\n    b1 = r2 - r1\n    b2 = r3 - r2\n    b3 = r4 - r3\n\n    # Calculate normal vectors to the planes\n    n1 = torch.cross(b1, b2, dim=1)\n    n2 = torch.cross(b2, b3, dim=1)\n\n    # Calculate the torsion angle\n    m1 = torch.cross(n1, b2 / torch.norm(b2, dim=1, keepdim=True), dim=1)\n\n    x = torch.sum(n1 * n2, dim=1)\n    y = torch.sum(m1 * n2, dim=1)\n\n    return torch.atan2(y, x)\n</code></pre>"},{"location":"reference/sample/#bespokefit_smee.sample._minimize_with_frozen_torsions","title":"_minimize_with_frozen_torsions","text":"<pre><code>_minimize_with_frozen_torsions(\n    simulation: Simulation,\n    coords: ndarray,\n    torsion_atoms_list: list[tuple[int, int, int, int]],\n    force_indices: list[int],\n    torsion_force_constant: float,\n    restraint_force_group: int,\n    max_iterations: int = 0,\n) -&gt; tuple[ndarray, float, ndarray]\n</code></pre> <p>Minimize a conformation with all torsions frozen.</p> <p>Assumes torsion restraint forces have already been added to the system. Only updates the target angles without reinitializing.</p> <p>Parameters:</p> <ul> <li> <code>simulation</code>               (<code>Simulation</code>)           \u2013            <p>OpenMM simulation object (with torsion forces already added)</p> </li> <li> <code>coords</code>               (<code>ndarray</code>)           \u2013            <p>Starting coordinates</p> </li> <li> <code>torsion_atoms_list</code>               (<code>list[tuple[int, int, int, int]]</code>)           \u2013            <p>List of torsion atom indices to freeze</p> </li> <li> <code>force_indices</code>               (<code>list[int]</code>)           \u2013            <p>Indices of the torsion restraint forces in the system</p> </li> <li> <code>torsion_force_constant</code>               (<code>float</code>)           \u2013            <p>Force constant for torsion restraints (in kJ/mol/rad^2)</p> </li> <li> <code>restraint_force_group</code>               (<code>int</code>)           \u2013            <p>Force group number for the torsion restraints</p> </li> <li> <code>max_iterations</code>               (<code>int</code>, default:                   <code>0</code> )           \u2013            <p>Maximum minimization iterations (0 = until convergence)</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>tuple[ndarray, float, ndarray]</code>           \u2013            <p>Minimized coordinates, energy, and forces (excluding restraint forces)</p> </li> </ul> Source code in <code>bespokefit_smee/sample.py</code> <pre><code>def _minimize_with_frozen_torsions(\n    simulation: Simulation,\n    coords: numpy.ndarray,\n    torsion_atoms_list: list[tuple[int, int, int, int]],\n    force_indices: list[int],\n    torsion_force_constant: float,\n    restraint_force_group: int,\n    max_iterations: int = 0,\n) -&gt; tuple[numpy.ndarray, float, numpy.ndarray]:\n    \"\"\"Minimize a conformation with all torsions frozen.\n\n    Assumes torsion restraint forces have already been added to the system.\n    Only updates the target angles without reinitializing.\n\n    Parameters\n    ----------\n    simulation : Simulation\n        OpenMM simulation object (with torsion forces already added)\n    coords : numpy.ndarray\n        Starting coordinates\n    torsion_atoms_list : list[tuple[int, int, int, int]]\n        List of torsion atom indices to freeze\n    force_indices : list[int]\n        Indices of the torsion restraint forces in the system\n    torsion_force_constant : float\n        Force constant for torsion restraints (in kJ/mol/rad^2)\n    restraint_force_group : int\n        Force group number for the torsion restraints\n    max_iterations : int, optional\n        Maximum minimization iterations (0 = until convergence)\n\n    Returns\n    -------\n    tuple[numpy.ndarray, float, numpy.ndarray]\n        Minimized coordinates, energy, and forces (excluding restraint forces)\n    \"\"\"\n    # Set initial positions\n    simulation.context.setPositions(Quantity(coords, angstrom))\n\n    # Calculate current angles and update restraint targets\n    coords_tensor = torch.tensor(coords).unsqueeze(0)\n    current_angles = [\n        _calculate_torsion_angles(coords_tensor, torsion_atoms).item()\n        for torsion_atoms in torsion_atoms_list\n    ]\n\n    _update_torsion_restraints(\n        simulation, force_indices, current_angles, torsion_force_constant\n    )\n\n    # Minimize\n    simulation.minimizeEnergy(maxIterations=max_iterations)\n\n    # Get minimized state - exclude restraint force group from energy\n    # Create groups mask: all groups except the restraint group\n    groups_mask = sum(\n        1 &lt;&lt; group for group in range(32) if group != restraint_force_group\n    )\n    state = simulation.context.getState(\n        getEnergy=True, getPositions=True, getForces=True, groups=groups_mask\n    )\n    minimized_coords = state.getPositions().value_in_unit(_OMM_ANGS)\n    energy = state.getPotentialEnergy().value_in_unit(_OMM_KCAL_PER_MOL)\n    forces = state.getForces(asNumpy=True).value_in_unit(_OMM_KCAL_PER_MOL_ANGS)\n\n    return minimized_coords, energy, forces\n</code></pre>"},{"location":"reference/sample/#bespokefit_smee.sample.generate_torsion_minimised_dataset","title":"generate_torsion_minimised_dataset","text":"<pre><code>generate_torsion_minimised_dataset(\n    mm_dataset: Dataset,\n    ml_simulation: Simulation,\n    mm_simulation: Simulation,\n    torsion_restraint_force_constant: float = 1000.0,\n    ml_minimisation_steps: int = 10,\n    mm_minimisation_steps: int = 10,\n    ml_pdb_path: Path | str | None = None,\n    mm_pdb_path: Path | str | None = None,\n    map_ml_coords_energy_to_mm_coords_energy: bool = True,\n    mm_min_energy_weight: float = 1000.0,\n    mm_min_forces_weight: float = 0.1,\n    ml_min_energy_weight: float = 1000.0,\n    ml_min_forces_weight: float = 0.1,\n) -&gt; tuple[Dataset, Dataset]\n</code></pre> <p>Generate a dataset of torsion-restrained minimised structures.</p> <p>For each conformation in the input dataset: 1. Restrain all rotatable torsions to their current values 2. Perform a short MLP minimisation and save the energies 3. From those coordinates, perform a short MM minimisation and save the coordinates 4. Set forces to 0</p> <p>Parameters:</p> <ul> <li> <code>mm_dataset</code>               (<code>Dataset</code>)           \u2013            <p>Input dataset with coordinates from MM MD sampling.</p> </li> <li> <code>ml_simulation</code>               (<code>Simulation</code>)           \u2013            <p>OpenMM simulation with ML potential.</p> </li> <li> <code>mm_simulation</code>               (<code>Simulation</code>)           \u2013            <p>OpenMM simulation with MM force field.</p> </li> <li> <code>torsion_restraint_force_constant</code>               (<code>float</code>, default:                   <code>1000.0</code> )           \u2013            <p>Force constant for torsion restraints in kJ/mol/rad^2.</p> </li> <li> <code>ml_minimisation_steps</code>               (<code>int</code>, default:                   <code>10</code> )           \u2013            <p>Number of MLP minimisation steps (default: 10).</p> </li> <li> <code>mm_minimisation_steps</code>               (<code>int</code>, default:                   <code>10</code> )           \u2013            <p>Number of MM minimisation steps (default: 10).</p> </li> <li> <code>ml_pdb_path</code>               (<code>Path | str | None</code>, default:                   <code>None</code> )           \u2013            <p>Path to save ML-minimised structures as a multi-model PDB file.</p> </li> <li> <code>mm_pdb_path</code>               (<code>Path | str | None</code>, default:                   <code>None</code> )           \u2013            <p>Path to save MM-minimised structures as a multi-model PDB file.</p> </li> <li> <code>map_ml_coords_energy_to_mm_coords_energy</code>               (<code>bool</code>, default:                   <code>True</code> )           \u2013            <p>Whether to substitute the MLP energy for the MM-minimised coordinates with the MLP energy for the corresponding MLP-minimised coordinates.</p> </li> <li> <code>mm_min_energy_weight</code>               (<code>float</code>, default:                   <code>1000.0</code> )           \u2013            <p>Energy weight for MM-minimised dataset.</p> </li> <li> <code>mm_min_forces_weight</code>               (<code>float</code>, default:                   <code>0.1</code> )           \u2013            <p>Forces weight for MM-minimised dataset.</p> </li> <li> <code>ml_min_energy_weight</code>               (<code>float</code>, default:                   <code>1000.0</code> )           \u2013            <p>Energy weight for ML-minimised dataset.</p> </li> <li> <code>ml_min_forces_weight</code>               (<code>float</code>, default:                   <code>0.1</code> )           \u2013            <p>Forces weight for ML-minimised dataset.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>tuple[Dataset, Dataset]</code>           \u2013            <p>Tuple of (MM-minimised dataset, ML-minimised dataset).</p> </li> </ul> Source code in <code>bespokefit_smee/sample.py</code> <pre><code>def generate_torsion_minimised_dataset(\n    mm_dataset: datasets.Dataset,\n    ml_simulation: Simulation,\n    mm_simulation: Simulation,\n    torsion_restraint_force_constant: float = 1000.0,\n    ml_minimisation_steps: int = 10,\n    mm_minimisation_steps: int = 10,\n    ml_pdb_path: pathlib.Path | str | None = None,\n    mm_pdb_path: pathlib.Path | str | None = None,\n    map_ml_coords_energy_to_mm_coords_energy: bool = True,\n    mm_min_energy_weight: float = 1000.0,\n    mm_min_forces_weight: float = 0.1,\n    ml_min_energy_weight: float = 1000.0,\n    ml_min_forces_weight: float = 0.1,\n) -&gt; tuple[datasets.Dataset, datasets.Dataset]:\n    \"\"\"Generate a dataset of torsion-restrained minimised structures.\n\n    For each conformation in the input dataset:\n    1. Restrain all rotatable torsions to their current values\n    2. Perform a short MLP minimisation and save the energies\n    3. From those coordinates, perform a short MM minimisation and save the coordinates\n    4. Set forces to 0\n\n    Parameters\n    ----------\n    mm_dataset : datasets.Dataset\n        Input dataset with coordinates from MM MD sampling.\n    ml_simulation : Simulation\n        OpenMM simulation with ML potential.\n    mm_simulation : Simulation\n        OpenMM simulation with MM force field.\n    torsion_restraint_force_constant : float, optional\n        Force constant for torsion restraints in kJ/mol/rad^2.\n    ml_minimisation_steps : int, optional\n        Number of MLP minimisation steps (default: 10).\n    mm_minimisation_steps : int, optional\n        Number of MM minimisation steps (default: 10).\n    ml_pdb_path : pathlib.Path | str | None, optional\n        Path to save ML-minimised structures as a multi-model PDB file.\n    mm_pdb_path : pathlib.Path | str | None, optional\n        Path to save MM-minimised structures as a multi-model PDB file.\n    map_ml_coords_energy_to_mm_coords_energy: bool = True,\n        Whether to substitute the MLP energy for the MM-minimised coordinates with the\n        MLP energy for the corresponding MLP-minimised coordinates.\n    mm_min_energy_weight : float, optional\n        Energy weight for MM-minimised dataset.\n    mm_min_forces_weight : float, optional\n        Forces weight for MM-minimised dataset.\n    ml_min_energy_weight : float, optional\n        Energy weight for ML-minimised dataset.\n    ml_min_forces_weight : float, optional\n        Forces weight for ML-minimised dataset.\n\n    Returns\n    -------\n    tuple[datasets.Dataset, datasets.Dataset]\n        Tuple of (MM-minimised dataset, ML-minimised dataset).\n    \"\"\"\n    # Extract molecule and find rotatable torsions\n    mol = _get_molecule_from_dataset(mm_dataset)\n    torsions_dict = get_rot_torsions_by_rot_bond(mol)\n    torsion_atoms_list = list(torsions_dict.values())\n\n    if not torsion_atoms_list:\n        logger.warning(\n            \"No rotatable torsions found - returning empty torsion minimised dataset\"\n        )\n        # Return empty datasets with correct schema\n        entry = mm_dataset[0]\n        smiles = entry[\"smiles\"]\n        n_atoms = len(entry[\"coords\"]) // (3 * len(entry[\"energy\"]))\n        empty_dataset = create_dataset_with_uniform_weights(\n            smiles=smiles,\n            coords=torch.empty(0, n_atoms, 3),\n            energy=torch.empty(0),\n            forces=torch.full((0, n_atoms, 3), 0.0),\n            energy_weight=1.0,\n            forces_weight=0.0,\n        )\n        return empty_dataset, empty_dataset\n\n    # Extract coordinates from dataset\n    assert len(mm_dataset) == 1, \"Dataset should contain exactly one entry.\"\n    entry = mm_dataset[0]\n    n_snapshots = len(entry[\"energy\"])\n    n_atoms = len(entry[\"coords\"]) // (3 * n_snapshots)\n    coords = entry[\"coords\"].reshape(n_snapshots, n_atoms, 3).numpy()\n    smiles = entry[\"smiles\"]\n\n    # Add torsion restraint forces once to both simulations\n    logger.debug(f\"Adding {len(torsion_atoms_list)} torsion restraint forces\")\n    mm_force_indices, mm_restraint_group = _add_torsion_restraint_forces(\n        mm_simulation, torsion_atoms_list, torsion_restraint_force_constant\n    )\n    ml_force_indices, ml_restraint_group = _add_torsion_restraint_forces(\n        ml_simulation, torsion_atoms_list, torsion_restraint_force_constant\n    )\n\n    mm_minimised_coords = []\n    mm_coords_ml_energies = []\n    mm_coords_ml_forces = []\n\n    ml_minimised_coords = []\n    ml_coords_ml_energies = []\n    ml_coords_ml_forces = []\n\n    for i in tqdm(\n        range(n_snapshots),\n        leave=False,\n        colour=\"magenta\",\n        desc=\"Generating torsion-minimised structures\",\n    ):\n        # Step 1: Minimize with ML potential and frozen torsions\n        ml_coords, ml_energy, ml_forces = _minimize_with_frozen_torsions(\n            ml_simulation,\n            coords[i],\n            torsion_atoms_list,\n            ml_force_indices,\n            torsion_restraint_force_constant,\n            ml_restraint_group,\n            ml_minimisation_steps,\n        )\n        ml_coords_ml_energies.append(ml_energy)\n        ml_coords_ml_forces.append(ml_forces)\n        ml_minimised_coords.append(ml_coords)\n\n        # Step 2: Minimize with MM potential and frozen torsions from ML coords\n        mm_coords, _, _ = _minimize_with_frozen_torsions(\n            mm_simulation,\n            ml_coords,\n            torsion_atoms_list,\n            mm_force_indices,\n            torsion_restraint_force_constant,\n            mm_restraint_group,\n            mm_minimisation_steps,\n        )\n        mm_minimised_coords.append(mm_coords)\n\n        # Step 3: Now recalculate ML energy/forces at MM-minimised coords\n        groups_mask = sum(\n            1 &lt;&lt; group for group in range(32) if group != ml_restraint_group\n        )\n        ml_simulation.context.setPositions(Quantity(mm_coords, angstrom))\n        state = ml_simulation.context.getState(\n            getEnergy=True, getForces=True, groups=groups_mask\n        )\n        ml_energy = state.getPotentialEnergy().value_in_unit(_OMM_KCAL_PER_MOL)\n        ml_forces = state.getForces(asNumpy=True).value_in_unit(_OMM_KCAL_PER_MOL_ANGS)\n        mm_coords_ml_energies.append(ml_energy)\n        mm_coords_ml_forces.append(ml_forces)\n\n    # Remove torsion restraint forces\n    logger.debug(\"Removing torsion restraint forces\")\n    _remove_torsion_restraint_forces(mm_simulation, mm_force_indices)\n    _remove_torsion_restraint_forces(ml_simulation, ml_force_indices)\n\n    # Save ML-minimised structures to PDB if path is provided\n    if ml_pdb_path is not None:\n        logger.debug(f\"Saving ML-minimised structures to {ml_pdb_path}\")\n        topology = ml_simulation.topology\n        with open(ml_pdb_path, \"w\") as f:\n            for i, ml_coords_frame in enumerate(ml_minimised_coords):\n                positions = Quantity(ml_coords_frame, angstrom)\n                PDBFile.writeModel(topology, positions, f, modelIndex=i)\n            PDBFile.writeFooter(topology, f)\n\n    # Save MM-minimised structures to PDB if path is provided\n    if mm_pdb_path is not None:\n        logger.debug(f\"Saving MM-minimised structures to {mm_pdb_path}\")\n        topology = mm_simulation.topology\n        with open(mm_pdb_path, \"w\") as f:\n            for i, mm_coords_frame in enumerate(mm_minimised_coords):\n                positions = Quantity(mm_coords_frame, angstrom)\n                PDBFile.writeModel(topology, positions, f, modelIndex=i)\n            PDBFile.writeFooter(topology, f)\n\n    # Return two datasets: one for ML-minimised, one for MM-minimised\n    mm_mapped_energies = (\n        ml_coords_ml_energies\n        if map_ml_coords_energy_to_mm_coords_energy\n        else mm_coords_ml_energies\n    )\n    mm_min_dataset = create_dataset_with_uniform_weights(\n        smiles=smiles,\n        coords=torch.tensor(np.array(mm_minimised_coords)),\n        energy=torch.tensor(np.array(mm_mapped_energies) - np.min(mm_mapped_energies)),\n        forces=torch.tensor(np.array(mm_coords_ml_forces)),\n        energy_weight=mm_min_energy_weight,\n        forces_weight=mm_min_forces_weight,\n    )\n\n    ml_min_dataset = create_dataset_with_uniform_weights(\n        smiles=smiles,\n        coords=torch.tensor(np.array(ml_minimised_coords)),\n        energy=torch.tensor(\n            np.array(ml_coords_ml_energies) - np.min(ml_coords_ml_energies)\n        ),\n        forces=torch.tensor(np.array(ml_coords_ml_forces)),\n        energy_weight=ml_min_energy_weight,\n        forces_weight=ml_min_forces_weight,\n    )\n\n    return mm_min_dataset, ml_min_dataset\n</code></pre>"},{"location":"reference/sample/#bespokefit_smee.sample.sample_mmmd_metadynamics_with_torsion_minimisation","title":"sample_mmmd_metadynamics_with_torsion_minimisation","text":"<pre><code>sample_mmmd_metadynamics_with_torsion_minimisation(\n    mols: list[Molecule],\n    off_ff: ForceField,\n    device: device,\n    settings: MMMDMetadynamicsTorsionMinimisationSamplingSettings,\n    output_paths: dict[OutputType, Path],\n) -&gt; list[Dataset]\n</code></pre> <p>Generate datasets using metadynamics with additional torsion-minimised structures.</p> <p>This function extends sample_mmmd_metadynamics by: 1. Running metadynamics to generate samples (same as sample_mmmd_metadynamics) 2. For each sample, generating additional torsion-restrained minimised structures using both    the ML and MM potentials. 3. Returning all datasets with requested weights.</p> <p>Parameters:</p> <ul> <li> <code>mols</code>               (<code>list[Molecule]</code>)           \u2013            <p>The molecules to sample.</p> </li> <li> <code>off_ff</code>               (<code>ForceField</code>)           \u2013            <p>The MM force field to use.</p> </li> <li> <code>device</code>               (<code>device</code>)           \u2013            <p>The device to use for any MD or ML calculations.</p> </li> <li> <code>settings</code>               (<code>MMMDMetadynamicsTorsionMinimisationSamplingSettings</code>)           \u2013            <p>The sampling settings to use.</p> </li> <li> <code>output_paths</code>               (<code>dict[OutputType, Path]</code>)           \u2013            <p>A mapping of output types to filesystem paths.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>list[Dataset]</code>           \u2013            <p>The generated datasets with combined metadynamics and torsion-minimised samples.</p> </li> </ul> Source code in <code>bespokefit_smee/sample.py</code> <pre><code>@_register_sampling_fn(settings.MMMDMetadynamicsTorsionMinimisationSamplingSettings)\ndef sample_mmmd_metadynamics_with_torsion_minimisation(\n    mols: list[openff.toolkit.Molecule],\n    off_ff: openff.toolkit.ForceField,\n    device: torch.device,\n    settings: settings.MMMDMetadynamicsTorsionMinimisationSamplingSettings,\n    output_paths: dict[OutputType, pathlib.Path],\n) -&gt; list[datasets.Dataset]:\n    \"\"\"Generate datasets using metadynamics with additional torsion-minimised structures.\n\n    This function extends sample_mmmd_metadynamics by:\n    1. Running metadynamics to generate samples (same as sample_mmmd_metadynamics)\n    2. For each sample, generating additional torsion-restrained minimised structures using both\n       the ML and MM potentials.\n    3. Returning all datasets with requested weights.\n\n    Parameters\n    ----------\n    mols : list[openff.toolkit.Molecule]\n        The molecules to sample.\n    off_ff : openff.toolkit.ForceField\n        The MM force field to use.\n    device : torch.device\n        The device to use for any MD or ML calculations.\n    settings : MMMDMetadynamicsTorsionMinimisationSamplingSettings\n        The sampling settings to use.\n    output_paths: dict[OutputType, PathLike]\n        A mapping of output types to filesystem paths.\n\n    Returns\n    -------\n    list[datasets.Dataset]\n        The generated datasets with combined metadynamics and torsion-minimised samples.\n    \"\"\"\n    if set(output_paths.keys()) != settings.output_types:\n        raise ValueError(\n            f\"Output paths must contain exactly the keys {settings.output_types}\"\n        )\n\n    all_datasets = []\n\n    for mol_idx, mol in enumerate(mols):\n        mol_with_conformers = _copy_mol_and_add_conformers(mol, settings.n_conformers)\n        interchange = openff.interchange.Interchange.from_smirnoff(\n            off_ff, openff.toolkit.Topology.from_molecules(mol_with_conformers)\n        )\n\n        torsions = get_rot_torsions_by_rot_bond(mol_with_conformers)\n        system = interchange.to_openmm_system()\n\n        if not torsions:\n            logger.warning(\n                f\"No rotatable bonds found in molecule {mol_idx}. \"\n                \"Falling back to regular MD without torsion minimisation.\"\n            )\n            # Fall back to regular MD for this molecule\n            integrator = _get_integrator(settings.temperature, settings.timestep)\n            simulation = Simulation(\n                interchange.topology.to_openmm(), system, integrator\n            )\n\n            pdb_path = None\n            if OutputType.PDB_TRAJECTORY in output_paths:\n                base_path = output_paths[OutputType.PDB_TRAJECTORY]\n                pdb_path = str(get_mol_path(base_path, mol_idx))\n\n            mm_dataset = _run_md(\n                mol_with_conformers,\n                simulation,\n                simulation.step,\n                settings.equilibration_n_steps_per_conformer,\n                settings.production_n_snapshots_per_conformer,\n                settings.production_n_steps_per_snapshot_per_conformer,\n                pdb_path,\n            )\n\n            # Clean up MM simulation to free GPU memory\n            cleanup_simulation(simulation, integrator)\n\n            # Recalculate with ML potential\n            ml_system = _get_ml_omm_system(mol_with_conformers, settings.ml_potential)\n            ml_integrator = _get_integrator(settings.temperature, settings.timestep)\n            ml_simulation = Simulation(\n                interchange.topology.to_openmm(),\n                ml_system,\n                ml_integrator,\n            )\n            ml_dataset = recalculate_energies_and_forces(mm_dataset, ml_simulation)\n\n            # Clean up ML simulation to free GPU memory\n            cleanup_simulation(ml_simulation, ml_integrator)\n\n            # Convert to weighted dataset\n            entry = ml_dataset[0]\n            n_confs = len(entry[\"energy\"])\n            weighted_dataset = create_dataset_with_uniform_weights(\n                smiles=entry[\"smiles\"],\n                coords=entry[\"coords\"].reshape(n_confs, -1, 3),\n                energy=entry[\"energy\"],\n                forces=entry[\"forces\"].reshape(n_confs, -1, 3),\n                energy_weight=settings.loss_energy_weight_mmmd,\n                forces_weight=settings.loss_force_weight_mmmd,\n            )\n            all_datasets.append(weighted_dataset)\n            continue\n\n        # Setup metadynamics\n        bias_variables = _get_torsion_bias_forces(\n            mol_with_conformers,\n            torsions_to_include=_TORSIONS_TO_INCLUDE_SMARTS,\n            torsions_to_exclude=_TORSIONS_TO_EXCLUDE_SMARTS,\n            bias_width=settings.bias_width,\n        )\n\n        # Create molecule-specific bias directory\n        base_bias_dir = output_paths[OutputType.METADYNAMICS_BIAS]\n        bias_dir = get_mol_path(base_bias_dir, mol_idx)\n        bias_dir.mkdir(parents=True, exist_ok=True)\n\n        metad = Metadynamics(  # type: ignore[no-untyped-call]\n            system=system,\n            variables=bias_variables,\n            temperature=settings.temperature,\n            biasFactor=settings.bias_factor,\n            height=settings.bias_height,\n            frequency=settings.n_steps_per_bias,\n            saveFrequency=settings.n_steps_per_bias_save,\n            biasDir=bias_dir,\n            independentCVs=True,\n        )\n\n        simulation = Simulation(\n            interchange.topology.to_openmm(),\n            system,\n            _get_integrator(settings.temperature, settings.timestep),\n        )\n\n        step_fn = functools.partial(metad.step, simulation)\n\n        # Create molecule-specific PDB path\n        pdb_path = None\n        if OutputType.PDB_TRAJECTORY in output_paths:\n            base_path = output_paths[OutputType.PDB_TRAJECTORY]\n            pdb_path = str(get_mol_path(base_path, mol_idx))\n\n        # Step 1: Generate MM metadynamics samples\n        mm_dataset = _run_md(\n            mol_with_conformers,\n            simulation,\n            step_fn,\n            settings.equilibration_n_steps_per_conformer,\n            settings.production_n_snapshots_per_conformer,\n            settings.production_n_steps_per_snapshot_per_conformer,\n            pdb_path,\n        )\n\n        # Clean up MM simulation to free GPU memory\n        cleanup_simulation(simulation)\n\n        # Create ML simulation for energy/force recalculation\n        ml_system = _get_ml_omm_system(mol_with_conformers, settings.ml_potential)\n        ml_integrator = _get_integrator(settings.temperature, settings.timestep)\n        ml_simulation = Simulation(\n            interchange.topology.to_openmm(),\n            ml_system,\n            ml_integrator,\n        )\n\n        # Step 2: Recalculate energies and forces with ML potential\n        ml_dataset = recalculate_energies_and_forces(mm_dataset, ml_simulation)\n\n        # Clean up ML recalculation simulation to free GPU memory\n        cleanup_simulation(ml_simulation, ml_integrator)\n\n        # Convert to weighted dataset with MMMD weights\n        entry = ml_dataset[0]\n        n_confs = len(entry[\"energy\"])\n        mmmd_weighted_dataset = create_dataset_with_uniform_weights(\n            smiles=entry[\"smiles\"],\n            coords=entry[\"coords\"].reshape(n_confs, -1, 3),\n            energy=entry[\"energy\"],\n            forces=entry[\"forces\"].reshape(n_confs, -1, 3),\n            energy_weight=settings.loss_energy_weight_mmmd,\n            forces_weight=settings.loss_force_weight_mmmd,\n        )\n\n        # Step 3: Generate torsion-minimised structures\n        # Create a fresh MM simulation for minimisation (without metadynamics biases)\n        mm_min_system = interchange.to_openmm_system()\n        mm_min_integrator = _get_integrator(settings.temperature, settings.timestep)\n        mm_min_simulation = Simulation(\n            interchange.topology.to_openmm(),\n            mm_min_system,\n            mm_min_integrator,\n        )\n\n        # Create a fresh ML simulation for minimisation\n        ml_min_system = _get_ml_omm_system(mol_with_conformers, settings.ml_potential)\n        ml_min_integrator = _get_integrator(settings.temperature, settings.timestep)\n        ml_min_simulation = Simulation(\n            interchange.topology.to_openmm(),\n            ml_min_system,\n            ml_min_integrator,\n        )\n\n        # Create molecule-specific PDB paths for minimised structures\n        ml_pdb_path = None\n        mm_pdb_path = None\n        if OutputType.ML_MINIMISED_PDB in output_paths:\n            base_path = output_paths[OutputType.ML_MINIMISED_PDB]\n            ml_pdb_path = get_mol_path(base_path, mol_idx)\n        if OutputType.MM_MINIMISED_PDB in output_paths:\n            base_path = output_paths[OutputType.MM_MINIMISED_PDB]\n            mm_pdb_path = get_mol_path(base_path, mol_idx)\n\n        torsion_mm_min_dataset, torsion_ml_min_dataset = (\n            generate_torsion_minimised_dataset(\n                mm_dataset,\n                ml_min_simulation,\n                mm_min_simulation,\n                torsion_restraint_force_constant=settings.torsion_restraint_force_constant.value_in_unit(\n                    _KJ_PER_MOL / _RADIAN**2\n                ),\n                ml_minimisation_steps=settings.ml_minimisation_steps,\n                mm_minimisation_steps=settings.mm_minimisation_steps,\n                ml_pdb_path=ml_pdb_path,\n                mm_pdb_path=mm_pdb_path,\n                map_ml_coords_energy_to_mm_coords_energy=settings.map_ml_coords_energy_to_mm_coords_energy,\n                mm_min_energy_weight=settings.loss_energy_weight_mm_torsion_min,\n                mm_min_forces_weight=settings.loss_force_weight_mm_torsion_min,\n                ml_min_energy_weight=settings.loss_energy_weight_ml_torsion_min,\n                ml_min_forces_weight=settings.loss_force_weight_ml_torsion_min,\n            )\n        )\n\n        # Clean up minimisation simulations to free GPU memory\n        cleanup_simulation(ml_min_simulation, ml_min_integrator)\n        cleanup_simulation(mm_min_simulation, mm_min_integrator)\n\n        # Merge all datasets\n        combined_dataset = merge_weighted_datasets(\n            [mmmd_weighted_dataset, torsion_ml_min_dataset, torsion_mm_min_dataset]\n        )\n\n        all_datasets.append(combined_dataset)\n\n    return all_datasets\n</code></pre>"},{"location":"reference/sample/#bespokefit_smee.sample.load_precomputed_dataset","title":"load_precomputed_dataset","text":"<pre><code>load_precomputed_dataset(\n    mols: list[Molecule],\n    off_ff: ForceField,\n    device: device,\n    settings: PreComputedDatasetSettings,\n    output_paths: dict[OutputType, Path],\n) -&gt; list[Dataset]\n</code></pre> <p>Load pre-computed dataset(s) from disk.</p> <p>For single-molecule fits, loads one dataset. For multi-molecule fits, loads one dataset per molecule in the order they appear in <code>mols</code>.</p> <p>Parameters:</p> <ul> <li> <code>mols</code>               (<code>list[Molecule]</code>)           \u2013            <p>The molecules. The number of datasets loaded must match the number of molecules.</p> </li> <li> <code>off_ff</code>               (<code>ForceField</code>)           \u2013            <p>The force field (not used, kept for API consistency).</p> </li> <li> <code>device</code>               (<code>device</code>)           \u2013            <p>The device to set the dataset format to.</p> </li> <li> <code>settings</code>               (<code>PreComputedDatasetSettings</code>)           \u2013            <p>Settings containing the path(s) to the pre-computed dataset(s).</p> </li> <li> <code>output_paths</code>               (<code>dict[OutputType, Path]</code>)           \u2013            <p>Output paths (should be empty for this protocol).</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>list[Dataset]</code>           \u2013            <p>The loaded datasets, one per molecule.</p> </li> </ul> <p>Raises:</p> <ul> <li> <code>ValueError</code>             \u2013            <p>If the number of dataset paths doesn't match the number of molecules.</p> </li> <li> <code>FileNotFoundError</code>             \u2013            <p>If any dataset path doesn't exist.</p> </li> </ul> Source code in <code>bespokefit_smee/sample.py</code> <pre><code>@_register_sampling_fn(settings.PreComputedDatasetSettings)\ndef load_precomputed_dataset(\n    mols: list[openff.toolkit.Molecule],\n    off_ff: openff.toolkit.ForceField,\n    device: torch.device,\n    settings: settings.PreComputedDatasetSettings,\n    output_paths: dict[OutputType, pathlib.Path],\n) -&gt; list[datasets.Dataset]:\n    \"\"\"Load pre-computed dataset(s) from disk.\n\n    For single-molecule fits, loads one dataset. For multi-molecule fits,\n    loads one dataset per molecule in the order they appear in `mols`.\n\n    Parameters\n    ----------\n    mols : list[openff.toolkit.Molecule]\n        The molecules. The number of datasets loaded must match the number of molecules.\n    off_ff : openff.toolkit.ForceField\n        The force field (not used, kept for API consistency).\n    device : torch.device\n        The device to set the dataset format to.\n    settings : PreComputedDatasetSettings\n        Settings containing the path(s) to the pre-computed dataset(s).\n    output_paths : dict[OutputType, pathlib.Path]\n        Output paths (should be empty for this protocol).\n\n    Returns\n    -------\n    list[datasets.Dataset]\n        The loaded datasets, one per molecule.\n\n    Raises\n    ------\n    ValueError\n        If the number of dataset paths doesn't match the number of molecules.\n    FileNotFoundError\n        If any dataset path doesn't exist.\n    \"\"\"\n    if set(output_paths.keys()) != settings.output_types:\n        raise ValueError(\n            f\"Output paths must contain exactly the keys {settings.output_types}\"\n        )\n\n    # Validate that the number of paths matches the number of molecules\n    if len(settings.dataset_paths) != len(mols):\n        raise ValueError(\n            f\"Number of dataset paths ({len(settings.dataset_paths)}) must match \"\n            f\"number of molecules ({len(mols)})\"\n        )\n\n    loaded_datasets = []\n\n    for mol_idx, dataset_path in enumerate(settings.dataset_paths):\n        if not dataset_path.exists():\n            raise FileNotFoundError(\n                f\"Dataset not found at {dataset_path} (molecule {mol_idx})\"\n            )\n\n        logger.info(\n            f\"Loading pre-computed dataset for molecule {mol_idx} from {dataset_path}\"\n        )\n        loaded_dataset = datasets.load_from_disk(str(dataset_path))\n        loaded_dataset.set_format(\"torch\", device=device)\n        loaded_datasets.append(loaded_dataset)\n\n    return loaded_datasets\n</code></pre>"},{"location":"reference/settings/","title":"settings","text":""},{"location":"reference/settings/#bespokefit_smee.settings","title":"settings","text":"<p>Pydantic models which control/validate the settings.</p> <p>Classes:</p> <ul> <li> <code>MMMDSamplingSettings</code>           \u2013            <p>Settings for molecular dynamics sampling using a molecular mechanics</p> </li> <li> <code>MLMDSamplingSettings</code>           \u2013            <p>Settings for molecular dynamics sampling using a machine learning</p> </li> <li> <code>MMMDMetadynamicsSamplingSettings</code>           \u2013            <p>Settings for molecular dynamics sampling using a molecular mechanics</p> </li> <li> <code>MMMDMetadynamicsTorsionMinimisationSamplingSettings</code>           \u2013            <p>Settings for MM MD metadynamics sampling with additional torsion-restrained</p> </li> <li> <code>PreComputedDatasetSettings</code>           \u2013            <p>Settings for loading pre-computed datasets from disk.</p> </li> <li> <code>TrainingSettings</code>           \u2013            <p>Settings for the training process.</p> </li> <li> <code>OutlierFilterSettings</code>           \u2013            <p>Settings for filtering outliers from datasets based on MM vs MLP differences.</p> </li> <li> <code>TypeGenerationSettings</code>           \u2013            <p>Settings for generating tagged SMARTS types for a given potential type.</p> </li> <li> <code>MSMSettings</code>           \u2013            <p>Settings for the modified Seminario method.</p> </li> <li> <code>ParameterisationSettings</code>           \u2013            <p>Settings for the starting parameterisation.</p> </li> <li> <code>WorkflowSettings</code>           \u2013            <p>Overall settings for the full fitting workflow.</p> </li> </ul>"},{"location":"reference/settings/#bespokefit_smee.settings._DefaultSettings","title":"_DefaultSettings","text":"<p>               Bases: <code>BaseModel</code>, <code>ABC</code></p> <p>Default configuration for all models.</p> <p>Methods:</p> <ul> <li> <code>to_yaml</code>             \u2013              <p>Save the settings to a YAML file</p> </li> <li> <code>from_yaml</code>             \u2013              <p>Load settings from a YAML file</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>output_types</code>               (<code>set[OutputType]</code>)           \u2013            <p>Return a set of expected output types for the function which</p> </li> </ul>"},{"location":"reference/settings/#bespokefit_smee.settings._DefaultSettings.output_types","title":"output_types  <code>property</code>","text":"<pre><code>output_types: set[OutputType]\n</code></pre> <p>Return a set of expected output types for the function which implements this settings object. Subclasses should override this method.</p>"},{"location":"reference/settings/#bespokefit_smee.settings._DefaultSettings.to_yaml","title":"to_yaml","text":"<pre><code>to_yaml(yaml_path: PathLike) -&gt; None\n</code></pre> <p>Save the settings to a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>def to_yaml(self, yaml_path: PathLike) -&gt; None:\n    \"\"\"Save the settings to a YAML file\"\"\"\n    _model_to_yaml(self, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings._DefaultSettings.from_yaml","title":"from_yaml  <code>classmethod</code>","text":"<pre><code>from_yaml(yaml_path: PathLike) -&gt; Self\n</code></pre> <p>Load settings from a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@classmethod\ndef from_yaml(cls, yaml_path: PathLike) -&gt; Self:\n    \"\"\"Load settings from a YAML file\"\"\"\n    return _model_from_yaml(cls, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings._SamplingSettingsBase","title":"_SamplingSettingsBase","text":"<p>               Bases: <code>_DefaultSettings</code>, <code>ABC</code></p> <p>Settings for sampling (usually molecular dynamics).</p> <p>Methods:</p> <ul> <li> <code>validate_sampling_times</code>             \u2013              <p>Ensure that the sampling times divide exactly by the timestep and (for production) the snapshot interval.</p> </li> <li> <code>to_yaml</code>             \u2013              <p>Save the settings to a YAML file</p> </li> <li> <code>from_yaml</code>             \u2013              <p>Load settings from a YAML file</p> </li> </ul>"},{"location":"reference/settings/#bespokefit_smee.settings._SamplingSettingsBase.validate_sampling_times","title":"validate_sampling_times","text":"<pre><code>validate_sampling_times() -&gt; Self\n</code></pre> <p>Ensure that the sampling times divide exactly by the timestep and (for production) the snapshot interval.</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@model_validator(mode=\"after\")\ndef validate_sampling_times(self) -&gt; Self:\n    \"\"\"Ensure that the sampling times divide exactly by the timestep and (for production) the snapshot interval.\"\"\"\n    for time, name in [\n        (\n            self.equilibration_sampling_time_per_conformer,\n            \"equilibration_sampling_time_per_conformer\",\n        ),\n        (\n            self.production_sampling_time_per_conformer,\n            \"production_sampling_time_per_conformer\",\n        ),\n    ]:\n        n_steps = time / self.timestep\n        if not n_steps.is_integer():\n            raise InvalidSettingsError(\n                f\"{name} ({time}) must be divisible by the timestep ({self.timestep}).\"\n            )\n\n    # Additionally check that production sampling time divides by snapshot interval\n    time = self.production_sampling_time_per_conformer / self.snapshot_interval\n    if not n_steps.is_integer():\n        raise InvalidSettingsError(\n            f\"production_sampling_time_per_conformer ({time}) must be divisible by the snapshot_interval ({self.snapshot_interval}).\"\n        )\n\n    return self\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings._SamplingSettingsBase.to_yaml","title":"to_yaml","text":"<pre><code>to_yaml(yaml_path: PathLike) -&gt; None\n</code></pre> <p>Save the settings to a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>def to_yaml(self, yaml_path: PathLike) -&gt; None:\n    \"\"\"Save the settings to a YAML file\"\"\"\n    _model_to_yaml(self, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings._SamplingSettingsBase.from_yaml","title":"from_yaml  <code>classmethod</code>","text":"<pre><code>from_yaml(yaml_path: PathLike) -&gt; Self\n</code></pre> <p>Load settings from a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@classmethod\ndef from_yaml(cls, yaml_path: PathLike) -&gt; Self:\n    \"\"\"Load settings from a YAML file\"\"\"\n    return _model_from_yaml(cls, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.MMMDSamplingSettings","title":"MMMDSamplingSettings","text":"<p>               Bases: <code>_SamplingSettingsBase</code></p> <p>Settings for molecular dynamics sampling using a molecular mechanics force field. This is initally the force field supplined in the parameterisation settings, but is updated as the bespoke force field is trained.</p> <p>Methods:</p> <ul> <li> <code>to_yaml</code>             \u2013              <p>Save the settings to a YAML file</p> </li> <li> <code>from_yaml</code>             \u2013              <p>Load settings from a YAML file</p> </li> <li> <code>validate_sampling_times</code>             \u2013              <p>Ensure that the sampling times divide exactly by the timestep and (for production) the snapshot interval.</p> </li> </ul>"},{"location":"reference/settings/#bespokefit_smee.settings.MMMDSamplingSettings.to_yaml","title":"to_yaml","text":"<pre><code>to_yaml(yaml_path: PathLike) -&gt; None\n</code></pre> <p>Save the settings to a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>def to_yaml(self, yaml_path: PathLike) -&gt; None:\n    \"\"\"Save the settings to a YAML file\"\"\"\n    _model_to_yaml(self, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.MMMDSamplingSettings.from_yaml","title":"from_yaml  <code>classmethod</code>","text":"<pre><code>from_yaml(yaml_path: PathLike) -&gt; Self\n</code></pre> <p>Load settings from a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@classmethod\ndef from_yaml(cls, yaml_path: PathLike) -&gt; Self:\n    \"\"\"Load settings from a YAML file\"\"\"\n    return _model_from_yaml(cls, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.MMMDSamplingSettings.validate_sampling_times","title":"validate_sampling_times","text":"<pre><code>validate_sampling_times() -&gt; Self\n</code></pre> <p>Ensure that the sampling times divide exactly by the timestep and (for production) the snapshot interval.</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@model_validator(mode=\"after\")\ndef validate_sampling_times(self) -&gt; Self:\n    \"\"\"Ensure that the sampling times divide exactly by the timestep and (for production) the snapshot interval.\"\"\"\n    for time, name in [\n        (\n            self.equilibration_sampling_time_per_conformer,\n            \"equilibration_sampling_time_per_conformer\",\n        ),\n        (\n            self.production_sampling_time_per_conformer,\n            \"production_sampling_time_per_conformer\",\n        ),\n    ]:\n        n_steps = time / self.timestep\n        if not n_steps.is_integer():\n            raise InvalidSettingsError(\n                f\"{name} ({time}) must be divisible by the timestep ({self.timestep}).\"\n            )\n\n    # Additionally check that production sampling time divides by snapshot interval\n    time = self.production_sampling_time_per_conformer / self.snapshot_interval\n    if not n_steps.is_integer():\n        raise InvalidSettingsError(\n            f\"production_sampling_time_per_conformer ({time}) must be divisible by the snapshot_interval ({self.snapshot_interval}).\"\n        )\n\n    return self\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.MLMDSamplingSettings","title":"MLMDSamplingSettings","text":"<p>               Bases: <code>_SamplingSettingsBase</code></p> <p>Settings for molecular dynamics sampling using a machine learning potential. This protocol uses the ML reference potential for sampling as well as for energy and force calculations.</p> <p>Methods:</p> <ul> <li> <code>to_yaml</code>             \u2013              <p>Save the settings to a YAML file</p> </li> <li> <code>from_yaml</code>             \u2013              <p>Load settings from a YAML file</p> </li> <li> <code>validate_sampling_times</code>             \u2013              <p>Ensure that the sampling times divide exactly by the timestep and (for production) the snapshot interval.</p> </li> </ul>"},{"location":"reference/settings/#bespokefit_smee.settings.MLMDSamplingSettings.to_yaml","title":"to_yaml","text":"<pre><code>to_yaml(yaml_path: PathLike) -&gt; None\n</code></pre> <p>Save the settings to a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>def to_yaml(self, yaml_path: PathLike) -&gt; None:\n    \"\"\"Save the settings to a YAML file\"\"\"\n    _model_to_yaml(self, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.MLMDSamplingSettings.from_yaml","title":"from_yaml  <code>classmethod</code>","text":"<pre><code>from_yaml(yaml_path: PathLike) -&gt; Self\n</code></pre> <p>Load settings from a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@classmethod\ndef from_yaml(cls, yaml_path: PathLike) -&gt; Self:\n    \"\"\"Load settings from a YAML file\"\"\"\n    return _model_from_yaml(cls, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.MLMDSamplingSettings.validate_sampling_times","title":"validate_sampling_times","text":"<pre><code>validate_sampling_times() -&gt; Self\n</code></pre> <p>Ensure that the sampling times divide exactly by the timestep and (for production) the snapshot interval.</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@model_validator(mode=\"after\")\ndef validate_sampling_times(self) -&gt; Self:\n    \"\"\"Ensure that the sampling times divide exactly by the timestep and (for production) the snapshot interval.\"\"\"\n    for time, name in [\n        (\n            self.equilibration_sampling_time_per_conformer,\n            \"equilibration_sampling_time_per_conformer\",\n        ),\n        (\n            self.production_sampling_time_per_conformer,\n            \"production_sampling_time_per_conformer\",\n        ),\n    ]:\n        n_steps = time / self.timestep\n        if not n_steps.is_integer():\n            raise InvalidSettingsError(\n                f\"{name} ({time}) must be divisible by the timestep ({self.timestep}).\"\n            )\n\n    # Additionally check that production sampling time divides by snapshot interval\n    time = self.production_sampling_time_per_conformer / self.snapshot_interval\n    if not n_steps.is_integer():\n        raise InvalidSettingsError(\n            f\"production_sampling_time_per_conformer ({time}) must be divisible by the snapshot_interval ({self.snapshot_interval}).\"\n        )\n\n    return self\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.MMMDMetadynamicsSamplingSettings","title":"MMMDMetadynamicsSamplingSettings","text":"<p>               Bases: <code>_SamplingSettingsBase</code></p> <p>Settings for molecular dynamics sampling using a molecular mechanics force field with metadynamics. This is initally the force field supplined in the parameterisation settings, but is updated as the bespoke force field is trained.</p> <p>Methods:</p> <ul> <li> <code>to_yaml</code>             \u2013              <p>Save the settings to a YAML file</p> </li> <li> <code>from_yaml</code>             \u2013              <p>Load settings from a YAML file</p> </li> <li> <code>validate_sampling_times</code>             \u2013              <p>Ensure that the sampling times divide exactly by the timestep and (for production) the snapshot interval.</p> </li> </ul>"},{"location":"reference/settings/#bespokefit_smee.settings.MMMDMetadynamicsSamplingSettings.to_yaml","title":"to_yaml","text":"<pre><code>to_yaml(yaml_path: PathLike) -&gt; None\n</code></pre> <p>Save the settings to a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>def to_yaml(self, yaml_path: PathLike) -&gt; None:\n    \"\"\"Save the settings to a YAML file\"\"\"\n    _model_to_yaml(self, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.MMMDMetadynamicsSamplingSettings.from_yaml","title":"from_yaml  <code>classmethod</code>","text":"<pre><code>from_yaml(yaml_path: PathLike) -&gt; Self\n</code></pre> <p>Load settings from a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@classmethod\ndef from_yaml(cls, yaml_path: PathLike) -&gt; Self:\n    \"\"\"Load settings from a YAML file\"\"\"\n    return _model_from_yaml(cls, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.MMMDMetadynamicsSamplingSettings.validate_sampling_times","title":"validate_sampling_times","text":"<pre><code>validate_sampling_times() -&gt; Self\n</code></pre> <p>Ensure that the sampling times divide exactly by the timestep and (for production) the snapshot interval.</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@model_validator(mode=\"after\")\ndef validate_sampling_times(self) -&gt; Self:\n    \"\"\"Ensure that the sampling times divide exactly by the timestep and (for production) the snapshot interval.\"\"\"\n    for time, name in [\n        (\n            self.equilibration_sampling_time_per_conformer,\n            \"equilibration_sampling_time_per_conformer\",\n        ),\n        (\n            self.production_sampling_time_per_conformer,\n            \"production_sampling_time_per_conformer\",\n        ),\n    ]:\n        n_steps = time / self.timestep\n        if not n_steps.is_integer():\n            raise InvalidSettingsError(\n                f\"{name} ({time}) must be divisible by the timestep ({self.timestep}).\"\n            )\n\n    # Additionally check that production sampling time divides by snapshot interval\n    time = self.production_sampling_time_per_conformer / self.snapshot_interval\n    if not n_steps.is_integer():\n        raise InvalidSettingsError(\n            f\"production_sampling_time_per_conformer ({time}) must be divisible by the snapshot_interval ({self.snapshot_interval}).\"\n        )\n\n    return self\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.MMMDMetadynamicsTorsionMinimisationSamplingSettings","title":"MMMDMetadynamicsTorsionMinimisationSamplingSettings","text":"<p>               Bases: <code>MMMDMetadynamicsSamplingSettings</code></p> <p>Settings for MM MD metadynamics sampling with additional torsion-restrained minimisation structures. This extends MMMDMetadynamicsSamplingSettings by generating additional training data from torsion-restrained minimisations.</p> <p>Methods:</p> <ul> <li> <code>to_yaml</code>             \u2013              <p>Save the settings to a YAML file</p> </li> <li> <code>from_yaml</code>             \u2013              <p>Load settings from a YAML file</p> </li> <li> <code>validate_sampling_times</code>             \u2013              <p>Ensure that the sampling times divide exactly by the timestep and (for production) the snapshot interval.</p> </li> </ul>"},{"location":"reference/settings/#bespokefit_smee.settings.MMMDMetadynamicsTorsionMinimisationSamplingSettings.to_yaml","title":"to_yaml","text":"<pre><code>to_yaml(yaml_path: PathLike) -&gt; None\n</code></pre> <p>Save the settings to a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>def to_yaml(self, yaml_path: PathLike) -&gt; None:\n    \"\"\"Save the settings to a YAML file\"\"\"\n    _model_to_yaml(self, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.MMMDMetadynamicsTorsionMinimisationSamplingSettings.from_yaml","title":"from_yaml  <code>classmethod</code>","text":"<pre><code>from_yaml(yaml_path: PathLike) -&gt; Self\n</code></pre> <p>Load settings from a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@classmethod\ndef from_yaml(cls, yaml_path: PathLike) -&gt; Self:\n    \"\"\"Load settings from a YAML file\"\"\"\n    return _model_from_yaml(cls, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.MMMDMetadynamicsTorsionMinimisationSamplingSettings.validate_sampling_times","title":"validate_sampling_times","text":"<pre><code>validate_sampling_times() -&gt; Self\n</code></pre> <p>Ensure that the sampling times divide exactly by the timestep and (for production) the snapshot interval.</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@model_validator(mode=\"after\")\ndef validate_sampling_times(self) -&gt; Self:\n    \"\"\"Ensure that the sampling times divide exactly by the timestep and (for production) the snapshot interval.\"\"\"\n    for time, name in [\n        (\n            self.equilibration_sampling_time_per_conformer,\n            \"equilibration_sampling_time_per_conformer\",\n        ),\n        (\n            self.production_sampling_time_per_conformer,\n            \"production_sampling_time_per_conformer\",\n        ),\n    ]:\n        n_steps = time / self.timestep\n        if not n_steps.is_integer():\n            raise InvalidSettingsError(\n                f\"{name} ({time}) must be divisible by the timestep ({self.timestep}).\"\n            )\n\n    # Additionally check that production sampling time divides by snapshot interval\n    time = self.production_sampling_time_per_conformer / self.snapshot_interval\n    if not n_steps.is_integer():\n        raise InvalidSettingsError(\n            f\"production_sampling_time_per_conformer ({time}) must be divisible by the snapshot_interval ({self.snapshot_interval}).\"\n        )\n\n    return self\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.PreComputedDatasetSettings","title":"PreComputedDatasetSettings","text":"<p>               Bases: <code>_DefaultSettings</code></p> <p>Settings for loading pre-computed datasets from disk.</p> <p>For single-molecule fits, provide a single Path. For multi-molecule fits, provide a list of Paths (one per molecule).</p> <p>Methods:</p> <ul> <li> <code>normalize_dataset_paths</code>             \u2013              <p>Normalize dataset_paths to always be a list internally.</p> </li> <li> <code>to_yaml</code>             \u2013              <p>Save the settings to a YAML file</p> </li> <li> <code>from_yaml</code>             \u2013              <p>Load settings from a YAML file</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>output_types</code>               (<code>set[OutputType]</code>)           \u2013            <p>Pre-computed datasets don't produce any output files.</p> </li> </ul>"},{"location":"reference/settings/#bespokefit_smee.settings.PreComputedDatasetSettings.output_types","title":"output_types  <code>property</code>","text":"<pre><code>output_types: set[OutputType]\n</code></pre> <p>Pre-computed datasets don't produce any output files.</p>"},{"location":"reference/settings/#bespokefit_smee.settings.PreComputedDatasetSettings.normalize_dataset_paths","title":"normalize_dataset_paths  <code>classmethod</code>","text":"<pre><code>normalize_dataset_paths(\n    value: Path | list[Path],\n) -&gt; list[Path]\n</code></pre> <p>Normalize dataset_paths to always be a list internally.</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@field_validator(\"dataset_paths\", mode=\"before\")\n@classmethod\ndef normalize_dataset_paths(cls, value: Path | list[Path]) -&gt; list[Path]:\n    \"\"\"Normalize dataset_paths to always be a list internally.\"\"\"\n    if isinstance(value, (str, Path)):\n        return [Path(value)]\n    return [Path(p) for p in value]\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.PreComputedDatasetSettings.to_yaml","title":"to_yaml","text":"<pre><code>to_yaml(yaml_path: PathLike) -&gt; None\n</code></pre> <p>Save the settings to a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>def to_yaml(self, yaml_path: PathLike) -&gt; None:\n    \"\"\"Save the settings to a YAML file\"\"\"\n    _model_to_yaml(self, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.PreComputedDatasetSettings.from_yaml","title":"from_yaml  <code>classmethod</code>","text":"<pre><code>from_yaml(yaml_path: PathLike) -&gt; Self\n</code></pre> <p>Load settings from a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@classmethod\ndef from_yaml(cls, yaml_path: PathLike) -&gt; Self:\n    \"\"\"Load settings from a YAML file\"\"\"\n    return _model_from_yaml(cls, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.TrainingSettings","title":"TrainingSettings","text":"<p>               Bases: <code>_DefaultSettings</code></p> <p>Settings for the training process.</p> <p>Methods:</p> <ul> <li> <code>to_yaml</code>             \u2013              <p>Save the settings to a YAML file</p> </li> <li> <code>from_yaml</code>             \u2013              <p>Load settings from a YAML file</p> </li> </ul>"},{"location":"reference/settings/#bespokefit_smee.settings.TrainingSettings.to_yaml","title":"to_yaml","text":"<pre><code>to_yaml(yaml_path: PathLike) -&gt; None\n</code></pre> <p>Save the settings to a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>def to_yaml(self, yaml_path: PathLike) -&gt; None:\n    \"\"\"Save the settings to a YAML file\"\"\"\n    _model_to_yaml(self, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.TrainingSettings.from_yaml","title":"from_yaml  <code>classmethod</code>","text":"<pre><code>from_yaml(yaml_path: PathLike) -&gt; Self\n</code></pre> <p>Load settings from a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@classmethod\ndef from_yaml(cls, yaml_path: PathLike) -&gt; Self:\n    \"\"\"Load settings from a YAML file\"\"\"\n    return _model_from_yaml(cls, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.OutlierFilterSettings","title":"OutlierFilterSettings","text":"<p>               Bases: <code>_DefaultSettings</code></p> <p>Settings for filtering outliers from datasets based on MM vs MLP differences.</p> <p>Outliers are identified by comparing MM and reference (typically MLP) energies and forces. Conformations where the absolute difference exceeds a threshold are removed.</p> <p>Methods:</p> <ul> <li> <code>to_yaml</code>             \u2013              <p>Save the settings to a YAML file</p> </li> <li> <code>from_yaml</code>             \u2013              <p>Load settings from a YAML file</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>output_types</code>               (<code>set[OutputType]</code>)           \u2013            <p>Return a set of expected output types for the function which</p> </li> </ul>"},{"location":"reference/settings/#bespokefit_smee.settings.OutlierFilterSettings.output_types","title":"output_types  <code>property</code>","text":"<pre><code>output_types: set[OutputType]\n</code></pre> <p>Return a set of expected output types for the function which implements this settings object. Subclasses should override this method.</p>"},{"location":"reference/settings/#bespokefit_smee.settings.OutlierFilterSettings.to_yaml","title":"to_yaml","text":"<pre><code>to_yaml(yaml_path: PathLike) -&gt; None\n</code></pre> <p>Save the settings to a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>def to_yaml(self, yaml_path: PathLike) -&gt; None:\n    \"\"\"Save the settings to a YAML file\"\"\"\n    _model_to_yaml(self, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.OutlierFilterSettings.from_yaml","title":"from_yaml  <code>classmethod</code>","text":"<pre><code>from_yaml(yaml_path: PathLike) -&gt; Self\n</code></pre> <p>Load settings from a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@classmethod\ndef from_yaml(cls, yaml_path: PathLike) -&gt; Self:\n    \"\"\"Load settings from a YAML file\"\"\"\n    return _model_from_yaml(cls, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.TypeGenerationSettings","title":"TypeGenerationSettings","text":"<p>               Bases: <code>_DefaultSettings</code></p> <p>Settings for generating tagged SMARTS types for a given potential type.</p> <p>Methods:</p> <ul> <li> <code>validate_include_exclude</code>             \u2013              <p>Ensure that only one of include or exclude is set.</p> </li> <li> <code>to_yaml</code>             \u2013              <p>Save the settings to a YAML file</p> </li> <li> <code>from_yaml</code>             \u2013              <p>Load settings from a YAML file</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>output_types</code>               (<code>set[OutputType]</code>)           \u2013            <p>Return a set of expected output types for the function which</p> </li> </ul>"},{"location":"reference/settings/#bespokefit_smee.settings.TypeGenerationSettings.output_types","title":"output_types  <code>property</code>","text":"<pre><code>output_types: set[OutputType]\n</code></pre> <p>Return a set of expected output types for the function which implements this settings object. Subclasses should override this method.</p>"},{"location":"reference/settings/#bespokefit_smee.settings.TypeGenerationSettings.validate_include_exclude","title":"validate_include_exclude","text":"<pre><code>validate_include_exclude() -&gt; Self\n</code></pre> <p>Ensure that only one of include or exclude is set.</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@model_validator(mode=\"after\")\ndef validate_include_exclude(self) -&gt; Self:\n    \"\"\"Ensure that only one of include or exclude is set.\"\"\"\n    if self.include and self.exclude:\n        raise InvalidSettingsError(\n            \"Only one of include or exclude can be set in TypeGenerationSettings.\"\n        )\n    return self\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.TypeGenerationSettings.to_yaml","title":"to_yaml","text":"<pre><code>to_yaml(yaml_path: PathLike) -&gt; None\n</code></pre> <p>Save the settings to a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>def to_yaml(self, yaml_path: PathLike) -&gt; None:\n    \"\"\"Save the settings to a YAML file\"\"\"\n    _model_to_yaml(self, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.TypeGenerationSettings.from_yaml","title":"from_yaml  <code>classmethod</code>","text":"<pre><code>from_yaml(yaml_path: PathLike) -&gt; Self\n</code></pre> <p>Load settings from a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@classmethod\ndef from_yaml(cls, yaml_path: PathLike) -&gt; Self:\n    \"\"\"Load settings from a YAML file\"\"\"\n    return _model_from_yaml(cls, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.MSMSettings","title":"MSMSettings","text":"<p>               Bases: <code>_DefaultSettings</code></p> <p>Settings for the modified Seminario method.</p> <p>Methods:</p> <ul> <li> <code>to_yaml</code>             \u2013              <p>Save the settings to a YAML file</p> </li> <li> <code>from_yaml</code>             \u2013              <p>Load settings from a YAML file</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>output_types</code>               (<code>set[OutputType]</code>)           \u2013            <p>Return a set of expected output types for the function which</p> </li> </ul>"},{"location":"reference/settings/#bespokefit_smee.settings.MSMSettings.output_types","title":"output_types  <code>property</code>","text":"<pre><code>output_types: set[OutputType]\n</code></pre> <p>Return a set of expected output types for the function which implements this settings object. Subclasses should override this method.</p>"},{"location":"reference/settings/#bespokefit_smee.settings.MSMSettings.to_yaml","title":"to_yaml","text":"<pre><code>to_yaml(yaml_path: PathLike) -&gt; None\n</code></pre> <p>Save the settings to a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>def to_yaml(self, yaml_path: PathLike) -&gt; None:\n    \"\"\"Save the settings to a YAML file\"\"\"\n    _model_to_yaml(self, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.MSMSettings.from_yaml","title":"from_yaml  <code>classmethod</code>","text":"<pre><code>from_yaml(yaml_path: PathLike) -&gt; Self\n</code></pre> <p>Load settings from a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@classmethod\ndef from_yaml(cls, yaml_path: PathLike) -&gt; Self:\n    \"\"\"Load settings from a YAML file\"\"\"\n    return _model_from_yaml(cls, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.ParameterisationSettings","title":"ParameterisationSettings","text":"<p>               Bases: <code>_DefaultSettings</code></p> <p>Settings for the starting parameterisation.</p> <p>Methods:</p> <ul> <li> <code>validate_smiles</code>             \u2013              <p>Validate all SMILES are valid, unique. Accepts string or list.</p> </li> <li> <code>to_yaml</code>             \u2013              <p>Save the settings to a YAML file</p> </li> <li> <code>from_yaml</code>             \u2013              <p>Load settings from a YAML file</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>molecules</code>               (<code>list[Molecule]</code>)           \u2013            <p>Return the list of OpenFF Molecule objects for the SMILES strings.</p> </li> <li> <code>output_types</code>               (<code>set[OutputType]</code>)           \u2013            <p>Return a set of expected output types for the function which</p> </li> </ul>"},{"location":"reference/settings/#bespokefit_smee.settings.ParameterisationSettings.molecules","title":"molecules  <code>property</code>","text":"<pre><code>molecules: list[Molecule]\n</code></pre> <p>Return the list of OpenFF Molecule objects for the SMILES strings.</p>"},{"location":"reference/settings/#bespokefit_smee.settings.ParameterisationSettings.output_types","title":"output_types  <code>property</code>","text":"<pre><code>output_types: set[OutputType]\n</code></pre> <p>Return a set of expected output types for the function which implements this settings object. Subclasses should override this method.</p>"},{"location":"reference/settings/#bespokefit_smee.settings.ParameterisationSettings.validate_smiles","title":"validate_smiles","text":"<pre><code>validate_smiles(value: str | list[str]) -&gt; list[str]\n</code></pre> <p>Validate all SMILES are valid, unique. Accepts string or list.</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@field_validator(\"smiles\", mode=\"before\")\ndef validate_smiles(cls, value: str | list[str]) -&gt; list[str]:\n    \"\"\"Validate all SMILES are valid, unique. Accepts string or list.\"\"\"\n    # Convert single string to list for backward compatibility\n    if isinstance(value, str):\n        value = [value]\n\n    if not value:\n        raise ValueError(\"smiles list cannot be empty\")\n\n    # Check for duplicates\n    if len(value) != len(set(value)):\n        duplicates = [s for s in value if value.count(s) &gt; 1]\n        unique_duplicates = list(set(duplicates))\n        raise ValueError(f\"Duplicate SMILES found: {unique_duplicates}\")\n\n    # Validate each SMILES string\n    for smiles in value:\n        if Chem.MolFromSmiles(smiles) is None:\n            raise ValueError(f\"Invalid SMILES string: {smiles}\")\n    return value\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.ParameterisationSettings.to_yaml","title":"to_yaml","text":"<pre><code>to_yaml(yaml_path: PathLike) -&gt; None\n</code></pre> <p>Save the settings to a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>def to_yaml(self, yaml_path: PathLike) -&gt; None:\n    \"\"\"Save the settings to a YAML file\"\"\"\n    _model_to_yaml(self, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.ParameterisationSettings.from_yaml","title":"from_yaml  <code>classmethod</code>","text":"<pre><code>from_yaml(yaml_path: PathLike) -&gt; Self\n</code></pre> <p>Load settings from a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@classmethod\ndef from_yaml(cls, yaml_path: PathLike) -&gt; Self:\n    \"\"\"Load settings from a YAML file\"\"\"\n    return _model_from_yaml(cls, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.WorkflowSettings","title":"WorkflowSettings","text":"<p>               Bases: <code>_DefaultSettings</code></p> <p>Overall settings for the full fitting workflow.</p> <p>Methods:</p> <ul> <li> <code>validate_version</code>             \u2013              <p>Validate version format and check compatibility.</p> </li> <li> <code>validate_device_type</code>             \u2013              <p>Ensure that the requested device type is available.</p> </li> <li> <code>validate_parameterisation_training_consistency</code>             \u2013              <p>Validate that linearise_harmonics argument in parameterisation settings is consistent with the valence types</p> </li> <li> <code>get_path_manager</code>             \u2013              <p>Get the output paths manager for this workflow settings object.</p> </li> <li> <code>to_yaml</code>             \u2013              <p>Save the settings to a YAML file</p> </li> <li> <code>from_yaml</code>             \u2013              <p>Load settings from a YAML file</p> </li> </ul> <p>Attributes:</p> <ul> <li> <code>output_types</code>               (<code>set[OutputType]</code>)           \u2013            <p>Return a set of expected output types for the function which</p> </li> </ul>"},{"location":"reference/settings/#bespokefit_smee.settings.WorkflowSettings.output_types","title":"output_types  <code>property</code>","text":"<pre><code>output_types: set[OutputType]\n</code></pre> <p>Return a set of expected output types for the function which implements this settings object. Subclasses should override this method.</p>"},{"location":"reference/settings/#bespokefit_smee.settings.WorkflowSettings.validate_version","title":"validate_version  <code>classmethod</code>","text":"<pre><code>validate_version(value: str) -&gt; str\n</code></pre> <p>Validate version format and check compatibility.</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@field_validator(\"version\")\n@classmethod\ndef validate_version(cls, value: str) -&gt; str:\n    \"\"\"Validate version format and check compatibility.\"\"\"\n    try:\n        parsed = Version(value)\n    except Exception as e:\n        raise ValueError(f\"Invalid version format: {value}\") from e\n\n    actual_version = Version(__version__)\n\n    # Warn the user if major or minor versions do not match\n    if parsed.major != actual_version.major or parsed.minor != actual_version.minor:\n        logger.warning(\n            f\"Version mismatch: settings version {value} may not be compatible with current version {__version__}.\"\n        )\n\n    return value\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.WorkflowSettings.validate_device_type","title":"validate_device_type  <code>classmethod</code>","text":"<pre><code>validate_device_type(value: TorchDevice) -&gt; TorchDevice\n</code></pre> <p>Ensure that the requested device type is available.</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@field_validator(\"device_type\")\n@classmethod\ndef validate_device_type(cls, value: TorchDevice) -&gt; TorchDevice:\n    \"\"\"Ensure that the requested device type is available.\"\"\"\n    if value == \"cuda\" and not torch.cuda.is_available():\n        raise ValueError(\"CUDA is not available on this system.\")\n\n    if value == \"cpu\":\n        warnings.warn(\n            \"Using CPU for training and sampling. This may be slow. Consider using CUDA if available.\",\n            UserWarning,\n            stacklevel=2,\n        )\n\n    return value\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.WorkflowSettings.validate_parameterisation_training_consistency","title":"validate_parameterisation_training_consistency","text":"<pre><code>validate_parameterisation_training_consistency() -&gt; Self\n</code></pre> <p>Validate that linearise_harmonics argument in parameterisation settings is consistent with the valence types in the training settings.</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@model_validator(mode=\"after\")\ndef validate_parameterisation_training_consistency(self) -&gt; Self:\n    \"\"\"Validate that linearise_harmonics argument in parameterisation settings is consistent with the valence types\n    in the training settings.\"\"\"\n\n    harmonics_linearised = self.parameterisation_settings.linearise_harmonics\n    excluded_valence_types = (\n        (\"Bonds\", \"Angles\")\n        if harmonics_linearised\n        else (\"LinearBonds\", \"LinearAngles\")\n    )\n    if any(\n        valence_type in self.training_settings.parameter_configs\n        for valence_type in excluded_valence_types\n    ):\n        raise InvalidSettingsError(\n            f\"ParameterisationSettings.linearise_harmonics is {harmonics_linearised}, but TrainingSettings.parameter_configs \"\n            f\"contains valence types that are inconsistent with this setting: {excluded_valence_types}. \"\n        )\n\n    return self\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.WorkflowSettings.get_path_manager","title":"get_path_manager","text":"<pre><code>get_path_manager() -&gt; WorkflowPathManager\n</code></pre> <p>Get the output paths manager for this workflow settings object.</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>def get_path_manager(self) -&gt; WorkflowPathManager:\n    \"\"\"Get the output paths manager for this workflow settings object.\"\"\"\n    # Get the number of molecules from the smiles list\n    smiles = self.parameterisation_settings.smiles\n    n_mols = len(smiles) if isinstance(smiles, list) else 1\n    return WorkflowPathManager(\n        output_dir=self.output_dir,\n        n_iterations=self.n_iterations,\n        n_mols=n_mols,\n        training_settings=self.training_settings,\n        training_sampling_settings=self.training_sampling_settings,\n        testing_sampling_settings=self.testing_sampling_settings,\n    )\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.WorkflowSettings.to_yaml","title":"to_yaml","text":"<pre><code>to_yaml(yaml_path: PathLike) -&gt; None\n</code></pre> <p>Save the settings to a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>def to_yaml(self, yaml_path: PathLike) -&gt; None:\n    \"\"\"Save the settings to a YAML file\"\"\"\n    _model_to_yaml(self, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings.WorkflowSettings.from_yaml","title":"from_yaml  <code>classmethod</code>","text":"<pre><code>from_yaml(yaml_path: PathLike) -&gt; Self\n</code></pre> <p>Load settings from a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>@classmethod\ndef from_yaml(cls, yaml_path: PathLike) -&gt; Self:\n    \"\"\"Load settings from a YAML file\"\"\"\n    return _model_from_yaml(cls, yaml_path)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings._model_to_yaml","title":"_model_to_yaml","text":"<pre><code>_model_to_yaml(\n    model: BaseModel, yaml_path: PathLike\n) -&gt; None\n</code></pre> <p>Save the settings to a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>def _model_to_yaml(model: BaseModel, yaml_path: PathLike) -&gt; None:\n    \"\"\"Save the settings to a YAML file\"\"\"\n    data = model.model_dump(mode=\"json\")\n    with open(yaml_path, \"w\") as file:\n        yaml.dump(data, file, default_flow_style=False, sort_keys=False, indent=4)\n</code></pre>"},{"location":"reference/settings/#bespokefit_smee.settings._model_from_yaml","title":"_model_from_yaml","text":"<pre><code>_model_from_yaml(cls: type[_T], yaml_path: PathLike) -&gt; _T\n</code></pre> <p>Load settings from a YAML file</p> Source code in <code>bespokefit_smee/settings.py</code> <pre><code>def _model_from_yaml(cls: type[_T], yaml_path: PathLike) -&gt; _T:\n    \"\"\"Load settings from a YAML file\"\"\"\n    with open(yaml_path, \"r\") as file:\n        settings_data = yaml.safe_load(file)\n    return cls(**settings_data)\n</code></pre>"},{"location":"reference/train/","title":"train","text":""},{"location":"reference/train/#bespokefit_smee.train","title":"train","text":"<p>Apply OpenFF parameters to molecule, cluster conformers by RMSD and train</p> <p>Classes:</p> <ul> <li> <code>TrainingFnArgs</code>           \u2013            <p>Arguments for training functions.</p> </li> <li> <code>TrainFn</code>           \u2013            <p>A protocol for training functions.</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>train_levenberg_marquardt</code>             \u2013              <p>Iterate the training process using the Levenberg-Marquardt algorithm.</p> </li> <li> <code>train_adam</code>             \u2013              <p>Iterate the training process using the Adam optimizer.</p> </li> </ul>"},{"location":"reference/train/#bespokefit_smee.train._TRAINING_FNS_REGISTRY","title":"_TRAINING_FNS_REGISTRY  <code>module-attribute</code>","text":"<pre><code>_TRAINING_FNS_REGISTRY: dict[OptimiserName, TrainFn] = {}\n</code></pre> <p>Registry of training functions for different optimiser names.</p>"},{"location":"reference/train/#bespokefit_smee.train.TrainingFnArgs","title":"TrainingFnArgs","text":"<p>               Bases: <code>TypedDict</code></p> <p>Arguments for training functions.</p>"},{"location":"reference/train/#bespokefit_smee.train.TrainFn","title":"TrainFn","text":"<p>               Bases: <code>Protocol</code></p> <p>A protocol for training functions.</p>"},{"location":"reference/train/#bespokefit_smee.train.train_levenberg_marquardt","title":"train_levenberg_marquardt","text":"<pre><code>train_levenberg_marquardt(\n    trainable_parameters: Tensor,\n    initial_parameters: Tensor,\n    trainable: Trainable,\n    topologies: list[TensorTopology],\n    datasets: list[Dataset],\n    datasets_test: list[Dataset],\n    settings: TrainingSettings,\n    output_paths: dict[OutputType, PathLike],\n    device: device,\n) -&gt; tuple[Tensor, Trainable]\n</code></pre> <p>Iterate the training process using the Levenberg-Marquardt algorithm.</p> <p>Returns:</p> <ul> <li> <code>    tuple[torch.Tensor, descent.train.Trainable]</code>           \u2013            <p>The updated parameters and the trainable object.</p> </li> </ul> Source code in <code>bespokefit_smee/train.py</code> <pre><code>@_register_training_fn(\"lm\")\ndef train_levenberg_marquardt(\n    trainable_parameters: torch.Tensor,\n    initial_parameters: torch.Tensor,\n    trainable: descent.train.Trainable,\n    topologies: list[smee.TensorTopology],\n    datasets: list[datasets.Dataset],\n    datasets_test: list[datasets.Dataset],\n    settings: TrainingSettings,\n    output_paths: dict[OutputType, PathLike],\n    device: torch.device,\n) -&gt; tuple[torch.Tensor, descent.train.Trainable]:\n    \"\"\"\n    Iterate the training process using the Levenberg-Marquardt algorithm.\n\n    Parameters\n    ----------\n        trainable_parameters: torch.Tensor\n            The parameters to be optimized.\n        initial_parameters: torch.Tensor\n            The initial parameters before training.\n        trainable: descent.train.Trainable\n            The trainable object containing the parameters.\n        topologies: list[smee.TensorTopology]\n            The topologies of the systems.\n        datasets: list[datasets.Dataset]\n            The datasets to be used for training.\n        datasets_test: list[datasets.Dataset]\n            The datasets to be used for testing.\n        settings: TrainingSettings\n            The settings object containing training parameters.\n        output_paths: dict[OutputType, PathLike]\n            A mapping of output types to filesystem paths. The following keys are\n            expected:\n                - OutputType.TENSORBOARD\n                - OutputType.TRAINING_METRICS\n        device: torch.device\n            The device to perform training on.\n\n    Returns\n    -------\n        tuple[torch.Tensor, descent.train.Trainable]\n            The updated parameters and the trainable object.\n    \"\"\"\n    # Make sure we have all the required output paths and no others\n    if set(output_paths.keys()) != settings.output_types:\n        raise ValueError(\n            f\"Output paths must contain exactly the keys {settings.output_types}\"\n        )\n\n    # Run the training with the LM optimiser\n    lm_config = descent.optim.LevenbergMarquardtConfig(\n        mode=\"adaptive\", n_convergence_criteria=2, max_steps=settings.n_epochs\n    )\n\n    # Get loss weights - using default values\n    # TODO: Support getting these from protocol settings when available\n    loss_energy_weight = 1000.0\n    loss_force_weight = 0.1\n\n    closure_fn = get_loss_closure_fn(\n        datasets,\n        trainable,\n        trainable_parameters,\n        initial_parameters,\n        topologies,\n        loss_energy_weight,\n        loss_force_weight,\n        settings.regularisation_target,\n    )\n\n    correct_fn = trainable.clamp\n\n    # Create report function that computes metrics consistently with train_adam\n    report_fn = functools.partial(\n        report,\n        trainable=trainable,\n        topologies=topologies,\n        datasets_train=datasets,\n        datasets_test=datasets_test,\n        initial_parameters=initial_parameters,\n        regularisation_target=settings.regularisation_target,\n        metrics_file=output_paths[OutputType.TRAINING_METRICS],\n        experiment_dir=Path(output_paths[OutputType.TENSORBOARD]),\n    )\n\n    trainable_parameters = descent.optim.levenberg_marquardt(\n        trainable_parameters, lm_config, closure_fn, correct_fn, report_fn\n    )\n    trainable_parameters.requires_grad_(True)\n\n    return trainable_parameters, trainable\n</code></pre>"},{"location":"reference/train/#bespokefit_smee.train.train_adam","title":"train_adam","text":"<pre><code>train_adam(\n    trainable_parameters: Tensor,\n    initial_parameters: Tensor,\n    trainable: Trainable,\n    topologies: list[TensorTopology],\n    datasets: list[Dataset],\n    datasets_test: list[Dataset],\n    settings: TrainingSettings,\n    output_paths: dict[OutputType, PathLike],\n    device: device,\n) -&gt; tuple[Tensor, Trainable]\n</code></pre> <p>Iterate the training process using the Adam optimizer.</p> <p>Returns:</p> <ul> <li> <code>    tuple[torch.Tensor, descent.train.Trainable]</code>           \u2013            <p>The updated parameters and the trainable object.</p> </li> </ul> Source code in <code>bespokefit_smee/train.py</code> <pre><code>@_register_training_fn(\"adam\")\ndef train_adam(\n    trainable_parameters: torch.Tensor,\n    initial_parameters: torch.Tensor,\n    trainable: descent.train.Trainable,\n    topologies: list[smee.TensorTopology],\n    datasets: list[datasets.Dataset],\n    datasets_test: list[datasets.Dataset],\n    settings: TrainingSettings,\n    output_paths: dict[OutputType, PathLike],\n    device: torch.device,\n) -&gt; tuple[torch.Tensor, descent.train.Trainable]:\n    \"\"\"\n    Iterate the training process using the Adam optimizer.\n\n    Parameters\n    ----------\n        trainable_parameters: torch.Tensor\n            The parameters to be optimized.\n        initial_parameters: torch.Tensor\n            The initial parameters before training.\n        trainable: descent.train.Trainable\n            The trainable object containing the parameters.\n        topologies: list[smee.TensorTopology]\n            The topologies of the systems.\n        datasets: list[datasets.Dataset]\n            The datasets to be used for training.\n        datasets_test: list[datasets.Dataset]\n            The datasets to be used for testing.\n        settings: TrainingSettings\n            The settings object containing training parameters.\n        output_paths: dict[OutputType, PathLike]\n            A mapping of output types to filesystem paths. The following keys are\n            expected:\n                - OutputType.TENSORBOARD\n                - OutputType.TRAINING_METRICS\n        device: torch.device\n            The device to perform training on.\n\n    Returns\n    -------\n        tuple[torch.Tensor, descent.train.Trainable]\n            The updated parameters and the trainable object.\n    \"\"\"\n    # Make sure we have all the required output paths and no others\n    if set(output_paths.keys()) != settings.output_types:\n        raise ValueError(\n            f\"Output paths must contain exactly the keys {settings.output_types}\"\n        )\n\n    # run the ML training\n    with open(output_paths[OutputType.TRAINING_METRICS], \"w\") as metrics_file:\n        with open_writer(Path(output_paths[OutputType.TENSORBOARD])) as writer:\n            optimizer = torch.optim.Adam(\n                [trainable_parameters], lr=settings.learning_rate, amsgrad=True\n            )\n            scheduler = torch.optim.lr_scheduler.ExponentialLR(\n                optimizer, gamma=settings.learning_rate_decay\n            )\n            for v in tensorboardX.writer.hparams(\n                {\"optimizer\": \"Adam\", \"lr\": settings.learning_rate}, {}\n            ):\n                writer.file_writer.add_summary(v)\n            for i in tqdm(\n                range(settings.n_epochs),\n                leave=False,\n                colour=\"blue\",\n                desc=\"Optimising MM parameters\",\n            ):\n                losses_train = prediction_loss(\n                    datasets,\n                    trainable,\n                    trainable_parameters,\n                    initial_parameters,\n                    topologies,\n                    settings.regularisation_target,\n                    str(device),\n                )\n                tot_loss_train = sum(losses_train)\n\n                logger.info(f\"Epoch {i}: Training Weighted Loss: {losses_train} \")\n                if i % 10 == 0:\n                    losses_test = prediction_loss(\n                        datasets_test,\n                        trainable,\n                        trainable_parameters,\n                        initial_parameters,\n                        topologies,\n                        settings.regularisation_target,\n                        str(device),\n                    )\n\n                    write_metrics(\n                        i,\n                        losses_train,\n                        losses_test,\n                        writer,\n                        metrics_file,\n                    )\n\n                tot_loss_train.backward(retain_graph=False)  # type: ignore[union-attr]\n                optimizer.step()\n                optimizer.zero_grad(set_to_none=True)\n                trainable.clamp(trainable_parameters)\n\n                if i % settings.learning_rate_decay_step == 0:\n                    scheduler.step()\n\n        # Required to avoid filling up the GPU memory between iterations\n        # TODO: Find a better way to do this.\n        if torch.cuda.is_available():\n            torch.cuda.synchronize()\n            torch.cuda.empty_cache()\n\n        # some book-keeping and outputting\n        losses_train = prediction_loss(\n            datasets,\n            trainable,\n            trainable_parameters,\n            initial_parameters,\n            topologies,\n            settings.regularisation_target,\n            str(device),\n        )\n        losses_test = prediction_loss(\n            datasets_test,\n            trainable,\n            trainable_parameters,\n            initial_parameters,\n            topologies,\n            settings.regularisation_target,\n            str(device),\n        )\n\n        write_metrics(\n            settings.n_epochs, losses_train, losses_test, writer, metrics_file\n        )\n\n        return trainable_parameters, trainable\n</code></pre>"},{"location":"reference/workflow/","title":"workflow","text":""},{"location":"reference/workflow/#bespokefit_smee.workflow","title":"workflow","text":"<p>Implements the overall workflow for fitting a bespoke force field.</p> <p>Functions:</p> <ul> <li> <code>get_bespoke_force_field</code>             \u2013              <p>Fit a bespoke force field. This involves:</p> </li> </ul>"},{"location":"reference/workflow/#bespokefit_smee.workflow.get_bespoke_force_field","title":"get_bespoke_force_field","text":"<pre><code>get_bespoke_force_field(\n    settings: WorkflowSettings, write_settings: bool = True\n) -&gt; ForceField\n</code></pre> <p>Fit a bespoke force field. This involves:</p> <ul> <li>Parameterising a base force field for the target molecule and generating   specific tagged SMARTS parameters</li> <li>Generating training data (e.g. from high-temperature MD simulations)</li> <li>Optimising the parameters of the force field to reproduce the training data</li> <li>Validating the fitted force field against test data</li> </ul> <p>Parameters:</p> <ul> <li> <code>settings</code>               (<code>WorkflowSettings</code>)           \u2013            <p>The workflow settings to use for fitting the force field.</p> </li> <li> <code>write_settings</code>               (<code>bool</code>, default:                   <code>True</code> )           \u2013            <p>Whether to write the settings to a YAML file in the output directory, by default True.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>ForceField</code>           \u2013            <p>The fitted bespoke force field.</p> </li> </ul> Source code in <code>bespokefit_smee/workflow.py</code> <pre><code>def get_bespoke_force_field(\n    settings: WorkflowSettings, write_settings: bool = True\n) -&gt; ForceField:\n    \"\"\"\n    Fit a bespoke force field. This involves:\n\n    - Parameterising a base force field for the target molecule and generating\n      specific tagged SMARTS parameters\n    - Generating training data (e.g. from high-temperature MD simulations)\n    - Optimising the parameters of the force field to reproduce the training data\n    - Validating the fitted force field against test data\n\n    Parameters\n    ----------\n    settings : WorkflowSettings\n        The workflow settings to use for fitting the force field.\n\n    write_settings : bool, optional\n        Whether to write the settings to a YAML file in the output directory, by default True.\n\n    Returns\n    -------\n    ForceField\n        The fitted bespoke force field.\n    \"\"\"\n    suppress_unwanted_output()\n\n    path_manager = settings.get_path_manager()\n    stage = OutputStage(StageKind.BASE)\n    path_manager.mk_stage_dir(stage)\n\n    if write_settings:\n        settings_output_path = path_manager.get_output_path(\n            stage, OutputType.WORKFLOW_SETTINGS\n        )\n        logger.info(f\"Writing workflow settings to {settings_output_path}.\")\n        # Copy the settings and change the output directory to be \".\" as we save\n        # to the output directory already\n        output_settings = copy.deepcopy(settings)\n        output_settings.output_dir = pathlib.Path(\".\")\n        output_settings.to_yaml(settings_output_path)\n\n    # Parameterise the base force field for all molecules\n    off_mols, initial_off_ff, tensor_tops, tensor_ff = parameterise(\n        settings.parameterisation_settings, device=settings.device_type\n    )\n\n    pruned_parameter_configs = {\n        p_type: p_config\n        for p_type, p_config in settings.training_settings.parameter_configs.items()\n        if p_type in tensor_ff.potentials_by_type\n    }\n\n    trainable = Trainable(\n        tensor_ff,\n        pruned_parameter_configs,\n        settings.training_settings.attribute_configs,\n    )\n\n    trainable_parameters = trainable.to_values().to((settings.device))\n\n    # Required for LM optimiser only\n    for tensor_top in tensor_tops:\n        for param in tensor_top.parameters.values():\n            param.assignment_matrix = param.assignment_matrix.to_dense()\n\n    # Get a copy of the initial trainable parameters for regularisation\n    initial_parameters = trainable_parameters.clone().detach()\n\n    # Generate the test data for all molecules\n    stage = OutputStage(StageKind.TESTING)\n    path_manager.mk_stage_dir(stage)\n    test_sample_fn: SampleFn = _SAMPLING_FNS_REGISTRY[\n        type(settings.testing_sampling_settings)\n    ]\n    logger.info(\"Generating test data\")\n    datasets_test = test_sample_fn(\n        mols=off_mols,\n        off_ff=initial_off_ff,\n        device=settings.device,\n        settings=settings.testing_sampling_settings,\n        output_paths={\n            output_type: path_manager.get_output_path(stage, output_type)\n            for output_type in settings.testing_sampling_settings.output_types\n        },\n    )\n\n    if test_sample_fn is not load_precomputed_dataset:  # type: ignore[comparison-overlap]\n        for mol_idx, dataset_test in enumerate(datasets_test):\n            dataset_path_mol = path_manager.get_output_path_for_mol(\n                stage, OutputType.ENERGIES_AND_FORCES, mol_idx\n            )\n            dataset_test.save_to_disk(str(dataset_path_mol))\n\n    # Write out statistics on the initial force field\n    stage = OutputStage(StageKind.INITIAL_STATISTICS)\n    path_manager.mk_stage_dir(stage)\n\n    # Write scatter plots for each molecule\n    for mol_idx, (dataset_test, tensor_top) in enumerate(\n        zip(datasets_test, tensor_tops, strict=True)\n    ):\n        scatter_path_mol = path_manager.get_output_path_for_mol(\n            stage, OutputType.SCATTER, mol_idx\n        )\n        energy_mean, energy_sd, forces_mean, forces_sd = write_scatter(\n            dataset_test,\n            tensor_ff,\n            tensor_top,\n            str(settings.device),\n            str(scatter_path_mol),\n        )\n        logger.info(\n            f\"Molecule {mol_idx} initial force field statistics: Energy (Mean/SD): {energy_mean:.3e}/{energy_sd:.3e}, Forces (Mean/SD): {forces_mean:.3e}/{forces_sd:.3e}\"\n        )\n\n    off_ff = convert_to_smirnoff(\n        trainable.to_force_field(trainable_parameters), base=initial_off_ff\n    )\n    off_ff.to_file(str(path_manager.get_output_path(stage, OutputType.OFFXML)))\n\n    train_sample_fn = _SAMPLING_FNS_REGISTRY[type(settings.training_sampling_settings)]\n\n    train_fn = _TRAINING_FNS_REGISTRY[settings.training_settings.optimiser]\n\n    # Train the force field\n    for iteration in tqdm(\n        range(1, settings.n_iterations + 1),  # Start from 1 (0 is untrained)\n        leave=False,\n        colour=\"magenta\",\n        desc=\"Iterating the Fit\",\n    ):\n        stage = OutputStage(StageKind.TRAINING, iteration)\n        path_manager.mk_stage_dir(stage)\n        datasets_train = None  # Only None for the first iteration\n\n        datasets_train_new = train_sample_fn(\n            mols=off_mols,\n            off_ff=off_ff,\n            device=settings.device,\n            settings=settings.training_sampling_settings,\n            output_paths={\n                output_type: path_manager.get_output_path(stage, output_type)\n                for output_type in settings.training_sampling_settings.output_types\n            },\n        )\n\n        # Apply outlier filtering if configured\n        if settings.outlier_filter_settings is not None:\n            logger.info(\"Applying outlier filtering to training data\")\n            datasets_train_new = [\n                filter_dataset_outliers(\n                    dataset=ds,\n                    force_field=tensor_ff,\n                    topology=tensor_top,\n                    settings=settings.outlier_filter_settings,\n                    device=str(settings.device),\n                )\n                for ds, tensor_top in zip(datasets_train_new, tensor_tops, strict=True)\n            ]\n\n        # Update training dataset: concatenate if memory is enabled and not the first iteration\n        if settings.memory and datasets_train is not None:\n            datasets_train = [\n                datasets.combine.concatenate_datasets([ds_old, ds_new])\n                for ds_old, ds_new in zip(\n                    datasets_train, datasets_train_new, strict=True\n                )\n            ]\n        else:\n            datasets_train = datasets_train_new\n\n        # Save each dataset\n        if train_sample_fn is not load_precomputed_dataset:  # type: ignore[comparison-overlap]\n            for mol_idx, dataset_train in enumerate(datasets_train):\n                dataset_path_mol = path_manager.get_output_path_for_mol(\n                    stage, OutputType.ENERGIES_AND_FORCES, mol_idx\n                )\n                dataset_train.save_to_disk(str(dataset_path_mol))\n\n        train_output_paths = {\n            output_type: path_manager.get_output_path(stage, output_type)\n            for output_type in settings.training_settings.output_types\n        }\n\n        trainable_parameters, trainable = train_fn(\n            trainable_parameters=trainable_parameters,\n            initial_parameters=initial_parameters,\n            trainable=trainable,\n            topologies=tensor_tops,\n            datasets=datasets_train,\n            datasets_test=datasets_test,\n            settings=settings.training_settings,\n            output_paths=train_output_paths,\n            device=settings.device,\n        )\n\n        for potential_type in trainable._param_types:\n            tensor_ff.potentials_by_type[potential_type].parameters = copy.copy(\n                trainable.to_force_field(trainable_parameters)\n                .potentials_by_type[potential_type]\n                .parameters\n            )\n\n        off_ff = convert_to_smirnoff(\n            trainable.to_force_field(trainable_parameters), base=initial_off_ff\n        )\n        off_ff.to_file(str(path_manager.get_output_path(stage, OutputType.OFFXML)))\n\n        # Write scatter plots for each molecule\n        for mol_idx, (dataset_test, tensor_top) in enumerate(\n            zip(datasets_test, tensor_tops, strict=True)\n        ):\n            scatter_path_mol = path_manager.get_output_path_for_mol(\n                stage, OutputType.SCATTER, mol_idx\n            )\n            energy_mean_new, energy_sd_new, forces_mean_new, forces_sd_new = (\n                write_scatter(\n                    dataset_test,\n                    tensor_ff,\n                    tensor_top,\n                    str(settings.device),\n                    str(scatter_path_mol),\n                )\n            )\n            logger.info(\n                f\"Iteration {iteration} Molecule {mol_idx} force field statistics: Energy (Mean/SD): {energy_mean_new:.3e}/{energy_sd_new:.3e}, Forces (Mean/SD): {forces_mean_new:.3e}/{forces_sd_new:.3e}\"\n            )\n\n    # Plot\n    analyse_workflow(settings)\n\n    return off_ff\n</code></pre>"},{"location":"reference/writers/","title":"writers","text":""},{"location":"reference/writers/#bespokefit_smee.writers","title":"writers","text":"<p>WRITERS:</p> <p>Output functions for run-fit</p> <p>Functions:</p> <ul> <li> <code>write_scatter</code>             \u2013              <p>Predict and save energies/forces to HDF5.</p> </li> <li> <code>report</code>             \u2013              <p>Report training progress for Levenberg-Marquardt optimizer.</p> </li> </ul>"},{"location":"reference/writers/#bespokefit_smee.writers.write_scatter","title":"write_scatter","text":"<pre><code>write_scatter(\n    dataset: Dataset,\n    force_field: TensorForceField,\n    topology_in: TensorTopology,\n    device_type: str,\n    filename: PathLike,\n) -&gt; tuple[float, float, float, float]\n</code></pre> <p>Predict and save energies/forces to HDF5.</p> Source code in <code>bespokefit_smee/writers.py</code> <pre><code>def write_scatter(\n    dataset: datasets.Dataset,\n    force_field: smee.TensorForceField,\n    topology_in: smee.TensorTopology,\n    device_type: str,\n    filename: PathLike,\n) -&gt; tuple[float, float, float, float]:\n    \"\"\"Predict and save energies/forces to HDF5.\"\"\"\n    energy_ref_all, energy_pred_all, forces_ref_all, forces_pred_all = predict(\n        dataset,\n        force_field,\n        {dataset[0][\"smiles\"]: topology_in},\n        device_type=device_type,\n        normalize=False,\n    )\n\n    with torch.no_grad():\n        energy_diffs = energy_pred_all - energy_ref_all\n        force_diffs = forces_pred_all - forces_ref_all\n\n        # Save to HDF5\n        with h5py.File(filename, \"w\") as f:\n            f.create_dataset(\"energy_reference\", data=energy_ref_all.cpu().numpy())\n            f.create_dataset(\"energy_predicted\", data=energy_pred_all.cpu().numpy())\n            f.create_dataset(\"energy_differences\", data=energy_diffs.cpu().numpy())\n\n            f.create_dataset(\"forces_reference\", data=forces_ref_all.cpu().numpy())\n            f.create_dataset(\"forces_predicted\", data=forces_pred_all.cpu().numpy())\n            f.create_dataset(\"forces_differences\", data=force_diffs.cpu().numpy())\n\n            f.attrs[\"n_conformers\"] = len(energy_ref_all)\n            f.attrs[\"n_atoms\"] = forces_ref_all.shape[0] // len(energy_ref_all)\n\n        # Summary statistics\n        energy_mean = torch.mean(energy_diffs).item()\n        energy_std = torch.std(energy_diffs).item()\n        forces_mean = torch.mean(force_diffs).item()\n        forces_std = torch.std(force_diffs).item()\n\n        return energy_mean, energy_std, forces_mean, forces_std\n</code></pre>"},{"location":"reference/writers/#bespokefit_smee.writers.report","title":"report","text":"<pre><code>report(\n    step: int,\n    x: Tensor,\n    loss: Tensor,\n    gradient: Tensor,\n    hessian: Tensor,\n    step_quality: float,\n    accept_step: bool,\n    trainable: Trainable,\n    topologies: list[TensorTopology],\n    datasets_train: list[Dataset],\n    datasets_test: list[Dataset],\n    initial_parameters: Tensor,\n    regularisation_target: Literal[\"initial\", \"zero\"],\n    metrics_file: PathLike,\n    experiment_dir: Path,\n) -&gt; None\n</code></pre> <p>Report training progress for Levenberg-Marquardt optimizer.</p> <p>This function computes training and test losses using the same loss computation as train_adam (via prediction_loss) to ensure consistent metrics reporting.</p> <p>Args:     step: Current optimization step.     x: Current trainable parameters.     loss: Loss value from the optimizer (not used, we recompute for consistency).     gradient: Gradient tensor (not used in reporting).     hessian: Hessian tensor (not used in reporting).     step_quality: Quality measure of the step (not used in reporting).     accept_step: Whether the step was accepted (not used in reporting).     trainable: The trainable object containing the force field.     topologies: List of topologies for all molecules.     datasets_train: List of training datasets for all molecules.     datasets_test: List of test datasets for all molecules.     initial_parameters: Initial parameters for regularization.     regularisation_target: Regularization target ('initial' or 'zero').     metrics_file: Path to the metrics output file.     experiment_dir: Path to the TensorBoard experiment directory.</p> Source code in <code>bespokefit_smee/writers.py</code> <pre><code>def report(\n    step: int,\n    x: torch.Tensor,\n    loss: torch.Tensor,\n    gradient: torch.Tensor,\n    hessian: torch.Tensor,\n    step_quality: float,\n    accept_step: bool,\n    trainable: descent.train.Trainable,\n    topologies: list[smee.TensorTopology],\n    datasets_train: list[datasets.Dataset],\n    datasets_test: list[datasets.Dataset],\n    initial_parameters: torch.Tensor,\n    regularisation_target: typing.Literal[\"initial\", \"zero\"],\n    metrics_file: PathLike,\n    experiment_dir: pathlib.Path,\n) -&gt; None:\n    \"\"\"Report training progress for Levenberg-Marquardt optimizer.\n\n    This function computes training and test losses using the same loss\n    computation as train_adam (via prediction_loss) to ensure consistent\n    metrics reporting.\n\n    Args:\n        step: Current optimization step.\n        x: Current trainable parameters.\n        loss: Loss value from the optimizer (not used, we recompute for consistency).\n        gradient: Gradient tensor (not used in reporting).\n        hessian: Hessian tensor (not used in reporting).\n        step_quality: Quality measure of the step (not used in reporting).\n        accept_step: Whether the step was accepted (not used in reporting).\n        trainable: The trainable object containing the force field.\n        topologies: List of topologies for all molecules.\n        datasets_train: List of training datasets for all molecules.\n        datasets_test: List of test datasets for all molecules.\n        initial_parameters: Initial parameters for regularization.\n        regularisation_target: Regularization target ('initial' or 'zero').\n        metrics_file: Path to the metrics output file.\n        experiment_dir: Path to the TensorBoard experiment directory.\n    \"\"\"\n    with torch.enable_grad():  # type: ignore[no-untyped-call]\n        # Compute training loss using the same function as train_adam\n        loss_train = prediction_loss(\n            datasets_train,\n            trainable,\n            x,\n            initial_parameters,\n            topologies,\n            regularisation_target,\n            x.device.type,\n        )\n\n        # Compute test loss using the same function as train_adam\n        loss_test = prediction_loss(\n            datasets_test,\n            trainable,\n            x,\n            initial_parameters,\n            topologies,\n            regularisation_target,\n            x.device.type,\n        )\n\n        with open_writer(experiment_dir) as writer:\n            with open(metrics_file, \"a\") as f:\n                write_metrics(step, loss_train, loss_test, writer, f)\n</code></pre>"},{"location":"reference/writers/#bespokefit_smee.writers._format_parameter_id","title":"_format_parameter_id","text":"<pre><code>_format_parameter_id(id_: Any) -&gt; str\n</code></pre> <p>Format a parameter ID for display in a table.</p> Source code in <code>bespokefit_smee/writers.py</code> <pre><code>def _format_parameter_id(id_: typing.Any) -&gt; str:\n    \"\"\"Format a parameter ID for display in a table.\"\"\"\n    id_str = id_ if \"EP\" not in id_ else id_[: id_.index(\"EP\") + 2]\n    return str(id_str[:60] + (id_str[60:] and \"...\"))\n</code></pre>"},{"location":"reference/models/","title":"Index","text":""},{"location":"reference/models/#bespokefit_smee.models","title":"models","text":"<p>Compiled models</p> <p>Modules:</p> <ul> <li> <code>compile_aimnet2_ens_models</code>           \u2013            <p>Script to compile AIMNet2 ensemble models for use in BespokeFit.</p> </li> </ul>"},{"location":"reference/models/compile_aimnet2_ens_models/","title":"compile_aimnet2_ens_models","text":""},{"location":"reference/models/compile_aimnet2_ens_models/#bespokefit_smee.models.compile_aimnet2_ens_models","title":"compile_aimnet2_ens_models","text":"<p>Script to compile AIMNet2 ensemble models for use in BespokeFit.</p> <p>Classes:</p> <ul> <li> <code>EnsembledModel</code>           \u2013            <p>Create ensemble of AIMNet2 models.</p> </li> </ul> <p>Functions:</p> <ul> <li> <code>compile_aimnet2_ens_model</code>             \u2013              <p>Compile an AIMNet2 ensemble model.</p> </li> <li> <code>main</code>             \u2013              <p>Main function to compile and save AIMNet2 ensemble models.</p> </li> </ul>"},{"location":"reference/models/compile_aimnet2_ens_models/#bespokefit_smee.models.compile_aimnet2_ens_models.EnsembledModel","title":"EnsembledModel","text":"<pre><code>EnsembledModel(\n    models: List,\n    x=[\"coord\", \"numbers\", \"charge\"],\n    out=[\"energy\", \"forces\", \"charges\"],\n    detach=True,\n)\n</code></pre> <p>               Bases: <code>Module</code></p> <p>Create ensemble of AIMNet2 models.</p> Source code in <code>bespokefit_smee/models/compile_aimnet2_ens_models.py</code> <pre><code>def __init__(\n    self,\n    models: List,\n    x=[\"coord\", \"numbers\", \"charge\"],\n    out=[\"energy\", \"forces\", \"charges\"],\n    detach=True,\n):\n    super().__init__()\n    self.models = nn.ModuleList(models)\n    self.x = x\n    self.out = out\n    self.detach = detach\n</code></pre>"},{"location":"reference/models/compile_aimnet2_ens_models/#bespokefit_smee.models.compile_aimnet2_ens_models._download_model","title":"_download_model","text":"<pre><code>_download_model(\n    method: str,\n    version: int = 0,\n    device: TorchDevice | None = None,\n) -&gt; ScriptModule\n</code></pre> <p>Download an AIMNet2 model directly from storage.</p> Source code in <code>bespokefit_smee/models/compile_aimnet2_ens_models.py</code> <pre><code>def _download_model(\n    method: str, version: int = 0, device: TorchDevice | None = None\n) -&gt; torch.jit.ScriptModule:\n    \"\"\"Download an AIMNet2 model directly from storage.\"\"\"\n    url = f\"{_MODEL_URL}{method}_{version}.jpt\"\n\n    with tempfile.NamedTemporaryFile(suffix=\".jpt\") as tmp_file:\n        urllib.request.urlretrieve(url, filename=tmp_file.name)\n        model: torch.jit.ScriptModule = torch.jit.load(  # type: ignore[no-untyped-call]\n            tmp_file.name, map_location=device\n        )\n        return model\n</code></pre>"},{"location":"reference/models/compile_aimnet2_ens_models/#bespokefit_smee.models.compile_aimnet2_ens_models.compile_aimnet2_ens_model","title":"compile_aimnet2_ens_model","text":"<pre><code>compile_aimnet2_ens_model(\n    model_name: AvailableModels,\n    n_members: int = 4,\n    device: TorchDevice = \"cpu\",\n) -&gt; ScriptModule\n</code></pre> <p>Compile an AIMNet2 ensemble model.</p> <p>Args:     model_name: Name of the AIMNet2 model to compile.     n_members: Number of ensemble members to include.     device: Torch device to load models onto.</p> <p>Returns:     Compiled AIMNet2 ensemble model.</p> Source code in <code>bespokefit_smee/models/compile_aimnet2_ens_models.py</code> <pre><code>def compile_aimnet2_ens_model(\n    model_name: AvailableModels,\n    n_members: int = 4,\n    device: TorchDevice = \"cpu\",\n) -&gt; torch.jit.ScriptModule:\n    \"\"\"Compile an AIMNet2 ensemble model.\n\n    Args:\n        model_name: Name of the AIMNet2 model to compile.\n        n_members: Number of ensemble members to include.\n        device: Torch device to load models onto.\n\n    Returns:\n        Compiled AIMNet2 ensemble model.\n    \"\"\"\n    if model_name not in get_args(AvailableModels):\n        raise ValueError(\n            f\"Invalid model name: {model_name}. Available models are: {get_args(AvailableModels)}\"\n        )\n\n    models = []\n    for i in range(n_members):\n        model = _download_model(model_name, version=i, device=device)\n        models.append(model)\n\n    ensemble_model = EnsembledModel(models=models, detach=False)\n    scripted_model = torch.jit.script(ensemble_model)  # type: ignore[no-untyped-call]\n\n    return scripted_model\n</code></pre>"},{"location":"reference/models/compile_aimnet2_ens_models/#bespokefit_smee.models.compile_aimnet2_ens_models.main","title":"main","text":"<pre><code>main()\n</code></pre> <p>Main function to compile and save AIMNet2 ensemble models.</p> Source code in <code>bespokefit_smee/models/compile_aimnet2_ens_models.py</code> <pre><code>def main():\n    \"\"\"Main function to compile and save AIMNet2 ensemble models.\"\"\"\n    for model_name in get_args(AvailableModels):\n        logger.info(f\"Compiling ensemble model for {model_name}...\")\n        ens_model = compile_aimnet2_ens_model(model_name, n_members=4, device=\"cpu\")\n        save_path = f\"{model_name}_ens.jpt\"\n        ens_model.save(save_path)\n        logger.info(f\"Saved ensemble model to {save_path}\")\n</code></pre>"},{"location":"reference/utils/","title":"Index","text":""},{"location":"reference/utils/#bespokefit_smee.utils","title":"utils","text":"<p>Utilities for the bespokefit_smee package.</p> <p>Modules:</p> <ul> <li> <code>aimnet2</code>           \u2013            <p>Utilities for working with AIMNet2. Mainly taken from</p> </li> <li> <code>gpu</code>           \u2013            <p>GPU memory management utilities.</p> </li> <li> <code>register</code>           \u2013            <p>Utilities for registering functions.</p> </li> <li> <code>typing</code>           \u2013            <p>Typing utilities for the bespokefit_smee package.</p> </li> </ul>"},{"location":"reference/utils/aimnet2/","title":"aimnet2","text":""},{"location":"reference/utils/aimnet2/#bespokefit_smee.utils.aimnet2","title":"aimnet2","text":"<p>Utilities for working with AIMNet2. Mainly taken from https://github.com/openmm/openmm-ml/pull/64 and https://github.com/SimonBoothroyd/befit/blob/main/befit/utils/aimnet2.py</p> <p>See discussion at https://github.com/isayevlab/AIMNet2/issues/15 re ensemble models.</p> <p>See https://github.com/isayevlab/aimnetcentral/blob/47969eb3e29e34824d82a648dd756669c875ecdb/scripts/compile/compile_off.yaml for available models. May compile the ensemble models in future.</p> <p>Classes:</p> <ul> <li> <code>AIMNet2PotentialImplFactory</code>           \u2013            <p>This is the factory that creates AIMNet2PotentialImpl objects.</p> </li> <li> <code>AIMNet2PotentialImpl</code>           \u2013            <p>This is the MLPotentialImpl implementing the AIMNet2 potential.</p> </li> </ul>"},{"location":"reference/utils/aimnet2/#bespokefit_smee.utils.aimnet2.AIMNet2PotentialImplFactory","title":"AIMNet2PotentialImplFactory","text":"<p>               Bases: <code>MLPotentialImplFactory</code></p> <p>This is the factory that creates AIMNet2PotentialImpl objects.</p>"},{"location":"reference/utils/aimnet2/#bespokefit_smee.utils.aimnet2.AIMNet2PotentialImpl","title":"AIMNet2PotentialImpl","text":"<pre><code>AIMNet2PotentialImpl(name: str)\n</code></pre> <p>               Bases: <code>MLPotentialImpl</code></p> <p>This is the MLPotentialImpl implementing the AIMNet2 potential.</p> Source code in <code>bespokefit_smee/utils/aimnet2.py</code> <pre><code>def __init__(self, name: str):\n    self.name = name\n</code></pre>"},{"location":"reference/utils/aimnet2/#bespokefit_smee.utils.aimnet2._load_local_model","title":"_load_local_model","text":"<pre><code>_load_local_model(\n    method: str, device: TorchDevice | None = None\n) -&gt; ScriptModule\n</code></pre> <p>Load an AIMNet2 model from local package resources.</p> Source code in <code>bespokefit_smee/utils/aimnet2.py</code> <pre><code>def _load_local_model(\n    method: str, device: TorchDevice | None = None\n) -&gt; torch.jit.ScriptModule:\n    \"\"\"Load an AIMNet2 model from local package resources.\"\"\"\n    filename = f\"{method}.jpt\"\n    with resources.path(\"bespokefit_smee.models\", filename) as model_path:\n        model: torch.jit.ScriptModule = torch.jit.load(  # type: ignore[no-untyped-call]\n            str(model_path), map_location=device\n        )\n        return model\n</code></pre>"},{"location":"reference/utils/aimnet2/#bespokefit_smee.utils.aimnet2._register_aimnet2_potentials","title":"_register_aimnet2_potentials","text":"<pre><code>_register_aimnet2_potentials() -&gt; None\n</code></pre> <p>Register the AIMNET2 potential implementation factory.</p> Source code in <code>bespokefit_smee/utils/aimnet2.py</code> <pre><code>def _register_aimnet2_potentials() -&gt; None:\n    \"\"\"Register the AIMNET2 potential implementation factory.\"\"\"\n    for model in _AVAILABLE_MODELS:\n        MLPotential.registerImplFactory(model, AIMNet2PotentialImplFactory())\n</code></pre>"},{"location":"reference/utils/gpu/","title":"gpu","text":""},{"location":"reference/utils/gpu/#bespokefit_smee.utils.gpu","title":"gpu","text":"<p>GPU memory management utilities.</p> <p>Functions:</p> <ul> <li> <code>cleanup_simulation</code>             \u2013              <p>Clean up OpenMM simulation and free GPU memory.</p> </li> </ul>"},{"location":"reference/utils/gpu/#bespokefit_smee.utils.gpu.cleanup_simulation","title":"cleanup_simulation","text":"<pre><code>cleanup_simulation(\n    simulation: Simulation,\n    integrator: Integrator | None = None,\n) -&gt; None\n</code></pre> <p>Clean up OpenMM simulation and free GPU memory.</p> <p>This function properly releases GPU resources by deleting the simulation and integrator objects, synchronizing CUDA operations, and emptying the GPU cache. The synchronization step is critical - without it, the cache may be cleared while GPU operations are still in flight.</p> <p>Parameters:</p> <ul> <li> <code>simulation</code>               (<code>Simulation</code>)           \u2013            <p>The OpenMM simulation object to clean up.</p> </li> <li> <code>integrator</code>               (<code>Integrator | None</code>, default:                   <code>None</code> )           \u2013            <p>The integrator object to clean up. If None, only the simulation is deleted.</p> </li> </ul> <p>Examples:</p> <pre><code>&gt;&gt;&gt; integrator = LangevinMiddleIntegrator(300*kelvin, 1/picosecond, 2*femtoseconds)\n&gt;&gt;&gt; simulation = Simulation(topology, system, integrator)\n&gt;&gt;&gt; # ... use simulation ...\n&gt;&gt;&gt; cleanup_simulation(simulation, integrator)\n</code></pre> Source code in <code>bespokefit_smee/utils/gpu.py</code> <pre><code>def cleanup_simulation(\n    simulation: Simulation, integrator: Integrator | None = None\n) -&gt; None:\n    \"\"\"Clean up OpenMM simulation and free GPU memory.\n\n    This function properly releases GPU resources by deleting the simulation\n    and integrator objects, synchronizing CUDA operations, and emptying the\n    GPU cache. The synchronization step is critical - without it, the cache\n    may be cleared while GPU operations are still in flight.\n\n    Parameters\n    ----------\n    simulation : Simulation\n        The OpenMM simulation object to clean up.\n    integrator : Integrator | None, optional\n        The integrator object to clean up. If None, only the simulation\n        is deleted.\n\n    Examples\n    --------\n    &gt;&gt;&gt; integrator = LangevinMiddleIntegrator(300*kelvin, 1/picosecond, 2*femtoseconds)\n    &gt;&gt;&gt; simulation = Simulation(topology, system, integrator)\n    &gt;&gt;&gt; # ... use simulation ...\n    &gt;&gt;&gt; cleanup_simulation(simulation, integrator)\n    \"\"\"\n    del simulation\n    if integrator is not None:\n        del integrator\n    if torch.cuda.is_available():\n        torch.cuda.synchronize()  # Wait for all GPU operations to complete\n        torch.cuda.empty_cache()  # Now GPU is idle, memory can actually be freed\n</code></pre>"},{"location":"reference/utils/register/","title":"register","text":""},{"location":"reference/utils/register/#bespokefit_smee.utils.register","title":"register","text":"<p>Utilities for registering functions.</p> <p>Functions:</p> <ul> <li> <code>get_registry_decorator</code>             \u2013              <p>Get a decorator to register functions in a given registry.</p> </li> </ul>"},{"location":"reference/utils/register/#bespokefit_smee.utils.register.get_registry_decorator","title":"get_registry_decorator","text":"<pre><code>get_registry_decorator(\n    registry: dict[Any, Any],\n) -&gt; Callable[[Any], Callable[[FnTypeVar], FnTypeVar]]\n</code></pre> <p>Get a decorator to register functions in a given registry.</p> <p>Parameters:</p> <ul> <li> <code>registry</code>               (<code>dict</code>)           \u2013            <p>The registry to register functions in.</p> </li> </ul> <p>Returns:</p> <ul> <li> <code>Callable[[Any], Callable[[FnTypeVar], FnTypeVar]]</code>           \u2013            <p>A decorator to register functions in the registry.</p> </li> </ul> Source code in <code>bespokefit_smee/utils/register.py</code> <pre><code>def get_registry_decorator(\n    registry: dict[Any, Any],\n) -&gt; Callable[[Any], Callable[[FnTypeVar], FnTypeVar]]:\n    \"\"\"Get a decorator to register functions in a given registry.\n\n    Parameters\n    ----------\n    registry : dict\n        The registry to register functions in.\n\n    Returns\n    -------\n    Callable[[Any], Callable[[FnTypeVar], FnTypeVar]]\n        A decorator to register functions in the registry.\n    \"\"\"\n\n    def register_fn(\n        key: Any,\n    ) -&gt; Callable[[FnTypeVar], FnTypeVar]:\n        \"\"\"Decorator to register a function in a given registry.\n\n        Parameters\n        ----------\n        key : Any\n            The key to register the function under.\n\n        Returns\n        -------\n        Callable[[FnTypeVar], FnTypeVar]\n            A decorator that registers the function in the registry.\n        \"\"\"\n\n        def decorator(func: FnTypeVar) -&gt; FnTypeVar:\n            if key in registry:\n                raise ValueError(f\"Key {key} is already registered.\")\n            registry[key] = func\n            return func\n\n        return decorator\n\n    return register_fn\n</code></pre>"},{"location":"reference/utils/typing/","title":"typing","text":""},{"location":"reference/utils/typing/#bespokefit_smee.utils.typing","title":"typing","text":"<p>Typing utilities for the bespokefit_smee package.</p> <p>Attributes:</p> <ul> <li> <code>OptimiserName</code>           \u2013            <p>Allowed optimiser names. 'adam' is Adam, 'lm' is Levenberg-Marquardt.</p> </li> </ul>"},{"location":"reference/utils/typing/#bespokefit_smee.utils.typing.OptimiserName","title":"OptimiserName  <code>module-attribute</code>","text":"<pre><code>OptimiserName = Literal['adam', 'lm']\n</code></pre> <p>Allowed optimiser names. 'adam' is Adam, 'lm' is Levenberg-Marquardt.</p>"}]}